!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t={exports:{}};(function(t){var e={exports:{}};!function(t,e){!function(e){t.exports=e()}((function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],i=t[1],r=t[2],s=t[3];i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[0]-680876936|0)<<7|n>>>25)+i|0)&i|~n&r)+e[1]-389564586|0)<<12|s>>>20)+n|0)&n|~s&i)+e[2]+606105819|0)<<17|r>>>15)+s|0)&s|~r&n)+e[3]-1044525330|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[4]-176418897|0)<<7|n>>>25)+i|0)&i|~n&r)+e[5]+1200080426|0)<<12|s>>>20)+n|0)&n|~s&i)+e[6]-1473231341|0)<<17|r>>>15)+s|0)&s|~r&n)+e[7]-45705983|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[8]+1770035416|0)<<7|n>>>25)+i|0)&i|~n&r)+e[9]-1958414417|0)<<12|s>>>20)+n|0)&n|~s&i)+e[10]-42063|0)<<17|r>>>15)+s|0)&s|~r&n)+e[11]-1990404162|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[12]+1804603682|0)<<7|n>>>25)+i|0)&i|~n&r)+e[13]-40341101|0)<<12|s>>>20)+n|0)&n|~s&i)+e[14]-1502002290|0)<<17|r>>>15)+s|0)&s|~r&n)+e[15]+1236535329|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[1]-165796510|0)<<5|n>>>27)+i|0)&r|i&~r)+e[6]-1069501632|0)<<9|s>>>23)+n|0)&i|n&~i)+e[11]+643717713|0)<<14|r>>>18)+s|0)&n|s&~n)+e[0]-373897302|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[5]-701558691|0)<<5|n>>>27)+i|0)&r|i&~r)+e[10]+38016083|0)<<9|s>>>23)+n|0)&i|n&~i)+e[15]-660478335|0)<<14|r>>>18)+s|0)&n|s&~n)+e[4]-405537848|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[9]+568446438|0)<<5|n>>>27)+i|0)&r|i&~r)+e[14]-1019803690|0)<<9|s>>>23)+n|0)&i|n&~i)+e[3]-187363961|0)<<14|r>>>18)+s|0)&n|s&~n)+e[8]+1163531501|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[13]-1444681467|0)<<5|n>>>27)+i|0)&r|i&~r)+e[2]-51403784|0)<<9|s>>>23)+n|0)&i|n&~i)+e[7]+1735328473|0)<<14|r>>>18)+s|0)&n|s&~n)+e[12]-1926607734|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[5]-378558|0)<<4|n>>>28)+i|0)^i^r)+e[8]-2022574463|0)<<11|s>>>21)+n|0)^n^i)+e[11]+1839030562|0)<<16|r>>>16)+s|0)^s^n)+e[14]-35309556|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[1]-1530992060|0)<<4|n>>>28)+i|0)^i^r)+e[4]+1272893353|0)<<11|s>>>21)+n|0)^n^i)+e[7]-155497632|0)<<16|r>>>16)+s|0)^s^n)+e[10]-1094730640|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[13]+681279174|0)<<4|n>>>28)+i|0)^i^r)+e[0]-358537222|0)<<11|s>>>21)+n|0)^n^i)+e[3]-722521979|0)<<16|r>>>16)+s|0)^s^n)+e[6]+76029189|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[9]-640364487|0)<<4|n>>>28)+i|0)^i^r)+e[12]-421815835|0)<<11|s>>>21)+n|0)^n^i)+e[15]+530742520|0)<<16|r>>>16)+s|0)^s^n)+e[2]-995338651|0)<<23|i>>>9)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[0]-198630844|0)<<6|n>>>26)+i|0)|~r))+e[7]+1126891415|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[14]-1416354905|0)<<15|r>>>17)+s|0)|~n))+e[5]-57434055|0)<<21|i>>>11)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[12]+1700485571|0)<<6|n>>>26)+i|0)|~r))+e[3]-1894986606|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[10]-1051523|0)<<15|r>>>17)+s|0)|~n))+e[1]-2054922799|0)<<21|i>>>11)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[8]+1873313359|0)<<6|n>>>26)+i|0)|~r))+e[15]-30611744|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[6]-1560198380|0)<<15|r>>>17)+s|0)|~n))+e[13]+1309151649|0)<<21|i>>>11)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[4]-145523070|0)<<6|n>>>26)+i|0)|~r))+e[11]-1120210379|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[2]+718787259|0)<<15|r>>>17)+s|0)|~n))+e[9]-343485551|0)<<21|i>>>11)+r|0,t[0]=n+t[0]|0,t[1]=i+t[1]|0,t[2]=r+t[2]|0,t[3]=s+t[3]|0}function i(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function r(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function s(t){var e,r,s,o,a,l,c=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(d,i(t.substring(e-64,e)));for(r=(t=t.substring(e-64)).length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(n(d,s),e=0;e<16;e+=1)s[e]=0;return o=(o=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(o[2],16),l=parseInt(o[1],16)||0,s[14]=a,s[15]=l,n(d,s),d}function o(t){var e,i,s,o,a,l,c=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(d,r(t.subarray(e-64,e)));for(i=(t=e-64<c?t.subarray(e-64):new Uint8Array(0)).length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)s[e>>2]|=t[e]<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(n(d,s),e=0;e<16;e+=1)s[e]=0;return o=(o=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(o[2],16),l=parseInt(o[1],16)||0,s[14]=a,s[15]=l,n(d,s),d}function a(t){var n,i="";for(n=0;n<4;n+=1)i+=e[t>>8*n+4&15]+e[t>>8*n&15];return i}function l(t){var e;for(e=0;e<t.length;e+=1)t[e]=a(t[e]);return t.join("")}function c(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function d(t,e){var n,i=t.length,r=new ArrayBuffer(i),s=new Uint8Array(r);for(n=0;n<i;n+=1)s[n]=t.charCodeAt(n);return e?s:r}function h(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function u(t,e,n){var i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t)),i.set(new Uint8Array(e),t.byteLength),n?i:i.buffer}function p(t){var e,n=[],i=t.length;for(e=0;e<i-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function f(){this.reset()}return l(s("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,i){var r,s,o,a,l=this.byteLength,c=e(n,l),d=l;return i!==t&&(d=e(i,l)),c>d?new ArrayBuffer(0):(r=d-c,s=new ArrayBuffer(r),o=new Uint8Array(s),a=new Uint8Array(this,c,r),o.set(a),s)}}(),f.prototype.append=function(t){return this.appendBinary(c(t)),this},f.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,r=this._buff.length;for(e=64;e<=r;e+=64)n(this._hash,i(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},f.prototype.end=function(t){var e,n,i=this._buff,r=i.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)s[e>>2]|=i.charCodeAt(e)<<(e%4<<3);return this._finish(s,r),n=l(this._hash),t&&(n=p(n)),this.reset(),n},f.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},f.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},f.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},f.prototype._finish=function(t,e){var i,r,s,o=e;if(t[o>>2]|=128<<(o%4<<3),o>55)for(n(this._hash,t),o=0;o<16;o+=1)t[o]=0;i=(i=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(i[2],16),s=parseInt(i[1],16)||0,t[14]=r,t[15]=s,n(this._hash,t)},f.hash=function(t,e){return f.hashBinary(c(t),e)},f.hashBinary=function(t,e){var n=l(s(t));return e?p(n):n},f.ArrayBuffer=function(){this.reset()},f.ArrayBuffer.prototype.append=function(t){var e,i=u(this._buff.buffer,t,!0),s=i.length;for(this._length+=t.byteLength,e=64;e<=s;e+=64)n(this._hash,r(i.subarray(e-64,e)));return this._buff=e-64<s?new Uint8Array(i.buffer.slice(e-64)):new Uint8Array(0),this},f.ArrayBuffer.prototype.end=function(t){var e,n,i=this._buff,r=i.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)s[e>>2]|=i[e]<<(e%4<<3);return this._finish(s,r),n=l(this._hash),t&&(n=p(n)),this.reset(),n},f.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.ArrayBuffer.prototype.getState=function(){var t=f.prototype.getState.call(this);return t.buff=h(t.buff),t},f.ArrayBuffer.prototype.setState=function(t){return t.buff=d(t.buff,!0),f.prototype.setState.call(this,t)},f.ArrayBuffer.prototype.destroy=f.prototype.destroy,f.ArrayBuffer.prototype._finish=f.prototype._finish,f.ArrayBuffer.hash=function(t,e){var n=l(o(new Uint8Array(t)));return e?p(n):n},f}))}(e);var n=e.exports;const i=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;class r{static create(t,e){new r(t).create(e)}constructor(t){this.file=t,this.chunkSize=2097152,this.chunkCount=Math.ceil(this.file.size/this.chunkSize),this.chunkIndex=0}create(t){this.callback=t,this.md5Buffer=new n.ArrayBuffer,this.fileReader=new FileReader,this.fileReader.addEventListener("load",(t=>this.fileReaderDidLoad(t))),this.fileReader.addEventListener("error",(t=>this.fileReaderDidError(t))),this.readNextChunk()}fileReaderDidLoad(t){if(this.md5Buffer.append(t.target.result),!this.readNextChunk()){const t=this.md5Buffer.end(!0),e=btoa(t);this.callback(null,e)}}fileReaderDidError(t){this.callback(`Error reading ${this.file.name}`)}readNextChunk(){if(this.chunkIndex<this.chunkCount||0==this.chunkIndex&&0==this.chunkCount){const t=this.chunkIndex*this.chunkSize,e=Math.min(t+this.chunkSize,this.file.size),n=i.call(this.file,t,e);return this.fileReader.readAsArrayBuffer(n),this.chunkIndex++,!0}return!1}}function s(t){const e=a(document.head,`meta[name="${t}"]`);if(e)return e.getAttribute("content")}function o(t,e){return"string"==typeof t&&(e=t,t=document),c(t.querySelectorAll(e))}function a(t,e){return"string"==typeof t&&(e=t,t=document),t.querySelector(e)}function l(t,e,n={}){const{disabled:i}=t,{bubbles:r,cancelable:s,detail:o}=n,a=document.createEvent("Event");a.initEvent(e,r||!0,s||!0),a.detail=o||{};try{t.disabled=!1,t.dispatchEvent(a)}finally{t.disabled=i}return a}function c(t){return Array.isArray(t)?t:Array.from?Array.from(t):[].slice.call(t)}class d{constructor(t,e,n){this.file=t,this.attributes={filename:t.name,content_type:t.type||"application/octet-stream",byte_size:t.size,checksum:e},this.xhr=new XMLHttpRequest,this.xhr.open("POST",n,!0),this.xhr.responseType="json",this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("Accept","application/json"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");const i=s("csrf-token");null!=i&&this.xhr.setRequestHeader("X-CSRF-Token",i),this.xhr.addEventListener("load",(t=>this.requestDidLoad(t))),this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}get status(){return this.xhr.status}get response(){const{responseType:t,response:e}=this.xhr;return"json"==t?e:JSON.parse(e)}create(t){this.callback=t,this.xhr.send(JSON.stringify({blob:this.attributes}))}requestDidLoad(t){if(this.status>=200&&this.status<300){const{response:t}=this,{direct_upload:e}=t;delete t.direct_upload,this.attributes=t,this.directUploadData=e,this.callback(null,this.toJSON())}else this.requestDidError(t)}requestDidError(t){this.callback(`Error creating Blob for "${this.file.name}". Status: ${this.status}`)}toJSON(){const t={};for(const e in this.attributes)t[e]=this.attributes[e];return t}}class h{constructor(t){this.blob=t,this.file=t.file;const{url:e,headers:n}=t.directUploadData;this.xhr=new XMLHttpRequest,this.xhr.open("PUT",e,!0),this.xhr.responseType="text";for(const t in n)this.xhr.setRequestHeader(t,n[t]);this.xhr.addEventListener("load",(t=>this.requestDidLoad(t))),this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}create(t){this.callback=t,this.xhr.send(this.file.slice())}requestDidLoad(t){const{status:e,response:n}=this.xhr;e>=200&&e<300?this.callback(null,n):this.requestDidError(t)}requestDidError(t){this.callback(`Error storing "${this.file.name}". Status: ${this.xhr.status}`)}}let u=0;class p{constructor(t,e,n){this.id=++u,this.file=t,this.url=e,this.delegate=n}create(t){r.create(this.file,((e,n)=>{if(e)return void t(e);const i=new d(this.file,n,this.url);f(this.delegate,"directUploadWillCreateBlobWithXHR",i.xhr),i.create((e=>{if(e)t(e);else{const e=new h(i);f(this.delegate,"directUploadWillStoreFileWithXHR",e.xhr),e.create((e=>{e?t(e):t(null,i.toJSON())}))}}))}))}}function f(t,e,...n){if(t&&"function"==typeof t[e])return t[e](...n)}class m{constructor(t,e){this.input=t,this.file=e,this.directUpload=new p(this.file,this.url,this),this.dispatch("initialize")}start(t){const e=document.createElement("input");e.type="hidden",e.name=this.input.name,this.input.insertAdjacentElement("beforebegin",e),this.dispatch("start"),this.directUpload.create(((n,i)=>{n?(e.parentNode.removeChild(e),this.dispatchError(n)):e.value=i.signed_id,this.dispatch("end"),t(n)}))}uploadRequestDidProgress(t){const e=t.loaded/t.total*100;e&&this.dispatch("progress",{progress:e})}get url(){return this.input.getAttribute("data-direct-upload-url")}dispatch(t,e={}){return e.file=this.file,e.id=this.directUpload.id,l(this.input,`direct-upload:${t}`,{detail:e})}dispatchError(t){this.dispatch("error",{error:t}).defaultPrevented||alert(t)}directUploadWillCreateBlobWithXHR(t){this.dispatch("before-blob-request",{xhr:t})}directUploadWillStoreFileWithXHR(t){this.dispatch("before-storage-request",{xhr:t}),t.upload.addEventListener("progress",(t=>this.uploadRequestDidProgress(t)))}}const g="input[type=file][data-direct-upload-url]:not([disabled])";class b{constructor(t){this.form=t,this.inputs=o(t,g).filter((t=>t.files.length))}start(t){const e=this.createDirectUploadControllers(),n=()=>{const i=e.shift();i?i.start((e=>{e?(t(e),this.dispatch("end")):n()})):(t(),this.dispatch("end"))};this.dispatch("start"),n()}createDirectUploadControllers(){const t=[];return this.inputs.forEach((e=>{c(e.files).forEach((n=>{const i=new m(e,n);t.push(i)}))})),t}dispatch(t,e={}){return l(this.form,`direct-uploads:${t}`,{detail:e})}}const v="data-direct-uploads-processing",y=new WeakMap;let w=!1;function k(){w||(w=!0,document.addEventListener("click",S,!0),document.addEventListener("submit",x,!0),document.addEventListener("ajax:before",E))}function S(t){const{target:e}=t;"INPUT"!=e.tagName&&"BUTTON"!=e.tagName||"submit"!=e.type||!e.form||y.set(e.form,e)}function x(t){C(t)}function E(t){"FORM"==t.target.tagName&&C(t)}function C(t){const e=t.target;if(e.hasAttribute(v))return void t.preventDefault();const n=new b(e),{inputs:i}=n;i.length&&(t.preventDefault(),e.setAttribute(v,""),i.forEach(A),n.start((t=>{e.removeAttribute(v),t?i.forEach(O):_(e)})))}function _(t){let e=y.get(t)||a(t,"input[type=submit], button[type=submit]");if(e){const{disabled:t}=e;e.disabled=!1,e.focus(),e.click(),e.disabled=t}else e=document.createElement("input"),e.type="submit",e.style.display="none",t.appendChild(e),e.click(),t.removeChild(e);y.delete(t)}function A(t){t.disabled=!0}function O(t){t.disabled=!1}function T(){window.ActiveStorage&&k()}setTimeout(T,1),t.DirectUpload=p,t.start=k,Object.defineProperty(t,"__esModule",{value:!0})})(t.exports);class e{constructor(e,n){this.attachment=e,this.element=n,this.directUpload=new t.exports.DirectUpload(e.file,this.directUploadUrl,this)}start(){this.directUpload.create(this.directUploadDidComplete.bind(this))}directUploadWillStoreFileWithXHR(t){t.upload.addEventListener("progress",(t=>{const e=t.loaded/t.total*100;this.attachment.setUploadProgress(e)}))}directUploadDidComplete(t,e){if(t)throw new Error(`Direct upload failed: ${t}`);this.attachment.setAttributes({sgid:e.attachable_sgid,url:this.createBlobUrl(e.signed_id,e.filename)})}createBlobUrl(t,e){return this.blobUrlTemplate.replace(":signed_id",t).replace(":filename",encodeURIComponent(e))}get directUploadUrl(){return this.element.dataset.directUploadUrl}get blobUrlTemplate(){return this.element.dataset.blobUrlTemplate}}addEventListener("trix-attachment-add",(t=>{const{attachment:n,target:i}=t;if(n.file){new e(n,i).start()}}));var n=/Mac|iOS|iPhone|iPad|iPod/i.test(window.navigator.platform),i=n?"cmd":"ctrl",r={attachFiles:"Attach Files",bold:`Bold <${i}+b>`,italics:`Italicize <${i}+i>`,strike:`Strikethrough <${i}+shift+x>`,link:`Link <${i}+k>`,heading:`Heading <${i}+alt+1>`,blockQuote:`Blockquote <${i}+shift+b>`,codeBlock:`Codeblock <${i}+e>`,bulletList:`Bullet List <${i}+shift+7>`,orderedList:`Ordered List <${i}+shift+8>`,undo:`Undo <${i}+z>`,redo:`Redo <${i}+shift+z>`,linkDialogLink:"Link",linkDialogUnlink:"Unlink",placeholder:"Write something..."};function s(t){this.content=t}function o(t,e,n){for(let i=0;;i++){if(i==t.childCount||i==e.childCount)return t.childCount==e.childCount?null:n;let r=t.child(i),s=e.child(i);if(r!=s){if(!r.sameMarkup(s))return n;if(r.isText&&r.text!=s.text){for(let t=0;r.text[t]==s.text[t];t++)n++;return n}if(r.content.size||s.content.size){let t=o(r.content,s.content,n+1);if(null!=t)return t}n+=r.nodeSize}else n+=r.nodeSize}}function a(t,e,n,i){for(let r=t.childCount,s=e.childCount;;){if(0==r||0==s)return r==s?null:{a:n,b:i};let o=t.child(--r),l=e.child(--s),c=o.nodeSize;if(o!=l){if(!o.sameMarkup(l))return{a:n,b:i};if(o.isText&&o.text!=l.text){let t=0,e=Math.min(o.text.length,l.text.length);for(;t<e&&o.text[o.text.length-t-1]==l.text[l.text.length-t-1];)t++,n--,i--;return{a:n,b:i}}if(o.content.size||l.content.size){let t=a(o.content,l.content,n-1,i-1);if(t)return t}n-=c,i-=c}else n-=c,i-=c}}s.prototype={constructor:s,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var i=n&&n!=t?this.remove(n):this,r=i.find(t),o=i.content.slice();return-1==r?o.push(n||t,e):(o[r+1]=e,n&&(o[r]=n)),new s(o)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new s(n)},addToStart:function(t,e){return new s([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new s(n)},addBefore:function(t,e,n){var i=this.remove(e),r=i.content.slice(),o=i.find(t);return r.splice(-1==o?r.length:o,0,e,n),new s(r)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=s.from(t)).size?new s(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=s.from(t)).size?new s(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=s.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach((function(e,n){t[e]=n})),t},get size(){return this.content.length>>1}},s.from=function(t){if(t instanceof s)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new s(e)};class l{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let e=0;e<t.length;e++)this.size+=t[e].nodeSize}nodesBetween(t,e,n,i=0,r){for(let s=0,o=0;o<e;s++){let a=this.content[s],l=o+a.nodeSize;if(l>t&&!1!==n(a,i+o,r||null,s)&&a.content.size){let r=o+1;a.nodesBetween(Math.max(0,t-r),Math.min(a.content.size,e-r),n,i+r)}o=l}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,n,i){let r="",s=!0;return this.nodesBetween(t,e,((o,a)=>{o.isText?(r+=o.text.slice(Math.max(t,a)-a,e-a),s=!n):o.isLeaf?(i?r+="function"==typeof i?i(o):i:o.type.spec.leafText&&(r+=o.type.spec.leafText(o)),s=!n):!s&&o.isBlock&&(r+=n,s=!0)}),0),r}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,n=t.firstChild,i=this.content.slice(),r=0;for(e.isText&&e.sameMarkup(n)&&(i[i.length-1]=e.withText(e.text+n.text),r=1);r<t.content.length;r++)i.push(t.content[r]);return new l(i,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let n=[],i=0;if(e>t)for(let r=0,s=0;s<e;r++){let o=this.content[r],a=s+o.nodeSize;a>t&&((s<t||a>e)&&(o=o.isText?o.cut(Math.max(0,t-s),Math.min(o.text.length,e-s)):o.cut(Math.max(0,t-s-1),Math.min(o.content.size,e-s-1))),n.push(o),i+=o.nodeSize),s=a}return new l(n,i)}cutByIndex(t,e){return t==e?l.empty:0==t&&e==this.content.length?this:new l(this.content.slice(t,e))}replaceChild(t,e){let n=this.content[t];if(n==e)return this;let i=this.content.slice(),r=this.size+e.nodeSize-n.nodeSize;return i[t]=e,new l(i,r)}addToStart(t){return new l([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new l(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,n=0;e<this.content.length;e++){let i=this.content[e];t(i,n,e),n+=i.nodeSize}}findDiffStart(t,e=0){return o(this,t,e)}findDiffEnd(t,e=this.size,n=t.size){return a(this,t,e,n)}findIndex(t,e=-1){if(0==t)return d(0,t);if(t==this.size)return d(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let n=0,i=0;;n++){let r=i+this.child(n).nodeSize;if(r>=t)return r==t||e>0?d(n+1,r):d(n,i);i=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((t=>t.toJSON())):null}static fromJSON(t,e){if(!e)return l.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new l(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return l.empty;let e,n=0;for(let i=0;i<t.length;i++){let r=t[i];n+=r.nodeSize,i&&r.isText&&t[i-1].sameMarkup(r)?(e||(e=t.slice(0,i)),e[e.length-1]=r.withText(e[e.length-1].text+r.text)):e&&e.push(r)}return new l(e||t,n)}static from(t){if(!t)return l.empty;if(t instanceof l)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new l([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}l.empty=new l([],0);const c={index:0,offset:0};function d(t,e){return c.index=t,c.offset=e,c}function h(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!h(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!h(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}class u{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,n=!1;for(let i=0;i<t.length;i++){let r=t[i];if(this.eq(r))return t;if(this.type.excludes(r.type))e||(e=t.slice(0,i));else{if(r.type.excludes(this.type))return t;!n&&r.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),n=!0),e&&e.push(r)}}return e||(e=t.slice()),n||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&h(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[e.type];if(!n)throw new RangeError(`There is no mark type ${e.type} in this schema`);return n.create(e.attrs)}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return u.none;if(t instanceof u)return[t];let e=t.slice();return e.sort(((t,e)=>t.type.rank-e.type.rank)),e}}u.none=[];class p extends Error{}class f{constructor(t,e,n){this.content=t,this.openStart=e,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let n=g(this.content,t+this.openStart,e);return n&&new f(n,this.openStart,this.openEnd)}removeBetween(t,e){return new f(m(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return f.empty;let n=e.openStart||0,i=e.openEnd||0;if("number"!=typeof n||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new f(l.fromJSON(t,e.content),n,i)}static maxOpen(t,e=!0){let n=0,i=0;for(let i=t.firstChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.firstChild)n++;for(let n=t.lastChild;n&&!n.isLeaf&&(e||!n.type.spec.isolating);n=n.lastChild)i++;return new f(t,n,i)}}function m(t,e,n){let{index:i,offset:r}=t.findIndex(e),s=t.maybeChild(i),{index:o,offset:a}=t.findIndex(n);if(r==e||s.isText){if(a!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(i!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(m(s.content,e-r-1,n-r-1)))}function g(t,e,n,i){let{index:r,offset:s}=t.findIndex(e),o=t.maybeChild(r);if(s==e||o.isText)return i&&!i.canReplace(r,r,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=g(o.content,e-s-1,n);return a&&t.replaceChild(r,o.copy(a))}function b(t,e,n){if(n.openStart>t.depth)throw new p("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new p("Inconsistent open depths");return v(t,e,n,0)}function v(t,e,n,i){let r=t.index(i),s=t.node(i);if(r==e.index(i)&&i<t.depth-n.openStart){let o=v(t,e,n,i+1);return s.copy(s.content.replaceChild(r,o))}if(n.content.size){if(n.openStart||n.openEnd||t.depth!=i||e.depth!=i){let{start:r,end:o}=function(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let t=n-1;t>=0;t--)i=e.node(t).copy(l.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}(n,t);return x(s,E(t,r,o,e,i))}{let i=t.parent,r=i.content;return x(i,r.cut(0,t.parentOffset).append(n.content).append(r.cut(e.parentOffset)))}}return x(s,C(t,e,i))}function y(t,e){if(!e.type.compatibleContent(t.type))throw new p("Cannot join "+e.type.name+" onto "+t.type.name)}function w(t,e,n){let i=t.node(n);return y(i,e.node(n)),i}function k(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function S(t,e,n,i){let r=(e||t).node(n),s=0,o=e?e.index(n):r.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(k(t.nodeAfter,i),s++));for(let t=s;t<o;t++)k(r.child(t),i);e&&e.depth==n&&e.textOffset&&k(e.nodeBefore,i)}function x(t,e){return t.type.checkContent(e),t.copy(e)}function E(t,e,n,i,r){let s=t.depth>r&&w(t,e,r+1),o=i.depth>r&&w(n,i,r+1),a=[];return S(null,t,r,a),s&&o&&e.index(r)==n.index(r)?(y(s,o),k(x(s,E(t,e,n,i,r+1)),a)):(s&&k(x(s,C(t,e,r+1)),a),S(e,n,r,a),o&&k(x(o,C(n,i,r+1)),a)),S(i,null,r,a),new l(a)}function C(t,e,n){let i=[];if(S(null,t,n,i),t.depth>n){k(x(w(t,e,n+1),C(t,e,n+1)),i)}return S(e,null,n,i),new l(i)}f.empty=new f(l.empty,0,0);class _{constructor(t,e,n){this.pos=t,this.path=e,this.parentOffset=n,this.depth=e.length/3-1}resolveDepth(t){return null==t?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[3*this.resolveDepth(t)]}index(t){return this.path[3*this.resolveDepth(t)+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)}start(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]}after(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=t.child(e);return n?t.child(e).cut(n):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let n=this.path[3*e],i=0==e?0:this.path[3*e-1]+1;for(let e=0;e<t;e++)i+=n.child(e).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(0==t.content.size)return u.none;if(this.textOffset)return t.child(e).marks;let n=t.maybeChild(e-1),i=t.maybeChild(e);if(!n){let t=n;n=i,i=t}let r=n.marks;for(var s=0;s<r.length;s++)!1!==r[s].type.spec.inclusive||i&&r[s].isInSet(i.marks)||(r=r[s--].removeFromSet(r));return r}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let n=e.marks,i=t.parent.maybeChild(t.index());for(var r=0;r<n.length;r++)!1!==n[r].type.spec.inclusive||i&&n[r].isInSet(i.marks)||(n=n[r--].removeFromSet(n));return n}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new M(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let n=[],i=0,r=e;for(let e=t;;){let{index:t,offset:s}=e.content.findIndex(r),o=r-s;if(n.push(e,t,i+s),!o)break;if(e=e.child(t),e.isText)break;r=o-1,i+=s+1}return new _(e,n,r)}static resolveCached(t,e){for(let n=0;n<A.length;n++){let i=A[n];if(i.pos==e&&i.doc==t)return i}let n=A[O]=_.resolve(t,e);return O=(O+1)%T,n}}let A=[],O=0,T=12;class M{constructor(t,e,n){this.$from=t,this.$to=e,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const D=Object.create(null);class L{constructor(t,e,n,i=u.none){this.type=t,this.attrs=e,this.marks=i,this.content=n||l.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,n,i=0){this.content.nodesBetween(t,e,n,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,n,i){return this.content.textBetween(t,e,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,n){return this.type==t&&h(this.attrs,e||t.defaultAttrs||D)&&u.sameSet(this.marks,n||u.none)}copy(t=null){return t==this.content?this:new L(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new L(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,n=!1){if(t==e)return f.empty;let i=this.resolve(t),r=this.resolve(e),s=n?0:i.sharedDepth(e),o=i.start(s),a=i.node(s).content.cut(i.pos-o,r.pos-o);return new f(a,i.depth-s,r.depth-s)}replace(t,e,n){return b(this.resolve(t),this.resolve(e),n)}nodeAt(t){for(let e=this;;){let{index:n,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(n),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:n}}childBefore(t){if(0==t)return{node:null,index:0,offset:0};let{index:e,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(e),index:e,offset:n};let i=this.content.child(e-1);return{node:i,index:e-1,offset:n-i.nodeSize}}resolve(t){return _.resolveCached(this,t)}resolveNoCache(t){return _.resolve(this,t)}rangeHasMark(t,e,n){let i=!1;return e>t&&this.nodesBetween(t,e,(t=>(n.isInSet(t.marks)&&(i=!0),!i))),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),I(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,n=l.empty,i=0,r=n.childCount){let s=this.contentMatchAt(t).matchFragment(n,i,r),o=s&&s.matchFragment(this.content,e);if(!o||!o.validEnd)return!1;for(let t=i;t<r;t++)if(!this.type.allowsMarks(n.child(t).marks))return!1;return!0}canReplaceWith(t,e,n,i){if(i&&!this.type.allowsMarks(i))return!1;let r=this.contentMatchAt(t).matchType(n),s=r&&r.matchFragment(this.content,e);return!!s&&s.validEnd}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content);let t=u.none;for(let e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!u.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map((t=>t.type.name))}`);this.content.forEach((t=>t.check()))}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((t=>t.toJSON()))),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}let i=l.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,i,n)}}L.prototype.text=void 0;class N extends L{constructor(t,e,n,i){if(super(t,e,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):I(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new N(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new N(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return 0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function I(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class P{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let n=new R(t,e);if(null==n.next)return P.empty;let i=F(n);n.next&&n.err("Unexpected trailing text");let r=function(t){let e=Object.create(null);return n(q(t,0));function n(i){let r=[];i.forEach((e=>{t[e].forEach((({term:e,to:n})=>{if(!e)return;let i;for(let t=0;t<r.length;t++)r[t][0]==e&&(i=r[t][1]);q(t,n).forEach((t=>{i||r.push([e,i=[]]),-1==i.indexOf(t)&&i.push(t)}))}))}));let s=e[i.join(",")]=new P(i.indexOf(t.length-1)>-1);for(let t=0;t<r.length;t++){let i=r[t][1].sort(V);s.next.push({type:r[t][0],next:e[i.join(",")]||n(i)})}return s}}(function(t){let e=[[]];return r(s(t,0),n()),e;function n(){return e.push([])-1}function i(t,n,i){let r={term:i,to:n};return e[t].push(r),r}function r(t,e){t.forEach((t=>t.to=e))}function s(t,e){if("choice"==t.type)return t.exprs.reduce(((t,n)=>t.concat(s(n,e))),[]);if("seq"!=t.type){if("star"==t.type){let o=n();return i(e,o),r(s(t.expr,o),o),[i(o)]}if("plus"==t.type){let o=n();return r(s(t.expr,e),o),r(s(t.expr,o),o),[i(o)]}if("opt"==t.type)return[i(e)].concat(s(t.expr,e));if("range"==t.type){let o=e;for(let e=0;e<t.min;e++){let e=n();r(s(t.expr,o),e),o=e}if(-1==t.max)r(s(t.expr,o),o);else for(let e=t.min;e<t.max;e++){let e=n();i(o,e),r(s(t.expr,o),e),o=e}return[i(o)]}if("name"==t.type)return[i(e,void 0,t.value)];throw new Error("Unknown expr type")}for(let i=0;;i++){let o=s(t.exprs[i],e);if(i==t.exprs.length-1)return o;r(o,e=n())}}}(i));return function(t,e){for(let n=0,i=[t];n<i.length;n++){let t=i[n],r=!t.validEnd,s=[];for(let e=0;e<t.next.length;e++){let{type:n,next:o}=t.next[e];s.push(n.name),!r||n.isText||n.hasRequiredAttrs()||(r=!1),-1==i.indexOf(o)&&i.push(o)}r&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(r,n),r}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,n=t.childCount){let i=this;for(let r=e;i&&r<n;r++)i=i.matchType(t.child(r).type);return i}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let n=0;n<t.next.length;n++)if(this.next[e].type==t.next[n].type)return!0;return!1}fillBefore(t,e=!1,n=0){let i=[this];return function r(s,o){let a=s.matchFragment(t,n);if(a&&(!e||a.validEnd))return l.from(o.map((t=>t.createAndFill())));for(let t=0;t<s.next.length;t++){let{type:e,next:n}=s.next[t];if(!e.isText&&!e.hasRequiredAttrs()&&-1==i.indexOf(n)){i.push(n);let t=r(n,o.concat(e));if(t)return t}}return null}(this,[])}findWrapping(t){for(let e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),r=i.match;if(r.matchType(t)){let t=[];for(let e=i;e.type;e=e.via)t.push(e.type);return t.reverse()}for(let t=0;t<r.next.length;t++){let{type:s,next:o}=r.next[t];s.isLeaf||s.hasRequiredAttrs()||s.name in e||i.type&&!o.validEnd||(n.push({match:s.contentMatch,type:s,via:i}),e[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];return function e(n){t.push(n);for(let i=0;i<n.next.length;i++)-1==t.indexOf(n.next[i].next)&&e(n.next[i].next)}(this),t.map(((e,n)=>{let i=n+(e.validEnd?"*":" ")+" ";for(let n=0;n<e.next.length;n++)i+=(n?", ":"")+e.next[n].type.name+"->"+t.indexOf(e.next[n].next);return i})).join("\n")}}P.empty=new P(!0);class R{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function F(t){let e=[];do{e.push(B(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function B(t){let e=[];do{e.push(j(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function j(t){let e=function(t){if(t.eat("(")){let e=F(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){let e=function(t,e){let n=t.nodeTypes,i=n[e];if(i)return[i];let r=[];for(let t in n){let i=n[t];i.groups.indexOf(e)>-1&&r.push(i)}0==r.length&&t.err("No node type or group '"+e+"' found");return r}(t,t.next).map((e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e})));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}t.err("Unexpected token '"+t.next+"'")}(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=z(t,e)}return e}function H(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function z(t,e){let n=H(t),i=n;return t.eat(",")&&(i="}"!=t.next?H(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:e}}function V(t,e){return e-t}function q(t,e){let n=[];return function e(i){let r=t[i];if(1==r.length&&!r[0].term)return e(r[0].to);n.push(i);for(let t=0;t<r.length;t++){let{term:i,to:s}=r[t];i||-1!=n.indexOf(s)||e(s)}}(e),n.sort(V)}function U(t){let e=Object.create(null);for(let n in t){let i=t[n];if(!i.hasDefault)return null;e[n]=i.default}return e}function W(t,e){let n=Object.create(null);for(let i in t){let r=e&&e[i];if(void 0===r){let e=t[i];if(!e.hasDefault)throw new RangeError("No value supplied for attribute "+i);r=e.default}n[i]=r}return n}function K(t){let e=Object.create(null);if(t)for(let n in t)e[n]=new J(t[n]);return e}class Y{constructor(t,e,n){this.name=t,this.schema=e,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=K(n.attrs),this.defaultAttrs=U(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==P.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:W(this.attrs,t)}create(t=null,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new L(this,this.computeAttrs(t),l.from(e),u.setFrom(n))}createChecked(t=null,e,n){return e=l.from(e),this.checkContent(e),new L(this,this.computeAttrs(t),e,u.setFrom(n))}createAndFill(t=null,e,n){if(t=this.computeAttrs(t),(e=l.from(e)).size){let t=this.contentMatch.fillBefore(e);if(!t)return null;e=t.append(e)}let i=this.contentMatch.matchFragment(e),r=i&&i.fillBefore(l.empty,!0);return r?new L(this,t,e.append(r),u.setFrom(n)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let e=0;e<t.childCount;e++)if(!this.allowsMarks(t.child(e).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}allowsMarkType(t){return null==this.markSet||this.markSet.indexOf(t)>-1}allowsMarks(t){if(null==this.markSet)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(null==this.markSet)return t;let e;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:u.none:t}static compile(t,e){let n=Object.create(null);t.forEach(((t,i)=>n[t]=new Y(t,e,i)));let i=e.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let t in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class J{constructor(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}get isRequired(){return!this.hasDefault}}class G{constructor(t,e,n,i){this.name=t,this.rank=e,this.schema=n,this.spec=i,this.attrs=K(i.attrs),this.excluded=null;let r=U(this.attrs);this.instance=r?new u(this,r):null}create(t=null){return!t&&this.instance?this.instance:new u(this,W(this.attrs,t))}static compile(t,e){let n=Object.create(null),i=0;return t.forEach(((t,r)=>n[t]=new G(t,i++,e,r))),n}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}excludes(t){return this.excluded.indexOf(t)>-1}}class X{constructor(t){this.cached=Object.create(null);let e=this.spec={};for(let n in t)e[n]=t[n];e.nodes=s.from(t.nodes),e.marks=s.from(t.marks||{}),this.nodes=Y.compile(this.spec.nodes,this),this.marks=G.compile(this.spec.marks,this);let n=Object.create(null);for(let t in this.nodes){if(t in this.marks)throw new RangeError(t+" can not be both a node and a mark");let e=this.nodes[t],i=e.spec.content||"",r=e.spec.marks;e.contentMatch=n[i]||(n[i]=P.parse(i,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.markSet="_"==r?null:r?Q(this,r.split(" ")):""!=r&&e.inlineContent?null:[]}for(let t in this.marks){let e=this.marks[t],n=e.spec.excludes;e.excluded=null==n?[e]:""==n?[]:Q(this,n.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,n,i){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Y))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,i)}text(t,e){let n=this.nodes.text;return new N(n,n.defaultAttrs,t,u.setFrom(e))}mark(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return L.fromJSON(this,t)}markFromJSON(t){return u.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function Q(t,e){let n=[];for(let i=0;i<e.length;i++){let r=e[i],s=t.marks[r],o=s;if(s)n.push(s);else for(let e in t.marks){let i=t.marks[e];("_"==r||i.spec.group&&i.spec.group.split(" ").indexOf(r)>-1)&&n.push(o=i)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}class Z{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((t=>{t.tag?this.tags.push(t):t.style&&this.styles.push(t)})),this.normalizeLists=!this.tags.some((e=>{if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;let n=t.nodes[e.node];return n.contentMatch.matchType(n)}))}parse(t,e={}){let n=new lt(this,e,!1);return n.addAll(t,e.from,e.to),n.finish()}parseSlice(t,e={}){let n=new lt(this,e,!0);return n.addAll(t,e.from,e.to),f.maxOpen(n.finish())}matchTag(t,e,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let n=this.tags[i];if(ct(t,n.tag)&&(void 0===n.namespace||t.namespaceURI==n.namespace)&&(!n.context||e.matchesContext(n.context))){if(n.getAttrs){let e=n.getAttrs(t);if(!1===e)continue;n.attrs=e||void 0}return n}}}matchStyle(t,e,n,i){for(let r=i?this.styles.indexOf(i)+1:0;r<this.styles.length;r++){let i=this.styles[r],s=i.style;if(!(0!=s.indexOf(t)||i.context&&!n.matchesContext(i.context)||s.length>t.length&&(61!=s.charCodeAt(t.length)||s.slice(t.length+1)!=e))){if(i.getAttrs){let t=i.getAttrs(e);if(!1===t)continue;i.attrs=t||void 0}return i}}}static schemaRules(t){let e=[];function n(t){let n=null==t.priority?50:t.priority,i=0;for(;i<e.length;i++){let t=e[i];if((null==t.priority?50:t.priority)<n)break}e.splice(i,0,t)}for(let e in t.marks){let i=t.marks[e].spec.parseDOM;i&&i.forEach((t=>{n(t=dt(t)),t.mark||t.ignore||t.clearMark||(t.mark=e)}))}for(let e in t.nodes){let i=t.nodes[e].spec.parseDOM;i&&i.forEach((t=>{n(t=dt(t)),t.node||t.ignore||t.mark||(t.node=e)}))}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Z(t,Z.schemaRules(t)))}}const tt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},et={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nt={ol:!0,ul:!0},it=1,rt=2,st=4;function ot(t,e,n){return null!=e?(e?it:0)|("full"===e?rt:0):t&&"pre"==t.whitespace?it|rt:n&~st}class at{constructor(t,e,n,i,r,s,o){this.type=t,this.attrs=e,this.marks=n,this.pendingMarks=i,this.solid=r,this.options=o,this.content=[],this.activeMarks=u.none,this.stashMarks=[],this.match=s||(o&st?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(l.from(t));if(!e){let e,n=this.type.contentMatch;return(e=n.findWrapping(t.type))?(this.match=n,e):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&it)){let t,e=this.content[this.content.length-1];if(e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))){let n=e;e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length))}}let e=l.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(l.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}popFromStashMark(t){for(let e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]}applyPending(t){for(let e=0,n=this.pendingMarks;e<n.length;e++){let i=n[e];(this.type?this.type.allowsMarkType(i.type):ht(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!tt.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class lt{constructor(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.open=0;let i,r=e.topNode,s=ot(null,e.preserveWhitespace,0)|(n?st:0);i=r?new at(r.type,r.attrs,u.none,u.none,!0,e.topMatch||r.type.contentMatch,s):new at(n?null:t.schema.topNodeType,null,u.none,u.none,!0,null,s),this.nodes=[i],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){let e=t.getAttribute("style");if(e){let n=this.readStyles(function(t){let e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,i=[];for(;e=n.exec(t);)i.push(e[1],e[2].trim());return i}(e));if(!n)return;let[i,r]=n,s=this.top;for(let t=0;t<r.length;t++)this.removePendingMark(r[t],s);for(let t=0;t<i.length;t++)this.addPendingMark(i[t]);this.addElement(t);for(let t=0;t<i.length;t++)this.removePendingMark(i[t],s);for(let t=0;t<r.length;t++)this.addPendingMark(r[t])}else this.addElement(t)}}addTextNode(t){let e=t.nodeValue,n=this.top;if(n.options&rt||n.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(n.options&it)e=n.options&rt?e.replace(/\r\n?/g,"\n"):e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){let i=n.content[n.content.length-1],r=t.previousSibling;(!i||r&&"BR"==r.nodeName||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)}addElement(t,e){let n,i=t.nodeName.toLowerCase();nt.hasOwnProperty(i)&&this.parser.normalizeLists&&function(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let t=1==e.nodeType?e.nodeName.toLowerCase():null;t&&nt.hasOwnProperty(t)&&n?(n.appendChild(e),e=n):"li"==t?n=e:t&&(n=null)}}(t);let r=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(n=this.parser.matchTag(t,this,e));if(r?r.ignore:et.hasOwnProperty(i))this.findInside(t),this.ignoreFallback(t);else if(!r||r.skip||r.closeParent){r&&r.closeParent?this.open=Math.max(0,this.open-1):r&&r.skip.nodeType&&(t=r.skip);let e,n=this.top,s=this.needsBlock;if(tt.hasOwnProperty(i))n.content.length&&n.content[0].isInline&&this.open&&(this.open--,n=this.top),e=!0,n.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),e&&this.sync(n),this.needsBlock=s}else this.addElementByRule(t,r,!1===r.consuming?n:void 0)}leafFallback(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))}ignoreFallback(t){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(t){let e=u.none,n=u.none;t:for(let i=0;i<t.length;i+=2)for(let r;;){let s=this.parser.matchStyle(t[i],t[i+1],this,r);if(!s)continue t;if(s.ignore)return null;if(s.clearMark?this.top.pendingMarks.forEach((t=>{s.clearMark(t)&&(n=t.addToSet(n))})):e=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(e),!1!==s.consuming)break;r=s}return[e,n]}addElementByRule(t,e,n){let i,r,s;if(e.node)r=this.parser.schema.nodes[e.node],r.isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):i=this.enter(r,e.attrs||null,e.preserveWhitespace);else{s=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(s)}let o=this.top;if(r&&r.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((t=>this.insertNode(t)));else{let n=t;"string"==typeof e.contentElement?n=t.querySelector(e.contentElement):"function"==typeof e.contentElement?n=e.contentElement(t):e.contentElement&&(n=e.contentElement),this.findAround(t,n,!0),this.addAll(n)}i&&this.sync(o)&&this.open--,s&&this.removePendingMark(s,o)}addAll(t,e,n){let i=e||0;for(let r=e?t.childNodes[e]:t.firstChild,s=null==n?null:t.childNodes[n];r!=s;r=r.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(r);this.findAtPoint(t,i)}findPlace(t){let e,n;for(let i=this.open;i>=0;i--){let r=this.nodes[i],s=r.findWrapping(t);if(s&&(!e||e.length>s.length)&&(e=s,n=r,!s.length))break;if(r.solid)break}if(!e)return!1;this.sync(n);for(let t=0;t<e.length;t++)this.enterInner(e[t],null,!1);return!0}insertNode(t){if(t.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(t)){this.closeExtra();let e=this.top;e.applyPending(t.type),e.match&&(e.match=e.match.matchType(t.type));let n=e.activeMarks;for(let i=0;i<t.marks.length;i++)e.type&&!e.type.allowsMarkType(t.marks[i].type)||(n=t.marks[i].addToSet(n));return e.content.push(t.mark(n)),!0}return!1}enter(t,e,n){let i=this.findPlace(t.create(e));return i&&this.enterInner(t,e,!0,n),i}enterInner(t,e=null,n=!1,i){this.closeExtra();let r=this.top;r.applyPending(t),r.match=r.match&&r.match.matchType(t);let s=ot(t,i,r.options);r.options&st&&0==r.content.length&&(s|=st),this.nodes.push(new at(t,e,r.activeMarks,r.pendingMarks,n,null,s)),this.open++}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(t){for(let e=this.open;e>=0;e--)if(this.nodes[e]==t)return this.open=e,!0;return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let n=this.nodes[e].content;for(let e=n.length-1;e>=0;e--)t+=n[e].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,n){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)if(null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node)){e.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),n=this.options.context,i=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),r=-(n?n.depth+1:0)+(i?0:1),s=(t,o)=>{for(;t>=0;t--){let a=e[t];if(""==a){if(t==e.length-1||0==t)continue;for(;o>=r;o--)if(s(t-1,o))return!0;return!1}{let t=o>0||0==o&&i?this.nodes[o].type:n&&o>=r?n.node(o-r).type:null;if(!t||t.name!=a&&-1==t.groups.indexOf(a))return!1;o--}}return!0};return s(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}addPendingMark(t){let e=function(t,e){for(let n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)}removePendingMark(t,e){for(let n=this.open;n>=0;n--){let i=this.nodes[n];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);let e=i.popFromStashMark(t);e&&i.type&&i.type.allowsMarkType(e.type)&&(i.activeMarks=e.addToSet(i.activeMarks))}if(i==e)break}}}function ct(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function dt(t){let e={};for(let n in t)e[n]=t[n];return e}function ht(t,e){let n=e.schema.nodes;for(let i in n){let r=n[i];if(!r.allowsMarkType(t))continue;let s=[],o=t=>{s.push(t);for(let n=0;n<t.edgeCount;n++){let{type:i,next:r}=t.edge(n);if(i==e)return!0;if(s.indexOf(r)<0&&o(r))return!0}};if(o(r.contentMatch))return!0}}class ut{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},n){n||(n=ft(e).createDocumentFragment());let i=n,r=[];return t.forEach((t=>{if(r.length||t.marks.length){let n=0,s=0;for(;n<r.length&&s<t.marks.length;){let e=t.marks[s];if(this.marks[e.type.name]){if(!e.eq(r[n][0])||!1===e.type.spec.spanning)break;n++,s++}else s++}for(;n<r.length;)i=r.pop()[1];for(;s<t.marks.length;){let n=t.marks[s++],o=this.serializeMark(n,t.isInline,e);o&&(r.push([n,i]),i.appendChild(o.dom),i=o.contentDOM||o.dom)}}i.appendChild(this.serializeNodeInner(t,e))})),n}serializeNodeInner(t,e){let{dom:n,contentDOM:i}=ut.renderSpec(ft(e),this.nodes[t.type.name](t));if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return n}serializeNode(t,e={}){let n=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let r=this.serializeMark(t.marks[i],t.isInline,e);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n}serializeMark(t,e,n={}){let i=this.marks[t.type.name];return i&&ut.renderSpec(ft(n),i(t,e))}static renderSpec(t,e,n=null){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;let i,r=e[0],s=r.indexOf(" ");s>0&&(n=r.slice(0,s),r=r.slice(s+1));let o=n?t.createElementNS(n,r):t.createElement(r),a=e[1],l=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a)){l=2;for(let t in a)if(null!=a[t]){let e=t.indexOf(" ");e>0?o.setAttributeNS(t.slice(0,e),t.slice(e+1),a[t]):o.setAttribute(t,a[t])}}for(let r=l;r<e.length;r++){let s=e[r];if(0===s){if(r<e.length-1||r>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:o,contentDOM:o}}{let{dom:e,contentDOM:r}=ut.renderSpec(t,s,n);if(o.appendChild(e),r){if(i)throw new RangeError("Multiple content holes");i=r}}}return{dom:o,contentDOM:i}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new ut(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=pt(t.nodes);return e.text||(e.text=t=>t.text),e}static marksFromSchema(t){return pt(t.marks)}}function pt(t){let e={};for(let n in t){let i=t[n].spec.toDOM;i&&(e[n]=i)}return e}function ft(t){return t.document||window.document}const mt=Math.pow(2,16);function gt(t,e){return t+e*mt}function bt(t){return 65535&t}class vt{constructor(t,e,n){this.pos=t,this.delInfo=e,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class yt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&yt.empty)return yt.empty}recover(t){let e=0,n=bt(t);if(!this.inverted)for(let t=0;t<n;t++)e+=this.ranges[3*t+2]-this.ranges[3*t+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/mt}(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,n){let i=0,r=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?i:0);if(a>t)break;let l=this.ranges[o+r],c=this.ranges[o+s],d=a+l;if(t<=d){let r=a+i+((l?t==a?-1:t==d?1:e:e)<0?0:c);if(n)return r;let s=t==(e<0?a:d)?null:gt(o/3,t-a),h=t==a?2:t==d?1:4;return(e<0?t!=a:t!=d)&&(h|=8),new vt(r,h,s)}i+=c-l}return n?t+i:new vt(t+i,0,null)}touches(t,e){let n=0,i=bt(e),r=this.inverted?2:1,s=this.inverted?1:2;for(let e=0;e<this.ranges.length;e+=3){let o=this.ranges[e]-(this.inverted?n:0);if(o>t)break;let a=this.ranges[e+r];if(t<=o+a&&e==3*i)return!0;n+=this.ranges[e+s]-a}return!1}forEach(t){let e=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,r=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?r:0),a=s+(this.inverted?0:r),l=this.ranges[i+e],c=this.ranges[i+n];t(o,o+l,a,a+c),r+=c-l}}invert(){return new yt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?yt.empty:new yt(t<0?[0,-t,0]:[0,0,t])}}yt.empty=new yt([]);class wt{constructor(t=[],e,n=0,i=t.length){this.maps=t,this.mirror=e,this.from=n,this.to=i}slice(t=0,e=this.maps.length){return new wt(this.maps,this.mirror,t,e)}copy(){return new wt(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)}appendMapping(t){for(let e=0,n=this.maps.length;e<t.maps.length;e++){let i=t.getMirror(e);this.appendMap(t.maps[e],null!=i&&i<e?n+i:void 0)}}getMirror(t){if(this.mirror)for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=i&&i>e?n-i-1:void 0)}}invert(){let t=new wt;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,n){let i=0;for(let n=this.from;n<this.to;n++){let r=this.maps[n].mapResult(t,e);if(null!=r.recover){let e=this.getMirror(n);if(null!=e&&e>n&&e<this.to){n=e,t=this.maps[e].recover(r.recover);continue}}i|=r.delInfo,t=r.pos}return n?t:new vt(t,i,null)}}const kt=Object.create(null);class St{getMap(){return yt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=kt[e.stepType];if(!n)throw new RangeError(`No step type ${e.stepType} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in kt)throw new RangeError("Duplicate use of step JSON ID "+t);return kt[t]=e,e.prototype.jsonID=t,e}}class xt{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new xt(t,null)}static fail(t){return new xt(null,t)}static fromReplace(t,e,n,i){try{return xt.ok(t.replace(e,n,i))}catch(t){if(t instanceof p)return xt.fail(t.message);throw t}}}function Et(t,e,n){let i=[];for(let r=0;r<t.childCount;r++){let s=t.child(r);s.content.size&&(s=s.copy(Et(s.content,e,s))),s.isInline&&(s=e(s,n,r)),i.push(s)}return l.fromArray(i)}class Ct extends St{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=t.resolve(this.from),i=n.node(n.sharedDepth(this.to)),r=new f(Et(e.content,((t,e)=>t.isAtom&&e.type.allowsMarkType(this.mark.type)?t.mark(this.mark.addToSet(t.marks)):t),i),e.openStart,e.openEnd);return xt.fromReplace(t,this.from,this.to,r)}invert(){return new _t(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new Ct(e.pos,n.pos,this.mark)}merge(t){return t instanceof Ct&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ct(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ct(e.from,e.to,t.markFromJSON(e.mark))}}St.jsonID("addMark",Ct);class _t extends St{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=new f(Et(e.content,(t=>t.mark(this.mark.removeFromSet(t.marks))),t),e.openStart,e.openEnd);return xt.fromReplace(t,this.from,this.to,n)}invert(){return new Ct(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new _t(e.pos,n.pos,this.mark)}merge(t){return t instanceof _t&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new _t(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new _t(e.from,e.to,t.markFromJSON(e.mark))}}St.jsonID("removeMark",_t);class At extends St{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return xt.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return xt.fromReplace(t,this.pos,this.pos+1,new f(l.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let t=this.mark.addToSet(e.marks);if(t.length==e.marks.length){for(let n=0;n<e.marks.length;n++)if(!e.marks[n].isInSet(t))return new At(this.pos,e.marks[n]);return new At(this.pos,this.mark)}}return new Ot(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new At(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new At(e.pos,t.markFromJSON(e.mark))}}St.jsonID("addNodeMark",At);class Ot extends St{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return xt.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return xt.fromReplace(t,this.pos,this.pos+1,new f(l.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new At(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Ot(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ot(e.pos,t.markFromJSON(e.mark))}}St.jsonID("removeNodeMark",Ot);class Tt extends St{constructor(t,e,n,i=!1){super(),this.from=t,this.to=e,this.slice=n,this.structure=i}apply(t){return this.structure&&Dt(t,this.from,this.to)?xt.fail("Structure replace would overwrite content"):xt.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new yt([this.from,this.to-this.from,this.slice.size])}invert(t){return new Tt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deletedAcross&&n.deletedAcross?null:new Tt(e.pos,Math.max(e.pos,n.pos),this.slice)}merge(t){if(!(t instanceof Tt)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?f.empty:new f(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Tt(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?f.empty:new f(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Tt(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Tt(e.from,e.to,f.fromJSON(t,e.slice),!!e.structure)}}St.jsonID("replace",Tt);class Mt extends St{constructor(t,e,n,i,r,s,o=!1){super(),this.from=t,this.to=e,this.gapFrom=n,this.gapTo=i,this.slice=r,this.insert=s,this.structure=o}apply(t){if(this.structure&&(Dt(t,this.from,this.gapFrom)||Dt(t,this.gapTo,this.to)))return xt.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return xt.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,e.content);return n?xt.fromReplace(t,this.from,this.to,n):xt.fail("Content does not fit in gap")}getMap(){return new yt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new Mt(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),i=t.map(this.gapFrom,-1),r=t.map(this.gapTo,1);return e.deletedAcross&&n.deletedAcross||i<e.pos||r>n.pos?null:new Mt(e.pos,n.pos,i,r,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Mt(e.from,e.to,e.gapFrom,e.gapTo,f.fromJSON(t,e.slice),e.insert,!!e.structure)}}function Dt(t,e,n){let i=t.resolve(e),r=n-e,s=i.depth;for(;r>0&&s>0&&i.indexAfter(s)==i.node(s).childCount;)s--,r--;if(r>0){let t=i.node(s).maybeChild(i.indexAfter(s));for(;r>0;){if(!t||t.isLeaf)return!0;t=t.firstChild,r--}}return!1}function Lt(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Nt(t){let e=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth;;--n){let i=t.$from.node(n),r=t.$from.index(n),s=t.$to.indexAfter(n);if(n<t.depth&&i.canReplace(r,s,e))return n;if(0==n||i.type.spec.isolating||!Lt(i,r,s))break}return null}function It(t,e,n=null,i=t){let r=function(t,e){let{parent:n,startIndex:i,endIndex:r}=t,s=n.contentMatchAt(i).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(i,r,o)?s:null}(t,e),s=r&&function(t,e){let{parent:n,startIndex:i,endIndex:r}=t,s=n.child(i),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let t=i;a&&t<r;t++)a=a.matchType(n.child(t).type);return a&&a.validEnd?o:null}(i,e);return s?r.map(Pt).concat({type:e,attrs:n}).concat(s.map(Pt)):null}function Pt(t){return{type:t,attrs:null}}function $t(t,e,n=1,i){let r=t.resolve(e),s=r.depth-n,o=i&&i[i.length-1]||r.parent;if(s<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!o.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let t=r.depth-1,e=n-2;t>s;t--,e--){let n=r.node(t),s=r.index(t);if(n.type.spec.isolating)return!1;let o=n.content.cutByIndex(s,n.childCount),a=i&&i[e]||n;if(a!=n&&(o=o.replaceChild(0,a.type.create(a.attrs))),!n.canReplace(s+1,n.childCount)||!a.type.validContent(o))return!1}let a=r.indexAfter(s),l=i&&i[0];return r.node(s).canReplaceWith(a,a,l?l.type:r.node(s+1).type)}function Rt(t,e){let n=t.resolve(e),i=n.index();return Ft(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function Ft(t,e){return!(!t||!e||t.isLeaf||!t.canAppend(e))}function Bt(t,e,n=-1){let i=t.resolve(e);for(let t=i.depth;;t--){let r,s,o=i.index(t);if(t==i.depth?(r=i.nodeBefore,s=i.nodeAfter):n>0?(r=i.node(t+1),o++,s=i.node(t).maybeChild(o)):(r=i.node(t).maybeChild(o-1),s=i.node(t+1)),r&&!r.isTextblock&&Ft(r,s)&&i.node(t).canReplace(o,o+1))return e;if(0==t)break;e=n<0?i.before(t):i.after(t)}}function jt(t,e,n){let i=t.resolve(e);if(!n.content.size)return e;let r=n.content;for(let t=0;t<n.openStart;t++)r=r.firstChild.content;for(let t=1;t<=(0==n.openStart&&n.size?2:1);t++)for(let e=i.depth;e>=0;e--){let n=e==i.depth?0:i.pos<=(i.start(e+1)+i.end(e+1))/2?-1:1,s=i.index(e)+(n>0?1:0),o=i.node(e),a=!1;if(1==t)a=o.canReplace(s,s,r);else{let t=o.contentMatchAt(s).findWrapping(r.firstChild.type);a=t&&o.canReplaceWith(s,s,t[0])}if(a)return 0==n?i.pos:n<0?i.before(e+1):i.after(e+1)}return null}function Ht(t,e,n=e,i=f.empty){if(e==n&&!i.size)return null;let r=t.resolve(e),s=t.resolve(n);return zt(r,s,i)?new Tt(e,n,i):new Vt(r,s,i).fit()}function zt(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}St.jsonID("replaceAround",Mt);class Vt{constructor(t,e,n){this.$from=t,this.$to=e,this.unplaced=n,this.frontier=[],this.placed=l.empty;for(let e=0;e<=t.depth;e++){let n=t.node(e);this.frontier.push({type:n.type,match:n.contentMatchAt(t.indexAfter(e))})}for(let e=t.depth;e>0;e--)this.placed=l.from(t.node(e).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(t<0?this.$to:n.doc.resolve(t));if(!i)return null;let r=this.placed,s=n.depth,o=i.depth;for(;s&&o&&1==r.childCount;)r=r.firstChild.content,s--,o--;let a=new f(r,s,o);return t>-1?new Mt(n.pos,t,this.$to.pos,this.$to.end(),a,e):a.size||n.pos!=this.$to.pos?new Tt(n.pos,i.pos,a):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<t;n++){let r=e.firstChild;if(e.childCount>1&&(i=0),r.type.spec.isolating&&i<=n){t=n;break}e=r.content}for(let e=1;e<=2;e++)for(let n=1==e?t:this.unplaced.openStart;n>=0;n--){let t,i=null;n?(i=Wt(this.unplaced.content,n-1).firstChild,t=i.content):t=this.unplaced.content;let r=t.firstChild;for(let t=this.depth;t>=0;t--){let s,{type:o,match:a}=this.frontier[t],c=null;if(1==e&&(r?a.matchType(r.type)||(c=a.fillBefore(l.from(r),!1)):i&&o.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:t,parent:i,inject:c};if(2==e&&r&&(s=a.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:t,parent:i,wrap:s};if(i&&a.matchType(i.type))break}}}openMore(){let{content:t,openStart:e,openEnd:n}=this.unplaced,i=Wt(t,e);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new f(t,e+1,Math.max(n,i.size+e>=t.size-n?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:n}=this.unplaced,i=Wt(t,e);if(i.childCount<=1&&e>0){let r=t.size-e<=e+i.size;this.unplaced=new f(qt(t,e-1,1),e-1,r?e-1:n)}else this.unplaced=new f(qt(t,e,1),e,n)}placeNodes({sliceDepth:t,frontierDepth:e,parent:n,inject:i,wrap:r}){for(;this.depth>e;)this.closeFrontierNode();if(r)for(let t=0;t<r.length;t++)this.openFrontierNode(r[t]);let s=this.unplaced,o=n?n.content:s.content,a=s.openStart-t,c=0,d=[],{match:h,type:u}=this.frontier[e];if(i){for(let t=0;t<i.childCount;t++)d.push(i.child(t));h=h.matchFragment(i)}let p=o.size+t-(s.content.size-s.openEnd);for(;c<o.childCount;){let t=o.child(c),e=h.matchType(t.type);if(!e)break;c++,(c>1||0==a||t.content.size)&&(h=e,d.push(Kt(t.mark(u.allowedMarks(t.marks)),1==c?a:0,c==o.childCount?p:-1)))}let m=c==o.childCount;m||(p=-1),this.placed=Ut(this.placed,e,l.from(d)),this.frontier[e].match=h,m&&p<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let t=0,e=o;t<p;t++){let t=e.lastChild;this.frontier.push({type:t.type,match:t.contentMatchAt(t.childCount)}),e=t.content}this.unplaced=m?0==t?f.empty:new f(qt(s.content,t-1,1),t-1,p<0?s.openEnd:t-1):new f(qt(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t,e=this.frontier[this.depth];if(!e.type.isTextblock||!Yt(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:n,type:i}=this.frontier[e],r=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=Yt(t,e,i,n,r);if(s){for(let n=e-1;n>=0;n--){let{match:e,type:i}=this.frontier[n],r=Yt(t,n,i,e,!0);if(!r||r.childCount)continue t}return{depth:e,fit:s,move:r?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Ut(this.placed,e.depth,e.fit)),t=e.move;for(let n=e.depth+1;n<=t.depth;n++){let e=t.node(n),i=e.type.contentMatch.fillBefore(e.content,!0,t.index(n));this.openFrontierNode(e.type,e.attrs,i)}return t}openFrontierNode(t,e=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=Ut(this.placed,this.depth,l.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(l.empty,!0);t.childCount&&(this.placed=Ut(this.placed,this.frontier.length,t))}}function qt(t,e,n){return 0==e?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(qt(t.firstChild.content,e-1,n)))}function Ut(t,e,n){return 0==e?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Ut(t.lastChild.content,e-1,n)))}function Wt(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function Kt(t,e,n){if(e<=0)return t;let i=t.content;return e>1&&(i=i.replaceChild(0,Kt(i.firstChild,e-1,1==i.childCount?n-1:0))),e>0&&(i=t.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(l.empty,!0)))),t.copy(i)}function Yt(t,e,n,i,r){let s=t.node(e),o=r?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=i.fillBefore(s.content,!0,o);return a&&!function(t,e,n){for(let i=n;i<e.childCount;i++)if(!t.allowsMarks(e.child(i).marks))return!0;return!1}(n,s.content,o)?a:null}function Jt(t){return t.spec.defining||t.spec.definingForContent}function Gt(t,e,n,i,r){if(e<n){let r=t.firstChild;t=t.replaceChild(0,r.copy(Gt(r.content,e+1,n,i,r)))}if(e>i){let e=r.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(l.empty,!0))}return t}function Xt(t,e){let n=[];for(let i=Math.min(t.depth,e.depth);i>=0;i--){let r=t.start(i);if(r<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(r==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==r-1)&&n.push(i)}return n}class Qt extends St{constructor(t,e,n){super(),this.pos=t,this.attr=e,this.value=n}apply(t){let e=t.nodeAt(this.pos);if(!e)return xt.fail("No node at attribute step's position");let n=Object.create(null);for(let t in e.attrs)n[t]=e.attrs[t];n[this.attr]=this.value;let i=e.type.create(n,null,e.marks);return xt.fromReplace(t,this.pos,this.pos+1,new f(l.from(i),0,e.isLeaf?0:1))}getMap(){return yt.empty}invert(t){return new Qt(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Qt(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Qt(e.pos,e.attr,e.value)}}St.jsonID("attr",Qt);let Zt=class extends Error{};Zt=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n},(Zt.prototype=Object.create(Error.prototype)).constructor=Zt,Zt.prototype.name="TransformError";class te{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new wt}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new Zt(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,n=f.empty){let i=Ht(this.doc,t,e,n);return i&&this.step(i),this}replaceWith(t,e,n){return this.replace(t,e,new f(l.from(n),0,0))}delete(t,e){return this.replace(t,e,f.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,n){return function(t,e,n,i){if(!i.size)return t.deleteRange(e,n);let r=t.doc.resolve(e),s=t.doc.resolve(n);if(zt(r,s,i))return t.step(new Tt(e,n,i));let o=Xt(r,t.doc.resolve(n));0==o[o.length-1]&&o.pop();let a=-(r.depth+1);o.unshift(a);for(let t=r.depth,e=r.pos-1;t>0;t--,e--){let n=r.node(t).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;o.indexOf(t)>-1?a=t:r.before(t)==e&&o.splice(1,0,-t)}let l=o.indexOf(a),c=[],d=i.openStart;for(let t=i.content,e=0;;e++){let n=t.firstChild;if(c.push(n),e==i.openStart)break;t=n.content}for(let t=d-1;t>=0;t--){let e=c[t].type,n=Jt(e);if(n&&r.node(l).type!=e)d=t;else if(n||!e.isTextblock)break}for(let e=i.openStart;e>=0;e--){let a=(e+d+1)%(i.openStart+1),h=c[a];if(h)for(let e=0;e<o.length;e++){let c=o[(e+l)%o.length],d=!0;c<0&&(d=!1,c=-c);let u=r.node(c-1),p=r.index(c-1);if(u.canReplaceWith(p,p,h.type,h.marks))return t.replace(r.before(c),d?s.after(c):n,new f(Gt(i.content,0,i.openStart,a),a,i.openEnd))}}let h=t.steps.length;for(let a=o.length-1;a>=0&&(t.replace(e,n,i),!(t.steps.length>h));a--){let t=o[a];t<0||(e=r.before(t),n=s.after(t))}}(this,t,e,n),this}replaceRangeWith(t,e,n){return function(t,e,n,i){if(!i.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let r=function(t,e,n){let i=t.resolve(e);if(i.parent.canReplaceWith(i.index(),i.index(),n))return e;if(0==i.parentOffset)for(let t=i.depth-1;t>=0;t--){let e=i.index(t);if(i.node(t).canReplaceWith(e,e,n))return i.before(t+1);if(e>0)return null}if(i.parentOffset==i.parent.content.size)for(let t=i.depth-1;t>=0;t--){let e=i.indexAfter(t);if(i.node(t).canReplaceWith(e,e,n))return i.after(t+1);if(e<i.node(t).childCount)return null}return null}(t.doc,e,i.type);null!=r&&(e=n=r)}t.replaceRange(e,n,new f(l.from(i),0,0))}(this,t,e,n),this}deleteRange(t,e){return function(t,e,n){let i=t.doc.resolve(e),r=t.doc.resolve(n),s=Xt(i,r);for(let e=0;e<s.length;e++){let n=s[e],o=e==s.length-1;if(o&&0==n||i.node(n).type.contentMatch.validEnd)return t.delete(i.start(n),r.end(n));if(n>0&&(o||i.node(n-1).canReplace(i.index(n-1),r.indexAfter(n-1))))return t.delete(i.before(n),r.after(n))}for(let s=1;s<=i.depth&&s<=r.depth;s++)if(e-i.start(s)==i.depth-s&&n>i.end(s)&&r.end(s)-n!=r.depth-s)return t.delete(i.before(s),n);t.delete(e,n)}(this,t,e),this}lift(t,e){return function(t,e,n){let{$from:i,$to:r,depth:s}=e,o=i.before(s+1),a=r.after(s+1),c=o,d=a,h=l.empty,u=0;for(let t=s,e=!1;t>n;t--)e||i.index(t)>0?(e=!0,h=l.from(i.node(t).copy(h)),u++):c--;let p=l.empty,m=0;for(let t=s,e=!1;t>n;t--)e||r.after(t+1)<r.end(t)?(e=!0,p=l.from(r.node(t).copy(p)),m++):d++;t.step(new Mt(c,d,o,a,new f(h.append(p),u,m),h.size-u,!0))}(this,t,e),this}join(t,e=1){return function(t,e,n){let i=new Tt(e-n,e+n,f.empty,!0);t.step(i)}(this,t,e),this}wrap(t,e){return function(t,e,n){let i=l.empty;for(let t=n.length-1;t>=0;t--){if(i.size){let e=n[t].type.contentMatch.matchFragment(i);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=l.from(n[t].type.create(n[t].attrs,i))}let r=e.start,s=e.end;t.step(new Mt(r,s,r,s,new f(i,0,0),n.length,!0))}(this,t,e),this}setBlockType(t,e=t,n,i=null){return function(t,e,n,i,r){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,((e,n)=>{if(e.isTextblock&&!e.hasMarkup(i,r)&&function(t,e,n){let i=t.resolve(e),r=i.index();return i.parent.canReplaceWith(r,r+1,n)}(t.doc,t.mapping.slice(s).map(n),i)){t.clearIncompatible(t.mapping.slice(s).map(n,1),i);let o=t.mapping.slice(s),a=o.map(n,1),c=o.map(n+e.nodeSize,1);return t.step(new Mt(a,c,a+1,c-1,new f(l.from(i.create(r,null,e.marks)),0,0),1,!0)),!1}}))}(this,t,e,n,i),this}setNodeMarkup(t,e,n=null,i){return function(t,e,n,i,r){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(i,null,r||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Mt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new f(l.from(o),0,0),1,!0))}(this,t,e,n,i),this}setNodeAttribute(t,e,n){return this.step(new Qt(t,e,n)),this}addNodeMark(t,e){return this.step(new At(t,e)),this}removeNodeMark(t,e){if(!(e instanceof u)){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(!(e=e.isInSet(n.marks)))return this}return this.step(new Ot(t,e)),this}split(t,e=1,n){return function(t,e,n=1,i){let r=t.doc.resolve(e),s=l.empty,o=l.empty;for(let t=r.depth,e=r.depth-n,a=n-1;t>e;t--,a--){s=l.from(r.node(t).copy(s));let e=i&&i[a];o=l.from(e?e.type.create(e.attrs,o):r.node(t).copy(o))}t.step(new Tt(e,e,new f(s.append(o),n,n),!0))}(this,t,e,n),this}addMark(t,e,n){return function(t,e,n,i){let r,s,o=[],a=[];t.doc.nodesBetween(e,n,((t,l,c)=>{if(!t.isInline)return;let d=t.marks;if(!i.isInSet(d)&&c.type.allowsMarkType(i.type)){let c=Math.max(l,e),h=Math.min(l+t.nodeSize,n),u=i.addToSet(d);for(let t=0;t<d.length;t++)d[t].isInSet(u)||(r&&r.to==c&&r.mark.eq(d[t])?r.to=h:o.push(r=new _t(c,h,d[t])));s&&s.to==c?s.to=h:a.push(s=new Ct(c,h,i))}})),o.forEach((e=>t.step(e))),a.forEach((e=>t.step(e)))}(this,t,e,n),this}removeMark(t,e,n){return function(t,e,n,i){let r=[],s=0;t.doc.nodesBetween(e,n,((t,o)=>{if(!t.isInline)return;s++;let a=null;if(i instanceof G){let e,n=t.marks;for(;e=i.isInSet(n);)(a||(a=[])).push(e),n=e.removeFromSet(n)}else i?i.isInSet(t.marks)&&(a=[i]):a=t.marks;if(a&&a.length){let i=Math.min(o+t.nodeSize,n);for(let t=0;t<a.length;t++){let n,l=a[t];for(let t=0;t<r.length;t++){let e=r[t];e.step==s-1&&l.eq(r[t].style)&&(n=e)}n?(n.to=i,n.step=s):r.push({style:l,from:Math.max(o,e),to:i,step:s})}}})),r.forEach((e=>t.step(new _t(e.from,e.to,e.style))))}(this,t,e,n),this}clearIncompatible(t,e,n){return function(t,e,n,i=n.contentMatch){let r=t.doc.nodeAt(e),s=[],o=e+1;for(let e=0;e<r.childCount;e++){let a=r.child(e),l=o+a.nodeSize,c=i.matchType(a.type);if(c){i=c;for(let e=0;e<a.marks.length;e++)n.allowsMarkType(a.marks[e].type)||t.step(new _t(o,l,a.marks[e]))}else s.push(new Tt(o,l,f.empty));o=l}if(!i.validEnd){let e=i.fillBefore(l.empty,!0);t.replace(o,o,new f(e,0,0))}for(let e=s.length-1;e>=0;e--)t.step(s[e])}(this,t,e,n),this}}const ee=Object.create(null);class ne{constructor(t,e,n){this.$anchor=t,this.$head=e,this.ranges=n||[new ie(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=f.empty){let n=e.content.lastChild,i=null;for(let t=0;t<e.openEnd;t++)i=n,n=n.lastChild;let r=t.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],c=t.mapping.slice(r);t.replaceRange(c.map(a.pos),c.map(l.pos),o?f.empty:e),0==o&&pe(t,r,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let n=t.steps.length,i=this.ranges;for(let r=0;r<i.length;r++){let{$from:s,$to:o}=i[r],a=t.mapping.slice(n),l=a.map(s.pos),c=a.map(o.pos);r?t.deleteRange(l,c):(t.replaceRangeWith(l,c,e),pe(t,n,e.isInline?-1:1))}}static findFrom(t,e,n=!1){let i=t.parent.inlineContent?new oe(t):ue(t.node(0),t.parent,t.pos,t.index(),e,n);if(i)return i;for(let i=t.depth-1;i>=0;i--){let r=e<0?ue(t.node(0),t.node(i),t.before(i+1),t.index(i),e,n):ue(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,e,n);if(r)return r}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new de(t.node(0))}static atStart(t){return ue(t,t,0,0,1)||new de(t)}static atEnd(t){return ue(t,t,t.content.size,t.childCount,-1)||new de(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=ee[e.type];if(!n)throw new RangeError(`No selection type ${e.type} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in ee)throw new RangeError("Duplicate use of selection JSON ID "+t);return ee[t]=e,e.prototype.jsonID=t,e}getBookmark(){return oe.between(this.$anchor,this.$head).getBookmark()}}ne.prototype.visible=!0;class ie{constructor(t,e){this.$from=t,this.$to=e}}let re=!1;function se(t){re||t.parent.inlineContent||(re=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class oe extends ne{constructor(t,e=t){se(t),se(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let n=t.resolve(e.map(this.head));if(!n.parent.inlineContent)return ne.near(n);let i=t.resolve(e.map(this.anchor));return new oe(i.parent.inlineContent?i:n,n)}replace(t,e=f.empty){if(super.replace(t,e),e==f.empty){let e=this.$from.marksAcross(this.$to);e&&t.ensureMarks(e)}}eq(t){return t instanceof oe&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new ae(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if("number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new oe(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,n=e){let i=t.resolve(e);return new this(i,n==e?i:t.resolve(n))}static between(t,e,n){let i=t.pos-e.pos;if(n&&!i||(n=i>=0?1:-1),!e.parent.inlineContent){let t=ne.findFrom(e,n,!0)||ne.findFrom(e,-n,!0);if(!t)return ne.near(e,n);e=t.$head}return t.parent.inlineContent||(0==i||(t=(ne.findFrom(t,-n,!0)||ne.findFrom(t,n,!0)).$anchor).pos<e.pos!=i<0)&&(t=e),new oe(t,e)}}ne.jsonID("text",oe);class ae{constructor(t,e){this.anchor=t,this.head=e}map(t){return new ae(t.map(this.anchor),t.map(this.head))}resolve(t){return oe.between(t.resolve(this.anchor),t.resolve(this.head))}}class le extends ne{constructor(t){let e=t.nodeAfter,n=t.node(0).resolve(t.pos+e.nodeSize);super(t,n),this.node=e}map(t,e){let{deleted:n,pos:i}=e.mapResult(this.anchor),r=t.resolve(i);return n?ne.near(r):new le(r)}content(){return new f(l.from(this.node),0,0)}eq(t){return t instanceof le&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ce(this.anchor)}static fromJSON(t,e){if("number"!=typeof e.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new le(t.resolve(e.anchor))}static create(t,e){return new le(t.resolve(e))}static isSelectable(t){return!t.isText&&!1!==t.type.spec.selectable}}le.prototype.visible=!1,ne.jsonID("node",le);class ce{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:n}=t.mapResult(this.anchor);return e?new ae(n,n):new ce(n)}resolve(t){let e=t.resolve(this.anchor),n=e.nodeAfter;return n&&le.isSelectable(n)?new le(e):ne.near(e)}}class de extends ne{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=f.empty){if(e==f.empty){t.delete(0,t.doc.content.size);let e=ne.atStart(t.doc);e.eq(t.selection)||t.setSelection(e)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new de(t)}map(t){return new de(t)}eq(t){return t instanceof de}getBookmark(){return he}}ne.jsonID("all",de);const he={map(){return this},resolve:t=>new de(t)};function ue(t,e,n,i,r,s=!1){if(e.inlineContent)return oe.create(t,n);for(let o=i-(r>0?0:1);r>0?o<e.childCount:o>=0;o+=r){let i=e.child(o);if(i.isAtom){if(!s&&le.isSelectable(i))return le.create(t,n-(r<0?i.nodeSize:0))}else{let e=ue(t,i,n+r,r<0?i.childCount:0,r,s);if(e)return e}n+=i.nodeSize*r}return null}function pe(t,e,n){let i=t.steps.length-1;if(i<e)return;let r,s=t.steps[i];(s instanceof Tt||s instanceof Mt)&&(t.mapping.maps[i].forEach(((t,e,n,i)=>{null==r&&(r=i)})),t.setSelection(ne.near(t.doc.resolve(r),n)))}class fe extends te{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=2,this}ensureMarks(t){return u.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(t,e){super.addStep(t,e),this.updated=-3&this.updated,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let n=this.selection;return e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||u.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,n){let i=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(null==n&&(n=e),n=null==n?e:n,!t)return this.deleteRange(e,n);let r=this.storedMarks;if(!r){let t=this.doc.resolve(e);r=n==e?t.marks():t.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,i.text(t,r)),this.selection.empty||this.setSelection(ne.near(this.selection.$to)),this}}setMeta(t,e){return this.meta["string"==typeof t?t:t.key]=e,this}getMeta(t){return this.meta["string"==typeof t?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function me(t,e){return e&&t?t.bind(e):t}class ge{constructor(t,e,n){this.name=t,this.init=me(e.init,n),this.apply=me(e.apply,n)}}const be=[new ge("doc",{init:t=>t.doc||t.schema.topNodeType.createAndFill(),apply:t=>t.doc}),new ge("selection",{init:(t,e)=>t.selection||ne.atStart(e.doc),apply:t=>t.selection}),new ge("storedMarks",{init:t=>t.storedMarks||null,apply:(t,e,n,i)=>i.selection.$cursor?t.storedMarks:null}),new ge("scrollToSelection",{init:()=>0,apply:(t,e)=>t.scrolledIntoView?e+1:e})];class ve{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=be.slice(),e&&e.forEach((t=>{if(this.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");this.plugins.push(t),this.pluginsByKey[t.key]=t,t.spec.state&&this.fields.push(new ge(t.key,t.spec.state,t))}))}}class ye{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=e){let e=this.config.plugins[n];if(e.spec.filterTransaction&&!e.spec.filterTransaction.call(e,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],n=this.applyInner(t),i=null;for(;;){let r=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let a=i?i[s].n:0,l=i?i[s].state:this,c=a<e.length&&o.spec.appendTransaction.call(o,a?e.slice(a):e,l,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",t),!i){i=[];for(let t=0;t<this.config.plugins.length;t++)i.push(t<s?{state:n,n:e.length}:{state:this,n:0})}e.push(c),n=n.applyInner(c),r=!0}i&&(i[s]={state:n,n:e.length})}}if(!r)return{state:n,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new ye(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let r=n[i];e[r.name]=r.apply(t,this[r.name],this,e)}return e}get tr(){return new fe(this)}static create(t){let e=new ve(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new ye(e);for(let i=0;i<e.fields.length;i++)n[e.fields[i].name]=e.fields[i].init(t,n);return n}reconfigure(t){let e=new ve(this.schema,t.plugins),n=e.fields,i=new ye(e);for(let e=0;e<n.length;e++){let r=n[e].name;i[r]=this.hasOwnProperty(r)?this[r]:n[e].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((t=>t.toJSON()))),t&&"object"==typeof t)for(let n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[n],r=i.spec.state;r&&r.toJSON&&(e[n]=r.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new ve(t.schema,t.plugins),r=new ye(i);return i.fields.forEach((i=>{if("doc"==i.name)r.doc=L.fromJSON(t.schema,e.doc);else if("selection"==i.name)r.selection=ne.fromJSON(r.doc,e.selection);else if("storedMarks"==i.name)e.storedMarks&&(r.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let s in n){let o=n[s],a=o.spec.state;if(o.key==i.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(e,s))return void(r[i.name]=a.fromJSON.call(o,t,e[s],r))}r[i.name]=i.init(t,r)}})),r}}function we(t,e,n){for(let i in t){let r=t[i];r instanceof Function?r=r.bind(e):"handleDOMEvents"==i&&(r=we(r,e,{})),n[i]=r}return n}class ke{constructor(t){this.spec=t,this.props={},t.props&&we(t.props,this,this.props),this.key=t.key?t.key.key:xe("plugin")}getState(t){return t[this.key]}}const Se=Object.create(null);function xe(t){return t in Se?t+"$"+ ++Se[t]:(Se[t]=0,t+"$")}class Ee{constructor(t="key"){this.key=xe(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const Ce=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},_e=function(t){let e=t.assignedSlot||t.parentNode;return e&&11==e.nodeType?e.host:e};let Ae=null;const Oe=function(t,e,n){let i=Ae||(Ae=document.createRange());return i.setEnd(t,null==n?t.nodeValue.length:n),i.setStart(t,e||0),i},Te=function(t,e,n,i){return n&&(De(t,e,n,i,-1)||De(t,e,n,i,1))},Me=/^(img|br|input|textarea|hr)$/i;function De(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:Le(t))){let n=t.parentNode;if(!n||1!=n.nodeType||Ne(t)||Me.test(t.nodeName)||"false"==t.contentEditable)return!1;e=Ce(t)+(r<0?0:1),t=n}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(r<0?-1:0)]).contentEditable)return!1;e=r<0?Le(t):0}}}function Le(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Ne(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Ie=function(t){return t.focusNode&&Te(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Pe(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}const $e="undefined"!=typeof navigator?navigator:null,Re="undefined"!=typeof document?document:null,Fe=$e&&$e.userAgent||"",Be=/Edge\/(\d+)/.exec(Fe),je=/MSIE \d/.exec(Fe),He=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fe),ze=!!(je||He||Be),Ve=je?document.documentMode:He?+He[1]:Be?+Be[1]:0,qe=!ze&&/gecko\/(\d+)/i.test(Fe);qe&&(/Firefox\/(\d+)/.exec(Fe)||[0,0])[1];const Ue=!ze&&/Chrome\/(\d+)/.exec(Fe),We=!!Ue,Ke=Ue?+Ue[1]:0,Ye=!ze&&!!$e&&/Apple Computer/.test($e.vendor),Je=Ye&&(/Mobile\/\w+/.test(Fe)||!!$e&&$e.maxTouchPoints>2),Ge=Je||!!$e&&/Mac/.test($e.platform),Xe=/Android \d/.test(Fe),Qe=!!Re&&"webkitFontSmoothing"in Re.documentElement.style,Ze=Qe?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function tn(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function en(t,e){return"number"==typeof t?t:t[e]}function nn(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,i=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*i}}function rn(t,e,n){let i=t.someProp("scrollThreshold")||0,r=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;o=_e(o)){if(1!=o.nodeType)continue;let t=o,n=t==s.body,a=n?tn(s):nn(t),l=0,c=0;if(e.top<a.top+en(i,"top")?c=-(a.top-e.top+en(r,"top")):e.bottom>a.bottom-en(i,"bottom")&&(c=e.bottom-a.bottom+en(r,"bottom")),e.left<a.left+en(i,"left")?l=-(a.left-e.left+en(r,"left")):e.right>a.right-en(i,"right")&&(l=e.right-a.right+en(r,"right")),l||c)if(n)s.defaultView.scrollBy(l,c);else{let n=t.scrollLeft,i=t.scrollTop;c&&(t.scrollTop+=c),l&&(t.scrollLeft+=l);let r=t.scrollLeft-n,s=t.scrollTop-i;e={left:e.left-r,top:e.top-s,right:e.right-r,bottom:e.bottom-s}}if(n)break}}function sn(t){let e=[],n=t.ownerDocument;for(let i=t;i&&(e.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),t!=n);i=_e(i));return e}function on(t,e){for(let n=0;n<t.length;n++){let{dom:i,top:r,left:s}=t[n];i.scrollTop!=r+e&&(i.scrollTop=r+e),i.scrollLeft!=s&&(i.scrollLeft=s)}}let an=null;function ln(t,e){let n,i,r=2e8,s=0,o=e.top,a=e.top;for(let l=t.firstChild,c=0;l;l=l.nextSibling,c++){let t;if(1==l.nodeType)t=l.getClientRects();else{if(3!=l.nodeType)continue;t=Oe(l).getClientRects()}for(let d=0;d<t.length;d++){let h=t[d];if(h.top<=o&&h.bottom>=a){o=Math.max(h.bottom,o),a=Math.min(h.top,a);let t=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(t<r){n=l,r=t,i=t&&3==n.nodeType?{left:h.right<e.left?h.right:h.left,top:e.top}:e,1==l.nodeType&&t&&(s=c+(e.left>=(h.left+h.right)/2?1:0));continue}}!n&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(s=c+1)}}return n&&3==n.nodeType?function(t,e){let n=t.nodeValue.length,i=document.createRange();for(let r=0;r<n;r++){i.setEnd(t,r+1),i.setStart(t,r);let n=un(i,1);if(n.top!=n.bottom&&cn(e,n))return{node:t,offset:r+(e.left>=(n.left+n.right)/2?1:0)}}return{node:t,offset:0}}(n,i):!n||r&&1==n.nodeType?{node:t,offset:s}:ln(n,i)}function cn(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function dn(t,e,n){let i=t.childNodes.length;if(i&&n.top<n.bottom)for(let r=Math.max(0,Math.min(i-1,Math.floor(i*(e.top-n.top)/(n.bottom-n.top))-2)),s=r;;){let n=t.childNodes[s];if(1==n.nodeType){let t=n.getClientRects();for(let i=0;i<t.length;i++){let r=t[i];if(cn(e,r))return dn(n,e,r)}}if((s=(s+1)%i)==r)break}return t}function hn(t,e){let n,i=t.dom.ownerDocument,r=0;if(i.caretPositionFromPoint)try{let t=i.caretPositionFromPoint(e.left,e.top);t&&({offsetNode:n,offset:r}=t)}catch(t){}if(!n&&i.caretRangeFromPoint){let t=i.caretRangeFromPoint(e.left,e.top);t&&({startContainer:n,startOffset:r}=t)}let s,o=(t.root.elementFromPoint?t.root:i).elementFromPoint(e.left,e.top);if(!o||!t.dom.contains(1!=o.nodeType?o.parentNode:o)){let n=t.dom.getBoundingClientRect();if(!cn(e,n))return null;if(o=dn(t.dom,e,n),!o)return null}if(Ye)for(let t=o;n&&t;t=_e(t))t.draggable&&(n=void 0);if(o=function(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(o,e),n){if(qe&&1==n.nodeType&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let t,i=n.childNodes[r];"IMG"==i.nodeName&&(t=i.getBoundingClientRect()).right<=e.left&&t.bottom>e.top&&r++}n==t.dom&&r==n.childNodes.length-1&&1==n.lastChild.nodeType&&e.top>n.lastChild.getBoundingClientRect().bottom?s=t.state.doc.content.size:0!=r&&1==n.nodeType&&"BR"==n.childNodes[r-1].nodeName||(s=function(t,e,n,i){let r=-1;for(let n=e,s=!1;n!=t.dom;){let e=t.docView.nearestDesc(n,!0);if(!e)return null;if(1==e.dom.nodeType&&(e.node.isBlock&&e.parent&&!s||!e.contentDOM)){let t=e.dom.getBoundingClientRect();if(e.node.isBlock&&e.parent&&!s&&(s=!0,t.left>i.left||t.top>i.top?r=e.posBefore:(t.right<i.left||t.bottom<i.top)&&(r=e.posAfter)),!e.contentDOM&&r<0)return(e.node.isBlock?i.top<(t.top+t.bottom)/2:i.left<(t.left+t.right)/2)?e.posBefore:e.posAfter}n=e.dom.parentNode}return r>-1?r:t.docView.posFromDOM(e,n,-1)}(t,n,r,e))}null==s&&(s=function(t,e,n){let{node:i,offset:r}=ln(e,n),s=-1;if(1==i.nodeType&&!i.firstChild){let t=i.getBoundingClientRect();s=t.left!=t.right&&n.left>(t.left+t.right)/2?1:-1}return t.docView.posFromDOM(i,r,s)}(t,o,e));let a=t.docView.nearestDesc(o,!0);return{pos:s,inside:a?a.posAtStart-a.border:-1}}function un(t,e){let n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}const pn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function fn(t,e,n){let{node:i,offset:r,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=Qe||qe;if(3==i.nodeType){if(!o||!pn.test(i.nodeValue)&&(n<0?r:r!=i.nodeValue.length)){let t=r,e=r,s=n<0?1:-1;return n<0&&!r?(e++,s=-1):n>=0&&r==i.nodeValue.length?(t--,s=1):n<0?t--:e++,mn(un(Oe(i,t,e),1),s<0)}{let t=un(Oe(i,r,r),n);if(qe&&r&&/\s/.test(i.nodeValue[r-1])&&r<i.nodeValue.length){let e=un(Oe(i,r-1,r-1),-1);if(e.top==t.top){let n=un(Oe(i,r,r+1),-1);if(n.top!=t.top)return mn(n,n.left<e.left)}}return t}}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(null==s&&r&&(n<0||r==Le(i))){let t=i.childNodes[r-1];if(1==t.nodeType)return gn(t.getBoundingClientRect(),!1)}if(null==s&&r<Le(i)){let t=i.childNodes[r];if(1==t.nodeType)return gn(t.getBoundingClientRect(),!0)}return gn(i.getBoundingClientRect(),n>=0)}if(null==s&&r&&(n<0||r==Le(i))){let t=i.childNodes[r-1],e=3==t.nodeType?Oe(t,Le(t)-(o?0:1)):1!=t.nodeType||"BR"==t.nodeName&&t.nextSibling?null:t;if(e)return mn(un(e,1),!1)}if(null==s&&r<Le(i)){let t=i.childNodes[r];for(;t.pmViewDesc&&t.pmViewDesc.ignoreForCoords;)t=t.nextSibling;let e=t?3==t.nodeType?Oe(t,0,o?0:1):1==t.nodeType?t:null:null;if(e)return mn(un(e,-1),!0)}return mn(un(3==i.nodeType?Oe(i):i,-n),n>=0)}function mn(t,e){if(0==t.width)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function gn(t,e){if(0==t.height)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function bn(t,e,n){let i=t.state,r=t.root.activeElement;i!=e&&t.updateState(e),r!=t.dom&&t.focus();try{return n()}finally{i!=e&&t.updateState(i),r!=t.dom&&r&&r.focus()}}const vn=/[\u0590-\u08ac]/;let yn=null,wn=null,kn=!1;function Sn(t,e,n){return yn==e&&wn==n?kn:(yn=e,wn=n,kn="up"==n||"down"==n?function(t,e,n){let i=e.selection,r="up"==n?i.$from:i.$to;return bn(t,e,(()=>{let{node:e}=t.docView.domFromPos(r.pos,"up"==n?-1:1);for(;;){let n=t.docView.nearestDesc(e,!0);if(!n)break;if(n.node.isBlock){e=n.contentDOM||n.dom;break}e=n.dom.parentNode}let i=fn(t,r.pos,1);for(let t=e.firstChild;t;t=t.nextSibling){let e;if(1==t.nodeType)e=t.getClientRects();else{if(3!=t.nodeType)continue;e=Oe(t,0,t.nodeValue.length).getClientRects()}for(let t=0;t<e.length;t++){let r=e[t];if(r.bottom>r.top+1&&("up"==n?i.top-r.top>2*(r.bottom-i.top):r.bottom-i.bottom>2*(i.bottom-r.top)))return!1}}return!0}))}(t,e,n):function(t,e,n){let{$head:i}=e.selection;if(!i.parent.isTextblock)return!1;let r=i.parentOffset,s=!r,o=r==i.parent.content.size,a=t.domSelection();return vn.test(i.parent.textContent)&&a.modify?bn(t,e,(()=>{let{focusNode:e,focusOffset:r,anchorNode:s,anchorOffset:o}=t.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=i.depth?t.docView.domAfterPos(i.before()):t.dom,{focusNode:d,focusOffset:h}=t.domSelectionRange(),u=d&&!c.contains(1==d.nodeType?d:d.parentNode)||e==d&&r==h;try{a.collapse(s,o),e&&(e!=s||r!=o)&&a.extend&&a.extend(e,r)}catch(t){}return null!=l&&(a.caretBidiLevel=l),u})):"left"==n||"backward"==n?s:o}(t,e,n))}class xn{constructor(t,e,n,i){this.parent=t,this.children=e,this.dom=n,this.contentDOM=i,this.dirty=0,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,n=this.posAtStart;;e++){let i=this.children[e];if(i==t)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){let n,i;if(t==this.contentDOM)n=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;n=t.previousSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(i)+i.size:this.posAtStart}{let n,i;if(t==this.contentDOM)n=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;n=t.nextSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(i):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>Ce(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let e=t;;e=e.parentNode){if(e==this.dom){i=!1;break}if(e.previousSibling)break}if(null==i&&e==t.childNodes.length)for(let e=t;;e=e.parentNode){if(e==this.dom){i=!0;break}if(e.nextSibling)break}}return(null==i?n>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let n=!0,i=t;i;i=i.parentNode){let r,s=this.getDesc(i);if(s&&(!e||s.node)){if(!n||!(r=s.nodeDOM)||(1==r.nodeType?r.contains(1==t.nodeType?t:t.parentNode):r==t))return s;n=!1}}}getDesc(t){let e=t.pmViewDesc;for(let t=e;t;t=t.parent)if(t==this)return e}posFromDOM(t,e,n){for(let i=t;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(t,e,n)}return-1}descAt(t){for(let e=0,n=0;e<this.children.length;e++){let i=this.children[e],r=n+i.size;if(n==t&&r!=n){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<r)return i.descAt(t-n-i.border);n=r}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let n=0,i=0;for(let e=0;n<this.children.length;n++){let r=this.children[n],s=e+r.size;if(s>t||r instanceof Mn){i=t-e;break}e=s}if(i)return this.children[n].domFromPos(i-this.children[n].border,e);for(let t;n&&!(t=this.children[n-1]).size&&t instanceof En&&t.side>=0;n--);if(e<=0){let t,i=!0;for(;t=n?this.children[n-1]:null,t&&t.dom.parentNode!=this.contentDOM;n--,i=!1);return t&&e&&i&&!t.border&&!t.domAtom?t.domFromPos(t.size,e):{node:this.contentDOM,offset:t?Ce(t.dom)+1:0}}{let t,i=!0;for(;t=n<this.children.length?this.children[n]:null,t&&t.dom.parentNode!=this.contentDOM;n++,i=!1);return t&&i&&!t.border&&!t.domAtom?t.domFromPos(0,e):{node:this.contentDOM,offset:t?Ce(t.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,n=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let s=n,o=0;;o++){let n=this.children[o],a=s+n.size;if(-1==i&&t<=a){let r=s+n.border;if(t>=r&&e<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(t,e,r);t=s;for(let e=o;e>0;e--){let n=this.children[e-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){i=Ce(n.dom)+1;break}t-=n.size}-1==i&&(i=0)}if(i>-1&&(a>e||o==this.children.length-1)){e=a;for(let t=o+1;t<this.children.length;t++){let n=this.children[t];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){r=Ce(n.dom);break}e+=n.size}-1==r&&(r=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:r}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:n}=this.domFromPos(t,0);if(1!=e.nodeType||n==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[n]}setSelection(t,e,n,i=!1){let r=Math.min(t,e),s=Math.max(t,e);for(let o=0,a=0;o<this.children.length;o++){let l=this.children[o],c=a+l.size;if(r>a&&s<c)return l.setSelection(t-a-l.border,e-a-l.border,n,i);a=c}let o=this.domFromPos(t,t?-1:1),a=e==t?o:this.domFromPos(e,e?-1:1),l=n.getSelection(),c=!1;if((qe||Ye)&&t==e){let{node:t,offset:e}=o;if(3==t.nodeType){if(c=!(!e||"\n"!=t.nodeValue[e-1]),c&&e==t.nodeValue.length)for(let e,n=t;n;n=n.parentNode){if(e=n.nextSibling){"BR"==e.nodeName&&(o=a={node:e.parentNode,offset:Ce(e)+1});break}let t=n.pmViewDesc;if(t&&t.node&&t.node.isBlock)break}}else{let n=t.childNodes[e-1];c=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(qe&&l.focusNode&&l.focusNode!=a.node&&1==l.focusNode.nodeType){let t=l.focusNode.childNodes[l.focusOffset];t&&"false"==t.contentEditable&&(i=!0)}if(!(i||c&&Ye)&&Te(o.node,o.offset,l.anchorNode,l.anchorOffset)&&Te(a.node,a.offset,l.focusNode,l.focusOffset))return;let d=!1;if((l.extend||t==e)&&!c){l.collapse(o.node,o.offset);try{t!=e&&l.extend(a.node,a.offset),d=!0}catch(t){}}if(!d){if(t>e){let t=o;o=a,a=t}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let n=0,i=0;i<this.children.length;i++){let r=this.children[i],s=n+r.size;if(n==s?t<=s&&e>=n:t<s&&e>n){let i=n+r.border,o=s-r.border;if(t>=i&&e<=o)return this.dirty=t==n||e==s?2:1,void(t!=i||e!=o||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(t-i,e-i):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}n=s}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let n=1==t?2:1;e.dirty<n&&(e.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class En extends xn{constructor(t,e,n,i){let r,s=e.type.toDOM;if("function"==typeof s&&(s=s(n,(()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i))),!e.type.spec.raw){if(1!=s.nodeType){let t=document.createElement("span");t.appendChild(s),s=t}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=e,this.widget=e,r=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Cn extends xn{constructor(t,e,n,i){super(t,[],e,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class _n extends xn{constructor(t,e,n,i){super(t,[],n,i),this.mark=e}static create(t,e,n,i){let r=i.nodeViews[e.type.name],s=r&&r(e,i,n);return s&&s.dom||(s=ut.renderSpec(document,e.type.spec.toDOM(e,n))),new _n(t,e,s.dom,s.contentDOM||s.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let t=this.parent;for(;!t.node;)t=t.parent;t.dirty<this.dirty&&(t.dirty=this.dirty),this.dirty=0}}slice(t,e,n){let i=_n.create(this.parent,this.mark,!0,n),r=this.children,s=this.size;e<s&&(r=Vn(r,e,s,n)),t>0&&(r=Vn(r,0,t,n));for(let t=0;t<r.length;t++)r[t].parent=i;return i.children=r,i}}class An extends xn{constructor(t,e,n,i,r,s,o,a,l){super(t,[],r,s),this.node=e,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o,s&&this.updateChildren(a,l)}static create(t,e,n,i,r,s){let o,a=r.nodeViews[e.type.name],l=a&&a(e,r,(()=>o?o.parent?o.parent.posBeforeChild(o):void 0:s),n,i),c=l&&l.dom,d=l&&l.contentDOM;if(e.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(e.text);else c||({dom:c,contentDOM:d}=ut.renderSpec(document,e.type.spec.toDOM(e)));d||e.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),e.type.spec.draggable&&(c.draggable=!0));let h=c;return c=Fn(c,n,e),l?o=new Dn(t,e,n,i,c,d||null,h,l,r,s+1):e.isText?new Tn(t,e,n,i,c,h,r):new An(t,e,n,i,c,d||null,h,r,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let n=this.children[e];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>l.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Bn(e,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let n=this.node.inlineContent,i=e,r=t.composing?this.localCompositionInfo(t,e):null,s=r&&r.pos>-1?r:null,o=r&&r.pos<0,a=new Hn(this,s&&s.node,t);!function(t,e,n,i){let r=e.locals(t),s=0;if(0==r.length){for(let n=0;n<t.childCount;n++){let o=t.child(n);i(o,r,e.forChild(s,o),n),s+=o.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){if(o<r.length&&r[o].to==s){let t,e=r[o++];for(;o<r.length&&r[o].to==s;)(t||(t=[e])).push(r[o++]);if(t){t.sort(zn);for(let e=0;e<t.length;e++)n(t[e],c,!!l)}else n(e,c,!!l)}let d,h;if(l)h=-1,d=l,l=null;else{if(!(c<t.childCount))break;h=c,d=t.child(c++)}for(let t=0;t<a.length;t++)a[t].to<=s&&a.splice(t--,1);for(;o<r.length&&r[o].from<=s&&r[o].to>s;)a.push(r[o++]);let u=s+d.nodeSize;if(d.isText){let t=u;o<r.length&&r[o].from<t&&(t=r[o].from);for(let e=0;e<a.length;e++)a[e].to<t&&(t=a[e].to);t<u&&(l=d.cut(t-s),d=d.cut(0,t-s),u=t,h=-1)}let p=d.isInline&&!d.isLeaf?a.filter((t=>!t.inline)):a.slice();i(d,p,e.forChild(s,d),h),s=u}}(this.node,this.innerDeco,((e,r,s)=>{e.spec.marks?a.syncToMarks(e.spec.marks,n,t):e.type.side>=0&&!s&&a.syncToMarks(r==this.node.childCount?u.none:this.node.child(r).marks,n,t),a.placeWidget(e,t,i)}),((e,s,l,c)=>{let d;a.syncToMarks(e.marks,n,t),a.findNodeMatch(e,s,l,c)||o&&t.state.selection.from>i&&t.state.selection.to<i+e.nodeSize&&(d=a.findIndexWithChild(r.node))>-1&&a.updateNodeAt(e,s,l,d,t)||a.updateNextNode(e,s,l,t,c)||a.addNode(e,s,l,t,i),i+=e.nodeSize})),a.syncToMarks([],n,t),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(t,s),Ln(this.contentDOM,this.children,t),Je&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom))}localCompositionInfo(t,e){let{from:n,to:i}=t.state.selection;if(!(t.state.selection instanceof oe)||n<e||i>e+this.node.content.size)return null;let r=t.domSelectionRange(),s=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];e=Le(t=t.childNodes[e-1])}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(r.focusNode,r.focusOffset);if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let t=s.nodeValue,r=function(t,e,n,i){for(let r=0,s=0;r<t.childCount&&s<=i;){let o=t.child(r++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;r<t.childCount;){let e=t.child(r++);if(s+=e.nodeSize,!e.isText)break;l+=e.text}if(s>=n){let t=a<i?l.lastIndexOf(e,i-a-1):-1;if(t>=0&&t+e.length+a>=n)return a+t;if(n==i&&l.length>=i+e.length-a&&l.slice(i-a,i-a+e.length)==e)return i}}return-1}(this.node.content,t,n-e,i-e);return r<0?null:{node:s,pos:r,text:t}}return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:n,text:i}){if(this.getDesc(e))return;let r=e;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let s=new Cn(this,r,e,i);t.input.compositionNodes.push(s),this.children=Vn(this.children,n,n+i.length,t,s)}update(t,e,n,i){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,i),!0)}updateInner(t,e,n,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(Bn(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=$n(this.dom,this.nodeDOM,Pn(this.outerDeco,this.node,e),Pn(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function On(t,e,n,i,r){return Fn(i,e,t),new An(void 0,t,e,n,i,i,i,r,0)}class Tn extends An{constructor(t,e,n,i,r,s,o){super(t,e,n,i,r,null,s,o,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,n,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,n){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,n)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,n){let i=this.node.cut(t,e),r=document.createTextNode(i.text);return new Tn(this.parent,i,this.outerDeco,this.innerDeco,r,r,n)}markDirty(t,e){super.markDirty(t,e),this.dom==this.nodeDOM||0!=t&&e!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}}class Mn extends xn{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class Dn extends An{constructor(t,e,n,i,r,s,o,a,l,c){super(t,e,n,i,r,s,o,l,c),this.spec=a}update(t,e,n,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(t,e,n);return r&&this.updateInner(t,e,n,i),r}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,n,i){this.spec.setSelection?this.spec.setSelection(t,e,n):super.setSelection(t,e,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Ln(t,e,n){let i=t.firstChild,r=!1;for(let s=0;s<e.length;s++){let o=e[s],a=o.dom;if(a.parentNode==t){for(;a!=i;)i=jn(i),r=!0;i=i.nextSibling}else r=!0,t.insertBefore(a,i);if(o instanceof _n){let e=i?i.previousSibling:t.lastChild;Ln(o.contentDOM,o.children,n),i=e?e.nextSibling:t.firstChild}}for(;i;)i=jn(i),r=!0;r&&n.trackWrites==t&&(n.trackWrites=null)}const Nn=function(t){t&&(this.nodeName=t)};Nn.prototype=Object.create(null);const In=[new Nn];function Pn(t,e,n){if(0==t.length)return In;let i=n?In[0]:new Nn,r=[i];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&r.push(i=new Nn(o.nodeName));for(let t in o){let s=o[t];null!=s&&(n&&1==r.length&&r.push(i=new Nn(e.isInline?"span":"div")),"class"==t?i.class=(i.class?i.class+" ":"")+s:"style"==t?i.style=(i.style?i.style+";":"")+s:"nodeName"!=t&&(i[t]=s))}}}return r}function $n(t,e,n,i){if(n==In&&i==In)return e;let r=e;for(let e=0;e<i.length;e++){let s=i[e],o=n[e];if(e){let e;o&&o.nodeName==s.nodeName&&r!=t&&(e=r.parentNode)&&e.nodeName.toLowerCase()==s.nodeName||(e=document.createElement(s.nodeName),e.pmIsDeco=!0,e.appendChild(r),o=In[0]),r=e}Rn(r,o||In[0],s)}return r}function Rn(t,e,n){for(let i in e)"class"==i||"style"==i||"nodeName"==i||i in n||t.removeAttribute(i);for(let i in n)"class"!=i&&"style"!=i&&"nodeName"!=i&&n[i]!=e[i]&&t.setAttribute(i,n[i]);if(e.class!=n.class){let i=e.class?e.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let e=0;e<i.length;e++)-1==r.indexOf(i[e])&&t.classList.remove(i[e]);for(let e=0;e<r.length;e++)-1==i.indexOf(r[e])&&t.classList.add(r[e]);0==t.classList.length&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let n,i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=i.exec(e.style);)t.style.removeProperty(n[1])}n.style&&(t.style.cssText+=n.style)}}function Fn(t,e,n){return $n(t,t,In,Pn(e,n,1!=t.nodeType))}function Bn(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function jn(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Hn{constructor(t,e,n){this.lock=e,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function(t,e){let n=e,i=n.children.length,r=t.childCount,s=new Map,o=[];t:for(;r>0;){let a;for(;;)if(i){let t=n.children[i-1];if(!(t instanceof _n)){a=t,i--;break}n=t,i=t.children.length}else{if(n==e)break t;i=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=t.child(r-1))break;--r,s.set(a,r),o.push(a)}}return{index:r,matched:s,matches:o.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,n){let i=0,r=this.stack.length>>1,s=Math.min(r,t.length);for(;i<s&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<t.length;){this.stack.push(this.top,this.index+1);let i=-1;for(let e=this.index;e<Math.min(this.index+3,this.top.children.length);e++){let n=this.top.children[e];if(n.matchesMark(t[r])&&!this.isLocked(n.dom)){i=e;break}}if(i>-1)i>this.index&&(this.changed=!0,this.destroyBetween(this.index,i)),this.top=this.top.children[this.index];else{let i=_n.create(this.top,t[r],e,n);this.top.children.splice(this.index,0,i),this.top=i,this.changed=!0}this.index=0,r++}}findNodeMatch(t,e,n,i){let r,s=-1;if(i>=this.preMatch.index&&(r=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&r.matchesNode(t,e,n))s=this.top.children.indexOf(r,this.index);else for(let i=this.index,r=Math.min(this.top.children.length,i+5);i<r;i++){let r=this.top.children[i];if(r.matchesNode(t,e,n)&&!this.preMatch.matched.has(r)){s=i;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,n,i,r){let s=this.top.children[i];return 3==s.dirty&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(t,e,n,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let e=t.pmViewDesc;if(e)for(let t=this.index;t<this.top.children.length;t++)if(this.top.children[t]==e)return t;return-1}t=e}}updateNextNode(t,e,n,i,r){for(let s=this.index;s<this.top.children.length;s++){let o=this.top.children[s];if(o instanceof An){let a=this.preMatch.matched.get(o);if(null!=a&&a!=r)return!1;let l=o.dom;if(!(this.isLocked(l)&&!(t.isText&&o.node&&o.node.isText&&o.nodeDOM.nodeValue==t.text&&3!=o.dirty&&Bn(e,o.outerDeco)))&&o.update(t,e,n,i))return this.destroyBetween(this.index,s),o.dom!=l&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,n,i,r){this.top.children.splice(this.index++,0,An.create(this.top,t,e,n,i,r)),this.changed=!0}placeWidget(t,e,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let i=new En(this.top,t,e,n);this.top.children.splice(this.index++,0,i),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof _n;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof Tn)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ye||We)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak");let i=new Mn(this.top,[],n,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||1==t.nodeType&&t.contains(this.lock.parentNode))}}function zn(t,e){return t.type.side-e.type.side}function Vn(t,e,n,i,r){let s=[];for(let o=0,a=0;o<t.length;o++){let l=t[o],c=a,d=a+=l.size;c>=n||d<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,i)),r&&(s.push(r),r=void 0),d>n&&s.push(l.slice(n-c,l.size,i)))}return s}function qn(t,e=null){let n=t.domSelectionRange(),i=t.state.doc;if(!n.focusNode)return null;let r=t.docView.nearestDesc(n.focusNode),s=r&&0==r.size,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a,l,c=i.resolve(o);if(Ie(n)){for(a=c;r&&!r.node;)r=r.parent;let t=r.node;if(r&&t.isAtom&&le.isSelectable(t)&&r.parent&&(!t.isInline||!function(t,e,n){for(let i=0==e,r=e==Le(t);i||r;){if(t==n)return!0;let e=Ce(t);if(!(t=t.parentNode))return!1;i=i&&0==e,r=r&&e==Le(t)}}(n.focusNode,n.focusOffset,r.dom))){let t=r.posBefore;l=new le(o==t?c:i.resolve(t))}}else{let e=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(e<0)return null;a=i.resolve(e)}if(!l){l=Zn(t,a,c,"pointer"==e||t.state.selection.head<c.pos&&!s?1:-1)}return l}function Un(t){return t.editable?t.hasFocus():ei(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Wn(t,e=!1){let n=t.state.selection;if(Xn(t,n),Un(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&We){let e=t.domSelectionRange(),n=t.domObserver.currentSelection;if(e.anchorNode&&n.anchorNode&&Te(e.anchorNode,e.anchorOffset,n.anchorNode,n.anchorOffset))return t.input.mouseDown.delayedSelectionSync=!0,void t.domObserver.setCurSelection()}if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){let e=t.domSelection(),n=document.createRange(),i=t.cursorWrapper.dom,r="IMG"==i.nodeName;r?n.setEnd(i.parentNode,Ce(i)+1):n.setEnd(i,0);n.collapse(!1),e.removeAllRanges(),e.addRange(n),!r&&!t.state.selection.visible&&ze&&Ve<=11&&(i.disabled=!0,i.disabled=!1)}(t);else{let i,r,{anchor:s,head:o}=n;!Kn||n instanceof oe||(n.$from.parent.inlineContent||(i=Yn(t,n.from)),n.empty||n.$from.parent.inlineContent||(r=Yn(t,n.to))),t.docView.setSelection(s,o,t.root,e),Kn&&(i&&Gn(i),r&&Gn(r)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),i=n.anchorNode,r=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{n.anchorNode==i&&n.anchorOffset==r||(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout((()=>{Un(t)&&!t.state.selection.visible||t.dom.classList.remove("ProseMirror-hideselection")}),20))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Kn=Ye||We&&Ke<63;function Yn(t,e){let{node:n,offset:i}=t.docView.domFromPos(e,0),r=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(Ye&&r&&"false"==r.contentEditable)return Jn(r);if(!(r&&"false"!=r.contentEditable||s&&"false"!=s.contentEditable)){if(r)return Jn(r);if(s)return Jn(s)}}function Jn(t){return t.contentEditable="true",Ye&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Gn(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Xn(t,e){if(e instanceof le){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Qn(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Qn(t)}function Qn(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Zn(t,e,n,i){return t.someProp("createSelectionBetween",(i=>i(t,e,n)))||oe.between(e,n,i)}function ti(t){return!(t.editable&&!t.hasFocus())&&ei(t)}function ei(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function ni(t,e){let{$anchor:n,$head:i}=t.selection,r=e>0?n.max(i):n.min(i),s=r.parent.inlineContent?r.depth?t.doc.resolve(e>0?r.after():r.before()):null:r;return s&&ne.findFrom(s,e)}function ii(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ri(t,e,n){let i=t.state.selection;if(!(i instanceof oe)){if(i instanceof le&&i.node.isInline)return ii(t,new oe(e>0?i.$to:i.$from));{let n=ni(t.state,e);return!!n&&ii(t,n)}}if(!i.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){let n=ni(t.state,e);return!!(n&&n instanceof le)&&ii(t,n)}if(!(Ge&&n.indexOf("m")>-1)){let n,r=i.$head,s=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!s||s.isText)return!1;let o=e<0?r.pos-s.nodeSize:r.pos;return!!(s.isAtom||(n=t.docView.descAt(o))&&!n.contentDOM)&&(le.isSelectable(s)?ii(t,new le(e<0?t.state.doc.resolve(r.pos-s.nodeSize):r)):!!Qe&&ii(t,new oe(t.state.doc.resolve(e<0?o:o+s.nodeSize))))}}function si(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function oi(t){let e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function ai(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let r,s,o=!1;for(qe&&1==n.nodeType&&i<si(n)&&oi(n.childNodes[i])&&(o=!0);;)if(i>0){if(1!=n.nodeType)break;{let t=n.childNodes[i-1];if(oi(t))r=n,s=--i;else{if(3!=t.nodeType)break;n=t,i=n.nodeValue.length}}}else{if(ci(n))break;{let e=n.previousSibling;for(;e&&oi(e);)r=n.parentNode,s=Ce(e),e=e.previousSibling;if(e)n=e,i=si(n);else{if(n=n.parentNode,n==t.dom)break;i=0}}}o?di(t,n,i):r&&di(t,r,s)}function li(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let r,s,o=si(n);for(;;)if(i<o){if(1!=n.nodeType)break;if(!oi(n.childNodes[i]))break;r=n,s=++i}else{if(ci(n))break;{let e=n.nextSibling;for(;e&&oi(e);)r=e.parentNode,s=Ce(e)+1,e=e.nextSibling;if(e)n=e,i=0,o=si(n);else{if(n=n.parentNode,n==t.dom)break;i=o=0}}}r&&di(t,r,s)}function ci(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function di(t,e,n){let i=t.domSelection();if(Ie(i)){let t=document.createRange();t.setEnd(e,n),t.setStart(e,n),i.removeAllRanges(),i.addRange(t)}else i.extend&&i.extend(e,n);t.domObserver.setCurSelection();let{state:r}=t;setTimeout((()=>{t.state==r&&Wn(t)}),50)}function hi(t,e,n){let i=t.state.selection;if(i instanceof oe&&!i.empty||n.indexOf("s")>-1)return!1;if(Ge&&n.indexOf("m")>-1)return!1;let{$from:r,$to:s}=i;if(!r.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let n=ni(t.state,e);if(n&&n instanceof le)return ii(t,n)}if(!r.parent.inlineContent){let n=e<0?r:s,o=i instanceof de?ne.near(n,e):ne.findFrom(n,e);return!!o&&ii(t,o)}return!1}function ui(t,e){if(!(t.state.selection instanceof oe))return!0;let{$head:n,$anchor:i,empty:r}=t.state.selection;if(!n.sameParent(i))return!0;if(!r)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let i=t.state.tr;return e<0?i.delete(n.pos-s.nodeSize,n.pos):i.delete(n.pos,n.pos+s.nodeSize),t.dispatch(i),!0}return!1}function pi(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function fi(t,e){let n=e.keyCode,i=function(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||Ge&&72==n&&"c"==i?ui(t,-1)||ai(t):46==n||Ge&&68==n&&"c"==i?ui(t,1)||li(t):13==n||27==n||(37==n||Ge&&66==n&&"c"==i?ri(t,-1,i)||ai(t):39==n||Ge&&70==n&&"c"==i?ri(t,1,i)||li(t):38==n||Ge&&80==n&&"c"==i?hi(t,-1,i)||ai(t):40==n||Ge&&78==n&&"c"==i?function(t){if(!Ye||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&1==e.nodeType&&0==n&&e.firstChild&&"false"==e.firstChild.contentEditable){let n=e.firstChild;pi(t,n,"true"),setTimeout((()=>pi(t,n,"false")),20)}return!1}(t)||hi(t,1,i)||li(t):i==(Ge?"m":"c")&&(66==n||73==n||89==n||90==n))}function mi(t,e){t.someProp("transformCopied",(n=>{e=n(e,t)}));let n=[],{content:i,openStart:r,openEnd:s}=e;for(;r>1&&s>1&&1==i.childCount&&1==i.firstChild.childCount;){r--,s--;let t=i.firstChild;n.push(t.type.name,t.attrs!=t.type.defaultAttrs?t.attrs:null),i=t.content}let o=t.someProp("clipboardSerializer")||ut.fromSchema(t.state.schema),a=Ci(),l=a.createElement("div");l.appendChild(o.serializeFragment(i,{document:a}));let c,d=l.firstChild,h=0;for(;d&&1==d.nodeType&&(c=xi[d.nodeName.toLowerCase()]);){for(let t=c.length-1;t>=0;t--){let e=a.createElement(c[t]);for(;l.firstChild;)e.appendChild(l.firstChild);l.appendChild(e),h++}d=l.firstChild}d&&1==d.nodeType&&d.setAttribute("data-pm-slice",`${r} ${s}${h?` -${h}`:""} ${JSON.stringify(n)}`);let u=t.someProp("clipboardTextSerializer",(n=>n(e,t)))||e.content.textBetween(0,e.content.size,"\n\n");return{dom:l,text:u}}function gi(t,e,n,i,r){let s,o,a=r.parent.type.spec.code;if(!n&&!e)return null;let c=e&&(i||a||!n);if(c){if(t.someProp("transformPastedText",(n=>{e=n(e,a||i,t)})),a)return e?new f(l.from(t.state.schema.text(e.replace(/\r\n?/g,"\n"))),0,0):f.empty;let n=t.someProp("clipboardTextParser",(n=>n(e,r,i,t)));if(n)o=n;else{let n=r.marks(),{schema:i}=t.state,o=ut.fromSchema(i);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach((t=>{let e=s.appendChild(document.createElement("p"));t&&e.appendChild(o.serializeNode(i.text(t,n)))}))}}else t.someProp("transformPastedHTML",(e=>{n=e(n,t)})),s=function(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n,i=Ci().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t);(n=r&&xi[r[1].toLowerCase()])&&(t=n.map((t=>"<"+t+">")).join("")+t+n.map((t=>"</"+t+">")).reverse().join(""));if(i.innerHTML=t,n)for(let t=0;t<n.length;t++)i=i.querySelector(n[t])||i;return i}(n),Qe&&function(t){let e=t.querySelectorAll(We?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let i=e[n];1==i.childNodes.length&&" "==i.textContent&&i.parentNode&&i.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),i)}}(s);let d=s&&s.querySelector("[data-pm-slice]"),h=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let t=+h[3];t>0;t--){let t=s.firstChild;for(;t&&1!=t.nodeType;)t=t.nextSibling;if(!t)break;s=t}if(!o){let e=t.someProp("clipboardParser")||t.someProp("domParser")||Z.fromSchema(t.state.schema);o=e.parseSlice(s,{preserveWhitespace:!(!c&&!h),context:r,ruleFromNode:t=>"BR"!=t.nodeName||t.nextSibling||!t.parentNode||bi.test(t.parentNode.nodeName)?null:{ignore:!0}})}if(h)o=function(t,e){if(!t.size)return t;let n,i=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}let{content:r,openStart:s,openEnd:o}=t;for(let t=n.length-2;t>=0;t-=2){let e=i.nodes[n[t]];if(!e||e.hasRequiredAttrs())break;r=l.from(e.create(n[t+1],r)),s++,o++}return new f(r,s,o)}(Si(o,+h[1],+h[2]),h[4]);else if(o=f.maxOpen(function(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i,r=e.node(n).contentMatchAt(e.index(n)),s=[];if(t.forEach((t=>{if(!s)return;let e,n=r.findWrapping(t.type);if(!n)return s=null;if(e=s.length&&i.length&&yi(n,i,t,s[s.length-1],0))s[s.length-1]=e;else{s.length&&(s[s.length-1]=wi(s[s.length-1],i.length));let e=vi(t,n);s.push(e),r=r.matchType(e.type),i=n}})),s)return l.from(s)}return t}(o.content,r),!0),o.openStart||o.openEnd){let t=0,e=0;for(let e=o.content.firstChild;t<o.openStart&&!e.type.spec.isolating;t++,e=e.firstChild);for(let t=o.content.lastChild;e<o.openEnd&&!t.type.spec.isolating;e++,t=t.lastChild);o=Si(o,t,e)}return t.someProp("transformPasted",(e=>{o=e(o,t)})),o}const bi=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function vi(t,e,n=0){for(let i=e.length-1;i>=n;i--)t=e[i].create(null,l.from(t));return t}function yi(t,e,n,i,r){if(r<t.length&&r<e.length&&t[r]==e[r]){let s=yi(t,e,n,i.lastChild,r+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(r==t.length-1?n.type:t[r+1]))return i.copy(i.content.append(l.from(vi(n,t,r+1))))}}function wi(t,e){if(0==e)return t;let n=t.content.replaceChild(t.childCount-1,wi(t.lastChild,e-1)),i=t.contentMatchAt(t.childCount).fillBefore(l.empty,!0);return t.copy(n.append(i))}function ki(t,e,n,i,r,s){let o=e<0?t.firstChild:t.lastChild,a=o.content;return r<i-1&&(a=ki(a,e,n,i,r+1,s)),r>=n&&(a=e<0?o.contentMatchAt(0).fillBefore(a,t.childCount>1||s<=r).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(l.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(a))}function Si(t,e,n){return e<t.openStart&&(t=new f(ki(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new f(ki(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const xi={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ei=null;function Ci(){return Ei||(Ei=document.implementation.createHTMLDocument("title"))}const _i={},Ai={},Oi={touchstart:!0,touchmove:!0};class Ti{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Mi(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Di(t){t.someProp("handleDOMEvents",(e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=e=>Li(t,e))}))}function Li(t,e){return t.someProp("handleDOMEvents",(n=>{let i=n[e.type];return!!i&&(i(t,e)||e.defaultPrevented)}))}function Ni(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function Ii(t){return{left:t.clientX,top:t.clientY}}function Pi(t,e,n,i,r){if(-1==i)return!1;let s=t.state.doc.resolve(i);for(let i=s.depth+1;i>0;i--)if(t.someProp(e,(e=>i>s.depth?e(t,n,s.nodeAfter,s.before(i),r,!0):e(t,n,s.node(i),s.before(i),r,!1))))return!0;return!1}function $i(t,e,n){t.focused||t.focus();let i=t.state.tr.setSelection(e);"pointer"==n&&i.setMeta("pointer",!0),t.dispatch(i)}function Ri(t,e,n,i,r){return Pi(t,"handleClickOn",e,n,i)||t.someProp("handleClick",(n=>n(t,e,i)))||(r?function(t,e){if(-1==e)return!1;let n,i,r=t.state.selection;r instanceof le&&(n=r.node);let s=t.state.doc.resolve(e);for(let t=s.depth+1;t>0;t--){let e=t>s.depth?s.nodeAfter:s.node(t);if(le.isSelectable(e)){i=n&&r.$from.depth>0&&t>=r.$from.depth&&s.before(r.$from.depth+1)==r.$from.pos?s.before(r.$from.depth):s.before(t);break}}return null!=i&&($i(t,le.create(t.state.doc,i),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;let n=t.state.doc.resolve(e),i=n.nodeAfter;return!!(i&&i.isAtom&&le.isSelectable(i))&&($i(t,new le(n),"pointer"),!0)}(t,n))}function Fi(t,e,n,i){return Pi(t,"handleDoubleClickOn",e,n,i)||t.someProp("handleDoubleClick",(n=>n(t,e,i)))}function Bi(t,e,n,i){return Pi(t,"handleTripleClickOn",e,n,i)||t.someProp("handleTripleClick",(n=>n(t,e,i)))||function(t,e,n){if(0!=n.button)return!1;let i=t.state.doc;if(-1==e)return!!i.inlineContent&&($i(t,oe.create(i,0,i.content.size),"pointer"),!0);let r=i.resolve(e);for(let e=r.depth+1;e>0;e--){let n=e>r.depth?r.nodeAfter:r.node(e),s=r.before(e);if(n.inlineContent)$i(t,oe.create(i,s+1,s+1+n.content.size),"pointer");else{if(!le.isSelectable(n))continue;$i(t,le.create(i,s),"pointer")}return!0}}(t,n,i)}function ji(t){return Ki(t)}Ai.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=16==n.keyCode||n.shiftKey,!Vi(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!Xe||!We||13!=n.keyCode))if(229!=n.keyCode&&t.domObserver.forceFlush(),!Je||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)t.someProp("handleKeyDown",(e=>e(t,n)))||fi(t,n)?n.preventDefault():Mi(t,"key");else{let e=Date.now();t.input.lastIOSEnter=e,t.input.lastIOSEnterFallbackTimeout=setTimeout((()=>{t.input.lastIOSEnter==e&&(t.someProp("handleKeyDown",(e=>e(t,Pe(13,"Enter")))),t.input.lastIOSEnter=0)}),200)}},Ai.keyup=(t,e)=>{16==e.keyCode&&(t.input.shiftKey=!1)},Ai.keypress=(t,e)=>{let n=e;if(Vi(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||Ge&&n.metaKey)return;if(t.someProp("handleKeyPress",(e=>e(t,n))))return void n.preventDefault();let i=t.state.selection;if(!(i instanceof oe&&i.$from.sameParent(i.$to))){let e=String.fromCharCode(n.charCode);/[\r\n]/.test(e)||t.someProp("handleTextInput",(n=>n(t,i.$from.pos,i.$to.pos,e)))||t.dispatch(t.state.tr.insertText(e).scrollIntoView()),n.preventDefault()}};const Hi=Ge?"metaKey":"ctrlKey";_i.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let i=ji(t),r=Date.now(),s="singleClick";r-t.input.lastClick.time<500&&function(t,e){let n=e.x-t.clientX,i=e.y-t.clientY;return n*n+i*i<100}(n,t.input.lastClick)&&!n[Hi]&&("singleClick"==t.input.lastClick.type?s="doubleClick":"doubleClick"==t.input.lastClick.type&&(s="tripleClick")),t.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:s};let o=t.posAtCoords(Ii(n));o&&("singleClick"==s?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new zi(t,o,n,!!i)):("doubleClick"==s?Fi:Bi)(t,o.pos,o.inside,n)?n.preventDefault():Mi(t,"pointer"))};class zi{constructor(t,e,n,i){let r,s;if(this.view=t,this.pos=e,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Hi],this.allowDefault=n.shiftKey,e.inside>-1)r=t.state.doc.nodeAt(e.inside),s=e.inside;else{let n=t.state.doc.resolve(e.pos);r=n.parent,s=n.depth?n.before():0}const o=i?null:n.target,a=o?t.docView.nearestDesc(o,!0):null;this.target=a?a.dom:null;let{selection:l}=t.state;(0==n.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||l instanceof le&&l.from<=s&&l.to>s)&&(this.mightDrag={node:r,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!qe||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Mi(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((()=>Wn(this.view))),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Ii(t))),this.updateAllowDefault(t),this.allowDefault||!e?Mi(this.view,"pointer"):Ri(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Ye&&this.mightDrag&&!this.mightDrag.node.isAtom||We&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?($i(this.view,ne.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):Mi(this.view,"pointer")}move(t){this.updateAllowDefault(t),Mi(this.view,"pointer"),0==t.buttons&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}function Vi(t,e){return!!t.composing||!!(Ye&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500)&&(t.input.compositionEndedAt=-2e8,!0)}_i.touchstart=t=>{t.input.lastTouch=Date.now(),ji(t),Mi(t,"pointer")},_i.touchmove=t=>{t.input.lastTouch=Date.now(),Mi(t,"pointer")},_i.contextmenu=t=>ji(t);const qi=Xe?5e3:-1;function Ui(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout((()=>Ki(t)),e))}function Wi(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=function(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Ki(t,e=!1){if(!(Xe&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Wi(t),e||t.docView&&t.docView.dirty){let e=qn(t);return e&&!e.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(e)):t.updateState(t.state),!0}return!1}}Ai.compositionstart=Ai.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((t=>!1===t.type.spec.inclusive))))t.markCursor=t.state.storedMarks||n.marks(),Ki(t,!0),t.markCursor=null;else if(Ki(t),qe&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let e=t.domSelectionRange();for(let n=e.focusNode,i=e.focusOffset;n&&1==n.nodeType&&0!=i;){let e=i<0?n.lastChild:n.childNodes[i-1];if(!e)break;if(3==e.nodeType){t.domSelection().collapse(e,e.nodeValue.length);break}n=e,i=-1}}t.input.composing=!0}Ui(t,qi)},Ai.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,Ui(t,20))};const Yi=ze&&Ve<15||Je&&Ze<604;function Ji(t,e,n,i,r){let s=gi(t,e,n,i,t.state.selection.$from);if(t.someProp("handlePaste",(e=>e(t,r,s||f.empty))))return!0;if(!s)return!1;let o=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(s),a=o?t.state.tr.replaceSelectionWith(o,t.input.shiftKey):t.state.tr.replaceSelection(s);return t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}_i.copy=Ai.cut=(t,e)=>{let n=e,i=t.state.selection,r="cut"==n.type;if(i.empty)return;let s=Yi?null:n.clipboardData,o=i.content(),{dom:a,text:l}=mi(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):function(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),r=document.createRange();r.selectNodeContents(e),t.dom.blur(),i.removeAllRanges(),i.addRange(r),setTimeout((()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()}),50)}(t,a),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Ai.paste=(t,e)=>{let n=e;if(t.composing&&!Xe)return;let i=Yi?null:n.clipboardData;i&&Ji(t,i.getData("text/plain"),i.getData("text/html"),t.input.shiftKey,n)?n.preventDefault():function(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,i=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.parentNode&&i.parentNode.removeChild(i),n?Ji(t,i.value,null,t.input.shiftKey,e):Ji(t,i.textContent,i.innerHTML,t.input.shiftKey,e)}),50)}(t,n)};class Gi{constructor(t,e){this.slice=t,this.move=e}}const Xi=Ge?"altKey":"ctrlKey";_i.dragstart=(t,e)=>{let n=e,i=t.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let r=t.state.selection,s=r.empty?null:t.posAtCoords(Ii(n));if(s&&s.pos>=r.from&&s.pos<=(r instanceof le?r.to-1:r.to));else if(i&&i.mightDrag)t.dispatch(t.state.tr.setSelection(le.create(t.state.doc,i.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let e=t.docView.nearestDesc(n.target,!0);e&&e.node.type.spec.draggable&&e!=t.docView&&t.dispatch(t.state.tr.setSelection(le.create(t.state.doc,e.posBefore)))}let o=t.state.selection.content(),{dom:a,text:l}=mi(t,o);n.dataTransfer.clearData(),n.dataTransfer.setData(Yi?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",Yi||n.dataTransfer.setData("text/plain",l),t.dragging=new Gi(o,!n[Xi])},_i.dragend=t=>{let e=t.dragging;window.setTimeout((()=>{t.dragging==e&&(t.dragging=null)}),50)},Ai.dragover=Ai.dragenter=(t,e)=>e.preventDefault(),Ai.drop=(t,e)=>{let n=e,i=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let r=t.posAtCoords(Ii(n));if(!r)return;let s=t.state.doc.resolve(r.pos),o=i&&i.slice;o?t.someProp("transformPasted",(e=>{o=e(o,t)})):o=gi(t,n.dataTransfer.getData(Yi?"Text":"text/plain"),Yi?null:n.dataTransfer.getData("text/html"),!1,s);let a=!(!i||n[Xi]);if(t.someProp("handleDrop",(e=>e(t,n,o||f.empty,a))))return void n.preventDefault();if(!o)return;n.preventDefault();let l=o?jt(t.state.doc,s.pos,o):s.pos;null==l&&(l=s.pos);let c=t.state.tr;a&&c.deleteSelection();let d=c.mapping.map(l),h=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,u=c.doc;if(h?c.replaceRangeWith(d,d,o.content.firstChild):c.replaceRange(d,d,o),c.doc.eq(u))return;let p=c.doc.resolve(d);if(h&&le.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new le(p));else{let e=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach(((t,n,i,r)=>e=r)),c.setSelection(Zn(t,p,c.doc.resolve(e)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))},_i.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Wn(t)}),20))},_i.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)},_i.beforeinput=(t,e)=>{if(We&&Xe&&"deleteContentBackward"==e.inputType){t.domObserver.flushSoon();let{domChangeCount:e}=t.input;setTimeout((()=>{if(t.input.domChangeCount!=e)return;if(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",(e=>e(t,Pe(8,"Backspace")))))return;let{$cursor:n}=t.state.selection;n&&n.pos>0&&t.dispatch(t.state.tr.delete(n.pos-1,n.pos).scrollIntoView())}),50)}};for(let t in Ai)_i[t]=Ai[t];function Qi(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Zi{constructor(t,e){this.toDOM=t,this.spec=e||rr,this.side=this.spec.side||0}map(t,e,n,i){let{pos:r,deleted:s}=t.mapResult(e.from+i,this.side<0?-1:1);return s?null:new nr(r-n,r-n,this)}valid(){return!0}eq(t){return this==t||t instanceof Zi&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Qi(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class tr{constructor(t,e){this.attrs=t,this.spec=e||rr}map(t,e,n,i){let r=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-n,s=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-n;return r>=s?null:new nr(r,s,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof tr&&Qi(this.attrs,t.attrs)&&Qi(this.spec,t.spec)}static is(t){return t.type instanceof tr}destroy(){}}class er{constructor(t,e){this.attrs=t,this.spec=e||rr}map(t,e,n,i){let r=t.mapResult(e.from+i,1);if(r.deleted)return null;let s=t.mapResult(e.to+i,-1);return s.deleted||s.pos<=r.pos?null:new nr(r.pos-n,s.pos-n,this)}valid(t,e){let n,{index:i,offset:r}=t.content.findIndex(e.from);return r==e.from&&!(n=t.child(i)).isText&&r+n.nodeSize==e.to}eq(t){return this==t||t instanceof er&&Qi(this.attrs,t.attrs)&&Qi(this.spec,t.spec)}destroy(){}}class nr{constructor(t,e,n){this.from=t,this.to=e,this.type=n}copy(t,e){return new nr(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,n){return this.type.map(t,this,e,n)}static widget(t,e,n){return new nr(t,t,new Zi(e,n))}static inline(t,e,n,i){return new nr(t,e,new tr(n,i))}static node(t,e,n,i){return new nr(t,e,new er(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof tr}}const ir=[],rr={};class sr{constructor(t,e){this.local=t.length?t:ir,this.children=e.length?e:ir}static create(t,e){return e.length?hr(e,t,0,rr):or}find(t,e,n){let i=[];return this.findInner(null==t?0:t,null==e?1e9:e,i,0,n),i}findInner(t,e,n,i,r){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=e&&o.to>=t&&(!r||r(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<e&&this.children[s+1]>t){let o=this.children[s]+1;this.children[s+2].findInner(t-o,e-o,n,i+o,r)}}map(t,e,n){return this==or||0==t.maps.length?this:this.mapInner(t,e,0,0,n||rr)}mapInner(t,e,n,i,r){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(t,n,i);a&&a.type.valid(e,a)?(s||(s=[])).push(a):r.onRemove&&r.onRemove(this.local[o].spec)}return this.children.length?function(t,e,n,i,r,s,o){let a=t.slice();for(let t=0,e=s;t<n.maps.length;t++){let i=0;n.maps[t].forEach(((t,n,s,o)=>{let l=o-s-(n-t);for(let o=0;o<a.length;o+=3){let c=a[o+1];if(c<0||t>c+e-i)continue;let d=a[o]+e-i;n>=d?a[o+1]=t<=d?-2:-1:s>=r&&l&&(a[o]+=l,a[o+1]+=l)}i+=l})),e=n.maps[t].map(e,-1)}let l=!1;for(let e=0;e<a.length;e+=3)if(a[e+1]<0){if(-2==a[e+1]){l=!0,a[e+1]=-1;continue}let c=n.map(t[e]+s),d=c-r;if(d<0||d>=i.content.size){l=!0;continue}let h=n.map(t[e+1]+s,-1)-r,{index:u,offset:p}=i.content.findIndex(d),f=i.maybeChild(u);if(f&&p==d&&p+f.nodeSize==h){let i=a[e+2].mapInner(n,f,c+1,t[e]+s+1,o);i!=or?(a[e]=d,a[e+1]=h,a[e+2]=i):(a[e+1]=-2,l=!0)}else l=!0}if(l){let l=function(t,e,n,i,r,s,o){function a(t,e){for(let s=0;s<t.local.length;s++){let a=t.local[s].map(i,r,e);a?n.push(a):o.onRemove&&o.onRemove(t.local[s].spec)}for(let n=0;n<t.children.length;n+=3)a(t.children[n+2],t.children[n]+e+1)}for(let n=0;n<t.length;n+=3)-1==t[n+1]&&a(t[n+2],e[n]+s+1);return n}(a,t,e,n,r,s,o),c=hr(l,i,0,o);e=c.local;for(let t=0;t<a.length;t+=3)a[t+1]<0&&(a.splice(t,3),t-=3);for(let t=0,e=0;t<c.children.length;t+=3){let n=c.children[t];for(;e<a.length&&a[e]<n;)e+=3;a.splice(e,0,c.children[t],c.children[t+1],c.children[t+2])}}return new sr(e.sort(ur),a)}(this.children,s||[],t,e,n,i,r):s?new sr(s.sort(ur),ir):or}add(t,e){return e.length?this==or?sr.create(t,e):this.addInner(t,e,0):this}addInner(t,e,n){let i,r=0;t.forEach(((t,s)=>{let o,a=s+n;if(o=cr(e,t,a)){for(i||(i=this.children.slice());r<i.length&&i[r]<s;)r+=3;i[r]==s?i[r+2]=i[r+2].addInner(t,o,a+1):i.splice(r,0,s,s+t.nodeSize,hr(o,t,a+1,rr)),r+=3}}));let s=lr(r?dr(e):e,-n);for(let e=0;e<s.length;e++)s[e].type.valid(t,s[e])||s.splice(e--,1);return new sr(s.length?this.local.concat(s).sort(ur):this.local,i||this.children)}remove(t){return 0==t.length||this==or?this:this.removeInner(t,0)}removeInner(t,e){let n=this.children,i=this.local;for(let i=0;i<n.length;i+=3){let r,s=n[i]+e,o=n[i+1]+e;for(let e,n=0;n<t.length;n++)(e=t[n])&&e.from>s&&e.to<o&&(t[n]=null,(r||(r=[])).push(e));if(!r)continue;n==this.children&&(n=this.children.slice());let a=n[i+2].removeInner(r,s+1);a!=or?n[i+2]=a:(n.splice(i,3),i-=3)}if(i.length)for(let n,r=0;r<t.length;r++)if(n=t[r])for(let t=0;t<i.length;t++)i[t].eq(n,e)&&(i==this.local&&(i=this.local.slice()),i.splice(t--,1));return n==this.children&&i==this.local?this:i.length||n.length?new sr(i,n):or}forChild(t,e){if(this==or)return this;if(e.isLeaf)return sr.empty;let n,i;for(let e=0;e<this.children.length;e+=3)if(this.children[e]>=t){this.children[e]==t&&(n=this.children[e+2]);break}let r=t+1,s=r+e.content.size;for(let t=0;t<this.local.length;t++){let e=this.local[t];if(e.from<s&&e.to>r&&e.type instanceof tr){let t=Math.max(r,e.from)-r,n=Math.min(s,e.to)-r;t<n&&(i||(i=[])).push(e.copy(t,n))}}if(i){let t=new sr(i.sort(ur),ir);return n?new ar([t,n]):t}return n||or}eq(t){if(this==t)return!0;if(!(t instanceof sr)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return pr(this.localsInner(t))}localsInner(t){if(this==or)return ir;if(t.inlineContent||!this.local.some(tr.is))return this.local;let e=[];for(let t=0;t<this.local.length;t++)this.local[t].type instanceof tr||e.push(this.local[t]);return e}}sr.empty=new sr([],[]),sr.removeOverlap=pr;const or=sr.empty;class ar{constructor(t){this.members=t}map(t,e){const n=this.members.map((n=>n.map(t,e,rr)));return ar.from(n)}forChild(t,e){if(e.isLeaf)return sr.empty;let n=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(t,e);r!=or&&(r instanceof ar?n=n.concat(r.members):n.push(r))}return ar.from(n)}eq(t){if(!(t instanceof ar)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,n=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(t);if(r.length)if(e){n&&(e=e.slice(),n=!1);for(let t=0;t<r.length;t++)e.push(r[t])}else e=r}return e?pr(n?e:e.sort(ur)):ir}static from(t){switch(t.length){case 0:return or;case 1:return t[0];default:return new ar(t.every((t=>t instanceof sr))?t:t.reduce(((t,e)=>t.concat(e instanceof sr?e:e.members)),[]))}}}function lr(t,e){if(!e||!t.length)return t;let n=[];for(let i=0;i<t.length;i++){let r=t[i];n.push(new nr(r.from+e,r.to+e,r.type))}return n}function cr(t,e,n){if(e.isLeaf)return null;let i=n+e.nodeSize,r=null;for(let e,s=0;s<t.length;s++)(e=t[s])&&e.from>n&&e.to<i&&((r||(r=[])).push(e),t[s]=null);return r}function dr(t){let e=[];for(let n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function hr(t,e,n,i){let r=[],s=!1;e.forEach(((e,o)=>{let a=cr(t,e,o+n);if(a){s=!0;let t=hr(a,e,n+o+1,i);t!=or&&r.push(o,o+e.nodeSize,t)}}));let o=lr(s?dr(t):t,-n).sort(ur);for(let t=0;t<o.length;t++)o[t].type.valid(e,o[t])||(i.onRemove&&i.onRemove(o[t].spec),o.splice(t--,1));return o.length||r.length?new sr(o,r):or}function ur(t,e){return t.from-e.from||t.to-e.to}function pr(t){let e=t;for(let n=0;n<e.length-1;n++){let i=e[n];if(i.from!=i.to)for(let r=n+1;r<e.length;r++){let s=e[r];if(s.from!=i.from){s.from<i.to&&(e==t&&(e=t.slice()),e[n]=i.copy(i.from,s.from),fr(e,r,i.copy(s.from,i.to)));break}s.to!=i.to&&(e==t&&(e=t.slice()),e[r]=s.copy(s.from,i.to),fr(e,r+1,s.copy(i.to,s.to)))}}return e}function fr(t,e,n){for(;e<t.length&&ur(n,t[e])>0;)e++;t.splice(e,0,n)}function mr(t){let e=[];return t.someProp("decorations",(n=>{let i=n(t.state);i&&i!=or&&e.push(i)})),t.cursorWrapper&&e.push(sr.create(t.state.doc,[t.cursorWrapper.deco])),ar.from(e)}const gr={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},br=ze&&Ve<=11;class vr{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class yr{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new vr,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver((t=>{for(let e=0;e<t.length;e++)this.queue.push(t[e]);ze&&Ve<=11&&t.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),br&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((()=>{this.flushingSoon=-1,this.flush()}),20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,gr)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout((()=>this.flush()),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout((()=>this.suppressingSelectionUpdates=!1),50)}onSelectionChange(){if(ti(this.view)){if(this.suppressingSelectionUpdates)return Wn(this.view);if(ze&&Ve<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&Te(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e,n=new Set;for(let e=t.focusNode;e;e=_e(e))n.add(e);for(let i=t.anchorNode;i;i=_e(i))if(n.has(i)){e=i;break}let i=e&&this.view.docView.nearestDesc(e);return i&&i.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);let n=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&ti(t)&&!this.ignoreSelectionChange(n),r=-1,s=-1,o=!1,a=[];if(t.editable)for(let t=0;t<e.length;t++){let n=this.registerMutation(e[t],a);n&&(r=r<0?n.from:Math.min(n.from,r),s=s<0?n.to:Math.max(n.to,s),n.typeOver&&(o=!0))}if(qe&&a.length>1){let t=a.filter((t=>"BR"==t.nodeName));if(2==t.length){let e=t[0],n=t[1];e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}}let l=null;r<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Ie(n)&&(l=qn(t))&&l.eq(ne.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Wn(t),this.currentSelection.set(n),t.scrollToSelection()):(r>-1||i)&&(r>-1&&(t.docView.markDirty(r,s),function(t){if(wr.has(t))return;if(wr.set(t,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)){if(t.requiresGeckoHackNode=qe,kr)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),kr=!0}}(t)),this.handleDOMChange(r,s,o,a),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||Wn(t),this.currentSelection.set(n))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(let n=0;n<t.addedNodes.length;n++)e.push(t.addedNodes[n]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let i=t.previousSibling,r=t.nextSibling;if(ze&&Ve<=11&&t.addedNodes.length)for(let e=0;e<t.addedNodes.length;e++){let{previousSibling:n,nextSibling:s}=t.addedNodes[e];(!n||Array.prototype.indexOf.call(t.addedNodes,n)<0)&&(i=n),(!s||Array.prototype.indexOf.call(t.addedNodes,s)<0)&&(r=s)}let s=i&&i.parentNode==t.target?Ce(i)+1:0,o=n.localPosFromDOM(t.target,s,-1),a=r&&r.parentNode==t.target?Ce(r):t.target.childNodes.length;return{from:o,to:n.localPosFromDOM(t.target,a,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let wr=new WeakMap,kr=!1;function Sr(t){let e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(Ye&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}if(t.parentNode.lastChild==t||Ye&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const xr=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Er(t,e,n,i,r){if(e<0){let e=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,n=qn(t,e);if(n&&!t.state.selection.eq(n)){if(We&&Xe&&13===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",(e=>e(t,Pe(13,"Enter")))))return;let i=t.state.tr.setSelection(n);"pointer"==e?i.setMeta("pointer",!0):"key"==e&&i.scrollIntoView(),t.dispatch(i)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(n);e=s.before(o+1),n=t.state.doc.resolve(n).after(o+1);let a,c,d=t.state.selection,h=function(t,e,n){let i,{node:r,fromOffset:s,toOffset:o,from:a,to:l}=t.docView.parseRange(e,n),c=t.domSelectionRange(),d=c.anchorNode;if(d&&t.dom.contains(1==d.nodeType?d:d.parentNode)&&(i=[{node:d,offset:c.anchorOffset}],Ie(c)||i.push({node:c.focusNode,offset:c.focusOffset})),We&&8===t.input.lastKeyCode)for(let t=o;t>s;t--){let e=r.childNodes[t-1],n=e.pmViewDesc;if("BR"==e.nodeName&&!n){o=t;break}if(!n||n.size)break}let h=t.state.doc,u=t.someProp("domParser")||Z.fromSchema(t.state.schema),p=h.resolve(a),f=null,m=u.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:s,to:o,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:i,ruleFromNode:Sr,context:p});if(i&&null!=i[0].pos){let t=i[0].pos,e=i[1]&&i[1].pos;null==e&&(e=t),f={anchor:t+a,head:e+a}}return{doc:m,sel:f,from:a,to:l}}(t,e,n),u=t.state.doc,p=u.slice(h.from,h.to);8===t.input.lastKeyCode&&Date.now()-100<t.input.lastKeyCodeTime?(a=t.state.selection.to,c="end"):(a=t.state.selection.from,c="start"),t.input.lastKeyCode=null;let f=function(t,e,n,i,r){let s=t.findDiffStart(e,n);if(null==s)return null;let{a:o,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if("end"==r){i-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&t.size<e.size){s-=i<=s&&i>=o?s-i:0,a=s+(a-o),o=s}else if(a<s){s-=i<=s&&i>=a?s-i:0,o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}(p.content,h.doc.content,h.from,a,c);if((Je&&t.input.lastIOSEnter>Date.now()-225||Xe)&&r.some((t=>1==t.nodeType&&!xr.test(t.nodeName)))&&(!f||f.endA>=f.endB)&&t.someProp("handleKeyDown",(e=>e(t,Pe(13,"Enter")))))return void(t.input.lastIOSEnter=0);if(!f){if(!(i&&d instanceof oe&&!d.empty&&d.$head.sameParent(d.$anchor))||t.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let e=Cr(t,t.state.doc,h.sel);e&&!e.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(e))}return}f={start:d.from,endA:d.to,endB:d.to}}if(We&&t.cursorWrapper&&h.sel&&h.sel.anchor==t.cursorWrapper.deco.from&&h.sel.head==h.sel.anchor){let t=f.endB-f.start;h.sel={anchor:h.sel.anchor+t,head:h.sel.anchor+t}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&f.start==f.endB&&t.state.selection instanceof oe&&(f.start>t.state.selection.from&&f.start<=t.state.selection.from+2&&t.state.selection.from>=h.from?f.start=t.state.selection.from:f.endA<t.state.selection.to&&f.endA>=t.state.selection.to-2&&t.state.selection.to<=h.to&&(f.endB+=t.state.selection.to-f.endA,f.endA=t.state.selection.to)),ze&&Ve<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>h.from&&"  "==h.doc.textBetween(f.start-h.from-1,f.start-h.from+1)&&(f.start--,f.endA--,f.endB--);let m,g=h.doc.resolveNoCache(f.start-h.from),b=h.doc.resolveNoCache(f.endB-h.from),v=u.resolve(f.start),y=g.sameParent(b)&&g.parent.inlineContent&&v.end()>=f.endA;if((Je&&t.input.lastIOSEnter>Date.now()-225&&(!y||r.some((t=>"DIV"==t.nodeName||"P"==t.nodeName)))||!y&&g.pos<h.doc.content.size&&(m=ne.findFrom(h.doc.resolve(g.pos+1),1,!0))&&m.head==b.pos)&&t.someProp("handleKeyDown",(e=>e(t,Pe(13,"Enter")))))return void(t.input.lastIOSEnter=0);if(t.state.selection.anchor>f.start&&function(t,e,n,i,r){if(!i.parent.isTextblock||n-e<=r.pos-i.pos||_r(i,!0,!1)<r.pos)return!1;let s=t.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(_r(s,!0,!0));return!(!o.parent.isTextblock||o.pos>n||_r(o,!0,!1)<n)&&i.parent.content.cut(i.parentOffset).eq(o.parent.content)}(u,f.start,f.endA,g,b)&&t.someProp("handleKeyDown",(e=>e(t,Pe(8,"Backspace")))))return void(Xe&&We&&t.domObserver.suppressSelectionUpdates());We&&Xe&&f.endB==f.start&&(t.input.lastAndroidDelete=Date.now()),Xe&&!y&&g.start()!=b.start()&&0==b.parentOffset&&g.depth==b.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==f.endA&&(f.endB-=2,b=h.doc.resolveNoCache(f.endB-h.from),setTimeout((()=>{t.someProp("handleKeyDown",(function(e){return e(t,Pe(13,"Enter"))}))}),20));let w,k,S,x=f.start,E=f.endA;if(y)if(g.pos==b.pos)ze&&Ve<=11&&0==g.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((()=>Wn(t)),20)),w=t.state.tr.delete(x,E),k=u.resolve(f.start).marksAcross(u.resolve(f.endA));else if(f.endA==f.endB&&(S=function(t,e){let n,i,r,s=t.firstChild.marks,o=e.firstChild.marks,a=s,c=o;for(let t=0;t<o.length;t++)a=o[t].removeFromSet(a);for(let t=0;t<s.length;t++)c=s[t].removeFromSet(c);if(1==a.length&&0==c.length)i=a[0],n="add",r=t=>t.mark(i.addToSet(t.marks));else{if(0!=a.length||1!=c.length)return null;i=c[0],n="remove",r=t=>t.mark(i.removeFromSet(t.marks))}let d=[];for(let t=0;t<e.childCount;t++)d.push(r(e.child(t)));if(l.from(d).eq(t))return{mark:i,type:n}}(g.parent.content.cut(g.parentOffset,b.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start()))))w=t.state.tr,"add"==S.type?w.addMark(x,E,S.mark):w.removeMark(x,E,S.mark);else if(g.parent.child(g.index()).isText&&g.index()==b.index()-(b.textOffset?0:1)){let e=g.parent.textBetween(g.parentOffset,b.parentOffset);if(t.someProp("handleTextInput",(n=>n(t,x,E,e))))return;w=t.state.tr.insertText(e,x,E)}if(w||(w=t.state.tr.replace(x,E,h.doc.slice(f.start-h.from,f.endB-h.from))),h.sel){let e=Cr(t,w.doc,h.sel);e&&!(We&&Xe&&t.composing&&e.empty&&(f.start!=f.endB||t.input.lastAndroidDelete<Date.now()-100)&&(e.head==x||e.head==w.mapping.map(E)-1)||ze&&e.empty&&e.head==x)&&w.setSelection(e)}k&&w.ensureMarks(k),t.dispatch(w.scrollIntoView())}function Cr(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Zn(t,e.resolve(n.anchor),e.resolve(n.head))}function _r(t,e,n){let i=t.depth,r=e?t.end():t.pos;for(;i>0&&(e||t.indexAfter(i)==t.node(i).childCount);)i--,r++,e=!1;if(n){let e=t.node(i).maybeChild(t.indexAfter(i));for(;e&&!e.isLeaf;)e=e.firstChild,r++}return r}class Ar{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Ti,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Lr),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Mr(this),Tr(this),this.nodeViews=Dr(this),this.docView=On(this.state.doc,Or(this),mr(this),this.dom,this),this.domObserver=new yr(this,((t,e,n,i)=>Er(this,t,e,n,i))),this.domObserver.start(),function(t){for(let e in _i){let n=_i[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=e=>{!Ni(t,e)||Li(t,e)||!t.editable&&e.type in Ai||n(t,e)},Oi[e]?{passive:!0}:void 0)}Ye&&t.dom.addEventListener("input",(()=>null)),Di(t)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Di(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Lr),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let t in this._props)e[t]=this._props[t];e.state=this.state;for(let n in t)e[n]=t[n];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){let n=this.state,i=!1,r=!1;t.storedMarks&&this.composing&&(Wi(this),r=!0),this.state=t;let s=n.plugins!=t.plugins||this._props.plugins!=e.plugins;if(s||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let t=Dr(this);(function(t,e){let n=0,i=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let t in e)i++;return n!=i})(t,this.nodeViews)&&(this.nodeViews=t,i=!0)}(s||e.handleDOMEvents!=this._props.handleDOMEvents)&&Di(this),this.editable=Mr(this),Tr(this);let o=mr(this),a=Or(this),l=n.plugins==t.plugins||n.doc.eq(t.doc)?t.scrollToSelection>n.scrollToSelection?"to selection":"preserve":"reset",c=i||!this.docView.matchesNode(t.doc,a,o);!c&&t.selection.eq(n.selection)||(r=!0);let d="preserve"==l&&r&&null==this.dom.style.overflowAnchor&&function(t){let e,n,i=t.dom.getBoundingClientRect(),r=Math.max(0,i.top);for(let s=(i.left+i.right)/2,o=r+1;o<Math.min(innerHeight,i.bottom);o+=5){let i=t.root.elementFromPoint(s,o);if(!i||i==t.dom||!t.dom.contains(i))continue;let a=i.getBoundingClientRect();if(a.top>=r-20){e=i,n=a.top;break}}return{refDOM:e,refTop:n,stack:sn(t.dom)}}(this);if(r){this.domObserver.stop();let e=c&&(ze||We)&&!this.composing&&!n.selection.empty&&!t.selection.empty&&function(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}(n.selection,t.selection);if(c){let n=We?this.trackWrites=this.domSelectionRange().focusNode:null;!i&&this.docView.update(t.doc,a,o,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=On(t.doc,a,o,this.dom,this)),n&&!this.trackWrites&&(e=!0)}e||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Te(e.node,e.offset,n.anchorNode,n.anchorOffset)}(this))?Wn(this,e):(Xn(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),"reset"==l?this.dom.scrollTop=0:"to selection"==l?this.scrollToSelection():d&&function({refDOM:t,refTop:e,stack:n}){let i=t?t.getBoundingClientRect().top:0;on(n,0==i?0:i-e)}(d)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",(t=>t(this))));else if(this.state.selection instanceof le){let e=this.docView.domAfterPos(this.state.selection.from);1==e.nodeType&&rn(this,e.getBoundingClientRect(),t)}else rn(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let e=this.directPlugins[t];e.spec.view&&this.pluginViews.push(e.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let e=this.state.plugins[t];e.spec.view&&this.pluginViews.push(e.spec.view(this))}}}someProp(t,e){let n,i=this._props&&this._props[t];if(null!=i&&(n=e?e(i):i))return n;for(let i=0;i<this.directPlugins.length;i++){let r=this.directPlugins[i].props[t];if(null!=r&&(n=e?e(r):r))return n}let r=this.state.plugins;if(r)for(let i=0;i<r.length;i++){let s=r[i].props[t];if(null!=s&&(n=e?e(s):s))return n}}hasFocus(){if(ze){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(an)return t.focus(an);let e=sn(t);t.focus(null==an?{get preventScroll(){return an={preventScroll:!0},!0}}:void 0),an||(an=!1,on(e,0))}(this.dom),Wn(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return t||document}posAtCoords(t){return hn(this,t)}coordsAtPos(t,e=1){return fn(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,n=-1){let i=this.docView.posFromDOM(t,e,n);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return Sn(this,e||this.state,t)}pasteHTML(t,e){return Ji(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return Ji(this,t,null,!0,e||new ClipboardEvent("paste"))}destroy(){this.docView&&(!function(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],mr(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function(t,e){Li(t,e)||!_i[e.type]||!t.editable&&e.type in Ai||_i[e.type](t,e)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){return Ye&&11===this.root.nodeType&&function(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}(this.dom.ownerDocument)==this.dom?function(t){let e;function n(t){t.preventDefault(),t.stopImmediatePropagation(),e=t.getTargetRanges()[0]}t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0);let i=e.startContainer,r=e.startOffset,s=e.endContainer,o=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return Te(a.node,a.offset,s,o)&&([i,r,s,o]=[s,o,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Or(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),e.translate="no",t.someProp("attributes",(n=>{if("function"==typeof n&&(n=n(t.state)),n)for(let t in n)"class"==t&&(e.class+=" "+n[t]),"style"==t?e.style=(e.style?e.style+";":"")+n[t]:e[t]||"contenteditable"==t||"nodeName"==t||(e[t]=String(n[t]))})),[nr.node(0,t.state.doc.content.size,e)]}function Tr(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:nr.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Mr(t){return!t.someProp("editable",(e=>!1===e(t.state)))}function Dr(t){let e=Object.create(null);function n(t){for(let n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function Lr(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Nr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ir={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Pr="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent);"undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent);for(var $r="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Rr="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Fr=$r||Pr&&+Pr[1]<57,Br=0;Br<10;Br++)Nr[48+Br]=Nr[96+Br]=String(Br);for(Br=1;Br<=24;Br++)Nr[Br+111]="F"+Br;for(Br=65;Br<=90;Br++)Nr[Br]=String.fromCharCode(Br+32),Ir[Br]=String.fromCharCode(Br);for(var jr in Nr)Ir.hasOwnProperty(jr)||(Ir[jr]=Nr[jr]);const Hr="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function zr(t){let e,n,i,r,s=t.split(/-(?!$)/),o=s[s.length-1];"Space"==o&&(o=" ");for(let t=0;t<s.length-1;t++){let o=s[t];if(/^(cmd|meta|m)$/i.test(o))r=!0;else if(/^a(lt)?$/i.test(o))e=!0;else if(/^(c|ctrl|control)$/i.test(o))n=!0;else if(/^s(hift)?$/i.test(o))i=!0;else{if(!/^mod$/i.test(o))throw new Error("Unrecognized modifier name: "+o);Hr?r=!0:n=!0}}return e&&(o="Alt-"+o),n&&(o="Ctrl-"+o),r&&(o="Meta-"+o),i&&(o="Shift-"+o),o}function Vr(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function qr(t){let e=function(t){let e=Object.create(null);for(let n in t)e[zr(n)]=t[n];return e}(t);return function(t,n){let i,r=function(t){var e=!(Fr&&(t.ctrlKey||t.altKey||t.metaKey)||Rr&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Ir:Nr)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),s=e[Vr(r,n)];if(s&&s(t.state,t.dispatch,t))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let i=e[Vr(r,n,!1)];if(i&&i(t.state,t.dispatch,t))return!0}if((n.shiftKey||n.altKey||n.metaKey||r.charCodeAt(0)>127)&&(i=Nr[n.keyCode])&&i!=r){let r=e[Vr(i,n)];if(r&&r(t.state,t.dispatch,t))return!0}}return!1}}function Ur(t,e,n=!1){for(let i=t;i;i="start"==e?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&1!=i.childCount)return!1}return!1}function Wr(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function Kr(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}function Yr(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Jr(t,e,n){let i,r,s=e.nodeBefore,o=e.nodeAfter;if(s.type.spec.isolating||o.type.spec.isolating)return!1;if(function(t,e,n){let i=e.nodeBefore,r=e.nodeAfter,s=e.index();return!(!(i&&r&&i.type.compatibleContent(r.type))||(!i.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-i.nodeSize,e.pos).scrollIntoView()),0):!e.parent.canReplace(s,s+1)||!r.isTextblock&&!Rt(t.doc,e.pos)||(n&&n(t.tr.clearIncompatible(e.pos,i.type,i.contentMatchAt(i.childCount)).join(e.pos).scrollIntoView()),0)))}(t,e,n))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(i=(r=s.contentMatchAt(s.childCount)).findWrapping(o.type))&&r.matchType(i[0]||o.type).validEnd){if(n){let r=e.pos+o.nodeSize,a=l.empty;for(let t=i.length-1;t>=0;t--)a=l.from(i[t].create(null,a));a=l.from(s.copy(a));let c=t.tr.step(new Mt(e.pos-1,r,e.pos,r,new f(a,1,0),i.length,!0)),d=r+2*i.length;Rt(c.doc,d)&&c.join(d),n(c.scrollIntoView())}return!0}let c=ne.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),h=d&&Nt(d);if(null!=h&&h>=e.depth)return n&&n(t.tr.lift(d,h).scrollIntoView()),!0;if(a&&Ur(o,"start",!0)&&Ur(s,"end")){let i=s,r=[];for(;r.push(i),!i.isTextblock;)i=i.lastChild;let a=o,c=1;for(;!a.isTextblock;a=a.firstChild)c++;if(i.canReplace(i.childCount,i.childCount,a.content)){if(n){let i=l.empty;for(let t=r.length-1;t>=0;t--)i=l.from(r[t].copy(i));n(t.tr.step(new Mt(e.pos-r.length,e.pos+o.nodeSize,e.pos+c,e.pos+o.nodeSize-c,new f(i,r.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Gr(t){return function(e,n){let i=e.selection,r=t<0?i.$from:i.$to,s=r.depth;for(;r.node(s).isInline;){if(!s)return!1;s--}return!!r.node(s).isTextblock&&(n&&n(e.tr.setSelection(oe.create(e.doc,t<0?r.start(s):r.end(s)))),!0)}}const Xr=Gr(-1),Qr=Gr(1);function Zr(t,e=null){return function(n,i){let r=!1;for(let i=0;i<n.selection.ranges.length&&!r;i++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[i];n.doc.nodesBetween(s,o,((i,s)=>{if(r)return!1;if(i.isTextblock&&!i.hasMarkup(t,e))if(i.type==t)r=!0;else{let e=n.doc.resolve(s),i=e.index();r=e.parent.canReplaceWith(i,i+1,t)}}))}if(!r)return!1;if(i){let r=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[i];r.setBlockType(s,o,t,e)}i(r.scrollIntoView())}return!0}}function ts(t,e=null){return function(n,i){let{$from:r,$to:s}=n.selection,o=r.blockRange(s),a=!1,c=o;if(!o)return!1;if(o.depth>=2&&r.node(o.depth-1).type.compatibleContent(t)&&0==o.startIndex){if(0==r.index(o.depth-1))return!1;let t=n.doc.resolve(o.start-2);c=new M(t,t,o.depth),o.endIndex<o.parent.childCount&&(o=new M(r,n.doc.resolve(s.end(o.depth)),o.depth)),a=!0}let d=It(c,t,e,o);return!!d&&(i&&i(function(t,e,n,i,r){let s=l.empty;for(let t=n.length-1;t>=0;t--)s=l.from(n[t].type.create(n[t].attrs,s));t.step(new Mt(e.start-(i?2:0),e.end,e.start,e.end,new f(s,0,0),n.length,!0));let o=0;for(let t=0;t<n.length;t++)n[t].type==r&&(o=t+1);let a=n.length-o,c=e.start+n.length-(i?2:0),d=e.parent;for(let n=e.startIndex,i=e.endIndex,r=!0;n<i;n++,r=!1)!r&&$t(t.doc,c,a)&&(t.split(c,a),c+=2*a),c+=d.child(n).nodeSize;return t}(n.tr,o,d,a,t).scrollIntoView()),!0)}}function es(t){return function(e,n){let{$from:i,$to:r}=e.selection,s=i.blockRange(r,(e=>e.childCount>0&&e.firstChild.type==t));return!!s&&(!n||(i.node(s.depth-1).type==t?function(t,e,n,i){let r=t.tr,s=i.end,o=i.$to.end(i.depth);s<o&&(r.step(new Mt(s-1,o,s,o,new f(l.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new M(r.doc.resolve(i.$from.pos),r.doc.resolve(o),i.depth));const a=Nt(i);if(null==a)return!1;r.lift(i,a);let c=r.mapping.map(s,-1)-1;Rt(r.doc,c)&&r.join(c);return e(r.scrollIntoView()),!0}(e,n,t,s):function(t,e,n){let i=t.tr,r=n.parent;for(let t=n.end,e=n.endIndex-1,s=n.startIndex;e>s;e--)t-=r.child(e).nodeSize,i.delete(t-1,t+1);let s=i.doc.resolve(n.start),o=s.nodeAfter;if(i.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,c=n.endIndex==r.childCount,d=s.node(-1),h=s.index(-1);if(!d.canReplace(h+(a?0:1),h+1,o.content.append(c?l.empty:l.from(r))))return!1;let u=s.pos,p=u+o.nodeSize;return i.step(new Mt(u-(a?1:0),p+(c?1:0),u+1,p-1,new f((a?l.empty:l.from(r.copy(l.empty))).append(c?l.empty:l.from(r.copy(l.empty))),a?0:1,c?0:1),a?0:1)),e(i.scrollIntoView()),!0}(e,n,s)))}}function ns(t){const{state:e,transaction:n}=t;let{selection:i}=n,{doc:r}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return i},get doc(){return r},get tr(){return i=n.selection,r=n.doc,s=n.storedMarks,n}}}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class is{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:i}=e,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,(...t)=>{const n=e(...t)(s);return r.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(r),n}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:i,state:r}=this,{view:s}=i,o=[],a=!!t,l=t||r.tr,c={...Object.fromEntries(Object.entries(n).map((([t,n])=>[t,(...t)=>{const i=this.buildProps(l,e),r=n(...t)(i);return o.push(r),c}]))),run:()=>(a||!e||l.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(l),o.every((t=>!0===t)))};return c}createCan(t){const{rawCommands:e,state:n}=this,i=t||n.tr,r=this.buildProps(i,false),s=Object.fromEntries(Object.entries(e).map((([t,e])=>[t,(...t)=>e(...t)({...r,dispatch:void 0})])));return{...s,chain:()=>this.createChain(i,false)}}buildProps(t,e=!0){const{rawCommands:n,editor:i,state:r}=this,{view:s}=i;r.storedMarks&&t.setStoredMarks(r.storedMarks);const o={tr:t,editor:i,view:s,state:ns({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map((([t,e])=>[t,(...t)=>e(...t)(o)])))}};return o}}class rs{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter((t=>t!==e)):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function ss(t,e,n){if(void 0===t.config[e]&&t.parent)return ss(t.parent,e,n);if("function"==typeof t.config[e]){return t.config[e].bind({...n,parent:t.parent?ss(t.parent,e,n):null})}return t.config[e]}function as(t){return{baseExtensions:t.filter((t=>"extension"===t.type)),nodeExtensions:t.filter((t=>"node"===t.type)),markExtensions:t.filter((t=>"mark"===t.type))}}function ls(t){const e=[],{nodeExtensions:n,markExtensions:i}=as(t),r=[...n,...i],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach((t=>{const n=ss(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage});if(!n)return;n().forEach((t=>{t.types.forEach((n=>{Object.entries(t.attributes).forEach((([t,i])=>{e.push({type:n,name:t,attribute:{...s,...i}})}))}))}))})),r.forEach((t=>{const n={name:t.name,options:t.options,storage:t.storage},i=ss(t,"addAttributes",n);if(!i)return;const r=i();Object.entries(r).forEach((([n,i])=>{const r={...s,...i};"function"==typeof(null==r?void 0:r.default)&&(r.default=r.default()),(null==r?void 0:r.isRequired)&&void 0===(null==r?void 0:r.default)&&delete r.default,e.push({type:t.name,name:n,attribute:r})}))})),e}function cs(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function ds(...t){return t.filter((t=>!!t)).reduce(((t,e)=>{const n={...t};return Object.entries(e).forEach((([t,e])=>{n[t]?n[t]="class"===t?[n[t],e].join(" "):"style"===t?[n[t],e].join("; "):e:n[t]=e})),n}),{})}function hs(t,e){return e.filter((t=>t.attribute.rendered)).map((e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]})).reduce(((t,e)=>ds(t,e)),{})}function us(t){return"function"==typeof t}function ps(t,e=undefined,...n){return us(t)?e?t.bind(e)(...n):t(...n):t}function fs(t,e){return t.style?t:{...t,getAttrs:n=>{const i=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===i)return!1;const r=e.reduce(((t,e)=>{const i=e.attribute.parseHTML?e.attribute.parseHTML(n):function(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(e.name));return null==i?t:{...t,[e.name]:i}}),{});return{...i,...r}}}}function ms(t){return Object.fromEntries(Object.entries(t).filter((([t,e])=>("attrs"!==t||!function(t={}){return 0===Object.keys(t).length&&t.constructor===Object}(e))&&null!=e)))}function gs(t,e){return e.nodes[t]||e.marks[t]||null}function bs(t,e){return Array.isArray(e)?e.some((e=>("string"==typeof e?e:e.name)===t.name)):e}const vs=(t,e=500)=>{let n="";const i=t.parentOffset;return t.parent.nodesBetween(Math.max(0,i-e),i,((t,e,r,s)=>{var o,a;const l=(null===(a=(o=t.type.spec).toText)||void 0===a?void 0:a.call(o,{node:t,pos:e,parent:r,index:s}))||t.textContent||"%leaf%";n+=l.slice(0,Math.max(0,i-e))})),n};function ys(t){return"[object RegExp]"===Object.prototype.toString.call(t)}class ws{constructor(t){this.find=t.find,this.handler=t.handler}}const ks=(t,e)=>{if(ys(e))return e.exec(t);const n=e(t);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=t,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i};function Ss(t){var e;const{editor:n,from:i,to:r,text:s,rules:o,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(i);if(c.parent.type.spec.code||(null===(e=c.nodeBefore||c.nodeAfter)||void 0===e?void 0:e.marks.find((t=>t.type.spec.code))))return!1;let d=!1;const h=vs(c)+s;return o.forEach((t=>{if(d)return;const e=ks(h,t.find);if(!e)return;const o=l.state.tr,c=ns({state:l.state,transaction:o}),u={from:i-(e[0].length-s.length),to:r},{commands:p,chain:f,can:m}=new is({editor:n,state:c});null!==t.handler({state:c,range:u,match:e,commands:p,chain:f,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:i,to:r,text:s}),l.dispatch(o),d=!0)})),d}function xs(t){const{editor:e,rules:n}=t,i=new ke({state:{init:()=>null,apply(t,e){const n=t.getMeta(i);return n||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:(t,r,s,o)=>Ss({editor:e,from:r,to:s,text:o,rules:n,plugin:i}),handleDOMEvents:{compositionend:t=>(setTimeout((()=>{const{$cursor:r}=t.state.selection;r&&Ss({editor:e,from:r.pos,to:r.pos,text:"",rules:n,plugin:i})})),!1)},handleKeyDown(t,r){if("Enter"!==r.key)return!1;const{$cursor:s}=t.state.selection;return!!s&&Ss({editor:e,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:i})}},isInputRules:!0});return i}class Es{constructor(t){this.find=t.find,this.handler=t.handler}}const Cs=(t,e)=>{if(ys(e))return[...t.matchAll(e)];const n=e(t);return n?n.map((e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n})):[]};function _s(t){const{editor:e,rules:n}=t;let i=null,r=!1,s=!1;const o=n.map((t=>new ke({view(t){const e=e=>{var n;i=(null===(n=t.dom.parentElement)||void 0===n?void 0:n.contains(e.target))?t.dom.parentElement:null};return window.addEventListener("dragstart",e),{destroy(){window.removeEventListener("dragstart",e)}}},props:{handleDOMEvents:{drop:t=>(s=i===t.dom.parentElement,!1),paste:(t,e)=>{var n;const i=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return r=!!(null==i?void 0:i.includes("data-pm-slice")),!1}}},appendTransaction:(n,i,o)=>{const a=n[0],l="paste"===a.getMeta("uiEvent")&&!r,c="drop"===a.getMeta("uiEvent")&&!s;if(!l&&!c)return;const d=i.doc.content.findDiffStart(o.doc.content),h=i.doc.content.findDiffEnd(o.doc.content);if("number"!=typeof d||!h||d===h.b)return;const u=o.tr,p=ns({state:o,transaction:u}),f=function(t){const{editor:e,state:n,from:i,to:r,rule:s}=t,{commands:o,chain:a,can:l}=new is({editor:e,state:n}),c=[];return n.doc.nodesBetween(i,r,((t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const d=Math.max(i,e),h=Math.min(r,e+t.content.size),u=t.textBetween(d-e,h-e,void 0,"￼");Cs(u,s.find).forEach((t=>{if(void 0===t.index)return;const e=d+t.index+1,i=e+t[0].length,r={from:n.tr.mapping.map(e),to:n.tr.mapping.map(i)},h=s.handler({state:n,range:r,match:t,commands:o,chain:a,can:l});c.push(h)}))})),c.every((t=>null!==t))}({editor:e,state:p,from:Math.max(d-1,0),to:h.b-1,rule:t});return f&&u.steps.length?u:void 0}})));return o}class As{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=As.resolve(t),this.schema=function(t,e){var n;const i=ls(t),{nodeExtensions:r,markExtensions:s}=as(t),o=null===(n=r.find((t=>ss(t,"topNode"))))||void 0===n?void 0:n.name,a=Object.fromEntries(r.map((n=>{const r=i.filter((t=>t.type===n.name)),s={name:n.name,options:n.options,storage:n.storage,editor:e},o=t.reduce(((t,e)=>{const i=ss(e,"extendNodeSchema",s);return{...t,...i?i(n):{}}}),{}),a=ms({...o,content:ps(ss(n,"content",s)),marks:ps(ss(n,"marks",s)),group:ps(ss(n,"group",s)),inline:ps(ss(n,"inline",s)),atom:ps(ss(n,"atom",s)),selectable:ps(ss(n,"selectable",s)),draggable:ps(ss(n,"draggable",s)),code:ps(ss(n,"code",s)),defining:ps(ss(n,"defining",s)),isolating:ps(ss(n,"isolating",s)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),l=ps(ss(n,"parseHTML",s));l&&(a.parseDOM=l.map((t=>fs(t,r))));const c=ss(n,"renderHTML",s);c&&(a.toDOM=t=>c({node:t,HTMLAttributes:hs(t,r)}));const d=ss(n,"renderText",s);return d&&(a.toText=d),[n.name,a]}))),l=Object.fromEntries(s.map((n=>{const r=i.filter((t=>t.type===n.name)),s={name:n.name,options:n.options,storage:n.storage,editor:e},o=t.reduce(((t,e)=>{const i=ss(e,"extendMarkSchema",s);return{...t,...i?i(n):{}}}),{}),a=ms({...o,inclusive:ps(ss(n,"inclusive",s)),excludes:ps(ss(n,"excludes",s)),group:ps(ss(n,"group",s)),spanning:ps(ss(n,"spanning",s)),code:ps(ss(n,"code",s)),attrs:Object.fromEntries(r.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),l=ps(ss(n,"parseHTML",s));l&&(a.parseDOM=l.map((t=>fs(t,r))));const c=ss(n,"renderHTML",s);return c&&(a.toDOM=t=>c({mark:t,HTMLAttributes:hs(t,r)})),[n.name,a]})));return new X({topNode:o,nodes:a,marks:l})}(this.extensions,e),this.extensions.forEach((t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:gs(t.name,this.schema)};if("mark"===t.type){(null===(e=ps(ss(t,"keepOnSplit",n)))||void 0===e||e)&&this.splittableMarks.push(t.name)}const i=ss(t,"onBeforeCreate",n);i&&this.editor.on("beforeCreate",i);const r=ss(t,"onCreate",n);r&&this.editor.on("create",r);const s=ss(t,"onUpdate",n);s&&this.editor.on("update",s);const o=ss(t,"onSelectionUpdate",n);o&&this.editor.on("selectionUpdate",o);const a=ss(t,"onTransaction",n);a&&this.editor.on("transaction",a);const l=ss(t,"onFocus",n);l&&this.editor.on("focus",l);const c=ss(t,"onBlur",n);c&&this.editor.on("blur",c);const d=ss(t,"onDestroy",n);d&&this.editor.on("destroy",d)}))}static resolve(t){const e=As.sort(As.flatten(t)),n=function(t){const e=t.filter(((e,n)=>t.indexOf(e)!==n));return[...new Set(e)]}(e.map((t=>t.name)));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map((t=>`'${t}'`)).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map((t=>{const e=ss(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...this.flatten(e())]:t})).flat(10)}static sort(t){return t.sort(((t,e)=>{const n=ss(t,"priority")||100,i=ss(e,"priority")||100;return n>i?-1:n<i?1:0}))}get commands(){return this.extensions.reduce(((t,e)=>{const n=ss(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:gs(e.name,this.schema)});return n?{...t,...n()}:t}),{})}get plugins(){const{editor:t}=this,e=As.sort([...this.extensions].reverse()),n=[],i=[],r=e.map((e=>{const r={name:e.name,options:e.options,storage:e.storage,editor:t,type:gs(e.name,this.schema)},s=[],o=ss(e,"addKeyboardShortcuts",r);let a={};if("mark"===e.type&&e.config.exitable&&(a.ArrowRight=()=>yo.handleExit({editor:t,mark:e})),o){const e=Object.fromEntries(Object.entries(o()).map((([e,n])=>[e,()=>n({editor:t})])));a={...a,...e}}const l=new ke({props:{handleKeyDown:qr(a)}});s.push(l);const c=ss(e,"addInputRules",r);bs(e,t.options.enableInputRules)&&c&&n.push(...c());const d=ss(e,"addPasteRules",r);bs(e,t.options.enablePasteRules)&&d&&i.push(...d());const h=ss(e,"addProseMirrorPlugins",r);if(h){const t=h();s.push(...t)}return s})).flat();return[xs({editor:t,rules:n}),..._s({editor:t,rules:i}),...r]}get attributes(){return ls(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=as(this.extensions);return Object.fromEntries(e.filter((t=>!!ss(t,"addNodeView"))).map((e=>{const n=this.attributes.filter((t=>t.type===e.name)),i={name:e.name,options:e.options,storage:e.storage,editor:t,type:cs(e.name,this.schema)},r=ss(e,"addNodeView",i);if(!r)return[];return[e.name,(i,s,o,a)=>{const l=hs(i,n);return r()({editor:t,node:i,getPos:o,decorations:a,HTMLAttributes:l,extension:e})}]})))}}function Os(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function Ts(t,e){const n={...t};return Os(t)&&Os(e)&&Object.keys(e).forEach((i=>{Os(e[i])?i in t?n[i]=Ts(t[i],e[i]):Object.assign(n,{[i]:e[i]}):Object.assign(n,{[i]:e[i]})})),n}class Ms{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ps(ss(this,"addOptions",{name:this.name}))),this.storage=ps(ss(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Ms(t)}configure(t={}){const e=this.extend();return e.options=Ts(this.options,t),e.storage=ps(ss(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new Ms(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=ps(ss(e,"addOptions",{name:e.name})),e.storage=ps(ss(e,"addStorage",{name:e.name,options:e.options})),e}}function Ds(t,e,n){const{from:i,to:r}=e,{blockSeparator:s="\n\n",textSerializers:o={}}=n||{};let a="",l=!0;return t.nodesBetween(i,r,((t,n,c,d)=>{var h;const u=null==o?void 0:o[t.type.name];u?(t.isBlock&&!l&&(a+=s,l=!0),c&&(a+=u({node:t,pos:n,parent:c,index:d,range:e}))):t.isText?(a+=null===(h=null==t?void 0:t.text)||void 0===h?void 0:h.slice(Math.max(i,n)-n,r-n),l=!1):t.isBlock&&!l&&(a+=s,l=!0)})),a}function Ls(t){return Object.fromEntries(Object.entries(t.nodes).filter((([,t])=>t.spec.toText)).map((([t,e])=>[t,e.spec.toText])))}const Ns=Ms.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new ke({key:new Ee("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:i,selection:r}=e,{ranges:s}=r,o=Math.min(...s.map((t=>t.$from.pos))),a=Math.max(...s.map((t=>t.$to.pos)));return Ds(i,{from:o,to:a},{textSerializers:Ls(n)})}}})]}});function Is(t,e,n={strict:!0}){const i=Object.keys(e);return!i.length||i.every((i=>n.strict?e[i]===t[i]:ys(e[i])?e[i].test(t[i]):e[i]===t[i]))}function Ps(t,e,n={}){return t.find((t=>t.type===e&&Is(t.attrs,n)))}function $s(t,e,n={}){return!!Ps(t,e,n)}function Rs(t,e,n={}){if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if(t.parentOffset===i.offset&&0!==i.offset&&(i=t.parent.childBefore(t.parentOffset)),!i.node)return;const r=Ps([...i.node.marks],e,n);if(!r)return;let s=i.index,o=t.start()+i.offset,a=s+1,l=o+i.node.nodeSize;for(Ps([...i.node.marks],e,n);s>0&&r.isInSet(t.parent.child(s-1).marks);)s-=1,o-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&$s([...t.parent.child(a).marks],e,n);)l+=t.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function Fs(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function Bs(t){return t instanceof oe}function js(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Hs(t,e=null){if(!e)return null;const n=ne.atStart(t),i=ne.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return i;const r=n.from,s=i.to;return"all"===e?oe.create(t,js(0,r,s),js(t.content.size,r,s)):oe.create(t,js(e,r,s),js(e,r,s))}function zs(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function Vs(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function qs(t,e,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof t&&null!==t)try{return Array.isArray(t)&&t.length>0?l.fromArray(t.map((t=>e.nodeFromJSON(t)))):e.nodeFromJSON(t)}catch(i){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),qs("",e,n)}if("string"==typeof t){const i=Z.fromSchema(e);return n.slice?i.parseSlice(Vs(t),n.parseOptions).content:i.parse(Vs(t),n.parseOptions)}return qs("",e,n)}function Us(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function Ws(t,e,n={}){const{from:i,to:r,empty:s}=t.selection,o=e?cs(e,t.schema):null,a=[];t.doc.nodesBetween(i,r,((t,e)=>{if(t.isText)return;const n=Math.max(i,e),s=Math.min(r,e+t.nodeSize);a.push({node:t,from:n,to:s})}));const l=r-i,c=a.filter((t=>!o||o.name===t.node.type.name)).filter((t=>Is(t.node.attrs,n,{strict:!1})));if(s)return!!c.length;return c.reduce(((t,e)=>t+e.to-e.from),0)>=l}function Ks(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Ys(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce(((e,i)=>(n.includes(i)||(e[i]=t[i]),e)),{})}function Js(t,e,n={}){return qs(t,e,{slice:!1,parseOptions:n})}function Gs(t){return e=>function(t,e){for(let n=t.depth;n>0;n-=1){const i=t.node(n);if(e(i))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:i}}}(e.$from,t)}function Xs(t,e){const n=Fs(e,t.schema),{from:i,to:r,empty:s}=t.selection,o=[];s?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(i,r,(t=>{o.push(...t.marks)}));const a=o.find((t=>t.type.name===n.name));return a?{...a.attrs}:{}}function Qs(t,e){const n=Ks("string"==typeof e?e:e.name,t.schema);return"node"===n?function(t,e){const n=cs(e,t.schema),{from:i,to:r}=t.selection,s=[];t.doc.nodesBetween(i,r,(t=>{s.push(t)}));const o=s.reverse().find((t=>t.type.name===n.name));return o?{...o.attrs}:{}}(t,e):"mark"===n?Xs(t,e):{}}function Zs(t){const e=function(t,e=JSON.stringify){const n={};return t.filter((t=>{const i=e(t);return!Object.prototype.hasOwnProperty.call(n,i)&&(n[i]=!0)}))}(t);return 1===e.length?e:e.filter(((t,n)=>{const i=e.filter(((t,e)=>e!==n));return!i.some((e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to))}))}function to(t,e,n){const i=[];return t===e?n.resolve(t).marks().forEach((e=>{const r=Rs(n.resolve(t-1),e.type);r&&i.push({mark:e,...r})})):n.nodesBetween(t,e,((t,e)=>{i.push(...t.marks.map((n=>({from:e,to:e+t.nodeSize,mark:n}))))})),i}function eo(t,e,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const i=t.find((t=>t.type===e&&t.name===n));return!!i&&i.attribute.keepOnSplit})))}function no(t,e,n={}){const{empty:i,ranges:r}=t.selection,s=e?Fs(e,t.schema):null;if(i)return!!(t.storedMarks||t.selection.$from.marks()).filter((t=>!s||s.name===t.type.name)).find((t=>Is(t.attrs,n,{strict:!1})));let o=0;const a=[];if(r.forEach((({$from:e,$to:n})=>{const i=e.pos,r=n.pos;t.doc.nodesBetween(i,r,((t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(i,e),s=Math.min(r,e+t.nodeSize);o+=s-n,a.push(...t.marks.map((t=>({mark:t,from:n,to:s}))))}))})),0===o)return!1;const l=a.filter((t=>!s||s.name===t.mark.type.name)).filter((t=>Is(t.mark.attrs,n,{strict:!1}))).reduce(((t,e)=>t+e.to-e.from),0),c=a.filter((t=>!s||t.mark.type!==s&&t.mark.type.excludes(s))).reduce(((t,e)=>t+e.to-e.from),0);return(l>0?l+c:l)>=o}function io(t,e){const{nodeExtensions:n}=as(e),i=n.find((e=>e.name===t));if(!i)return!1;const r=ps(ss(i,"group",{name:i.name,options:i.options,storage:i.storage}));return"string"==typeof r&&r.split(" ").includes("list")}function ro(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const i=n.filter((t=>null==e?void 0:e.includes(t.type.name)));t.tr.ensureMarks(i)}}const so=(t,e)=>{const n=Gs((t=>t.type===e))(t.selection);if(!n)return!0;const i=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===i)return!0;const r=t.doc.nodeAt(i);return n.node.type!==(null==r?void 0:r.type)||!Rt(t.doc,n.pos)||(t.join(n.pos),!0)},oo=(t,e)=>{const n=Gs((t=>t.type===e))(t.selection);if(!n)return!0;const i=t.doc.resolve(n.start).after(n.depth);if(void 0===i)return!0;const r=t.doc.nodeAt(i);return n.node.type!==(null==r?void 0:r.type)||!Rt(t.doc,i)||(t.join(i),!0)};var ao=Object.freeze({__proto__:null,blur:()=>({editor:t,view:e})=>(requestAnimationFrame((()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())})),!0),clearContent:(t=!1)=>({commands:e})=>e.setContent("",t),clearNodes:()=>({state:t,tr:e,dispatch:n})=>{const{selection:i}=e,{ranges:r}=i;return!n||(r.forEach((({$from:n,$to:i})=>{t.doc.nodesBetween(n.pos,i.pos,((t,n)=>{if(t.type.isText)return;const{doc:i,mapping:r}=e,s=i.resolve(r.map(n)),o=i.resolve(r.map(n+t.nodeSize)),a=s.blockRange(o);if(!a)return;const l=Nt(a);if(t.type.isTextblock){const{defaultType:t}=s.parent.contentMatchAt(s.index());e.setNodeMarkup(a.start,t)}(l||0===l)&&e.lift(a,l)}))})),!0)},command:t=>e=>t(e),createParagraphNear:()=>({state:t,dispatch:e})=>((t,e)=>{let n=t.selection,{$from:i,$to:r}=n;if(n instanceof de||i.parent.inlineContent||r.parent.inlineContent)return!1;let s=Yr(r.parent.contentMatchAt(r.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let n=(!i.parentOffset&&r.index()<r.parent.childCount?i:r).pos,o=t.tr.insert(n,s.createAndFill());o.setSelection(oe.create(o.doc,n+1)),e(o.scrollIntoView())}return!0})(t,e),deleteCurrentNode:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,i=n.$anchor.node();if(i.content.size>0)return!1;const r=t.selection.$anchor;for(let n=r.depth;n>0;n-=1){if(r.node(n).type===i.type){if(e){const e=r.before(n),i=r.after(n);t.delete(e,i).scrollIntoView()}return!0}}return!1},deleteNode:t=>({tr:e,state:n,dispatch:i})=>{const r=cs(t,n.schema),s=e.selection.$anchor;for(let t=s.depth;t>0;t-=1){if(s.node(t).type===r){if(i){const n=s.before(t),i=s.after(t);e.delete(n,i).scrollIntoView()}return!0}}return!1},deleteRange:t=>({tr:e,dispatch:n})=>{const{from:i,to:r}=t;return n&&e.delete(i,r),!0},deleteSelection:()=>({state:t,dispatch:e})=>((t,e)=>!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0))(t,e),enter:()=>({commands:t})=>t.keyboardShortcut("Enter"),exitCode:()=>({state:t,dispatch:e})=>((t,e)=>{let{$head:n,$anchor:i}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let r=n.node(-1),s=n.indexAfter(-1),o=Yr(r.contentMatchAt(s));if(!o||!r.canReplaceWith(s,s,o))return!1;if(e){let i=n.after(),r=t.tr.replaceWith(i,i,o.createAndFill());r.setSelection(ne.near(r.doc.resolve(i),1)),e(r.scrollIntoView())}return!0})(t,e),extendMarkRange:(t,e={})=>({tr:n,state:i,dispatch:r})=>{const s=Fs(t,i.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:d}=a;if(r){const t=Rs(l,s,e);if(t&&t.from<=c&&t.to>=d){const e=oe.create(o,t.from,t.to);n.setSelection(e)}}return!0},first:t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1},focus:(t=null,e={})=>({editor:n,view:i,tr:r,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{zs()&&i.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(i.focus(),(null==e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())}))};if(i.hasFocus()&&null===t||!1===t)return!0;if(s&&null===t&&!Bs(n.state.selection))return o(),!0;const a=Hs(r.doc,t)||n.state.selection,l=n.state.selection.eq(a);return s&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},forEach:(t,e)=>n=>t.every(((t,i)=>e(t,{...n,index:i}))),insertContent:(t,e)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),insertContentAt:(t,e,n)=>({tr:i,dispatch:r,editor:s})=>{if(r){n={parseOptions:{},updateSelection:!0,...n};const r=qs(e,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===r.toString())return!0;let{from:o,to:a}="number"==typeof t?{from:t,to:t}:t,l=!0,c=!0;if((r.toString().startsWith("<")?r:[r]).forEach((t=>{t.check(),l=!!l&&(t.isText&&0===t.marks.length),c=!!c&&t.isBlock})),o===a&&c){const{parent:t}=i.doc.resolve(o);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(o-=1,a+=1)}l?Array.isArray(e)?i.insertText(e.map((t=>t.text||"")).join(""),o,a):"object"==typeof e&&e&&e.text?i.insertText(e.text,o,a):i.insertText(e,o,a):i.replaceWith(o,a,r),n.updateSelection&&function(t,e,n){const i=t.steps.length-1;if(i<e)return;const r=t.steps[i];if(!(r instanceof Tt||r instanceof Mt))return;const s=t.mapping.maps[i];let o=0;s.forEach(((t,e,n,i)=>{0===o&&(o=i)})),t.setSelection(ne.near(t.doc.resolve(o),n))}(i,i.steps.length-1,-1)}return!0},joinUp:()=>({state:t,dispatch:e})=>((t,e)=>{let n,i=t.selection,r=i instanceof le;if(r){if(i.node.isTextblock||!Rt(t.doc,i.from))return!1;n=i.from}else if(n=Bt(t.doc,i.from,-1),null==n)return!1;if(e){let i=t.tr.join(n);r&&i.setSelection(le.create(i.doc,n-t.doc.resolve(n).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0})(t,e),joinDown:()=>({state:t,dispatch:e})=>((t,e)=>{let n,i=t.selection;if(i instanceof le){if(i.node.isTextblock||!Rt(t.doc,i.to))return!1;n=i.to}else if(n=Bt(t.doc,i.to,1),null==n)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0})(t,e),joinBackward:()=>({state:t,dispatch:e})=>((t,e,n)=>{let i=function(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}(t,n);if(!i)return!1;let r=Wr(i);if(!r){let n=i.blockRange(),r=n&&Nt(n);return null!=r&&(e&&e(t.tr.lift(n,r).scrollIntoView()),!0)}let s=r.nodeBefore;if(!s.type.spec.isolating&&Jr(t,r,e))return!0;if(0==i.parent.content.size&&(Ur(s,"end")||le.isSelectable(s))){let n=Ht(t.doc,i.before(),i.after(),f.empty);if(n&&n.slice.size<n.to-n.from){if(e){let i=t.tr.step(n);i.setSelection(Ur(s,"end")?ne.findFrom(i.doc.resolve(i.mapping.map(r.pos,-1)),-1):le.create(i.doc,r.pos-s.nodeSize)),e(i.scrollIntoView())}return!0}}return!(!s.isAtom||r.depth!=i.depth-1||(e&&e(t.tr.delete(r.pos-s.nodeSize,r.pos).scrollIntoView()),0))})(t,e),joinForward:()=>({state:t,dispatch:e})=>((t,e,n)=>{let i=function(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}(t,n);if(!i)return!1;let r=Kr(i);if(!r)return!1;let s=r.nodeAfter;if(Jr(t,r,e))return!0;if(0==i.parent.content.size&&(Ur(s,"start")||le.isSelectable(s))){let n=Ht(t.doc,i.before(),i.after(),f.empty);if(n&&n.slice.size<n.to-n.from){if(e){let i=t.tr.step(n);i.setSelection(Ur(s,"start")?ne.findFrom(i.doc.resolve(i.mapping.map(r.pos)),1):le.create(i.doc,i.mapping.map(r.pos))),e(i.scrollIntoView())}return!0}}return!(!s.isAtom||r.depth!=i.depth-1||(e&&e(t.tr.delete(r.pos,r.pos+s.nodeSize).scrollIntoView()),0))})(t,e),keyboardShortcut:t=>({editor:e,view:n,tr:i,dispatch:r})=>{const s=function(t){const e=t.split(/-(?!$)/);let n,i,r,s,o=e[e.length-1];"Space"===o&&(o=" ");for(let t=0;t<e.length-1;t+=1){const o=e[t];if(/^(cmd|meta|m)$/i.test(o))s=!0;else if(/^a(lt)?$/i.test(o))n=!0;else if(/^(c|ctrl|control)$/i.test(o))i=!0;else if(/^s(hift)?$/i.test(o))r=!0;else{if(!/^mod$/i.test(o))throw new Error(`Unrecognized modifier name: ${o}`);zs()||Us()?s=!0:i=!0}}return n&&(o=`Alt-${o}`),i&&(o=`Ctrl-${o}`),s&&(o=`Meta-${o}`),r&&(o=`Shift-${o}`),o}(t).split(/-(?!$)/),o=s.find((t=>!["Alt","Ctrl","Meta","Shift"].includes(t))),a=new KeyboardEvent("keydown",{key:"Space"===o?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction((()=>{n.someProp("handleKeyDown",(t=>t(n,a)))}));return null==l||l.steps.forEach((t=>{const e=t.map(i.mapping);e&&r&&i.maybeStep(e)})),!0},lift:(t,e={})=>({state:n,dispatch:i})=>!!Ws(n,cs(t,n.schema),e)&&((t,e)=>{let{$from:n,$to:i}=t.selection,r=n.blockRange(i),s=r&&Nt(r);return null!=s&&(e&&e(t.tr.lift(r,s).scrollIntoView()),!0)})(n,i),liftEmptyBlock:()=>({state:t,dispatch:e})=>((t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if($t(t.doc,i))return e&&e(t.tr.split(i).scrollIntoView()),!0}let i=n.blockRange(),r=i&&Nt(i);return null!=r&&(e&&e(t.tr.lift(i,r).scrollIntoView()),!0)})(t,e),liftListItem:t=>({state:e,dispatch:n})=>es(cs(t,e.schema))(e,n),newlineInCode:()=>({state:t,dispatch:e})=>((t,e)=>{let{$head:n,$anchor:i}=t.selection;return!(!n.parent.type.spec.code||!n.sameParent(i)||(e&&e(t.tr.insertText("\n").scrollIntoView()),0))})(t,e),resetAttributes:(t,e)=>({tr:n,state:i,dispatch:r})=>{let s=null,o=null;const a=Ks("string"==typeof t?t:t.name,i.schema);return!!a&&("node"===a&&(s=cs(t,i.schema)),"mark"===a&&(o=Fs(t,i.schema)),r&&n.selection.ranges.forEach((t=>{i.doc.nodesBetween(t.$from.pos,t.$to.pos,((t,i)=>{s&&s===t.type&&n.setNodeMarkup(i,void 0,Ys(t.attrs,e)),o&&t.marks.length&&t.marks.forEach((r=>{o===r.type&&n.addMark(i,i+t.nodeSize,o.create(Ys(r.attrs,e)))}))}))})),!0)},scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),selectAll:()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),selectNodeBackward:()=>({state:t,dispatch:e})=>((t,e,n)=>{let{$head:i,empty:r}=t.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):i.parentOffset>0)return!1;s=Wr(i)}let o=s&&s.nodeBefore;return!(!o||!le.isSelectable(o)||(e&&e(t.tr.setSelection(le.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),0))})(t,e),selectNodeForward:()=>({state:t,dispatch:e})=>((t,e,n)=>{let{$head:i,empty:r}=t.selection,s=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size)return!1;s=Kr(i)}let o=s&&s.nodeAfter;return!(!o||!le.isSelectable(o)||(e&&e(t.tr.setSelection(le.create(t.doc,s.pos)).scrollIntoView()),0))})(t,e),selectParentNode:()=>({state:t,dispatch:e})=>((t,e)=>{let n,{$from:i,to:r}=t.selection,s=i.sharedDepth(r);return 0!=s&&(n=i.before(s),e&&e(t.tr.setSelection(le.create(t.doc,n))),!0)})(t,e),selectTextblockEnd:()=>({state:t,dispatch:e})=>Qr(t,e),selectTextblockStart:()=>({state:t,dispatch:e})=>Xr(t,e),setContent:(t,e=!1,n={})=>({tr:i,editor:r,dispatch:s})=>{const{doc:o}=i,a=Js(t,r.schema,n);return s&&i.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0},setMark:(t,e={})=>({tr:n,state:i,dispatch:r})=>{const{selection:s}=n,{empty:o,ranges:a}=s,l=Fs(t,i.schema);if(r)if(o){const t=Xs(i,l);n.addStoredMark(l.create({...t,...e}))}else a.forEach((t=>{const r=t.$from.pos,s=t.$to.pos;i.doc.nodesBetween(r,s,((t,i)=>{const o=Math.max(i,r),a=Math.min(i+t.nodeSize,s);t.marks.find((t=>t.type===l))?t.marks.forEach((t=>{l===t.type&&n.addMark(o,a,l.create({...t.attrs,...e}))})):n.addMark(o,a,l.create(e))}))}));return function(t,e,n){var i;const{selection:r}=e;let s=null;if(Bs(r)&&(s=r.$cursor),s){const e=null!==(i=t.storedMarks)&&void 0!==i?i:s.marks();return!!n.isInSet(e)||!e.some((t=>t.type.excludes(n)))}const{ranges:o}=r;return o.some((({$from:e,$to:i})=>{let r=0===e.depth&&t.doc.inlineContent&&t.doc.type.allowsMarkType(n);return t.doc.nodesBetween(e.pos,i.pos,((t,e,i)=>{if(r)return!1;if(t.isInline){const e=!i||i.type.allowsMarkType(n),s=!!n.isInSet(t.marks)||!t.marks.some((t=>t.type.excludes(n)));r=e&&s}return!r})),r}))}(i,n,l)},setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),setNode:(t,e={})=>({state:n,dispatch:i,chain:r})=>{const s=cs(t,n.schema);return s.isTextblock?r().command((({commands:t})=>!!Zr(s,e)(n)||t.clearNodes())).command((({state:t})=>Zr(s,e)(t,i))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,i=js(t,0,n.content.size),r=le.create(n,i);e.setSelection(r)}return!0},setTextSelection:t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,{from:i,to:r}="number"==typeof t?{from:t,to:t}:t,s=oe.atStart(n).from,o=oe.atEnd(n).to,a=js(i,s,o),l=js(r,s,o),c=oe.create(n,a,l);e.setSelection(c)}return!0},sinkListItem:t=>({state:e,dispatch:n})=>{const i=cs(t,e.schema);return(r=i,function(t,e){let{$from:n,$to:i}=t.selection,s=n.blockRange(i,(t=>t.childCount>0&&t.firstChild.type==r));if(!s)return!1;let o=s.startIndex;if(0==o)return!1;let a=s.parent,c=a.child(o-1);if(c.type!=r)return!1;if(e){let n=c.lastChild&&c.lastChild.type==a.type,i=l.from(n?r.create():null),o=new f(l.from(r.create(null,l.from(a.type.create(null,i)))),n?3:1,0),d=s.start,h=s.end;e(t.tr.step(new Mt(d-(n?3:1),h,d,h,o,1,!0)).scrollIntoView())}return!0})(e,n);var r},splitBlock:({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:i,editor:r})=>{const{selection:s,doc:o}=e,{$from:a,$to:l}=s,c=eo(r.extensionManager.attributes,a.node().type.name,a.node().attrs);if(s instanceof le&&s.node.isBlock)return!(!a.parentOffset||!$t(o,a.pos))&&(i&&(t&&ro(n,r.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(i){const i=l.parentOffset===l.parent.content.size;s instanceof oe&&e.deleteSelection();const o=0===a.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let d=i&&o?[{type:o,attrs:c}]:void 0,h=$t(e.doc,e.mapping.map(a.pos),1,d);if(d||h||!$t(e.doc,e.mapping.map(a.pos),1,o?[{type:o}]:void 0)||(h=!0,d=o?[{type:o,attrs:c}]:void 0),h&&(e.split(e.mapping.map(a.pos),1,d),o&&!i&&!a.parentOffset&&a.parent.type!==o)){const t=e.mapping.map(a.before()),n=e.doc.resolve(t);a.node(-1).canReplaceWith(n.index(),n.index()+1,o)&&e.setNodeMarkup(e.mapping.map(a.before()),o)}t&&ro(n,r.extensionManager.splittableMarks),e.scrollIntoView()}return!0},splitListItem:t=>({tr:e,state:n,dispatch:i,editor:r})=>{var s;const o=cs(t,n.schema),{$from:a,$to:c}=n.selection,d=n.selection.node;if(d&&d.isBlock||a.depth<2||!a.sameParent(c))return!1;const h=a.node(-1);if(h.type!==o)return!1;const u=r.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let t=l.empty;const n=a.index(-1)?1:a.index(-2)?2:3;for(let e=a.depth-n;e>=a.depth-3;e-=1)t=l.from(a.node(e).copy(t));const i=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,r=eo(u,a.node().type.name,a.node().attrs),c=(null===(s=o.contentMatch.defaultType)||void 0===s?void 0:s.createAndFill(r))||void 0;t=t.append(l.from(o.createAndFill(null,c)||void 0));const d=a.before(a.depth-(n-1));e.replace(d,a.after(-i),new f(t,4-n,0));let h=-1;e.doc.nodesBetween(d,e.doc.content.size,((t,e)=>{if(h>-1)return!1;t.isTextblock&&0===t.content.size&&(h=e+1)})),h>-1&&e.setSelection(oe.near(e.doc.resolve(h))),e.scrollIntoView()}return!0}const p=c.pos===a.end()?h.contentMatchAt(0).defaultType:null,m=eo(u,h.type.name,h.attrs),g=eo(u,a.node().type.name,a.node().attrs);e.delete(a.pos,c.pos);const b=p?[{type:o,attrs:m},{type:p,attrs:g}]:[{type:o,attrs:m}];if(!$t(e.doc,a.pos,2))return!1;if(i){const{selection:t,storedMarks:s}=n,{splittableMarks:o}=r.extensionManager,l=s||t.$to.parentOffset&&t.$from.marks();if(e.split(a.pos,2,b).scrollIntoView(),!l||!i)return!0;const c=l.filter((t=>o.includes(t.type.name)));e.ensureMarks(c)}return!0},toggleList:(t,e,n,i={})=>({editor:r,tr:s,state:o,dispatch:a,chain:l,commands:c,can:d})=>{const{extensions:h,splittableMarks:u}=r.extensionManager,p=cs(t,o.schema),f=cs(e,o.schema),{selection:m,storedMarks:g}=o,{$from:b,$to:v}=m,y=b.blockRange(v),w=g||m.$to.parentOffset&&m.$from.marks();if(!y)return!1;const k=Gs((t=>io(t.type.name,h)))(m);if(y.depth>=1&&k&&y.depth-k.depth<=1){if(k.node.type===p)return c.liftListItem(f);if(io(k.node.type.name,h)&&p.validContent(k.node.content)&&a)return l().command((()=>(s.setNodeMarkup(k.pos,p),!0))).command((()=>so(s,p))).command((()=>oo(s,p))).run()}return n&&w&&a?l().command((()=>{const t=d().wrapInList(p,i),e=w.filter((t=>u.includes(t.type.name)));return s.ensureMarks(e),!!t||c.clearNodes()})).wrapInList(p,i).command((()=>so(s,p))).command((()=>oo(s,p))).run():l().command((()=>!!d().wrapInList(p,i)||c.clearNodes())).wrapInList(p,i).command((()=>so(s,p))).command((()=>oo(s,p))).run()},toggleMark:(t,e={},n={})=>({state:i,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,o=Fs(t,i.schema);return no(i,o,e)?r.unsetMark(o,{extendEmptyMarkRange:s}):r.setMark(o,e)},toggleNode:(t,e,n={})=>({state:i,commands:r})=>{const s=cs(t,i.schema),o=cs(e,i.schema);return Ws(i,s,n)?r.setNode(o):r.setNode(s,n)},toggleWrap:(t,e={})=>({state:n,commands:i})=>{const r=cs(t,n.schema);return Ws(n,r,e)?i.lift(r):i.wrapIn(r,e)},undoInputRule:()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let i=0;i<n.length;i+=1){const r=n[i];let s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:i,ranges:r}=n;return i||e&&r.forEach((e=>{t.removeMark(e.$from.pos,e.$to.pos)})),!0},unsetMark:(t,e={})=>({tr:n,state:i,dispatch:r})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=n,l=Fs(t,i.schema),{$from:c,empty:d,ranges:h}=a;if(!r)return!0;if(d&&o){let{from:t,to:e}=a;const i=null===(s=c.marks().find((t=>t.type===l)))||void 0===s?void 0:s.attrs,r=Rs(c,l,i);r&&(t=r.from,e=r.to),n.removeMark(t,e,l)}else h.forEach((t=>{n.removeMark(t.$from.pos,t.$to.pos,l)}));return n.removeStoredMark(l),!0},updateAttributes:(t,e={})=>({tr:n,state:i,dispatch:r})=>{let s=null,o=null;const a=Ks("string"==typeof t?t:t.name,i.schema);return!!a&&("node"===a&&(s=cs(t,i.schema)),"mark"===a&&(o=Fs(t,i.schema)),r&&n.selection.ranges.forEach((t=>{const r=t.$from.pos,a=t.$to.pos;i.doc.nodesBetween(r,a,((t,i)=>{s&&s===t.type&&n.setNodeMarkup(i,void 0,{...t.attrs,...e}),o&&t.marks.length&&t.marks.forEach((s=>{if(o===s.type){const l=Math.max(i,r),c=Math.min(i+t.nodeSize,a);n.addMark(l,c,o.create({...s.attrs,...e}))}}))}))})),!0)},wrapIn:(t,e={})=>({state:n,dispatch:i})=>function(t,e=null){return function(n,i){let{$from:r,$to:s}=n.selection,o=r.blockRange(s),a=o&&It(o,t,e);return!!a&&(i&&i(n.tr.wrap(o,a).scrollIntoView()),!0)}}(cs(t,n.schema),e)(n,i),wrapInList:(t,e={})=>({state:n,dispatch:i})=>ts(cs(t,n.schema),e)(n,i)});const lo=Ms.create({name:"commands",addCommands:()=>({...ao})}),co=Ms.create({name:"editable",addProseMirrorPlugins(){return[new ke({key:new Ee("editable"),props:{editable:()=>this.editor.options.editable}})]}}),ho=Ms.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new ke({key:new Ee("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const i=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1},blur:(e,n)=>{t.isFocused=!1;const i=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1}}}})]}}),uo=Ms.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first((({commands:t})=>[()=>t.undoInputRule(),()=>t.command((({tr:e})=>{const{selection:n,doc:i}=e,{empty:r,$anchor:s}=n,{pos:o,parent:a}=s,l=ne.atStart(i).from===o;return!(!(r&&l&&a.type.isTextblock)||a.textContent.length)&&t.clearNodes()})),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()])),e=()=>this.editor.commands.first((({commands:t})=>[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()])),n={Enter:()=>this.editor.commands.first((({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},r={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return zs()||Us()?r:i},addProseMirrorPlugins(){return[new ke({key:new Ee("clearDocument"),appendTransaction:(t,e,n)=>{if(!(t.some((t=>t.docChanged))&&!e.doc.eq(n.doc)))return;const{empty:i,from:r,to:s}=e.selection,o=ne.atStart(e.doc).from,a=ne.atEnd(e.doc).to;if(i||!(r===o&&s===a))return;if(!(0===n.doc.textBetween(0,n.doc.content.size," "," ").length))return;const l=n.tr,c=ns({state:n,transaction:l}),{commands:d}=new is({editor:this.editor,state:c});return d.clearNodes(),l.steps.length?l:void 0}})]}}),po=Ms.create({name:"tabindex",addProseMirrorPlugins(){return[new ke({key:new Ee("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var fo=Object.freeze({__proto__:null,ClipboardTextSerializer:Ns,Commands:lo,Editable:co,FocusEvents:ho,Keymap:uo,Tabindex:po});class mo extends rs{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(t,e){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=us(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],i=this.state.reconfigure({plugins:n});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((t=>!t.key.startsWith(e)))});this.view.updateState(n)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(fo):[],...this.options.extensions].filter((t=>["extension","node","mark"].includes(null==t?void 0:t.type)));this.extensionManager=new As(t,this)}createCommandManager(){this.commandManager=new is({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=Js(this.options.content,this.schema,this.options.parseOptions),e=Hs(t,this.options.autofocus);this.view=new Ar(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:ye.create({doc:t,selection:e||void 0})});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews();this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach((t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)})):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),r=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Qs(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,i="string"==typeof t?e:t;return function(t,e,n={}){if(!e)return Ws(t,null,n)||no(t,null,n);const i=Ks(e,t.schema);return"node"===i?Ws(t,e,n):"mark"===i&&no(t,e,n)}(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function(t,e){const n=ut.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return function(t,e){return Ds(t,{from:0,to:t.content.size},e)}(this.state.doc,{blockSeparator:e,textSerializers:{...Ls(this.schema),...n}})}get isEmpty(){return function(t){var e;const n=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),i=t.toJSON();return JSON.stringify(n)===JSON.stringify(i)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function go(t){return new ws({find:t.find,handler:({state:e,range:n,match:i})=>{const r=ps(t.getAttributes,void 0,i);if(!1===r||null===r)return null;const{tr:s}=e,o=i[i.length-1],a=i[0];let l=n.to;if(o){const i=a.search(/\S/),c=n.from+a.indexOf(o),d=c+o.length;if(to(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>c)).length)return null;d<n.to&&s.delete(d,n.to),c>n.from&&s.delete(n.from+i,c),l=n.from+i+o.length,s.addMark(n.from+i,l,t.type.create(r||{})),s.removeStoredMark(t.type)}}})}function bo(t){return new ws({find:t.find,handler:({state:e,range:n,match:i})=>{const r=e.doc.resolve(n.from),s=ps(t.getAttributes,void 0,i)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function vo(t){return new ws({find:t.find,handler:({state:e,range:n,match:i,chain:r})=>{const s=ps(t.getAttributes,void 0,i)||{},o=e.tr.delete(n.from,n.to),a=o.doc.resolve(n.from).blockRange(),l=a&&It(a,t.type,s);if(!l)return null;if(o.wrap(a,l),t.keepMarks&&t.editor){const{selection:n,storedMarks:i}=e,{splittableMarks:r}=t.editor.extensionManager,s=i||n.$to.parentOffset&&n.$from.marks();if(s){const t=s.filter((t=>r.includes(t.type.name)));o.ensureMarks(t)}}if(t.keepAttributes){const e="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";r().updateAttributes(e,s).run()}const c=o.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&Rt(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(i,c))&&o.join(n.from-1)}})}class yo{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ps(ss(this,"addOptions",{name:this.name}))),this.storage=ps(ss(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new yo(t)}configure(t={}){const e=this.extend();return e.options=Ts(this.options,t),e.storage=ps(ss(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new yo(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=ps(ss(e,"addOptions",{name:e.name})),e.storage=ps(ss(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:n}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const r=i.marks(),s=!!r.find((t=>(null==t?void 0:t.type.name)===e.name));if(!s)return!1;const o=r.find((t=>(null==t?void 0:t.type.name)===e.name));return o&&n.removeStoredMark(o),n.insertText(" ",i.pos),t.view.dispatch(n),!0}return!1}}class wo{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ps(ss(this,"addOptions",{name:this.name}))),this.storage=ps(ss(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new wo(t)}configure(t={}){const e=this.extend();return e.options=Ts(this.options,t),e.storage=ps(ss(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new wo(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=ps(ss(e,"addOptions",{name:e.name})),e.storage=ps(ss(e,"addStorage",{name:e.name,options:e.options})),e}}function ko(t){return new Es({find:t.find,handler:({state:e,range:n,match:i})=>{const r=ps(t.getAttributes,void 0,i);if(!1===r||null===r)return null;const{tr:s}=e,o=i[i.length-1],a=i[0];let l=n.to;if(o){const i=a.search(/\S/),c=n.from+a.indexOf(o),d=c+o.length;if(to(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>c)).length)return null;d<n.to&&s.delete(d,n.to),c>n.from&&s.delete(n.from+i,c),l=n.from+i+o.length,s.addMark(n.from+i,l,t.type.create(r||{})),s.removeStoredMark(t.type)}}})}function So(t,e,n,i){let r=!1;return"attachment-gallery"!=t.type.name||2===t.nodeSize&&(e.replaceWith(i,i+t.nodeSize,n.schema.node("paragraph",null,[])),r=!0),r}function xo(t,e,n,i){let r=!1;if("attachment-figure"!==t.type.name)return r;let s=document.createElement("div");s.appendChild(ut.fromSchema(n.schema).serializeNode(t));const o=s.querySelector("figcaption");if(null==o)return r;const a=o.innerHTML;return t.attrs.caption!==a&&(e.setNodeMarkup(i,void 0,{...t.attrs,caption:a}),r=!0),r}var Eo=wo.create({name:"attachment-gallery",group:"block",draggable:!1,selectable:!1,content:"block*",parseHTML:()=>[{tag:"div.attachment-gallery"}],renderHTML:()=>["div",ds({},{class:"attachment-gallery"}),0],addProseMirrorPlugins:()=>[new ke({appendTransaction:(t,e,n)=>{const i=n.tr;let r=!1;if(n.doc.descendants(((t,e,s)=>{[So(t,i,n,e),xo(t,i,n,e)].some((t=>!0===t))&&(r=!0)})),r)return i}})]});function Co(t,e){const n=t.closest("action-text-attachment")?.getAttribute(e);if(n)return n;const i=t.closest("figure[data-trix-attachment]")?.getAttribute("data-trix-attachment");return i?JSON.parse(i)[e]:null}var _o=wo.create({name:"attachment-image",selectable:!1,draggable:!1,group:"block",addOptions:()=>({HTMLAttributes:{}}),addAttributes:()=>({src:{default:"",parseHTML:t=>Co(t,"url")},height:{default:"",parseHTML:t=>Co(t,"height")},width:{default:"",parseHTML:t=>Co(t,"width")},attachmentId:{default:null}}),parseHTML:()=>[{tag:"figure[data-trix-attachment] img[src]"}],renderHTML({HTMLAttributes:t}){return["img",ds(this.options.HTMLAttributes,t)]}});const Ao=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Oo=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,To=yo.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML({HTMLAttributes:t}){return["s",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[go({find:Ao,type:this.type})]},addPasteRules(){return[ko({find:Oo,type:this.type})]}});var Mo=To.extend({name:"rhino-strike",renderHTML({HTMLAttributes:t}){return["del",ds(this.options.HTMLAttributes,t),0]}});function Do(t){const e=t/1024;if(e<1)return t.toString()+"B";const n=e/1024;return n<1?e.toFixed(2).toString()+" KB":n.toFixed(2).toString()+" MB"}function Lo({fileName:t,fileSize:e}){return t&&e?`${t} · ${Do(Number(e))}`:""}var No=/^image(\/(gif|png|jpe?g)|$)/;function Io(t,e){return t||null!=e?.match(No)}function Po(t){return t?"attachment--"+t.match(/\.(\w+)$/)?.[1].toLowerCase():""}function $o(t,e){return e?"attachment--preview":t?"attachment--content":"attachment--file"}var Ro=wo.create({name:"attachment-figure",group:"block attachmentFigure",content:"inline*",selectable:!0,draggable:!0,isolating:!0,defining:!0,addOptions:()=>({HTMLAttributes:{class:"attachment","data-trix-attributes":JSON.stringify({presentation:"gallery"})}}),parseHTML:()=>[{tag:"figure[data-trix-attachment]"},{tag:"figure.attachment",contentElement:"figcaption"}],renderHTML({node:t}){const{content:e,contentType:n,sgid:i,fileName:r,fileSize:s,caption:o,url:a,previewable:l,src:c,width:d,height:h}=t.attrs,u={caption:o,contentType:n,content:e,filename:r,filesize:s,height:h,width:d,sgid:i,url:a,src:c},p=["figure",ds(this.options.HTMLAttributes,{class:this.options.HTMLAttributes.class+" "+$o(e,Io(l,n))+" "+Po(r),"data-trix-content-type":n,"data-trix-attachment":JSON.stringify(u),"data-trix-attributes":JSON.stringify({caption:o,presentation:"gallery"})})],f=["figcaption",ds({},{class:"attachment__caption attachment__caption--edited"}),0],m=["img",ds({},{src:a||c,contenteditable:!1,width:d,height:h})];return e?[...p,f]:[...p,m,f]},addAttributes:()=>({attachmentId:{default:null},caption:{default:"",parseHTML:t=>t.querySelector("figcaption")?.innerHTML||Co(t,"caption")},progress:{default:100},sgid:{default:"",parseHTML:t=>Co(t,"sgid")},src:{default:"",parseHTML:t=>Co(t,"src")},height:{default:"",parseHTML:t=>Co(t,"height")},width:{default:"",parseHTML:t=>Co(t,"width")},contentType:{default:"",parseHTML:t=>Co(t,"content-type")||JSON.parse(t.getAttribute("data-trix-attachment")||"").contentType||"application/octet-stream"},fileName:{default:"",parseHTML:t=>Co(t,"filename")},fileSize:{default:"",parseHTML:t=>Co(t,"filesize")},content:{default:"",parseHTML:t=>Co(t,"content")||t.closest("action-text-attachment")?.innerHTML||""},url:{default:"",parseHTML:t=>Co(t,"url")},previewable:{default:!1,parseHTML:t=>{const{previewable:e}=JSON.parse(t.getAttribute("data-trix-attachment")||"{}");return e}}}),addNodeView(){return({node:t,getPos:e,editor:n})=>{const{content:i,contentType:r,sgid:s,fileName:o,progress:a,fileSize:l,url:c,src:d,width:h,height:u,caption:p,previewable:f}=t.attrs,m=document.createElement("figure"),g=document.createElement("figcaption");p?g.classList.remove("is-empty"):g.classList.add("is-empty"),g.setAttribute("data-default-caption",Lo({fileSize:l,fileName:o})),g.setAttribute("data-placeholder","Add a caption..."),g.classList.add("attachment__caption"),m.setAttribute("class",this.options.HTMLAttributes.class+" "+$o(i,Io(f,r))+" "+Po(o)),m.setAttribute("data-trix-content-type",t.attrs.contentType),s&&m.setAttribute("sgid",s),m.setAttribute("data-trix-attachment",JSON.stringify({contentType:r,content:i,filename:o,filesize:l,height:u,width:h,sgid:s,url:c,caption:p})),m.setAttribute("data-trix-attributes",JSON.stringify({presentation:"gallery",caption:p}));const b=document.createElement("rhino-attachment-editor");b.setAttribute("file-name",o),b.setAttribute("file-size",l),b.setAttribute("contenteditable","false"),b.setAttribute("progress",a),m.addEventListener("click",(t=>{t.composedPath().includes(g)||"function"==typeof e&&n.chain().setTextSelection(e()+1).run()}));const v=document.createElement("img");return v.setAttribute("contenteditable","false"),v.setAttribute("width",h),v.setAttribute("height",u),Io(f,r)&&((c||d)&&v.setAttribute("src",c||d),h&&u||(v.src=c||d,v.onload=()=>{const{naturalHeight:i,naturalWidth:r}=v;if("function"==typeof e){const s=n.view;s.dispatch(s.state.tr.setNodeMarkup(e(),void 0,{...t.attrs,height:i,width:r}))}})),i&&!Io(f,r)?(m.innerHTML=i,m.prepend(b),m.append(g)):m.append(b,v,g),{dom:m,contentDOM:g}}},addCommands:()=>({setAttachment:t=>({state:e,tr:n,dispatch:i})=>{const{schema:r}=e,s=null==r.nodes["attachment-gallery"],o=e.doc.resolve(e.selection.anchor),a=e.selection.anchor-2<0?0:e.selection.anchor-2,l=e.doc.resolve(a),c="attachment-gallery"===o.node(1).type.name,d="attachment-gallery"===l.node(1)?.type.name,h=c||d;let u=(Array.isArray(t)?t:[].concat(t)).map((t=>r.nodes["attachment-figure"].create(t,t.caption?[r.text(t.caption)]:[])));const p=o.end();if(s)return u=u.flatMap((t=>[t,r.nodes.paragraph.create()])),n.insert(p,u),i&&i(n),!0;if(h){const t=c?0:2;n.insert(p-t,u)}else{const t=e.selection,i=r.nodes["attachment-gallery"].create({},u);n.replaceWith(t.from-1,t.to,[r.nodes.paragraph.create(),i,r.nodes.paragraph.create()]),function(t,e,n){const i=t.steps.length-1;if(i<e)return;const r=t.steps[i];if(!(r instanceof Tt||r instanceof Mt))return;const s=t.mapping.maps[i];let o=0;s.forEach(((t,e,n,i)=>{0===o&&(o=i)})),t.setSelection(ne.near(t.doc.resolve(o),n))}(n,n.steps.length-1,-1)}return i&&i(n),!0}})}),Fo=wo.create({name:"attachment-figcaption",group:"block figcaption",content:"inline*",selectable:!1,draggable:!1,defining:!0,isolating:!0,addOptions:()=>({HTMLAttributes:{class:"attachment__caption attachment--edited"}}),parseHTML:()=>[{tag:"figure[data-trix-attachment] figcaption"}],renderHTML({HTMLAttributes:t}){return["figcaption",ds(this.options.HTMLAttributes,t),0]}});function Bo(){let t=!1;return new ke({props:{handleDOMEvents:{focus:e=>(t?t=!1:(t=!0,setTimeout((()=>{e.dom.blur(),e.dom.focus()}))),!1)}}})}const jo=Ms.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new ke({key:new Ee("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,r=[];if(!n)return null;const s=t.type.createAndFill(),o=(null==s?void 0:s.sameMarkup(t))&&null===s.content.findDiffStart(t.content);return t.descendants(((t,e)=>{const n=i>=e&&i<=e+t.nodeSize,s=!t.isLeaf&&!t.childCount;if((n||!this.options.showOnlyCurrent)&&s){const i=[this.options.emptyNodeClass];o&&i.push(this.options.emptyEditorClass);const s=nr.node(e,e+t.nodeSize,{class:i.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:t,pos:e,hasAnchor:n}):this.options.placeholder});r.push(s)}return this.options.includeChildren})),sr.create(t,r)}}})]}}),Ho=Ms.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new ke({key:new Ee("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:i}=this.editor,{anchor:r}=e,s=[];if(!n||!i)return sr.create(t,[]);let o=0;"deepest"===this.options.mode&&t.descendants(((t,e)=>{if(t.isText)return;if(!(r>=e&&r<=e+t.nodeSize-1))return!1;o+=1}));let a=0;return t.descendants(((t,e)=>{if(t.isText)return!1;if(!(r>=e&&r<=e+t.nodeSize-1))return!1;a+=1;if("deepest"===this.options.mode&&o-a>0||"shallowest"===this.options.mode&&a>1)return"deepest"===this.options.mode;s.push(nr.node(e,e+t.nodeSize,{class:this.options.className}))})),sr.create(t,s)}}})]}}),zo="aaa1rp3barth4b0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0faromeo7ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re2s2c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y0eats7k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking0channel11l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t0isalat7u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0at2delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d0network8tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntdoor4ier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5gtv3iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0eles2s3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1nder2le4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster5ia3d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4de2k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0cys3drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7serati6ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic3tual5v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rthwesternmutual14on4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3ssagens7y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cher3ks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w0time7i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ffany5ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0channel7ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lkswagen7vo3te1ing3o2yage5u0elos6wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Vo="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5تصالات6رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",qo=(t,e)=>{for(const n in e)t[n]=e[n];return t},Uo="numeric",Wo="ascii",Ko="alpha",Yo="asciinumeric",Jo="alphanumeric",Go="domain",Xo="emoji",Qo="scheme",Zo="slashscheme",ta="whitespace";function ea(t,e){return t in e||(e[t]=[]),e[t]}function na(t,e,n){e[Uo]&&(e[Yo]=!0,e[Jo]=!0),e[Wo]&&(e[Yo]=!0,e[Ko]=!0),e[Yo]&&(e[Jo]=!0),e[Ko]&&(e[Jo]=!0),e[Jo]&&(e[Go]=!0),e[Xo]&&(e[Go]=!0);for(const i in e){const e=ea(i,n);e.indexOf(t)<0&&e.push(t)}}function ia(t){void 0===t&&(t=null),this.j={},this.jr=[],this.jd=null,this.t=t}ia.groups={},ia.prototype={accepts(){return!!this.t},go(t){const e=this,n=e.j[t];if(n)return n;for(let n=0;n<e.jr.length;n++){const i=e.jr[n][0],r=e.jr[n][1];if(r&&i.test(t))return r}return e.jd},has(t,e){return void 0===e&&(e=!1),e?t in this.j:!!this.go(t)},ta(t,e,n,i){for(let r=0;r<t.length;r++)this.tt(t[r],e,n,i)},tr(t,e,n,i){let r;return i=i||ia.groups,e&&e.j?r=e:(r=new ia(e),n&&i&&na(e,n,i)),this.jr.push([t,r]),r},ts(t,e,n,i){let r=this;const s=t.length;if(!s)return r;for(let e=0;e<s-1;e++)r=r.tt(t[e]);return r.tt(t[s-1],e,n,i)},tt(t,e,n,i){i=i||ia.groups;const r=this;if(e&&e.j)return r.j[t]=e,e;const s=e;let o,a=r.go(t);if(a?(o=new ia,qo(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new ia,s){if(i)if(o.t&&"string"==typeof o.t){const t=qo(function(t,e){const n={};for(const i in e)e[i].indexOf(t)>=0&&(n[i]=!0);return n}(o.t,i),n);na(s,t,i)}else n&&na(s,n,i);o.t=s}return r.j[t]=o,o}};const ra=(t,e,n,i,r)=>t.ta(e,n,i,r),sa=(t,e,n,i,r)=>t.tr(e,n,i,r),oa=(t,e,n,i,r)=>t.ts(e,n,i,r),aa=(t,e,n,i,r)=>t.tt(e,n,i,r),la="WORD",ca="UWORD",da="LOCALHOST",ha="TLD",ua="UTLD",pa="SCHEME",fa="SLASH_SCHEME",ma="NUM",ga="WS",ba="NL",va="OPENBRACE",ya="OPENBRACKET",wa="OPENANGLEBRACKET",ka="OPENPAREN",Sa="CLOSEBRACE",xa="CLOSEBRACKET",Ea="CLOSEANGLEBRACKET",Ca="CLOSEPAREN",_a="AMPERSAND",Aa="APOSTROPHE",Oa="ASTERISK",Ta="AT",Ma="BACKSLASH",Da="BACKTICK",La="CARET",Na="COLON",Ia="COMMA",Pa="DOLLAR",$a="DOT",Ra="EQUALS",Fa="EXCLAMATION",Ba="HYPHEN",ja="PERCENT",Ha="PIPE",za="PLUS",Va="POUND",qa="QUERY",Ua="QUOTE",Wa="SEMI",Ka="SLASH",Ya="TILDE",Ja="UNDERSCORE",Ga="EMOJI",Xa="SYM";var Qa=Object.freeze({__proto__:null,WORD:la,UWORD:ca,LOCALHOST:da,TLD:ha,UTLD:ua,SCHEME:pa,SLASH_SCHEME:fa,NUM:ma,WS:ga,NL:ba,OPENBRACE:va,OPENBRACKET:ya,OPENANGLEBRACKET:wa,OPENPAREN:ka,CLOSEBRACE:Sa,CLOSEBRACKET:xa,CLOSEANGLEBRACKET:Ea,CLOSEPAREN:Ca,AMPERSAND:_a,APOSTROPHE:Aa,ASTERISK:Oa,AT:Ta,BACKSLASH:Ma,BACKTICK:Da,CARET:La,COLON:Na,COMMA:Ia,DOLLAR:Pa,DOT:$a,EQUALS:Ra,EXCLAMATION:Fa,HYPHEN:Ba,PERCENT:ja,PIPE:Ha,PLUS:za,POUND:Va,QUERY:qa,QUOTE:Ua,SEMI:Wa,SLASH:Ka,TILDE:Ya,UNDERSCORE:Ja,EMOJI:Ga,SYM:Xa});const Za=/[a-z]/,tl=/\p{L}/u,el=/\p{Emoji}/u,nl=/\d/,il=/\s/,rl="\n",sl="️",ol="‍";let al=null,ll=null;function cl(t,e,n,i,r){let s;const o=e.length;for(let n=0;n<o-1;n++){const o=e[n];t.j[o]?s=t.j[o]:(s=new ia(i),s.jr=r.slice(),t.j[o]=s),t=s}return s=new ia(n),s.jr=r.slice(),t.j[e[o-1]]=s,s}function dl(t){const e=[],n=[];let i=0;for(;i<t.length;){let r=0;for(;"0123456789".indexOf(t[i+r])>=0;)r++;if(r>0){e.push(n.join(""));for(let e=parseInt(t.substring(i,i+r),10);e>0;e--)n.pop();i+=r}else n.push(t[i]),i++}return e}const hl={defaultProtocol:"http",events:null,format:pl,formatHref:pl,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function ul(t,e){void 0===e&&(e=null);let n=qo({},hl);t&&(n=qo(n,t instanceof ul?t.o:t));const i=n.ignoreTags,r=[];for(let t=0;t<i.length;t++)r.push(i[t].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=r}function pl(t){return t}function fl(t,e){this.t="token",this.v=t,this.tk=e}function ml(t,e){class n extends fl{constructor(e,n){super(e,n),this.t=t}}for(const t in e)n.prototype[t]=e[t];return n.t=t,n}ul.prototype={o:hl,ignoreTags:[],defaultRender:t=>t,check(t){return this.get("validate",t.toString(),t)},get(t,e,n){const i=null!=e;let r=this.o[t];return r?("object"==typeof r?(r=n.t in r?r[n.t]:hl[t],"function"==typeof r&&i&&(r=r(e,n))):"function"==typeof r&&i&&(r=r(e,n.t,n)),r):r},getObj(t,e,n){let i=this.o[t];return"function"==typeof i&&null!=e&&(i=i(e,n.t,n)),i},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}},fl.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),n=t.get("truncate",e,this),i=t.get("format",e,this);return n&&i.length>n?i.substring(0,n)+"…":i},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t){return void 0===t&&(t=hl.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,n=this.toHref(t.get("defaultProtocol")),i=t.get("formatHref",n,this),r=t.get("tagName",n,e),s=this.toFormattedString(t),o={},a=t.get("className",n,e),l=t.get("target",n,e),c=t.get("rel",n,e),d=t.getObj("attributes",n,e),h=t.getObj("events",n,e);return o.href=i,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),d&&qo(o,d),{tagName:r,attributes:o,content:s,eventListeners:h}}};const gl=ml("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),bl=ml("text"),vl=ml("nl"),yl=ml("url",{isLink:!0,toHref(t){return void 0===t&&(t=hl.defaultProtocol),this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==da&&t[1].t===Na}}),wl=t=>new ia(t);function kl(t,e,n){const i=n[0].s,r=n[n.length-1].e;return new t(e.slice(i,r),n)}const Sl="undefined"!=typeof console&&console&&console.warn||(()=>{}),xl={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function El(t,e){if(void 0===e&&(e=!1),xl.initialized&&Sl(`linkifyjs: already initialized - will not register custom scheme "${t}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error('linkifyjs: incorrect scheme format.\n 1. Must only contain digits, lowercase ASCII letters or "-"\n 2. Cannot start or end with "-"\n 3. "-" cannot repeat');xl.customSchemes.push([t,e])}function Cl(){xl.scanner=function(t){void 0===t&&(t=[]);const e={};ia.groups=e;const n=new ia;null==al&&(al=dl(zo)),null==ll&&(ll=dl(Vo)),aa(n,"'",Aa),aa(n,"{",va),aa(n,"[",ya),aa(n,"<",wa),aa(n,"(",ka),aa(n,"}",Sa),aa(n,"]",xa),aa(n,">",Ea),aa(n,")",Ca),aa(n,"&",_a),aa(n,"*",Oa),aa(n,"@",Ta),aa(n,"`",Da),aa(n,"^",La),aa(n,":",Na),aa(n,",",Ia),aa(n,"$",Pa),aa(n,".",$a),aa(n,"=",Ra),aa(n,"!",Fa),aa(n,"-",Ba),aa(n,"%",ja),aa(n,"|",Ha),aa(n,"+",za),aa(n,"#",Va),aa(n,"?",qa),aa(n,'"',Ua),aa(n,"/",Ka),aa(n,";",Wa),aa(n,"~",Ya),aa(n,"_",Ja),aa(n,"\\",Ma);const i=sa(n,nl,ma,{[Uo]:!0});sa(i,nl,i);const r=sa(n,Za,la,{[Wo]:!0});sa(r,Za,r);const s=sa(n,tl,ca,{[Ko]:!0});sa(s,Za),sa(s,tl,s);const o=sa(n,il,ga,{[ta]:!0});aa(n,rl,ba,{[ta]:!0}),aa(o,rl),sa(o,il,o);const a=sa(n,el,Ga,{[Xo]:!0});sa(a,el,a),aa(a,sl,a);const l=aa(a,ol);sa(l,el,a);const c=[[Za,r]],d=[[Za,null],[tl,s]];for(let t=0;t<al.length;t++)cl(n,al[t],ha,la,c);for(let t=0;t<ll.length;t++)cl(n,ll[t],ua,ca,d);na(ha,{tld:!0,ascii:!0},e),na(ua,{utld:!0,alpha:!0},e),cl(n,"file",pa,la,c),cl(n,"mailto",pa,la,c),cl(n,"http",fa,la,c),cl(n,"https",fa,la,c),cl(n,"ftp",fa,la,c),cl(n,"ftps",fa,la,c),na(pa,{scheme:!0,ascii:!0},e),na(fa,{slashscheme:!0,ascii:!0},e),t=t.sort(((t,e)=>t[0]>e[0]?1:-1));for(let e=0;e<t.length;e++){const i=t[e][0],r=t[e][1]?{[Qo]:!0}:{[Zo]:!0};i.indexOf("-")>=0?r[Go]=!0:Za.test(i)?nl.test(i)?r[Yo]=!0:r[Wo]=!0:r[Uo]=!0,oa(n,i,i,r)}return oa(n,"localhost",da,{ascii:!0}),n.jd=new ia(Xa),{start:n,tokens:qo({groups:e},Qa)}}(xl.customSchemes);for(let t=0;t<xl.tokenQueue.length;t++)xl.tokenQueue[t][1]({scanner:xl.scanner});xl.parser=function(t){let{groups:e}=t;const n=e.domain.concat([_a,Oa,Ta,Ma,Da,La,Pa,Ra,Ba,ma,ja,Ha,za,Va,Ka,Xa,Ya,Ja]),i=[Aa,Ea,Sa,xa,Ca,Na,Ia,$a,Fa,wa,va,ya,ka,qa,Ua,Wa],r=[_a,Aa,Oa,Ma,Da,La,Sa,Pa,Ra,Ba,va,ja,Ha,za,Va,qa,Ka,Xa,Ya,Ja],s=wl(),o=aa(s,Ya);ra(o,r,o),ra(o,e.domain,o);const a=wl(),l=wl(),c=wl();ra(s,e.domain,a),ra(s,e.scheme,l),ra(s,e.slashscheme,c),ra(a,r,o),ra(a,e.domain,a);const d=aa(a,Ta);aa(o,Ta,d),aa(l,Ta,d),aa(c,Ta,d);const h=aa(o,$a);ra(h,r,o),ra(h,e.domain,o);const u=wl();ra(d,e.domain,u),ra(u,e.domain,u);const p=aa(u,$a);ra(p,e.domain,u);const f=wl(gl);ra(p,e.tld,f),ra(p,e.utld,f),aa(d,da,f);const m=aa(u,Ba);ra(m,e.domain,u),ra(f,e.domain,u),aa(f,$a,p),aa(f,Ba,m);const g=aa(f,Na);ra(g,e.numeric,gl);const b=aa(a,Ba),v=aa(a,$a);ra(b,e.domain,a),ra(v,r,o),ra(v,e.domain,a);const y=wl(yl);ra(v,e.tld,y),ra(v,e.utld,y),ra(y,e.domain,a),ra(y,r,o),aa(y,$a,v),aa(y,Ba,b),aa(y,Ta,d);const w=aa(y,Na),k=wl(yl);ra(w,e.numeric,k);const S=wl(yl),x=wl();ra(S,n,S),ra(S,i,x),ra(x,n,S),ra(x,i,x),aa(y,Ka,S),aa(k,Ka,S);const E=aa(l,Na),C=aa(c,Na),_=aa(C,Ka),A=aa(_,Ka);ra(l,e.domain,a),aa(l,$a,v),aa(l,Ba,b),ra(c,e.domain,a),aa(c,$a,v),aa(c,Ba,b),ra(E,e.domain,S),aa(E,Ka,S),ra(A,e.domain,S),ra(A,n,S),aa(A,Ka,S);const O=aa(S,va),T=aa(S,ya),M=aa(S,wa),D=aa(S,ka);aa(x,va,O),aa(x,ya,T),aa(x,wa,M),aa(x,ka,D),aa(O,Sa,S),aa(T,xa,S),aa(M,Ea,S),aa(D,Ca,S),aa(O,Sa,S);const L=wl(yl),N=wl(yl),I=wl(yl),P=wl(yl);ra(O,n,L),ra(T,n,N),ra(M,n,I),ra(D,n,P);const $=wl(),R=wl(),F=wl(),B=wl();return ra(O,i),ra(T,i),ra(M,i),ra(D,i),ra(L,n,L),ra(N,n,N),ra(I,n,I),ra(P,n,P),ra(L,i,L),ra(N,i,N),ra(I,i,I),ra(P,i,P),ra($,n,$),ra(R,n,N),ra(F,n,I),ra(B,n,P),ra($,i,$),ra(R,i,R),ra(F,i,F),ra(B,i,B),aa(N,xa,S),aa(I,Ea,S),aa(P,Ca,S),aa(L,Sa,S),aa(R,xa,S),aa(F,Ea,S),aa(B,Ca,S),aa($,Ca,S),aa(s,da,y),aa(s,ba,vl),{start:s,tokens:Qa}}(xl.scanner.tokens);for(let t=0;t<xl.pluginQueue.length;t++)xl.pluginQueue[t][1]({scanner:xl.scanner,parser:xl.parser});xl.initialized=!0}function _l(t){return xl.initialized||Cl(),function(t,e,n){let i=n.length,r=0,s=[],o=[];for(;r<i;){let a=t,l=null,c=null,d=0,h=null,u=-1;for(;r<i&&!(l=a.go(n[r].t));)o.push(n[r++]);for(;r<i&&(c=l||a.go(n[r].t));)l=null,a=c,a.accepts()?(u=0,h=a):u>=0&&u++,r++,d++;if(u<0)r-=d,r<i&&(o.push(n[r]),r++);else{o.length>0&&(s.push(kl(bl,e,o)),o=[]),r-=u,d-=u;const t=h.t,i=n.slice(r-d,r);s.push(kl(t,e,i))}}return o.length>0&&s.push(kl(bl,e,o)),s}(xl.parser.start,t,function(t,e){const n=function(t){const e=[],n=t.length;let i=0;for(;i<n;){let r,s=t.charCodeAt(i),o=s<55296||s>56319||i+1===n||(r=t.charCodeAt(i+1))<56320||r>57343?t[i]:t.slice(i,i+2);e.push(o),i+=o.length}return e}(e.replace(/[A-Z]/g,(t=>t.toLowerCase()))),i=n.length,r=[];let s=0,o=0;for(;o<i;){let a=t,l=null,c=0,d=null,h=-1,u=-1;for(;o<i&&(l=a.go(n[o]));)a=l,a.accepts()?(h=0,u=0,d=a):h>=0&&(h+=n[o].length,u++),c+=n[o].length,s+=n[o].length,o++;s-=h,o-=u,c-=h,r.push({t:d.t,v:e.slice(s-c,s),s:s-c,e:s})}return r}(xl.scanner.start,t))}function Al(t,e,n){if(void 0===e&&(e=null),void 0===n&&(n=null),e&&"object"==typeof e){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const i=new ul(n),r=_l(t),s=[];for(let t=0;t<r.length;t++){const n=r[t];!n.isLink||e&&n.t!==e||s.push(n.toFormattedObject(i))}return s}function Ol(t,e){void 0===e&&(e=null);const n=_l(t);return 1===n.length&&n[0].isLink&&(!e||n[0].t===e)}function Tl(t){return new ke({key:new Ee("autolink"),appendTransaction:(e,n,i)=>{const r=e.some((t=>t.docChanged))&&!n.doc.eq(i.doc),s=e.some((t=>t.getMeta("preventAutolink")));if(!r||s)return;const{tr:o}=i,a=function(t,e){const n=new te(t);return e.forEach((t=>{t.steps.forEach((t=>{n.step(t)}))})),n}(n.doc,[...e]),{mapping:l}=a,c=function(t){const{mapping:e,steps:n}=t,i=[];return e.maps.forEach(((t,r)=>{const s=[];if(t.ranges.length)t.forEach(((t,e)=>{s.push({from:t,to:e})}));else{const{from:t,to:e}=n[r];if(void 0===t||void 0===e)return;s.push({from:t,to:e})}s.forEach((({from:t,to:n})=>{const s=e.slice(r).map(t,-1),o=e.slice(r).map(n),a=e.invert().map(s,-1),l=e.invert().map(o);i.push({oldRange:{from:a,to:l},newRange:{from:s,to:o}})}))})),Zs(i)}(a);return c.forEach((({oldRange:e,newRange:r})=>{to(e.from,e.to,n.doc).filter((e=>e.mark.type===t.type)).forEach((e=>{const r=to(l.map(e.from),l.map(e.to),i.doc).filter((e=>e.mark.type===t.type));if(!r.length)return;const s=r[0],a=n.doc.textBetween(e.from,e.to,void 0," "),c=i.doc.textBetween(s.from,s.to,void 0," "),d=Ol(a),h=Ol(c);d&&!h&&o.removeMark(s.from,s.to,t.type)}));const s=function(t,e,n){const i=[];return t.nodesBetween(e.from,e.to,((t,e)=>{n(t)&&i.push({node:t,pos:e})})),i}(i.doc,r,(t=>t.isTextblock));let a,c;if(s.length>1?(a=s[0],c=i.doc.textBetween(a.pos,a.pos+a.node.nodeSize,void 0," ")):s.length&&i.doc.textBetween(r.from,r.to," "," ").endsWith(" ")&&(a=s[0],c=i.doc.textBetween(a.pos,r.to,void 0," ")),a&&c){const e=c.split(" ").filter((t=>""!==t));if(e.length<=0)return!1;const n=e[e.length-1],i=a.pos+c.lastIndexOf(n);if(!n)return!1;Al(n).filter((t=>t.isLink)).filter((e=>!t.validate||t.validate(e.value))).map((t=>({...t,from:i+t.start+1,to:i+t.end+1}))).forEach((e=>{o.addMark(e.from,e.to,t.type.create({href:e.href}))}))}})),o.steps.length?o:void 0}})}const Ml=yo.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach((t=>{"string"!=typeof t?El(t.scheme,t.optionalSlashes):El(t)}))},onDestroy(){ia.groups={},xl.scanner=null,xl.parser=null,xl.tokenQueue=[],xl.pluginQueue=[],xl.customSchemes=[],xl.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}),addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},class:{default:this.options.HTMLAttributes.class}}},parseHTML:()=>[{tag:'a[href]:not([href *= "javascript:" i])'}],renderHTML({HTMLAttributes:t}){return["a",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setLink:t=>({chain:e})=>e().setMark(this.name,t).setMeta("preventAutolink",!0).run(),toggleLink:t=>({chain:e})=>e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[ko({find:t=>Al(t).filter((t=>!this.options.validate||this.options.validate(t.value))).filter((t=>t.isLink)).map((t=>({text:t.value,index:t.start,data:t}))),type:this.type,getAttributes:t=>{var e;return{href:null===(e=t.data)||void 0===e?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[];return this.options.autolink&&t.push(Tl({type:this.type,validate:this.options.validate})),this.options.openOnClick&&t.push(function(t){return new ke({key:new Ee("handleClickLink"),props:{handleClick:(e,n,i)=>{var r,s,o;if(0!==i.button)return!1;const a=Qs(e.state,t.type.name),l=null===(r=i.target)||void 0===r?void 0:r.closest("a"),c=null!==(s=null==l?void 0:l.href)&&void 0!==s?s:a.href,d=null!==(o=null==l?void 0:l.target)&&void 0!==o?o:a.target;return!(!l||!c||(window.open(c,d),0))}}})}({type:this.type})),this.options.linkOnPaste&&t.push(function(t){return new ke({key:new Ee("handlePasteLink"),props:{handlePaste:(e,n,i)=>{const{state:r}=e,{selection:s}=r,{empty:o}=s;if(o)return!1;let a="";i.content.forEach((t=>{a+=t.textContent}));const l=Al(a).find((t=>t.isLink&&t.value===a));return!(!a||!l||(t.editor.commands.setMark(t.type,{href:l.href}),0))}}})}({editor:this.editor,type:this.type})),t}});var Dl=Ms.create({addProseMirrorPlugins(){const t=[];return[["firefoxCaretPlugin",Bo]].forEach((([e,n])=>{const i=this.options[e];!1!==i&&t.push(n(i))})),t},addExtensions(){const t=[];return[["gallery",Eo],["attachment",Ro],["image",_o],["figcaption",Fo],["strike",Mo],["link",Ml],["focus",Ho],["placeholder",jo]].forEach((([e,n])=>{const i=this.options[e];!1!==i&&t.push(n.configure(i))})),t}});
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */const Ll=window,Nl=Ll.ShadowRoot&&(void 0===Ll.ShadyCSS||Ll.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Il=Symbol(),Pl=new WeakMap;class $l{constructor(t,e,n){if(this._$cssResult$=!0,n!==Il)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(Nl&&void 0===t){const n=void 0!==e&&1===e.length;n&&(t=Pl.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&Pl.set(e,t))}return t}toString(){return this.cssText}}const Rl=(t,...e)=>{const n=1===t.length?t[0]:e.reduce(((e,n,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+t[i+1]),t[0]);return new $l(n,t,Il)},Fl=Nl?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return(t=>new $l("string"==typeof t?t:t+"",void 0,Il))(e)})(t):t
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */;var Bl;const jl=window,Hl=jl.trustedTypes,zl=Hl?Hl.emptyScript:"",Vl=jl.reactiveElementPolyfillSupport,ql={toAttribute(t,e){switch(e){case Boolean:t=t?zl:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},Ul=(t,e)=>e!==t&&(e==e||t==t),Wl={attribute:!0,type:String,converter:ql,reflect:!1,hasChanged:Ul};class Kl extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,n)=>{const i=this._$Ep(n,e);void 0!==i&&(this._$Ev.set(i,n),t.push(i))})),t}static createProperty(t,e=Wl){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const n="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const r=this[t];this[e]=i,this.requestUpdate(t,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||Wl}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const n of e)this.createProperty(n,t[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const t of n)e.unshift(Fl(t))}else void 0!==t&&e.push(Fl(t));return e}static _$Ep(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,n;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(n=t.hostConnected)||void 0===n||n.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const e=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,e)=>{Nl?t.adoptedStyleSheets=e.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):e.forEach((e=>{const n=document.createElement("style"),i=Ll.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=e.cssText,t.appendChild(n)}))})(e,this.constructor.elementStyles),e}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$EO(t,e,n=Wl){var i;const r=this.constructor._$Ep(t,n);if(void 0!==r&&!0===n.reflect){const s=(void 0!==(null===(i=n.converter)||void 0===i?void 0:i.toAttribute)?n.converter:ql).toAttribute(e,n.type);this._$El=t,null==s?this.removeAttribute(r):this.setAttribute(r,s),this._$El=null}}_$AK(t,e){var n;const i=this.constructor,r=i._$Ev.get(t);if(void 0!==r&&this._$El!==r){const t=i.getPropertyOptions(r),s="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(n=t.converter)||void 0===n?void 0:n.fromAttribute)?t.converter:ql;this._$El=r,this[r]=s.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,n){let i=!0;void 0!==t&&(((n=n||this.constructor.getPropertyOptions(t)).hasChanged||Ul)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===n.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(n)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(n)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var Yl;Kl.finalized=!0,Kl.elementProperties=new Map,Kl.elementStyles=[],Kl.shadowRootOptions={mode:"open"},null==Vl||Vl({ReactiveElement:Kl}),(null!==(Bl=jl.reactiveElementVersions)&&void 0!==Bl?Bl:jl.reactiveElementVersions=[]).push("1.6.1");const Jl=window,Gl=Jl.trustedTypes,Xl=Gl?Gl.createPolicy("lit-html",{createHTML:t=>t}):void 0,Ql="$lit$",Zl=`lit$${(Math.random()+"").slice(9)}$`,tc="?"+Zl,ec=`<${tc}>`,nc=document,ic=()=>nc.createComment(""),rc=t=>null===t||"object"!=typeof t&&"function"!=typeof t,sc=Array.isArray,oc="[ \t\n\f\r]",ac=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,lc=/-->/g,cc=/>/g,dc=RegExp(`>|${oc}(?:([^\\s"'>=/]+)(${oc}*=${oc}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),hc=/'/g,uc=/"/g,pc=/^(?:script|style|textarea|title)$/i,fc=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),mc=fc(1),gc=fc(2),bc=Symbol.for("lit-noChange"),vc=Symbol.for("lit-nothing"),yc=new WeakMap,wc=nc.createTreeWalker(nc,129,null,!1),kc=(t,e)=>{const n=t.length-1,i=[];let r,s=2===e?"<svg>":"",o=ac;for(let e=0;e<n;e++){const n=t[e];let a,l,c=-1,d=0;for(;d<n.length&&(o.lastIndex=d,l=o.exec(n),null!==l);)d=o.lastIndex,o===ac?"!--"===l[1]?o=lc:void 0!==l[1]?o=cc:void 0!==l[2]?(pc.test(l[2])&&(r=RegExp("</"+l[2],"g")),o=dc):void 0!==l[3]&&(o=dc):o===dc?">"===l[0]?(o=null!=r?r:ac,c=-1):void 0===l[1]?c=-2:(c=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?dc:'"'===l[3]?uc:hc):o===uc||o===hc?o=dc:o===lc||o===cc?o=ac:(o=dc,r=void 0);const h=o===dc&&t[e+1].startsWith("/>")?" ":"";s+=o===ac?n+ec:c>=0?(i.push(a),n.slice(0,c)+Ql+n.slice(c)+Zl+h):n+Zl+(-2===c?(i.push(void 0),e):h)}const a=s+(t[n]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==Xl?Xl.createHTML(a):a,i]};class Sc{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let r=0,s=0;const o=t.length-1,a=this.parts,[l,c]=kc(t,e);if(this.el=Sc.createElement(l,n),wc.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(i=wc.nextNode())&&a.length<o;){if(1===i.nodeType){if(i.hasAttributes()){const t=[];for(const e of i.getAttributeNames())if(e.endsWith(Ql)||e.startsWith(Zl)){const n=c[s++];if(t.push(e),void 0!==n){const t=i.getAttribute(n.toLowerCase()+Ql).split(Zl),e=/([.?@])?(.*)/.exec(n);a.push({type:1,index:r,name:e[2],strings:t,ctor:"."===e[1]?Ac:"?"===e[1]?Tc:"@"===e[1]?Mc:_c})}else a.push({type:6,index:r})}for(const e of t)i.removeAttribute(e)}if(pc.test(i.tagName)){const t=i.textContent.split(Zl),e=t.length-1;if(e>0){i.textContent=Gl?Gl.emptyScript:"";for(let n=0;n<e;n++)i.append(t[n],ic()),wc.nextNode(),a.push({type:2,index:++r});i.append(t[e],ic())}}}else if(8===i.nodeType)if(i.data===tc)a.push({type:2,index:r});else{let t=-1;for(;-1!==(t=i.data.indexOf(Zl,t+1));)a.push({type:7,index:r}),t+=Zl.length-1}r++}}static createElement(t,e){const n=nc.createElement("template");return n.innerHTML=t,n}}function xc(t,e,n=t,i){var r,s,o,a;if(e===bc)return e;let l=void 0!==i?null===(r=n._$Co)||void 0===r?void 0:r[i]:n._$Cl;const c=rc(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(s=null==l?void 0:l._$AO)||void 0===s||s.call(l,!1),void 0===c?l=void 0:(l=new c(t),l._$AT(t,n,i)),void 0!==i?(null!==(o=(a=n)._$Co)&&void 0!==o?o:a._$Co=[])[i]=l:n._$Cl=l),void 0!==l&&(e=xc(t,l._$AS(t,e.values),l,i)),e}class Ec{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:n},parts:i}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:nc).importNode(n,!0);wc.currentNode=r;let s=wc.nextNode(),o=0,a=0,l=i[0];for(;void 0!==l;){if(o===l.index){let e;2===l.type?e=new Cc(s,s.nextSibling,this,t):1===l.type?e=new l.ctor(s,l.name,l.strings,this,t):6===l.type&&(e=new Dc(s,this,t)),this._$AV.push(e),l=i[++a]}o!==(null==l?void 0:l.index)&&(s=wc.nextNode(),o++)}return r}v(t){let e=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class Cc{constructor(t,e,n,i){var r;this.type=2,this._$AH=vc,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$Cp=null===(r=null==i?void 0:i.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=xc(this,t,e),rc(t)?t===vc||null==t||""===t?(this._$AH!==vc&&this._$AR(),this._$AH=vc):t!==this._$AH&&t!==bc&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>sc(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==vc&&rc(this._$AH)?this._$AA.nextSibling.data=t:this.$(nc.createTextNode(t)),this._$AH=t}g(t){var e;const{values:n,_$litType$:i}=t,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=Sc.createElement(i.h,this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(n);else{const t=new Ec(r,this),e=t.u(this.options);t.v(n),this.$(e),this._$AH=t}}_$AC(t){let e=yc.get(t.strings);return void 0===e&&yc.set(t.strings,e=new Sc(t)),e}T(t){sc(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const r of t)i===e.length?e.push(n=new Cc(this.k(ic()),this.k(ic()),this,this.options)):n=e[i],n._$AI(r),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class _c{constructor(t,e,n,i,r){this.type=1,this._$AH=vc,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=r,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=vc}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,n,i){const r=this.strings;let s=!1;if(void 0===r)t=xc(this,t,e,0),s=!rc(t)||t!==this._$AH&&t!==bc,s&&(this._$AH=t);else{const i=t;let o,a;for(t=r[0],o=0;o<r.length-1;o++)a=xc(this,i[n+o],e,o),a===bc&&(a=this._$AH[o]),s||(s=!rc(a)||a!==this._$AH[o]),a===vc?t=vc:t!==vc&&(t+=(null!=a?a:"")+r[o+1]),this._$AH[o]=a}s&&!i&&this.j(t)}j(t){t===vc?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class Ac extends _c{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===vc?void 0:t}}const Oc=Gl?Gl.emptyScript:"";class Tc extends _c{constructor(){super(...arguments),this.type=4}j(t){t&&t!==vc?this.element.setAttribute(this.name,Oc):this.element.removeAttribute(this.name)}}class Mc extends _c{constructor(t,e,n,i,r){super(t,e,n,i,r),this.type=5}_$AI(t,e=this){var n;if((t=null!==(n=xc(this,t,e,0))&&void 0!==n?n:vc)===bc)return;const i=this._$AH,r=t===vc&&i!==vc||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==vc&&(i===vc||r);r&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==n?n:this.element,t):this._$AH.handleEvent(t)}}class Dc{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){xc(this,t)}}const Lc=Jl.litHtmlPolyfillSupport;null==Lc||Lc(Sc,Cc),(null!==(Yl=Jl.litHtmlVersions)&&void 0!==Yl?Yl:Jl.litHtmlVersions=[]).push("2.7.3");
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */
var Nc,Ic;class Pc extends Kl{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const n=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=n.firstChild),n}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,n)=>{var i,r;const s=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e;let o=s._$litPart$;if(void 0===o){const t=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:null;s._$litPart$=o=new Cc(e.insertBefore(ic(),t),t,void 0,null!=n?n:{})}return o._$AI(t),o})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return bc}}Pc.finalized=!0,Pc._$litElement$=!0,null===(Nc=globalThis.litElementHydrateSupport)||void 0===Nc||Nc.call(globalThis,{LitElement:Pc});const $c=globalThis.litElementPolyfillSupport;null==$c||$c({LitElement:Pc}),(null!==(Ic=globalThis.litElementVersions)&&void 0!==Ic?Ic:globalThis.litElementVersions=[]).push("3.3.2");var Rc=Rl`
  :host {
    display: block;

    /* General tokens */
    --rhino-focus-ring: 0px 0px 3px 0px var(--rhino-button-active-border-color);
    --rhino-border-radius: 4px;

    --rhino-danger-border-color: red;
    --rhino-danger-background-color: #ffdddd;

    /* Editor tokens */
    --rhino-text-color: #374151;
    --rhino-border-color: #cecece;
    --rhino-placeholder-text-color: #cecece;

    /* Regular buttons */
    --rhino-button-text-color: #889;
    --rhino-button-border-color: #cecece;

    /** Disabled Buttons */
    --rhino-button-disabled-text-color: #d1d5db;
    --rhino-button-disabled-border-color: #d1d5db;
    --rhino-button-disabled-background-color: #d1d5db;

    /** Active buttons */
    --rhino-button-active-border-color: #005a9c;
    --rhino-button-active-background-color: rgb(226 239 255);

    --rhino-toolbar-text-color: hsl(219, 6%, 43%);
    --rhino-toolbar-icon-size: 24px;

    --rhino-dialog-border-color: hsl(
      var(--rhino-button-focus-background-color-hsl) / 50%
    );

    /** Focus buttons */
    --rhino-button-focus-background-color: hsl(
      var(--rhino-button-focus-background-color-hsl)
    );

    --rhino-button-focus-background-color-hsl: 219 26% 95%;

    color: var(--rhino-text-color);
  }

  .toolbar {
    color: var(--rhino-toolbar-text-color);
  }

  .toolbar::part(base) {
    overflow: auto;
  }

  .toolbar::part(base) {
    border-color: var(--rhino-border-color);
    border-width: 1px;
    border-bottom-color: transparent;
    border-radius: var(--rhino-border-radius) var(--rhino-border-radius) 0px 0px;
  }

  .toolbar::part(base):is(:focus-visible, :focus-within) {
    border-color: var(--rhino-button-active-border-color);
    outline: transparent;
  }

  .toolbar__button {
    border: 1px solid var(--rhino-border-color);
    border-radius: var(--rhino-border-radius);
    padding: 0.2em 0.4em;
  }

  .toolbar__button[aria-disabled="true"] {
    color: var(--rhino-button-disabled-text-color);
    border-color: var(--rhino-button-disabled-border-color);
  }

  .toolbar__button[aria-disabled="true"]:focus {
    border-color: var(--rhino-button-disabled-border-color);
  }

  .toolbar__button svg {
    min-height: var(--rhino-toolbar-icon-size);
    min-width: var(--rhino-toolbar-icon-size);

    /* max-height / max-width needs to be set for safari */
    max-height: var(--rhino-toolbar-icon-size);
    max-width: var(--rhino-toolbar-icon-size);
  }

  button:is(:focus, :hover):not([aria-disabled="true"], :disabled) {
    outline: transparent;
    box-shadow: var(--rhino-focus-ring);
    border-color: var(--rhino-button-active-border-color);
    background-color: var(--rhino-button-focus-background-color);
  }

  .toolbar__button:is(
      [aria-disabled="true"]:not([part~="toolbar__button--active"])
    ) {
    color: var(--rhino-button-disabled-text-color);
    border-color: var(--rhino-button-disabled-border-color);
  }

  .toolbar__button:is(:focus, :hover):is(
      [aria-disabled="true"]:not([part~="toolbar__button--active"])
    ) {
    outline: transparent;
    color: var(--rhino-button-disabled-text-color);
    border-color: var(--rhino-button-disabled-border-color);
    box-shadow: 0 0 0 1px var(--rhino-button-disabled-border-color);
  }

  :host::part(toolbar__button--active),
  :host::part(toolbar__button--active):is(:hover, :focus) {
    background-color: var(--rhino-button-active-background-color);
  }

  :host::part(toolbar__button--link),
  :host::part(toolbar__button--ordered-list) {
    margin-inline-end: 1rem;
  }

  :host::part(toolbar__button--attach-files) {
    margin-inline-end: auto;
  }

  .link-dialog {
    position: absolute;
    z-index: 1;
    height: 100%;
    width: 100%;
    padding: 1px;
  }

  .link-dialog__container {
    display: flex;
    align-items: center;
    background: white;
    box-shadow: 0 0.3em 1em #ccc;
    max-width: 600px;
    padding: 0.75rem 0.4rem;
    border-radius: 8px;
    border-top: 2px solid var(--rhino-border-color);
  }

  .link-dialog__input {
    border: 1px solid var(--rhino-border-color);
    border-radius: var(--rhino-border-radius);
    padding: 0.4em 0.6em;
    flex: 1 1 auto;
  }

  .link-dialog__input:is(:focus) {
    outline: transparent;
    box-shadow: var(--rhino-focus-ring);
    border-color: var(--rhino-button-active-border-color);
  }

  .link-validate:invalid {
    outline: transparent;
    background-color: var(--rhino-danger-background-color);
    border-color: var(--rhino-danger-border-color);
    box-shadow: none;
  }

  .link-dialog__button {
    padding: 0.4em 0.6em;
    border: 1px solid var(--rhino-button-border-color);
    border-radius: var(--rhino-border-radius);
  }

  .link-dialog__buttons {
    margin-right: 0.5em;
    margin-left: 0.5em;
  }

  .editor-wrapper {
    position: relative;
  }
`,Fc=Rl`
  .ProseMirror {
    position: relative;
    word-wrap: break-word;
    white-space: pre-wrap;
    white-space: break-spaces;
    -webkit-font-variant-ligatures: none;
    font-variant-ligatures: none;
    font-feature-settings: "liga" 0;
  }

  .ProseMirror [contenteditable="false"] [contenteditable="true"] {
    white-space: pre-wrap;
  }
  .ProseMirror pre {
    white-space: pre-wrap;
  }
  img.ProseMirror-separator {
    display: inline !important;
    border: none !important;
    margin: 0 !important;
    width: 1px !important;
    height: 1px !important;
  }
  .ProseMirror-gapcursor {
    display: none;
    pointer-events: none;
    position: absolute;
    margin: 0;
    min-width: 1px;
  }
  .ProseMirror-gapcursor:after {
    content: "";
    display: block;
    position: absolute;
    top: -2px;
    width: 20px;
    border-top: 1px solid black;
    animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
  }
  @keyframes ProseMirror-cursor-blink {
    to {
      visibility: hidden;
    }
  }
  .ProseMirror-hideselection *::selection {
    background: transparent;
  }
  .ProseMirror-hideselection *::-moz-selection {
    background: transparent;
  }
  .ProseMirror-hideselection * {
    caret-color: transparent;
  }
  .ProseMirror-focused .ProseMirror-gapcursor {
    display: block;
  }
  .tippy-box[data-animation="fade"][data-state="hidden"] {
    opacity: 0;
  }
`;function Bc(){const t=window.crypto||window.msCrypto;return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^t.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}var jc=class{constructor(t,e){this.editorView=e,this.attributes={attachmentId:Bc(),content:null,imageId:Bc(),sgid:null,url:null,...t}}setUploadProgress(t){null==this.content&&this.setNodeMarkup({progress:t})}setAttributes(t){if(this.attributes.sgid=t.sgid,null==t.content&&t.url){const e=new Image;return this.attributes.url=t.url,e.src=t.url,void(e.onload=()=>{this.setNodeMarkup({sgid:this.attributes.sgid,url:this.attributes.url,src:this.attributes.url,href:this.attributes.url+"?content-disposition=attachment"}),e.remove()})}this.setNodeMarkup({sgid:this.attributes.sgid,content:this.attributes.content})}setNodeMarkup(t){const e=this.editorView;null!=e&&e.state.doc.descendants(((n,i)=>{n.attrs.attachmentId===this.attachmentId&&e.dispatch(e.state.tr.setNodeMarkup(i,void 0,{...n.attrs,...t}))}))}get attachmentId(){return this.attributes.attachmentId}get imageId(){return this.attributes.imageId}get src(){return this.attributes.src}set src(t){this.attributes.src=t}get sgid(){return this.attributes.sgid}get file(){return this.attributes.file}get contentType(){return this.file?.type}get fileName(){return this.file?.name}get fileSize(){return this.file?.size}get content(){return this.attributes.content}set content(t){this.attributes.content=t}get caption(){return Lo({fileName:this.fileName,fileSize:this.fileSize})}},Hc={exports:{}};Hc.exports=function(t){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],i=t[1],r=t[2],s=t[3];i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[0]-680876936|0)<<7|n>>>25)+i|0)&i|~n&r)+e[1]-389564586|0)<<12|s>>>20)+n|0)&n|~s&i)+e[2]+606105819|0)<<17|r>>>15)+s|0)&s|~r&n)+e[3]-1044525330|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[4]-176418897|0)<<7|n>>>25)+i|0)&i|~n&r)+e[5]+1200080426|0)<<12|s>>>20)+n|0)&n|~s&i)+e[6]-1473231341|0)<<17|r>>>15)+s|0)&s|~r&n)+e[7]-45705983|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[8]+1770035416|0)<<7|n>>>25)+i|0)&i|~n&r)+e[9]-1958414417|0)<<12|s>>>20)+n|0)&n|~s&i)+e[10]-42063|0)<<17|r>>>15)+s|0)&s|~r&n)+e[11]-1990404162|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&r|~i&s)+e[12]+1804603682|0)<<7|n>>>25)+i|0)&i|~n&r)+e[13]-40341101|0)<<12|s>>>20)+n|0)&n|~s&i)+e[14]-1502002290|0)<<17|r>>>15)+s|0)&s|~r&n)+e[15]+1236535329|0)<<22|i>>>10)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[1]-165796510|0)<<5|n>>>27)+i|0)&r|i&~r)+e[6]-1069501632|0)<<9|s>>>23)+n|0)&i|n&~i)+e[11]+643717713|0)<<14|r>>>18)+s|0)&n|s&~n)+e[0]-373897302|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[5]-701558691|0)<<5|n>>>27)+i|0)&r|i&~r)+e[10]+38016083|0)<<9|s>>>23)+n|0)&i|n&~i)+e[15]-660478335|0)<<14|r>>>18)+s|0)&n|s&~n)+e[4]-405537848|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[9]+568446438|0)<<5|n>>>27)+i|0)&r|i&~r)+e[14]-1019803690|0)<<9|s>>>23)+n|0)&i|n&~i)+e[3]-187363961|0)<<14|r>>>18)+s|0)&n|s&~n)+e[8]+1163531501|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i&s|r&~s)+e[13]-1444681467|0)<<5|n>>>27)+i|0)&r|i&~r)+e[2]-51403784|0)<<9|s>>>23)+n|0)&i|n&~i)+e[7]+1735328473|0)<<14|r>>>18)+s|0)&n|s&~n)+e[12]-1926607734|0)<<20|i>>>12)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[5]-378558|0)<<4|n>>>28)+i|0)^i^r)+e[8]-2022574463|0)<<11|s>>>21)+n|0)^n^i)+e[11]+1839030562|0)<<16|r>>>16)+s|0)^s^n)+e[14]-35309556|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[1]-1530992060|0)<<4|n>>>28)+i|0)^i^r)+e[4]+1272893353|0)<<11|s>>>21)+n|0)^n^i)+e[7]-155497632|0)<<16|r>>>16)+s|0)^s^n)+e[10]-1094730640|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[13]+681279174|0)<<4|n>>>28)+i|0)^i^r)+e[0]-358537222|0)<<11|s>>>21)+n|0)^n^i)+e[3]-722521979|0)<<16|r>>>16)+s|0)^s^n)+e[6]+76029189|0)<<23|i>>>9)+r|0,i=((i+=((r=((r+=((s=((s+=((n=((n+=(i^r^s)+e[9]-640364487|0)<<4|n>>>28)+i|0)^i^r)+e[12]-421815835|0)<<11|s>>>21)+n|0)^n^i)+e[15]+530742520|0)<<16|r>>>16)+s|0)^s^n)+e[2]-995338651|0)<<23|i>>>9)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[0]-198630844|0)<<6|n>>>26)+i|0)|~r))+e[7]+1126891415|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[14]-1416354905|0)<<15|r>>>17)+s|0)|~n))+e[5]-57434055|0)<<21|i>>>11)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[12]+1700485571|0)<<6|n>>>26)+i|0)|~r))+e[3]-1894986606|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[10]-1051523|0)<<15|r>>>17)+s|0)|~n))+e[1]-2054922799|0)<<21|i>>>11)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[8]+1873313359|0)<<6|n>>>26)+i|0)|~r))+e[15]-30611744|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[6]-1560198380|0)<<15|r>>>17)+s|0)|~n))+e[13]+1309151649|0)<<21|i>>>11)+r|0,i=((i+=((s=((s+=(i^((n=((n+=(r^(i|~s))+e[4]-145523070|0)<<6|n>>>26)+i|0)|~r))+e[11]-1120210379|0)<<10|s>>>22)+n|0)^((r=((r+=(n^(s|~i))+e[2]+718787259|0)<<15|r>>>17)+s|0)|~n))+e[9]-343485551|0)<<21|i>>>11)+r|0,t[0]=n+t[0]|0,t[1]=i+t[1]|0,t[2]=r+t[2]|0,t[3]=s+t[3]|0}function i(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function r(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function s(t){var e,r,s,o,a,l,c=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(d,i(t.substring(e-64,e)));for(r=(t=t.substring(e-64)).length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(n(d,s),e=0;e<16;e+=1)s[e]=0;return o=(o=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(o[2],16),l=parseInt(o[1],16)||0,s[14]=a,s[15]=l,n(d,s),d}function o(t){var e,i,s,o,a,l,c=t.length,d=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(d,r(t.subarray(e-64,e)));for(i=(t=e-64<c?t.subarray(e-64):new Uint8Array(0)).length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)s[e>>2]|=t[e]<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(n(d,s),e=0;e<16;e+=1)s[e]=0;return o=(o=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(o[2],16),l=parseInt(o[1],16)||0,s[14]=a,s[15]=l,n(d,s),d}function a(t){var n,i="";for(n=0;n<4;n+=1)i+=e[t>>8*n+4&15]+e[t>>8*n&15];return i}function l(t){var e;for(e=0;e<t.length;e+=1)t[e]=a(t[e]);return t.join("")}function c(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function d(t,e){var n,i=t.length,r=new ArrayBuffer(i),s=new Uint8Array(r);for(n=0;n<i;n+=1)s[n]=t.charCodeAt(n);return e?s:r}function h(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function u(t,e,n){var i=new Uint8Array(t.byteLength+e.byteLength);return i.set(new Uint8Array(t)),i.set(new Uint8Array(e),t.byteLength),n?i:i.buffer}function p(t){var e,n=[],i=t.length;for(e=0;e<i-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function f(){this.reset()}return l(s("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,i){var r,s,o,a,l=this.byteLength,c=e(n,l),d=l;return i!==t&&(d=e(i,l)),c>d?new ArrayBuffer(0):(r=d-c,s=new ArrayBuffer(r),o=new Uint8Array(s),a=new Uint8Array(this,c,r),o.set(a),s)}}(),f.prototype.append=function(t){return this.appendBinary(c(t)),this},f.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,r=this._buff.length;for(e=64;e<=r;e+=64)n(this._hash,i(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},f.prototype.end=function(t){var e,n,i=this._buff,r=i.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)s[e>>2]|=i.charCodeAt(e)<<(e%4<<3);return this._finish(s,r),n=l(this._hash),t&&(n=p(n)),this.reset(),n},f.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},f.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},f.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},f.prototype._finish=function(t,e){var i,r,s,o=e;if(t[o>>2]|=128<<(o%4<<3),o>55)for(n(this._hash,t),o=0;o<16;o+=1)t[o]=0;i=(i=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(i[2],16),s=parseInt(i[1],16)||0,t[14]=r,t[15]=s,n(this._hash,t)},f.hash=function(t,e){return f.hashBinary(c(t),e)},f.hashBinary=function(t,e){var n=l(s(t));return e?p(n):n},f.ArrayBuffer=function(){this.reset()},f.ArrayBuffer.prototype.append=function(t){var e,i=u(this._buff.buffer,t,!0),s=i.length;for(this._length+=t.byteLength,e=64;e<=s;e+=64)n(this._hash,r(i.subarray(e-64,e)));return this._buff=e-64<s?new Uint8Array(i.buffer.slice(e-64)):new Uint8Array(0),this},f.ArrayBuffer.prototype.end=function(t){var e,n,i=this._buff,r=i.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)s[e>>2]|=i[e]<<(e%4<<3);return this._finish(s,r),n=l(this._hash),t&&(n=p(n)),this.reset(),n},f.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.ArrayBuffer.prototype.getState=function(){var t=f.prototype.getState.call(this);return t.buff=h(t.buff),t},f.ArrayBuffer.prototype.setState=function(t){return t.buff=d(t.buff,!0),f.prototype.setState.call(this,t)},f.ArrayBuffer.prototype.destroy=f.prototype.destroy,f.ArrayBuffer.prototype._finish=f.prototype._finish,f.ArrayBuffer.hash=function(t,e){var n=l(o(new Uint8Array(t)));return e?p(n):n},f}();var zc=Hc.exports;const Vc=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;class qc{static create(t,e){new qc(t).create(e)}constructor(t){this.file=t,this.chunkSize=2097152,this.chunkCount=Math.ceil(this.file.size/this.chunkSize),this.chunkIndex=0}create(t){this.callback=t,this.md5Buffer=new zc.ArrayBuffer,this.fileReader=new FileReader,this.fileReader.addEventListener("load",(t=>this.fileReaderDidLoad(t))),this.fileReader.addEventListener("error",(t=>this.fileReaderDidError(t))),this.readNextChunk()}fileReaderDidLoad(t){if(this.md5Buffer.append(t.target.result),!this.readNextChunk()){const t=this.md5Buffer.end(!0),e=btoa(t);this.callback(null,e)}}fileReaderDidError(t){this.callback(`Error reading ${this.file.name}`)}readNextChunk(){if(this.chunkIndex<this.chunkCount||0==this.chunkIndex&&0==this.chunkCount){const t=this.chunkIndex*this.chunkSize,e=Math.min(t+this.chunkSize,this.file.size),n=Vc.call(this.file,t,e);return this.fileReader.readAsArrayBuffer(n),this.chunkIndex++,!0}return!1}}function Uc(t,e){return"string"==typeof t&&(e=t,t=document),t.querySelector(e)}function Wc(t,e,n={}){const{disabled:i}=t,{bubbles:r,cancelable:s,detail:o}=n,a=document.createEvent("Event");a.initEvent(e,r||!0,s||!0),a.detail=o||{};try{t.disabled=!1,t.dispatchEvent(a)}finally{t.disabled=i}return a}function Kc(t){return Array.isArray(t)?t:Array.from?Array.from(t):[].slice.call(t)}class Yc{constructor(t,e,n){this.file=t,this.attributes={filename:t.name,content_type:t.type||"application/octet-stream",byte_size:t.size,checksum:e},this.xhr=new XMLHttpRequest,this.xhr.open("POST",n,!0),this.xhr.responseType="json",this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("Accept","application/json"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");const i=function(t){const e=Uc(document.head,`meta[name="${t}"]`);if(e)return e.getAttribute("content")}("csrf-token");null!=i&&this.xhr.setRequestHeader("X-CSRF-Token",i),this.xhr.addEventListener("load",(t=>this.requestDidLoad(t))),this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}get status(){return this.xhr.status}get response(){const{responseType:t,response:e}=this.xhr;return"json"==t?e:JSON.parse(e)}create(t){this.callback=t,this.xhr.send(JSON.stringify({blob:this.attributes}))}requestDidLoad(t){if(this.status>=200&&this.status<300){const{response:t}=this,{direct_upload:e}=t;delete t.direct_upload,this.attributes=t,this.directUploadData=e,this.callback(null,this.toJSON())}else this.requestDidError(t)}requestDidError(t){this.callback(`Error creating Blob for "${this.file.name}". Status: ${this.status}`)}toJSON(){const t={};for(const e in this.attributes)t[e]=this.attributes[e];return t}}class Jc{constructor(t){this.blob=t,this.file=t.file;const{url:e,headers:n}=t.directUploadData;this.xhr=new XMLHttpRequest,this.xhr.open("PUT",e,!0),this.xhr.responseType="text";for(const t in n)this.xhr.setRequestHeader(t,n[t]);this.xhr.addEventListener("load",(t=>this.requestDidLoad(t))),this.xhr.addEventListener("error",(t=>this.requestDidError(t)))}create(t){this.callback=t,this.xhr.send(this.file.slice())}requestDidLoad(t){const{status:e,response:n}=this.xhr;e>=200&&e<300?this.callback(null,n):this.requestDidError(t)}requestDidError(t){this.callback(`Error storing "${this.file.name}". Status: ${this.xhr.status}`)}}let Gc=0;class Xc{constructor(t,e,n){this.id=++Gc,this.file=t,this.url=e,this.delegate=n}create(t){qc.create(this.file,((e,n)=>{if(e)return void t(e);const i=new Yc(this.file,n,this.url);Qc(this.delegate,"directUploadWillCreateBlobWithXHR",i.xhr),i.create((e=>{if(e)t(e);else{const e=new Jc(i);Qc(this.delegate,"directUploadWillStoreFileWithXHR",e.xhr),e.create((e=>{e?t(e):t(null,i.toJSON())}))}}))}))}}function Qc(t,e,...n){if(t&&"function"==typeof t[e])return t[e](...n)}class Zc{constructor(t,e){this.input=t,this.file=e,this.directUpload=new Xc(this.file,this.url,this),this.dispatch("initialize")}start(t){const e=document.createElement("input");e.type="hidden",e.name=this.input.name,this.input.insertAdjacentElement("beforebegin",e),this.dispatch("start"),this.directUpload.create(((n,i)=>{n?(e.parentNode.removeChild(e),this.dispatchError(n)):e.value=i.signed_id,this.dispatch("end"),t(n)}))}uploadRequestDidProgress(t){const e=t.loaded/t.total*100;e&&this.dispatch("progress",{progress:e})}get url(){return this.input.getAttribute("data-direct-upload-url")}dispatch(t,e={}){return e.file=this.file,e.id=this.directUpload.id,Wc(this.input,`direct-upload:${t}`,{detail:e})}dispatchError(t){this.dispatch("error",{error:t}).defaultPrevented||alert(t)}directUploadWillCreateBlobWithXHR(t){this.dispatch("before-blob-request",{xhr:t})}directUploadWillStoreFileWithXHR(t){this.dispatch("before-storage-request",{xhr:t}),t.upload.addEventListener("progress",(t=>this.uploadRequestDidProgress(t)))}}class td{constructor(t){this.form=t,this.inputs=function(t,e){return"string"==typeof t&&(e=t,t=document),Kc(t.querySelectorAll(e))}(t,"input[type=file][data-direct-upload-url]:not([disabled])").filter((t=>t.files.length))}start(t){const e=this.createDirectUploadControllers(),n=()=>{const i=e.shift();i?i.start((e=>{e?(t(e),this.dispatch("end")):n()})):(t(),this.dispatch("end"))};this.dispatch("start"),n()}createDirectUploadControllers(){const t=[];return this.inputs.forEach((e=>{Kc(e.files).forEach((n=>{const i=new Zc(e,n);t.push(i)}))})),t}dispatch(t,e={}){return Wc(this.form,`direct-uploads:${t}`,{detail:e})}}const ed="data-direct-uploads-processing",nd=new WeakMap;let id=!1;function rd(t){const{target:e}=t;"INPUT"!=e.tagName&&"BUTTON"!=e.tagName||"submit"!=e.type||!e.form||nd.set(e.form,e)}function sd(t){ad(t)}function od(t){"FORM"==t.target.tagName&&ad(t)}function ad(t){const e=t.target;if(e.hasAttribute(ed))return void t.preventDefault();const n=new td(e),{inputs:i}=n;i.length&&(t.preventDefault(),e.setAttribute(ed,""),i.forEach(ld),n.start((t=>{e.removeAttribute(ed),t?i.forEach(cd):function(t){let e=nd.get(t)||Uc(t,"input[type=submit], button[type=submit]");if(e){const{disabled:t}=e;e.disabled=!1,e.focus(),e.click(),e.disabled=t}else e=document.createElement("input"),e.type="submit",e.style.display="none",t.appendChild(e),e.click(),t.removeChild(e);nd.delete(t)}(e)})))}function ld(t){t.disabled=!0}function cd(t){t.disabled=!1}setTimeout((function(){window.ActiveStorage&&(id||(id=!0,document.addEventListener("click",rd,!0),document.addEventListener("submit",sd,!0),document.addEventListener("ajax:before",od)))}),1);var dd=Rl`
  [hidden] {
    display: none !important;
  }

  *,
  *::after,
  *::before {
    box-sizing: border-box;
  }

  button {
    background-color: inherit;
    border: none;
    color: inherit;
    cursor: pointer;
  }
`,hd=Object.defineProperty,ud=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},pd=(t,e,n)=>(ud(t,e,"read from private field"),n?n.call(t):e.get(t)),fd=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},md=(t,e,n)=>(ud(t,e,"access private method"),n),gd={};function bd(t,e=24){return mc`<svg
    xmlns="http://www.w3.org/2000/svg"
    aria-hidden="true"
    fill="currentColor"
    viewBox="0 0 ${e} ${e}"
    width="${e}"
    height="${e}"
    part="toolbar__icon"
  >
    ${t}
  </svg>`}((t,e)=>{for(var n in e)hd(t,n,{get:e[n],enumerable:!0})})(gd,{attachFiles:()=>Ad,blockQuote:()=>xd,bold:()=>vd,bulletList:()=>Cd,close:()=>Md,codeBlock:()=>Ed,heading:()=>Sd,italics:()=>yd,link:()=>kd,orderedList:()=>_d,redo:()=>Td,strike:()=>wd,undo:()=>Od});var vd=bd(gc`<path fill-rule="evenodd" d="M6 4.75c0-.69.56-1.25 1.25-1.25h5a4.75 4.75 0 013.888 7.479A5 5 0 0114 20.5H7.25c-.69 0-1.25-.56-1.25-1.25V4.75zM8.5 13v5H14a2.5 2.5 0 000-5H8.5zm0-2.5h3.751A2.25 2.25 0 0012.25 6H8.5v4.5z"></path>`),yd=bd(gc`<path fill-rule="evenodd" d="M10 4.75a.75.75 0 01.75-.75h8.5a.75.75 0 010 1.5h-3.514l-5.828 13h3.342a.75.75 0 010 1.5h-8.5a.75.75 0 010-1.5h3.514l5.828-13H10.75a.75.75 0 01-.75-.75z"></path>`),wd=bd(gc`<path fill-rule="evenodd" d="M12.36 5C9.37 5 8.105 6.613 8.105 7.848c0 .411.072.744.193 1.02a.75.75 0 01-1.373.603 3.993 3.993 0 01-.32-1.623c0-2.363 2.271-4.348 5.755-4.348 1.931 0 3.722.794 4.814 1.5a.75.75 0 11-.814 1.26c-.94-.607-2.448-1.26-4-1.26zm4.173 7.5h3.717a.75.75 0 000-1.5H3.75a.75.75 0 000 1.5h9.136c1.162.28 2.111.688 2.76 1.211.642.518.979 1.134.979 1.898a2.63 2.63 0 01-.954 2.036c-.703.601-1.934 1.105-3.999 1.105-2.018 0-3.529-.723-4.276-1.445a.75.75 0 10-1.042 1.08c1.066 1.028 2.968 1.865 5.318 1.865 2.295 0 3.916-.56 4.974-1.464a4.131 4.131 0 001.479-3.177c0-1.296-.608-2.316-1.538-3.066a5.77 5.77 0 00-.054-.043z"></path>`),kd=bd(gc`<path d="M14.78 3.653a3.936 3.936 0 115.567 5.567l-3.627 3.627a3.936 3.936 0 01-5.88-.353.75.75 0 00-1.18.928 5.436 5.436 0 008.12.486l3.628-3.628a5.436 5.436 0 10-7.688-7.688l-3 3a.75.75 0 001.06 1.061l3-3z"></path> <path d="M7.28 11.153a3.936 3.936 0 015.88.353.75.75 0 001.18-.928 5.436 5.436 0 00-8.12-.486L2.592 13.72a5.436 5.436 0 107.688 7.688l3-3a.75.75 0 10-1.06-1.06l-3 3a3.936 3.936 0 01-5.567-5.568l3.627-3.627z"></path>`),Sd=bd(gc`<path fill-rule="evenodd" d="M6.25 4a.75.75 0 01.75.75V11h10V4.75a.75.75 0 011.5 0v14.5a.75.75 0 01-1.5 0V12.5H7v6.75a.75.75 0 01-1.5 0V4.75A.75.75 0 016.25 4z"></path>`),xd=bd(gc`<path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z" /> <path d="M7.066 6.76A1.665 1.665 0 0 0 4 7.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 0 0 .6.58c1.486-1.54 1.293-3.214.682-4.112zm4 0A1.665 1.665 0 0 0 8 7.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 0 0 .6.58c1.486-1.54 1.293-3.214.682-4.112z" />`,16),Ed=bd(gc`<path fill-rule="evenodd" d="M8.78 4.97a.75.75 0 010 1.06L2.81 12l5.97 5.97a.75.75 0 11-1.06 1.06l-6.5-6.5a.75.75 0 010-1.06l6.5-6.5a.75.75 0 011.06 0zm6.44 0a.75.75 0 000 1.06L21.19 12l-5.97 5.97a.75.75 0 101.06 1.06l6.5-6.5a.75.75 0 000-1.06l-6.5-6.5a.75.75 0 00-1.06 0z"></path>`),Cd=bd(gc`<path fill-rule="evenodd" d="M4 7a1 1 0 100-2 1 1 0 000 2zm4.75-1.5a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H8.75zm0 6a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H8.75zm0 6a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H8.75zM5 12a1 1 0 11-2 0 1 1 0 012 0zm-1 7a1 1 0 100-2 1 1 0 000 2z"></path>`),_d=bd(gc`<path
    d="M3.604 3.089A.75.75 0 014 3.75V8.5h.75a.75.75 0 010 1.5h-3a.75.75 0 110-1.5h.75V5.151l-.334.223a.75.75 0 01-.832-1.248l1.5-1a.75.75 0 01.77-.037zM8.75 5.5a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H8.75zm0 6a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H8.75zm0 6a.75.75 0 000 1.5h11.5a.75.75 0 000-1.5H8.75zM5.5 15.75c0-.704-.271-1.286-.72-1.686a2.302 2.302 0 00-1.53-.564c-.535 0-1.094.178-1.53.565-.449.399-.72.982-.72 1.685a.75.75 0 001.5 0c0-.296.104-.464.217-.564A.805.805 0 013.25 15c.215 0 .406.072.533.185.113.101.217.268.217.565 0 .332-.069.48-.21.657-.092.113-.216.24-.403.419l-.147.14c-.152.144-.33.313-.52.504l-1.5 1.5a.75.75 0 00-.22.53v.25c0 .414.336.75.75.75H5A.75.75 0 005 19H3.31l.47-.47c.176-.176.333-.324.48-.465l.165-.156a5.98 5.98 0 00.536-.566c.358-.447.539-.925.539-1.593z"></path>`),Ad=bd(gc`<path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z" />`,16),Od=bd(gc`<path fill-rule="evenodd" d="M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5z" />`,16),Td=bd(gc`<path fill-rule="evenodd" d="M1.5 1.5A.5.5 0 0 0 1 2v4.8a2.5 2.5 0 0 0 2.5 2.5h9.793l-3.347 3.346a.5.5 0 0 0 .708.708l4.2-4.2a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 8.3H3.5A1.5 1.5 0 0 1 2 6.8V2a.5.5 0 0 0-.5-.5z" />`,16),Md=bd(gc`<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />`,16),Dd=class extends Pc{static define(t,e,n){var i;(null==t&&(t=this.baseName),null==e&&(e=this),this.customElementRegistry.get(t))||this.customElementRegistry.define(t,(i=e,class extends i{}),n)}};Dd.customElementRegistry=window.customElements;var Ld=class extends Dd{close(){return mc`${Md}`}static get properties(){return{fileName:{attribute:"file-name",type:String},fileSize:{attribute:"file-size",type:Number},progress:{type:Number},class:{attribute:"class",type:String}}}connectedCallback(){super.connectedCallback(),this.classList.add("rhino-attachment-editor")}static get styles(){return Rl`
      ${dd}

      :host {
        position: absolute;
        width: 100%;
        pointer-events: none;
        top: 0;
        left: 0;
        height: 100%;
        z-index: 0;
      }

      button {
        background-color: white;
        border: 1px solid var(--rhino-button-active-border-color);
        border-radius: 9999px;
        display: flex;
        align-items: center;
        padding: 0.15rem;
        position: absolute;
        top: 0;
        left: 50%;
        transform: translate(0, -50%);
        pointer-events: all;
      }

      button svg {
        height: 1.5rem;
        width: 1.5rem;
      }

      button:is(:focus, :hover):not([aria-disabled="true"], :disabled) {
        outline: transparent;
        background-color: rgb(240, 240, 240);
      }

      .file-metadata {
        position: absolute;
        left: 50%;
        top: 2em;
        transform: translate(-50%, 0);
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
        text-align: center;
        max-width: 90%;
        padding: 0.4rem 0.6rem;
        outline: 1px solid white;
        font-size: 0.8rem;
        color: #fff;
        background-color: hsla(0 0% 0% / 70%);
        border-radius: 3px;
      }

      .file-name {
        display: inline-block;
        max-width: 100%;
        vertical-align: bottom;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .file-size {
        margin-left: 0.2em;
        white-space: nowrap;
      }

      .file-progress {
        position: absolute;
        z-index: 1;
        height: 20px;
        top: calc(50% - 10px);
        left: 5%;
        padding: 0;
        margin: 0;
        width: 90%;
        opacity: 0.9;
        transition: opacity 200ms ease-out;
      }

      .file-progress[value="100"] {
        opacity: 0;
      }
    `}toFileSize(){return this.fileSize?Do(this.fileSize):""}render(){return mc`
      <button
        class="delete-button"
        part="delete-button"
        @pointerdown=${t=>{t.preventDefault(),this.parentElement?.remove()}}
      >
        ${this.close()}
      </button>

      <span
        part="file-metadata"
        class="file-metadata"
        ?hidden=${!(this.fileName||this.toFileSize())}
      >
        <span class="file-name" part="file-name">${this.fileName}</span>
        <span class="file-size" part="file-size">${this.toFileSize()}</span>
      </span>
      <progress
        class="file-progress"
        part="file-progress"
        value=${this.progress||0}
        min="0"
        max="100"
      ></progress>
    `}};Ld.baseName="rhino-attachment-editor";const Nd=/^\s*>\s$/,Id=wo.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:t}){return["blockquote",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[vo({find:Nd,type:this.type})]}}),Pd=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,$d=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Rd=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Fd=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Bd=yo.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],renderHTML({HTMLAttributes:t}){return["strong",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[go({find:Pd,type:this.type}),go({find:Rd,type:this.type})]},addPasteRules(){return[ko({find:$d,type:this.type}),ko({find:Fd,type:this.type})]}}),jd=wo.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",ds(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Hd=yo.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:t=>!!t.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:t}){return["span",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=Xs(t,this.type);return!!Object.entries(n).some((([,t])=>!!t))||e.unsetMark(this.name)}}}}),zd=/^\s*([-+*])\s$/,Vd=wo.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:t}){return["ul",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(jd.name,this.editor.getAttributes(Hd.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=vo({find:zd,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=vo({find:zd,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Hd.name),editor:this.editor})),[t]}}),qd=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Ud=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Wd=yo.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:t}){return["code",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[go({find:qd,type:this.type})]},addPasteRules(){return[ko({find:Ud,type:this.type})]}}),Kd=/^```([a-z]+)?[\s\n]$/,Yd=/^~~~([a-z]+)?[\s\n]$/,Jd=wo.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,i=[...(null===(e=t.firstElementChild)||void 0===e?void 0:e.classList)||[]].filter((t=>t.startsWith(n))).map((t=>t.replace(n,"")))[0];return i||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:t,HTMLAttributes:e}){return["pre",ds(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=1===e.pos;return!(!t||e.parent.type.name!==this.name)&&(!(!n&&e.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:i,empty:r}=n;if(!r||i.parent.type!==this.type)return!1;const s=i.parentOffset===i.parent.nodeSize-2,o=i.parent.textContent.endsWith("\n\n");return!(!s||!o)&&t.chain().command((({tr:t})=>(t.delete(i.pos-2,i.pos),!0))).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:i}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;if(!(r.parentOffset===r.parent.nodeSize-2))return!1;const o=r.after();if(void 0===o)return!1;return!i.nodeAt(o)&&t.commands.exitCode()}}},addInputRules(){return[bo({find:Kd,type:this.type,getAttributes:t=>({language:t[1]})}),bo({find:Yd,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new ke({key:new Ee("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),i=e.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,s=null==r?void 0:r.mode;if(!n||!s)return!1;const{tr:o}=t.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(oe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(n.replace(/\r\n?/g,"\n")),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),Gd=wo.create({name:"doc",topNode:!0,content:"block+"});function Xd(t={}){return new ke({view:e=>new Qd(e,t)})}class Qd{constructor(t,e){var n;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=e.width)&&void 0!==n?n:1,this.color=!1===e.color?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map((e=>{let n=t=>{this[e](t)};return t.dom.addEventListener(e,n),{name:e,handler:n}}))}destroy(){this.handlers.forEach((({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e)))}update(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t,e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent;if(n){let n=e.nodeBefore,i=e.nodeAfter;if(n||i){let e=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(e){let r=e.getBoundingClientRect(),s=n?r.bottom:r.top;n&&i&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:r.left,right:r.right,top:s-this.width/2,bottom:s+this.width/2}}}}if(!t){let e=this.editorView.coordsAtPos(this.cursorPos);t={left:e.left-this.width/2,right:e.left+this.width/2,top:e.top,bottom:e.bottom}}let i,r,s=this.editorView.dom.offsetParent;if(this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!s||s==document.body&&"static"==getComputedStyle(s).position)i=-pageXOffset,r=-pageYOffset;else{let t=s.getBoundingClientRect();i=t.left-s.scrollLeft,r=t.top-s.scrollTop}this.element.style.left=t.left-i+"px",this.element.style.top=t.top-r+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout((()=>this.setCursor(null)),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),n=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),i=n&&n.type.spec.disableDropCursor,r="function"==typeof i?i(this.editorView,e,t):i;if(e&&!r){let t=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let e=jt(this.editorView.state.doc,t,this.editorView.dragging.slice);null!=e&&(t=e)}this.setCursor(t),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}const Zd=Ms.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[Xd(this.options)]}});class th extends ne{constructor(t){super(t,t)}map(t,e){let n=t.resolve(e.map(this.head));return th.valid(n)?new th(n):ne.near(n)}content(){return f.empty}eq(t){return t instanceof th&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new th(t.resolve(e.pos))}getBookmark(){return new eh(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!function(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),i=t.node(e);if(0!=n)for(let t=i.child(n-1);;t=t.lastChild){if(0==t.childCount&&!t.inlineContent||t.isAtom||t.type.spec.isolating)return!0;if(t.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(t)||!function(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),i=t.node(e);if(n!=i.childCount)for(let t=i.child(n);;t=t.firstChild){if(0==t.childCount&&!t.inlineContent||t.isAtom||t.type.spec.isolating)return!0;if(t.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(t))return!1;let n=e.type.spec.allowGapCursor;if(null!=n)return n;let i=e.contentMatchAt(t.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(t,e,n=!1){t:for(;;){if(!n&&th.valid(t))return t;let i=t.pos,r=null;for(let n=t.depth;;n--){let s=t.node(n);if(e>0?t.indexAfter(n)<s.childCount:t.index(n)>0){r=s.child(e>0?t.indexAfter(n):t.index(n)-1);break}if(0==n)return null;i+=e;let o=t.doc.resolve(i);if(th.valid(o))return o}for(;;){let s=e>0?r.firstChild:r.lastChild;if(!s){if(r.isAtom&&!r.isText&&!le.isSelectable(r)){t=t.doc.resolve(i+r.nodeSize*e),n=!1;continue t}break}r=s,i+=e;let o=t.doc.resolve(i);if(th.valid(o))return o}return null}}}th.prototype.visible=!1,th.findFrom=th.findGapCursorFrom,ne.jsonID("gapcursor",th);class eh{constructor(t){this.pos=t}map(t){return new eh(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return th.valid(e)?new th(e):ne.near(e)}}const nh=qr({ArrowLeft:ih("horiz",-1),ArrowRight:ih("horiz",1),ArrowUp:ih("vert",-1),ArrowDown:ih("vert",1)});function ih(t,e){const n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,i,r){let s=t.selection,o=e>0?s.$to:s.$from,a=s.empty;if(s instanceof oe){if(!r.endOfTextblock(n)||0==o.depth)return!1;a=!1,o=t.doc.resolve(e>0?o.after():o.before())}let l=th.findGapCursorFrom(o,e,a);return!!l&&(i&&i(t.tr.setSelection(new th(l))),!0)}}function rh(t,e,n){if(!t||!t.editable)return!1;let i=t.state.doc.resolve(e);if(!th.valid(i))return!1;let r=t.posAtCoords({left:n.clientX,top:n.clientY});return!(r&&r.inside>-1&&le.isSelectable(t.state.doc.nodeAt(r.inside)))&&(t.dispatch(t.state.tr.setSelection(new th(i))),!0)}function sh(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof th))return!1;let{$from:n}=t.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!i)return!1;let r=l.empty;for(let t=i.length-1;t>=0;t--)r=l.from(i[t].createAndFill(null,r));let s=t.state.tr.replace(n.pos,n.pos,new f(r,0,0));return s.setSelection(oe.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function oh(t){if(!(t.selection instanceof th))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",sr.create(t.doc,[nr.widget(t.selection.head,e,{key:"gapcursor"})])}const ah=Ms.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ke({props:{decorations:oh,createSelectionBetween:(t,e,n)=>e.pos==n.pos&&th.valid(n)?new th(n):null,handleClick:rh,handleKeyDown:nh,handleDOMEvents:{beforeinput:sh}}})],extendNodeSchema(t){var e;return{allowGapCursor:null!==(e=ps(ss(t,"allowGapCursor",{name:t.name,options:t.options,storage:t.storage})))&&void 0!==e?e:null}}}),lh=wo.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:t}){return["br",ds(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:i})=>t.first([()=>t.exitCode(),()=>t.command((()=>{const{selection:t,storedMarks:r}=n;if(t.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=i.extensionManager,a=r||t.$to.parentOffset&&t.$from.marks();return e().insertContent({type:this.name}).command((({tr:t,dispatch:e})=>{if(e&&a&&s){const e=a.filter((t=>o.includes(t.type.name)));t.ensureMarks(e)}return!0})).run()}))])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),ch=wo.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map((t=>({tag:`h${t}`,attrs:{level:t}})))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,ds(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode(this.name,t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce(((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})})),{})},addInputRules(){return this.options.levels.map((t=>bo({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}})))}});var dh=200,hh=function(){};hh.prototype.append=function(t){return t.length?(t=hh.from(t),!this.length&&t||t.length<dh&&this.leafAppend(t)||this.length<dh&&t.leafPrepend(this)||this.appendInner(t)):this},hh.prototype.prepend=function(t){return t.length?hh.from(t).append(this):this},hh.prototype.appendInner=function(t){return new ph(this,t)},hh.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?hh.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},hh.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},hh.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},hh.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var i=[];return this.forEach((function(e,n){return i.push(t(e,n))}),e,n),i},hh.from=function(t){return t instanceof hh?t:t&&t.length?new uh(t):hh.empty};var uh=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,i){for(var r=e;r<n;r++)if(!1===t(this.values[r],i+r))return!1},e.prototype.forEachInvertedInner=function(t,e,n,i){for(var r=e-1;r>=n;r--)if(!1===t(this.values[r],i+r))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=dh)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=dh)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(hh);hh.empty=new uh([]);var ph=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,i){var r=this.left.length;return!(e<r&&!1===this.left.forEachInner(t,e,Math.min(n,r),i))&&(!(n>r&&!1===this.right.forEachInner(t,Math.max(e-r,0),Math.min(this.length,n)-r,i+r))&&void 0)},e.prototype.forEachInvertedInner=function(t,e,n,i){var r=this.left.length;return!(e>r&&!1===this.right.forEachInvertedInner(t,e-r,Math.max(n,r)-r,i+r))&&(!(n<r&&!1===this.left.forEachInvertedInner(t,Math.min(e,r),n,i))&&void 0)},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(hh),fh=hh;class mh{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(0==this.eventCount)return null;let n,i,r=this.items.length;for(;;r--){if(this.items.get(r-1).selection){--r;break}}e&&(n=this.remapping(r,this.items.length),i=n.maps.length);let s,o,a=t.tr,l=[],c=[];return this.items.forEach(((t,e)=>{if(!t.step)return n||(n=this.remapping(r,e+1),i=n.maps.length),i--,void c.push(t);if(n){c.push(new gh(t.map));let e,r=t.step.map(n.slice(i));r&&a.maybeStep(r).doc&&(e=a.mapping.maps[a.mapping.maps.length-1],l.push(new gh(e,void 0,void 0,l.length+c.length))),i--,e&&n.appendMap(e,i)}else a.maybeStep(t.step);return t.selection?(s=n?t.selection.map(n.slice(i)):t.selection,o=new mh(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0}),this.items.length,0),{remaining:o,transform:a,selection:s}}addTransform(t,e,n,i){let r=[],s=this.eventCount,o=this.items,a=!i&&o.length?o.get(o.length-1):null;for(let n=0;n<t.steps.length;n++){let l,c=t.steps[n].invert(t.docs[n]),d=new gh(t.mapping.maps[n],c,e);(l=a&&a.merge(d))&&(d=l,n?r.pop():o=o.slice(0,o.length-1)),r.push(d),e&&(s++,e=void 0),i||(a=d)}let l=s-n.depth;return l>vh&&(o=function(t,e){let n;return t.forEach(((t,i)=>{if(t.selection&&0==e--)return n=i,!1})),t.slice(n)}(o,l),s-=l),new mh(o.append(r),s)}remapping(t,e){let n=new wt;return this.items.forEach(((e,i)=>{let r=null!=e.mirrorOffset&&i-e.mirrorOffset>=t?n.maps.length-e.mirrorOffset:void 0;n.appendMap(e.map,r)}),t,e),n}addMaps(t){return 0==this.eventCount?this:new mh(this.items.append(t.map((t=>new gh(t)))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-e),r=t.mapping,s=t.steps.length,o=this.eventCount;this.items.forEach((t=>{t.selection&&o--}),i);let a=e;this.items.forEach((e=>{let i=r.getMirror(--a);if(null==i)return;s=Math.min(s,i);let l=r.maps[i];if(e.step){let s=t.steps[i].invert(t.docs[i]),c=e.selection&&e.selection.map(r.slice(a+1,i));c&&o++,n.push(new gh(l,s,c))}else n.push(new gh(l))}),i);let l=[];for(let t=e;t<s;t++)l.push(new gh(r.maps[t]));let c=this.items.slice(0,i).append(l).append(n),d=new mh(c,o);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-n.length)),d}emptyItemCount(){let t=0;return this.items.forEach((e=>{e.step||t++})),t}compress(t=this.items.length){let e=this.remapping(0,t),n=e.maps.length,i=[],r=0;return this.items.forEach(((s,o)=>{if(o>=t)i.push(s),s.selection&&r++;else if(s.step){let t=s.step.map(e.slice(n)),o=t&&t.getMap();if(n--,o&&e.appendMap(o,n),t){let a=s.selection&&s.selection.map(e.slice(n));a&&r++;let l,c=new gh(o.invert(),t,a),d=i.length-1;(l=i.length&&i[d].merge(c))?i[d]=l:i.push(c)}}else s.map&&n--}),this.items.length,0),new mh(fh.from(i.reverse()),r)}}mh.empty=new mh(fh.empty,0);class gh{constructor(t,e,n,i){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new gh(e.getMap().invert(),e,this.selection)}}}class bh{constructor(t,e,n,i){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=i}}const vh=20;function yh(t){let e=[];return t.forEach(((t,n,i,r)=>e.push(i,r))),e}function wh(t,e){if(!t)return null;let n=[];for(let i=0;i<t.length;i+=2){let r=e.map(t[i],1),s=e.map(t[i+1],-1);r<=s&&n.push(r,s)}return n}function kh(t,e,n,i){let r=Eh(e),s=Ch.get(e).spec.config,o=(i?t.undone:t.done).popEvent(e,r);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(i?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),s,r),c=new bh(i?l:o.remaining,i?o.remaining:l,null,0);n(o.transform.setSelection(a).setMeta(Ch,{redo:i,historyState:c}).scrollIntoView())}let Sh=!1,xh=null;function Eh(t){let e=t.plugins;if(xh!=e){Sh=!1,xh=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Sh=!0;break}}return Sh}const Ch=new Ee("history"),_h=new Ee("closeHistory");function Ah(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new ke({key:Ch,state:{init:()=>new bh(mh.empty,mh.empty,null,0),apply:(e,n,i)=>function(t,e,n,i){let r,s=n.getMeta(Ch);if(s)return s.historyState;n.getMeta(_h)&&(t=new bh(t.done,t.undone,null,0));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(o&&o.getMeta(Ch))return o.getMeta(Ch).redo?new bh(t.done.addTransform(n,void 0,i,Eh(e)),t.undone,yh(n.mapping.maps[n.steps.length-1]),t.prevTime):new bh(t.done,t.undone.addTransform(n,void 0,i,Eh(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(r=n.getMeta("rebased"))?new bh(t.done.rebased(n,r),t.undone.rebased(n,r),wh(t.prevRanges,n.mapping),t.prevTime):new bh(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),wh(t.prevRanges,n.mapping),t.prevTime);{let r=0==t.prevTime||!o&&(t.prevTime<(n.time||0)-i.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach(((t,i)=>{for(let r=0;r<e.length;r+=2)t<=e[r+1]&&i>=e[r]&&(n=!0)})),n}(n,t.prevRanges)),s=o?wh(t.prevRanges,n.mapping):yh(n.mapping.maps[n.steps.length-1]);return new bh(t.done.addTransform(n,r?e.selection.getBookmark():void 0,i,Eh(e)),mh.empty,s,n.time)}}(n,i,e,t)},config:t,props:{handleDOMEvents:{beforeinput(t,e){let n=e.inputType,i="historyUndo"==n?Oh:"historyRedo"==n?Th:null;return!!i&&(e.preventDefault(),i(t.state,t.dispatch))}}}})}const Oh=(t,e)=>{let n=Ch.getState(t);return!(!n||0==n.done.eventCount)&&(e&&kh(n,t,e,!1),!0)},Th=(t,e)=>{let n=Ch.getState(t);return!(!n||0==n.undone.eventCount)&&(e&&kh(n,t,e,!0),!0)},Mh=Ms.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:t,dispatch:e})=>Oh(t,e),redo:()=>({state:t,dispatch:e})=>Th(t,e)}),addProseMirrorPlugins(){return[Ah(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),Dh=wo.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:t}){return["hr",ds(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command((({tr:t,dispatch:e})=>{var n;if(e){const{$to:e}=t.selection,i=e.end();if(e.nodeAfter)t.setSelection(oe.create(t.doc,e.pos));else{const r=null===(n=e.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();r&&(t.insert(i,r),t.setSelection(oe.create(t.doc,i)))}t.scrollIntoView()}return!0})).run()}},addInputRules(){return[(t={find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type},new ws({find:t.find,handler:({state:e,range:n,match:i})=>{const r=ps(t.getAttributes,void 0,i)||{},{tr:s}=e,o=n.from;let a=n.to;if(i[1]){let e=o+i[0].lastIndexOf(i[1]);e>a?e=a:a=e+i[1].length;const n=i[0][i[0].length-1];s.insertText(n,o+i[0].length-1),s.replaceWith(e,a,t.type.create(r))}else i[0]&&s.replaceWith(o,a,t.type.create(r))}}))];var t}}),Lh=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Nh=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,Ih=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Ph=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,$h=yo.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:t}){return["em",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[go({find:Lh,type:this.type}),go({find:Ih,type:this.type})]},addPasteRules(){return[ko({find:Nh,type:this.type}),ko({find:Ph,type:this.type})]}}),Rh=wo.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",ds(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Fh=wo.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",ds(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Bh=yo.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:t=>!!t.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:t}){return["span",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=Xs(t,this.type);return!!Object.entries(n).some((([,t])=>!!t))||e.unsetMark(this.name)}}}}),jh=/^(\d+)\.\s$/,Hh=wo.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return 1===e?["ol",ds(this.options.HTMLAttributes,n),0]:["ol",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Fh.name,this.editor.getAttributes(Bh.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=vo({find:jh,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=vo({find:jh,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Bh.name)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[t]}}),zh=wo.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",ds(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Vh=wo.create({name:"text",group:"inline"}),qh=Ms.create({name:"starterKit",addExtensions(){var t,e,n,i,r,s,o,a,l,c,d,h,u,p,f,m,g,b;const v=[];return!1!==this.options.blockquote&&v.push(Id.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bold&&v.push(Bd.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.bulletList&&v.push(Vd.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&v.push(Wd.configure(null===(i=this.options)||void 0===i?void 0:i.code)),!1!==this.options.codeBlock&&v.push(Jd.configure(null===(r=this.options)||void 0===r?void 0:r.codeBlock)),!1!==this.options.document&&v.push(Gd.configure(null===(s=this.options)||void 0===s?void 0:s.document)),!1!==this.options.dropcursor&&v.push(Zd.configure(null===(o=this.options)||void 0===o?void 0:o.dropcursor)),!1!==this.options.gapcursor&&v.push(ah.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&v.push(lh.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&v.push(ch.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&v.push(Mh.configure(null===(d=this.options)||void 0===d?void 0:d.history)),!1!==this.options.horizontalRule&&v.push(Dh.configure(null===(h=this.options)||void 0===h?void 0:h.horizontalRule)),!1!==this.options.italic&&v.push($h.configure(null===(u=this.options)||void 0===u?void 0:u.italic)),!1!==this.options.listItem&&v.push(Rh.configure(null===(p=this.options)||void 0===p?void 0:p.listItem)),!1!==this.options.orderedList&&v.push(Hh.configure(null===(f=this.options)||void 0===f?void 0:f.orderedList)),!1!==this.options.paragraph&&v.push(zh.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&v.push(To.configure(null===(g=this.options)||void 0===g?void 0:g.strike)),!1!==this.options.text&&v.push(Vh.configure(null===(b=this.options)||void 0===b?void 0:b.text)),v}}),Uh=2;class Wh{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */const Kh=(t,e)=>{var n,i;const r=t._$AN;if(void 0===r)return!1;for(const t of r)null===(i=(n=t)._$AO)||void 0===i||i.call(n,e,!1),Kh(t,e);return!0},Yh=t=>{let e,n;do{if(void 0===(e=t._$AM))break;n=e._$AN,n.delete(t),t=e}while(0===(null==n?void 0:n.size))},Jh=t=>{for(let e;e=t._$AM;t=e){let n=e._$AN;if(void 0===n)e._$AN=n=new Set;else if(n.has(t))break;n.add(t),Qh(e)}};function Gh(t){void 0!==this._$AN?(Yh(this),this._$AM=t,Jh(this)):this._$AM=t}function Xh(t,e=!1,n=0){const i=this._$AH,r=this._$AN;if(void 0!==r&&0!==r.size)if(e)if(Array.isArray(i))for(let t=n;t<i.length;t++)Kh(i[t],!1),Yh(i[t]);else null!=i&&(Kh(i,!1),Yh(i));else Kh(this,t)}const Qh=t=>{var e,n,i,r;t.type==Uh&&(null!==(e=(i=t)._$AP)&&void 0!==e||(i._$AP=Xh),null!==(n=(r=t)._$AQ)&&void 0!==n||(r._$AQ=Gh))};class Zh extends Wh{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,n){super._$AT(t,e,n),Jh(this),this.isConnected=t._$AU}_$AO(t,e=!0){var n,i;t!==this.isConnected&&(this.isConnected=t,t?null===(n=this.reconnected)||void 0===n||n.call(this):null===(i=this.disconnected)||void 0===i||i.call(this)),e&&(Kh(this,t),Yh(this))}setValue(t){if((t=>void 0===t.strings)
/**
   * @license
   * Copyright 2017 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}
/**
   * @license
   * Copyright 2020 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   */class tu{}const eu=new WeakMap,nu=(t=>(...e)=>({_$litDirective$:t,values:e}))(class extends Zh{render(t){return vc}update(t,[e]){var n;const i=e!==this.G;return i&&void 0!==this.G&&this.ot(void 0),(i||this.rt!==this.lt)&&(this.G=e,this.ct=null===(n=t.options)||void 0===n?void 0:n.host,this.ot(this.lt=t.element)),vc}ot(t){var e;if("function"==typeof this.G){const n=null!==(e=this.ct)&&void 0!==e?e:globalThis;let i=eu.get(n);void 0===i&&(i=new WeakMap,eu.set(n,i)),void 0!==i.get(this.G)&&this.G.call(this.ct,void 0),i.set(this.G,t),void 0!==t&&this.G.call(this.ct,t)}else this.G.value=t}get rt(){var t,e,n;return"function"==typeof this.G?null===(e=eu.get(null!==(t=this.ct)&&void 0!==t?t:globalThis))||void 0===e?void 0:e.get(this.G):null===(n=this.G)||void 0===n?void 0:n.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}});var iu=Object.defineProperty,ru=(t,e,n)=>(((t,e,n)=>{e in t?iu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),su=class extends HTMLElement{constructor(){super(),this.__sheet__=void 0;try{this.__sheet__=new CSSStyleSheet}catch{}const t=this.attachShadow({mode:"open"});let e=this.render();const n=this.constructor;this.__sheet__?(document.adoptedStyleSheets=[this.__sheet__],t.adoptedStyleSheets=[this.__sheet__]):e=`\n        <style>${n.styles}</style>\n        ${e}\n      `,this.shadowRoot&&(this.shadowRoot.innerHTML=e)}static define(t,e,n){var i;(null==t&&(t=this.baseName),null==e&&(e=this),this.customElementRegistry.get(t))||this.customElementRegistry.define(t,(i=e,class extends i{}),n)}connectedCallback(){if(!this.isConnected)return;const t=this.constructor;this.shadowRoot&&this.shadowRoot.adoptedStyleSheets&&this.__sheet__&&0==this.__sheet__.cssRules.length&&this.__sheet__.replaceSync(t.styles)}static get styles(){return""}render(){return""}shadowQuery(t){return this.shadowRoot?.querySelector(t)}shadowQueryAll(t){return null==this.shadowRoot?[]:[...this.shadowRoot.querySelectorAll(t)]}};function ou(t){return t}function au(t){return t}ru(su,"customElementRegistry",window.customElements),ru(su,"baseName");var lu=class extends su{constructor(){super(),ru(this,"handleClick",(t=>{const e=t.composedPath?.()[0]||t.target;if(!(e instanceof Element))return;const n=e.closest("[data-role='toolbar-item']");n?(this.toolbarItems.forEach(((t,e)=>{t!==n?t.setAttribute("tabindex","-1"):this.currentFocusIndex=e})),this.focusCurrentElement({focus:!1})):this.focusCurrentElement({focus:!0})})),ru(this,"handleKeyDown",(t=>{const e=t.key?.toLowerCase();("vertical"!==this.orientation||"arrowleft"!==e&&"arrowright"!==e)&&("horizontal"!==this.orientation||"arrowdown"!==e&&"arrowup"!==e)&&Object.keys(this.keydownHandlers).includes(e)&&(t.preventDefault(),this.keydownHandlers[e](t))})),ru(this,"focusNext",(t=>{this.currentFocusElement?.setAttribute("tabindex","-1"),this.currentFocusIndex+=1,this.currentFocusIndex>=this.toolbarItems.length?this.focusFirst():this.focusCurrentElement()})),ru(this,"focusPrevious",(t=>{this.currentFocusElement?.setAttribute("tabindex","-1"),this.currentFocusIndex-=1,this.currentFocusIndex<0?this.focusLast():this.focusCurrentElement()})),ru(this,"focusFirst",(()=>{this.currentFocusIndex=0,this.focusCurrentElement()})),ru(this,"focusLast",(()=>{null!=this.toolbarItems&&(this.currentFocusIndex=this.toolbarItems.length-1,this.focusCurrentElement())})),ru(this,"focusCurrentElement",(({focus:t=!0}={})=>{this.currentFocusElement?.setAttribute("tabindex","0"),t&&this.currentFocusElement?.focus?.()})),ru(this,"updateToolbarItems",(()=>{const t=this.shadowQuery("slot");if(!(t instanceof HTMLSlotElement))return;const e=t.assignedElements({flatten:!0}).filter((t=>t instanceof HTMLElement&&t.dataset.role?.match(/toolbar-item/)));this.toolbarItems=e,this.currentFocusIndex=this.toolbarItems.findIndex((t=>"0"===t.getAttribute("tabindex"))),-1===this.currentFocusIndex&&(this.currentFocusIndex=0,this.currentFocusElement?.setAttribute("tabindex","0"))})),this.currentFocusIndex=0,this.toolbarItems=[]}static get baseName(){return"role-toolbar"}static get styles(){return ou`
      :host {
        display: block;
      }

      .base {
        display: flex;
        max-width: 100%;
        padding: 0.4rem 0.6rem;
        border-radius: 4px;
        border: 2px solid transparent;
        gap: 4px;
        overflow: auto;
      }

      :host([orientation="vertical"]) .base {
        flex-direction: column;
      }

      :host(:focus-within) .base {
        border-color: #005a9c;
      }
    `}get keydownHandlers(){return this._keydownHandlers||(this._keydownHandlers={arrowleft:this.focusPrevious,arrowup:this.focusPrevious,arrowright:this.focusNext,arrowdown:this.focusNext,home:this.focusFirst,end:this.focusLast}),this._keydownHandlers}render(){return au`<div role="toolbar" class="base" part="base">
      <slot></slot>
    </div>`}connectedCallback(){super.connectedCallback(),this.shadowRoot?.querySelector("slot:not([name])")?.addEventListener("slotchange",this.updateToolbarItems),this.updateToolbarItems(),this.addEventListener("click",this.handleClick),this.addEventListener("keydown",this.handleKeyDown),this.addEventListener("focus",this.handleClick)}get orientation(){return"vertical"===this.getAttribute("orientation")?"vertical":"horizontal"}get currentFocusElement(){if(null!=this.toolbarItems)return this.toolbarItems[this.currentFocusIndex]}disconnectedCallback(){}adoptedCallback(){}};function cu(t){return t.split("-")[0]}function du(t){return t.split("-")[1]}function hu(t){return["top","bottom"].includes(cu(t))?"x":"y"}function uu(t){return"y"===t?"height":"width"}function pu(t,e,n){let{reference:i,floating:r}=t;const s=i.x+i.width/2-r.width/2,o=i.y+i.height/2-r.height/2,a=hu(e),l=uu(a),c=i[l]/2-r[l]/2,d="x"===a;let h;switch(cu(e)){case"top":h={x:s,y:i.y-r.height};break;case"bottom":h={x:s,y:i.y+i.height};break;case"right":h={x:i.x+i.width,y:o};break;case"left":h={x:i.x-r.width,y:o};break;default:h={x:i.x,y:i.y}}switch(du(e)){case"start":h[a]-=c*(n&&d?-1:1);break;case"end":h[a]+=c*(n&&d?-1:1)}return h}function fu(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function mu(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function gu(t,e){var n;void 0===e&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:u=!1,padding:p=0}=e,f=fu(p),m=a[u?"floating"===h?"reference":"floating":h],g=mu(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(m)))||n?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),b=mu(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===h?{...o.floating,x:i,y:r}:o.reference,offsetParent:await(null==s.getOffsetParent?void 0:s.getOffsetParent(a.floating)),strategy:l}):o[h]);return{top:g.top-b.top+f.top,bottom:b.bottom-g.bottom+f.bottom,left:g.left-b.left+f.left,right:b.right-g.right+f.right}}const bu=Math.min,vu=Math.max;function yu(t,e,n){return vu(t,bu(e,n))}const wu=t=>({name:"arrow",options:t,async fn(e){const{element:n,padding:i=0}=null!=t?t:{},{x:r,y:s,placement:o,rects:a,platform:l}=e;if(null==n)return{};const c=fu(i),d={x:r,y:s},h=hu(o),u=du(o),p=uu(h),f=await l.getDimensions(n),m="y"===h?"top":"left",g="y"===h?"bottom":"right",b=a.reference[p]+a.reference[h]-d[h]-a.floating[p],v=d[h]-a.reference[h],y=await(null==l.getOffsetParent?void 0:l.getOffsetParent(n));let w=y?"y"===h?y.clientHeight||0:y.clientWidth||0:0;0===w&&(w=a.floating[p]);const k=b/2-v/2,S=c[m],x=w-f[p]-c[g],E=w/2-f[p]/2+k,C=yu(S,E,x),_=("start"===u?c[m]:c[g])>0&&E!==C&&a.reference[p]<=a.floating[p];return{[h]:d[h]-(_?E<S?S-E:x-E:0),data:{[h]:C,centerOffset:E-C}}}}),ku={left:"right",right:"left",bottom:"top",top:"bottom"};function Su(t){return t.replace(/left|right|bottom|top/g,(t=>ku[t]))}const xu={start:"end",end:"start"};function Eu(t){return t.replace(/start|end/g,(t=>xu[t]))}const Cu=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var n;const{placement:i,middlewareData:r,rects:s,initialPlacement:o,platform:a,elements:l}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:u="bestFit",flipAlignment:p=!0,...f}=t,m=cu(i),g=h||(m===o||!p?[Su(o)]:function(t){const e=Su(t);return[Eu(t),e,Eu(e)]}(o)),b=[o,...g],v=await gu(e,f),y=[];let w=(null==(n=r.flip)?void 0:n.overflows)||[];if(c&&y.push(v[m]),d){const{main:t,cross:e}=function(t,e,n){void 0===n&&(n=!1);const i=du(t),r=hu(t),s=uu(r);let o="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=Su(o)),{main:o,cross:Su(o)}}(i,s,await(null==a.isRTL?void 0:a.isRTL(l.floating)));y.push(v[t],v[e])}if(w=[...w,{placement:i,overflows:y}],!y.every((t=>t<=0))){var k,S;const t=(null!=(k=null==(S=r.flip)?void 0:S.index)?k:0)+1,e=b[t];if(e)return{data:{index:t,overflows:w},reset:{placement:e}};let n="bottom";switch(u){case"bestFit":{var x;const t=null==(x=w.map((t=>[t,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:x[0].placement;t&&(n=t);break}case"initialPlacement":n=o}if(i!==n)return{reset:{placement:n}}}return{}}}};const _u=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:i}=e,r=await async function(t,e){const{placement:n,platform:i,elements:r}=t,s=await(null==i.isRTL?void 0:i.isRTL(r.floating)),o=cu(n),a=du(n),l="x"===hu(n),c=["left","top"].includes(o)?-1:1,d=s&&l?-1:1,h="function"==typeof e?e(t):e;let{mainAxis:u,crossAxis:p,alignmentAxis:f}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return a&&"number"==typeof f&&(p="end"===a?-1*f:f),l?{x:p*d,y:u*c}:{x:u*c,y:p*d}}(e,t);return{x:n+r.x,y:i+r.y,data:r}}}};const Au=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...l}=t,c={x:n,y:i},d=await gu(e,l),h=hu(cu(r)),u="x"===h?"y":"x";let p=c[h],f=c[u];if(s){const t="y"===h?"bottom":"right";p=yu(p+d["y"===h?"top":"left"],p,p-d[t])}if(o){const t="y"===u?"bottom":"right";f=yu(f+d["y"===u?"top":"left"],f,f-d[t])}const m=a.fn({...e,[h]:p,[u]:f});return{...m,data:{x:m.x-n,y:m.y-i}}}}};function Ou(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function Tu(t){if(null==t)return window;if(!Ou(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function Mu(t){return Tu(t).getComputedStyle(t)}function Du(t){return Ou(t)?"":t?(t.nodeName||"").toLowerCase():""}function Lu(){const t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((t=>t.brand+"/"+t.version)).join(" "):navigator.userAgent}function Nu(t){return t instanceof Tu(t).HTMLElement}function Iu(t){return t instanceof Tu(t).Element}function Pu(t){if("undefined"==typeof ShadowRoot)return!1;return t instanceof Tu(t).ShadowRoot||t instanceof ShadowRoot}function $u(t){const{overflow:e,overflowX:n,overflowY:i}=Mu(t);return/auto|scroll|overlay|hidden/.test(e+i+n)}function Ru(t){return["table","td","th"].includes(Du(t))}function Fu(t){const e=/firefox/i.test(Lu()),n=Mu(t);return"none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||["transform","perspective"].includes(n.willChange)||e&&"filter"===n.willChange||e&&!!n.filter&&"none"!==n.filter}function Bu(){return!/^((?!chrome|android).)*safari/i.test(Lu())}const ju=Math.min,Hu=Math.max,zu=Math.round;function Vu(t,e,n){var i,r,s,o;void 0===e&&(e=!1),void 0===n&&(n=!1);const a=t.getBoundingClientRect();let l=1,c=1;e&&Nu(t)&&(l=t.offsetWidth>0&&zu(a.width)/t.offsetWidth||1,c=t.offsetHeight>0&&zu(a.height)/t.offsetHeight||1);const d=Iu(t)?Tu(t):window,h=!Bu()&&n,u=(a.left+(h&&null!=(i=null==(r=d.visualViewport)?void 0:r.offsetLeft)?i:0))/l,p=(a.top+(h&&null!=(s=null==(o=d.visualViewport)?void 0:o.offsetTop)?s:0))/c,f=a.width/l,m=a.height/c;return{width:f,height:m,top:p,right:u+f,bottom:p+m,left:u,x:u,y:p}}function qu(t){return(e=t,(e instanceof Tu(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function Uu(t){return Iu(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Wu(t){return Vu(qu(t)).left+Uu(t).scrollLeft}function Ku(t,e,n){const i=Nu(e),r=qu(e),s=Vu(t,i&&function(t){const e=Vu(t);return zu(e.width)!==t.offsetWidth||zu(e.height)!==t.offsetHeight}(e),"fixed"===n);let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if(i||!i&&"fixed"!==n)if(("body"!==Du(e)||$u(r))&&(o=Uu(e)),Nu(e)){const t=Vu(e,!0);a.x=t.x+e.clientLeft,a.y=t.y+e.clientTop}else r&&(a.x=Wu(r));return{x:s.left+o.scrollLeft-a.x,y:s.top+o.scrollTop-a.y,width:s.width,height:s.height}}function Yu(t){return"html"===Du(t)?t:t.assignedSlot||t.parentNode||(Pu(t)?t.host:null)||qu(t)}function Ju(t){return Nu(t)&&"fixed"!==getComputedStyle(t).position?t.offsetParent:null}function Gu(t){const e=Tu(t);let n=Ju(t);for(;n&&Ru(n)&&"static"===getComputedStyle(n).position;)n=Ju(n);return n&&("html"===Du(n)||"body"===Du(n)&&"static"===getComputedStyle(n).position&&!Fu(n))?e:n||function(t){let e=Yu(t);for(Pu(e)&&(e=e.host);Nu(e)&&!["html","body"].includes(Du(e));){if(Fu(e))return e;e=e.parentNode}return null}(t)||e}function Xu(t){if(Nu(t))return{width:t.offsetWidth,height:t.offsetHeight};const e=Vu(t);return{width:e.width,height:e.height}}function Qu(t){const e=Yu(t);return["html","body","#document"].includes(Du(e))?t.ownerDocument.body:Nu(e)&&$u(e)?e:Qu(e)}function Zu(t,e){var n;void 0===e&&(e=[]);const i=Qu(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),s=Tu(i),o=r?[s].concat(s.visualViewport||[],$u(i)?i:[]):i,a=e.concat(o);return r?a:a.concat(Zu(o))}function tp(t,e,n){return"viewport"===e?mu(function(t,e){const n=Tu(t),i=qu(t),r=n.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const t=Bu();(t||!t&&"fixed"===e)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}(t,n)):Iu(e)?function(t,e){const n=Vu(t,!1,"fixed"===e),i=n.top+t.clientTop,r=n.left+t.clientLeft;return{top:i,left:r,x:r,y:i,right:r+t.clientWidth,bottom:i+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(e,n):mu(function(t){var e;const n=qu(t),i=Uu(t),r=null==(e=t.ownerDocument)?void 0:e.body,s=Hu(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Hu(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0);let a=-i.scrollLeft+Wu(t);const l=-i.scrollTop;return"rtl"===Mu(r||n).direction&&(a+=Hu(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(qu(t)))}function ep(t){const e=Zu(t),n=["absolute","fixed"].includes(Mu(t).position)&&Nu(t)?Gu(t):t;return Iu(n)?e.filter((t=>Iu(t)&&function(t,e){const n=null==e.getRootNode?void 0:e.getRootNode();if(t.contains(e))return!0;if(n&&Pu(n)){let n=e;do{if(n&&t===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(t,n)&&"body"!==Du(t))):[]}const np={getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const s=[..."clippingAncestors"===n?ep(e):[].concat(n),i],o=s[0],a=s.reduce(((t,n)=>{const i=tp(e,n,r);return t.top=Hu(i.top,t.top),t.right=ju(i.right,t.right),t.bottom=ju(i.bottom,t.bottom),t.left=Hu(i.left,t.left),t}),tp(e,o,r));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:i}=t;const r=Nu(n),s=qu(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0};const a={x:0,y:0};if((r||!r&&"fixed"!==i)&&(("body"!==Du(n)||$u(s))&&(o=Uu(n)),Nu(n))){const t=Vu(n,!0);a.x=t.x+n.clientLeft,a.y=t.y+n.clientTop}return{...e,x:e.x-o.scrollLeft+a.x,y:e.y-o.scrollTop+a.y}},isElement:Iu,getDimensions:Xu,getOffsetParent:Gu,getDocumentElement:qu,getElementRects:t=>{let{reference:e,floating:n,strategy:i}=t;return{reference:Ku(e,Gu(n),i),floating:{...Xu(n),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>"rtl"===Mu(t).direction};const ip=(t,e,n)=>(async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=n,a=await(null==o.isRTL?void 0:o.isRTL(e));let l=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:d}=pu(l,i,a),h=i,u={},p=0;for(let n=0;n<s.length;n++){const{name:f,fn:m}=s[n],{x:g,y:b,data:v,reset:y}=await m({x:c,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:u,rects:l,platform:o,elements:{reference:t,floating:e}});c=null!=g?g:c,d=null!=b?b:d,u={...u,[f]:{...u[f],...v}},y&&p<=50&&(p++,"object"==typeof y&&(y.placement&&(h=y.placement),y.rects&&(l=!0===y.rects?await o.getElementRects({reference:t,floating:e,strategy:r}):y.rects),({x:c,y:d}=pu(l,h,a))),n=-1)}return{x:c,y:d,placement:h,strategy:r,middlewareData:u}})(t,e,{platform:np,...n});var rp=class extends su{constructor(){super(),ru(this,"show",(t=>{let e=t;e instanceof Element||(e=t.currentTarget),this.willShow=!0,this.computeTooltipPosition(e)})),ru(this,"hide",(t=>{this.willShow=!1,this.cleanup?.(),window.requestAnimationFrame((()=>{!0!==this.willShow&&(this.base.style.display="none")}))})),ru(this,"keyboardHide",(t=>{null!=t.key&&"escape"===t.key.toLowerCase()&&(t.preventDefault(),this.hide())})),this._tooltipAnchors=[],this.query=`[aria-describedby~='${this.getAttribute("id")}']`,this.listeners=[["pointerenter",this.show],["pointerleave",this.hide],["pointercancel",this.hide],["pointerup",this.hide],["focusin",this.show],["focusout",this.hide],["keydown",this.keyboardHide]]}static get observedAttributes(){return["id"]}get rootElement(){return this._rootElement=this.getRootNode()||document,this._rootElement}set rootElement(t){this._rootElement!==t&&(null!=t?(this._rootElement=t,this.attachListeners()):this.removeListeners())}static get baseName(){return"role-tooltip"}static get styles(){return ou`
      :host {
        --background-color: #222;
        --arrow-size: 8px;
      }

      .base {
        display: none;
        position: absolute;
        left: 0px;
        top: 0px;
        max-width: calc(100vw - 10px);
        padding: 0.4em 0.6em;
        background: var(--background-color);
        color: white;
        border-radius: 4px;
        font-size: 0.9em;
        pointer-events: none;
        z-index: 1;
      }

      :host([hoist]) .base {
        position: fixed;
      }

      .arrow {
        position: absolute;
        background: var(--background-color);
        width: var(--arrow-size);
        height: var(--arrow-size);
        transform: rotate(45deg);
      }
    `}get tooltipAnchors(){return this._tooltipAnchors=[...this.rootElement.querySelectorAll(this.query)],this._tooltipAnchors}render(){return au`
      <div role="tooltip" part="base" class="base">
        <slot></slot>
        <div class="arrow" part="arrow"></div>
      </div>
    `}connectedCallback(){super.connectedCallback(),setTimeout((()=>this.attachListeners()))}attributeChangedCallback(t,e,n){"id"===t&&this.attachListeners()}attachListeners(){this.listeners.forEach((([t,e])=>{this._tooltipAnchors.forEach((n=>n.removeEventListener(t,e))),this.tooltipAnchors.forEach((n=>n.addEventListener(t,e)))}))}removeListeners(){this.listeners.forEach((([t,e])=>{this._tooltipAnchors.forEach((n=>n.removeEventListener(t,e)))}))}get arrow(){return this.shadowQuery(".arrow")}computeTooltipPosition(t){const e=this.arrow,n=this.base;this.base.style.display="unset",this.cleanup=function(t,e,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=!0,animationFrame:a=!1}=i,l=r&&!a,c=s&&!a,d=l||c?[...Iu(t)?Zu(t):[],...Zu(e)]:[];d.forEach((t=>{l&&t.addEventListener("scroll",n,{passive:!0}),c&&t.addEventListener("resize",n)}));let h,u=null;if(o){let i=!0;u=new ResizeObserver((()=>{i||n(),i=!1})),Iu(t)&&!a&&u.observe(t),u.observe(e)}let p=a?Vu(t):null;return a&&function e(){const i=Vu(t);!p||i.x===p.x&&i.y===p.y&&i.width===p.width&&i.height===p.height||n(),p=i,h=requestAnimationFrame(e)}(),n(),()=>{var t;d.forEach((t=>{l&&t.removeEventListener("scroll",n),c&&t.removeEventListener("resize",n)})),null==(t=u)||t.disconnect(),u=null,a&&cancelAnimationFrame(h)}}(t,n,(()=>{ip(t,n,{placement:this.getAttribute("placement")??"top",middleware:[_u(6),Cu(),Au({padding:5}),wu({element:e})],strategy:this.hasAttribute("hoist")?"fixed":"absolute"}).then((({x:t,y:i,middlewareData:r,placement:s})=>{Object.assign(n.style,{left:`${t}px`,top:`${i}px`});const{x:o,y:a}=r.arrow,l={top:"bottom",right:"left",bottom:"top",left:"right"}[s.split("-")[0]];Object.assign(e.style,{left:null!=o?`${o}px`:"",top:null!=a?`${a}px`:"",right:"",bottom:"",[l]:"-4px"})}))}))}get base(){return this.shadowQuery(".base")}disconnectedCallback(){this.removeListeners()}};function sp(t){let e="";for(const[n,i]of Object.entries(t))i&&(e+=`${n} `);return e}var op,ap,lp,cp,dp,hp,up,pp,fp,mp,gp,bp,vp,yp,wp=class extends Event{constructor(t,e={}){null==e.bubbles&&(e.bubbles=!0),null==e.composed&&(e.composed=!0),null==e.cancelable&&(e.cancelable=!0),super(wp.eventName,e),this.attachment=t}static get eventName(){return"rhino-add-attachment"}},kp=class extends Dd{constructor(){super(...arguments),fd(this,op),fd(this,fp),fd(this,gp),fd(this,vp),this.readonly=!1,this.linkInputRef=new tu,this.linkDialogExpanded=!1,this.translations=r,this.serializer="",this.accept="*",this.starterKit={strike:!1},this.rhinoStarterKit={placeholder:{placeholder:this.translations.placeholder}},this.handleKeyboardDialogToggle=t=>{let{key:e,metaKey:i,ctrlKey:r}=t;if(null==e)return;if(e=e.toLowerCase(),"escape"===e&&this.linkDialogExpanded)return void this.closeLinkDialog();"k"===e&&(n?i:r)&&this.showLinkDialog()},this.handleAttachment=t=>{const{attachment:e,target:n}=t;if(n instanceof HTMLElement&&e.file){const t=new class{constructor(t,e){this.currentProgress=0,this.animationProgress=this.currentProgress,this.attachment=t,this.element=e,this.directUpload=new Xc(this.attachment.file,this.directUploadUrl,this)}start(){this.directUpload.create(this.directUploadDidComplete.bind(this))}directUploadWillStoreFileWithXHR(t){t.upload.addEventListener("progress",(t=>{const e=t.loaded/t.total*100;this.currentProgress=e,this.setUploadProgress()}))}directUploadDidComplete(t,e){if(t)throw new Error(`Direct upload failed: ${t}`);this.attachment.setAttributes({sgid:e.attachable_sgid??"",url:this.createBlobUrl(e.signed_id,e.filename)}),this.currentProgress=100,this.setUploadProgress()}setUploadProgress(){window.requestAnimationFrame((()=>{if(this.animationProgress>=100)return this.currentProgress=100,this.animationProgress=100,void this.attachment.setUploadProgress(100);this.animationProgress>this.currentProgress||(this.animationProgress+=1,this.attachment.setUploadProgress(this.animationProgress),this.setUploadProgress())}))}createBlobUrl(t,e){return null==this.blobUrlTemplate?"":this.blobUrlTemplate.replace(":signed_id",t).replace(":filename",encodeURIComponent(e))}get directUploadUrl(){if(null==this.element.dataset.directUploadUrl)throw Error(`No "data-direct-upload-url" attribute is set on ${this.element}`);return this.element.dataset.directUploadUrl}get blobUrlTemplate(){return this.element.dataset.blobUrlTemplate}}(e,n);t.start()}},this.handleDropFile=t=>{if(null==this.editor)return;if(null==t)return;if(!(t instanceof DragEvent))return;const{dataTransfer:e}=t;if(null==e)return;if(!(e.files.length>0))return;const{view:n}=this.editor;if(null==n)return;const i=this.transformFilesToAttachments.call(this,e.files);null!=i&&(t.preventDefault(),this.editor.chain().focus().setAttachment(i).run(),i.forEach((t=>{this.dispatchEvent(new wp(t))})))},fd(this,lp,(()=>{this.requestUpdate()})),fd(this,cp,(()=>{this.updateInputElementValue(),this.requestUpdate()})),fd(this,dp,(()=>{this.closeLinkDialog(),this.requestUpdate()})),fd(this,hp,(()=>{this.updateInputElementValue(),this.requestUpdate()})),fd(this,up,(()=>{this.requestUpdate()})),fd(this,pp,(()=>{this.requestUpdate()}))}static get properties(){return{readonly:{type:Boolean,reflect:!0},editor:{state:!0},editorElement:{state:!0},linkDialogExpanded:{type:Boolean},input:{},linkInputRef:{state:!0},translations:{state:!0},class:{reflect:!0},accept:{reflect:!0}}}willUpdate(t){t.has("class")&&this.classList.add("rhino-editor")}static get styles(){return[dd,Fc,Rc]}registerDependencies(){[Ld,rp,lu].forEach((t=>t.define()))}connectedCallback(){super.connectedCallback(),this.classList.add("rhino-editor"),this.registerDependencies(),this.addEventListener(wp.eventName,this.handleAttachment),this.addEventListener("keydown",this.handleKeyboardDialogToggle),this.addEventListener("drop",this.handleDropFile)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener(wp.eventName,this.handleAttachment),this.removeEventListener("keydown",this.handleKeyboardDialogToggle),this.removeEventListener("drop",this.handleDropFile)}get icons(){return gd}updated(t){t.has("readonly")&&this.editor?.setEditable(!this.readonly)}editorElementChanged(t){if(null==t)return;this.editor&&md(this,gp,bp).call(this);const e=document.createElement("div");this.insertAdjacentElement("beforeend",e),e.setAttribute("slot","editor"),this.editor=md(this,vp,yp).call(this,e),md(this,fp,mp).call(this),this.editorElement=e.querySelector(".ProseMirror"),this.editorElement?.classList.add("trix-content"),this.editorElement?.setAttribute("tabindex","0"),this.editorElement?.setAttribute("role","textbox")}extensions(){return[qh.configure({...this.starterKit}),Dl.configure({...this.rhinoStarterKit})]}editorOptions(t){return{}}updateInputElementValue(){null==this.inputElement||null==this.editor||this.readonly||(this.inputElement.value=this.serialize())}serialize(){return null==this.editor?"":"json"===this.serializer?.toLowerCase()?JSON.stringify(this.editor.getJSON()):this.editor.getHTML()}get inputElement(){if(null!=this.input)return document.getElementById(this.input)}toggleLinkDialog(){this.linkDialogExpanded?this.closeLinkDialog():this.showLinkDialog()}closeLinkDialog(){null!=this.linkDialog&&(this.linkDialogExpanded=!1,this.linkDialog.setAttribute("hidden",""))}showLinkDialog(){if(null==this.linkDialog)return;const t=this.linkInputRef.value;null!=t&&(t.classList.remove("link-validate"),t.value=""),this.linkDialogExpanded=!0,this.linkDialog.removeAttribute("hidden"),setTimeout((()=>{null!=t&&t.focus()}))}get linkDialog(){return this.shadowRoot?.querySelector(".link-dialog")}async handleFileUpload(){const t=this.fileInputEl;return await new Promise(((e,n)=>{if(null==t)return void e();if(null==this.editor)return;const i=this.transformFilesToAttachments(t.files);null!=i&&(this.editor.chain().focus().setAttachment(i).run(),i.forEach((t=>{this.dispatchEvent(new wp(t))})),t.value="",e())}))}transformFilesToAttachments(t){if(null==this.editor)return;if(null==t||0===t.length)return;const e=[];for(let n=0;n<t.length;n++){const i=t[n];if(null==i)return;const r=URL.createObjectURL(i),s=new jc({src:r,file:i},this.editor.view);e.push(s)}return e}get fileInputEl(){return this.shadowRoot?.getElementById("file-input")}attachFiles(){const t=this.fileInputEl;null!=t&&t.click()}addLink(){const t=this.linkInputRef.value;if(null==t)return;const e=t.value;try{new URL(e),t.setCustomValidity("")}catch(e){return t.setCustomValidity("Not a valid URL"),void t.classList.add("link-validate")}if(e){this.closeLinkDialog(),t.value="";const n=this.editor?.chain().focus().extendMarkRange("link").setLink({href:e});this.editor?.state.selection.empty&&n?.insertContent(e),n?.run()}}renderBoldButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        part=${sp({toolbar__button:!0,"toolbar__button--bold":!0,"toolbar__button--active":Boolean(this.editor?.isActive("bold")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleBold()})}
        aria-describedby="bold"
        aria-disabled=${null==this.editor||!this.editor.can().toggleBold()}
        aria-pressed=${this.editor?.isActive("bold")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleBold().run()}}
      >
        <slot name="bold-tooltip">
          <role-tooltip
            id="bold"
            hoist
            part="toolbar-tooltip toolbar-tooltip__bold"
            >${this.translations.bold}</role-tooltip
          >
        </slot>
        <slot name="bold-icon">${this.icons.bold}</slot>
      </button>
    `}renderItalicButton(){return mc`
      <button
        class="toolbar__button"
        tabindex="-1"
        type="button"
        part=${sp({toolbar__button:!0,"toolbar__button--italic":!0,"toolbar__button--active":Boolean(this.editor?.isActive("italic")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleItalic()})}
        aria-describedby="italics"
        aria-disabled=${null==this.editor||!this.editor.can().toggleItalic()}
        aria-pressed=${this.editor?.isActive("italic")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleItalic().run()}}
      >
        <slot name="italics-tooltip">
          <role-tooltip
            id="italics"
            hoist
            part="toolbar-tooltip toolbar-tooltip__italics"
            >${this.translations.italics}</role-tooltip
          >
        </slot>
        <slot name="italics-icon">${this.icons.italics}</slot>
      </button>
    `}renderStrikeButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--strike":!0,"toolbar__button--active":Boolean(this.editor?.isActive("strike")),"toolbar__button--disabled":!(this.editor&&this.editor.can().toggleStrike())})}
        aria-describedby="strike"
        aria-disabled=${!(this.editor&&this.editor.can().toggleStrike())}
        aria-pressed=${this.editor?.isActive("strike")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleStrike().run()}}
      >
        <slot name="strike-tooltip">
          <role-tooltip
            id="strike"
            hoist
            part="toolbar-tooltip toolbar-tooltip__strike"
            >${this.translations.strike}</role-tooltip
          >
        </slot>
        <slot name="strike-icon">${this.icons.strike}</slot>
      </button>
    `}renderLinkButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--link":!0,"toolbar__button--active":Boolean(this.editor?.isActive("link")),"toolbar__button--disabled":!(this.editor&&this.editor.can().setLink({href:""}))})}
        aria-describedby="link"
        aria-disabled=${null==this.editor||!this.editor.can().setLink({href:""})}
        aria-pressed=${this.editor?.isActive("link")}
        aria-controls="link-dialog"
        data-role="toolbar-item"
        @click=${t=>{null!=this.editor&&"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.toggleLinkDialog()}}
      >
        <slot name="link-tooltip">
          <role-tooltip
            id="link"
            hoist
            part="toolbar-tooltip toolbar-tooltip__link"
            >${this.translations.link}</role-tooltip
          >
        </slot>
        <slot name="link-icon">${this.icons.link}</slot>
      </button>
    `}renderHeadingButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--heading":!0,"toolbar__button--active":Boolean(this.editor?.isActive("heading")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleHeading({level:1})})}
        aria-describedby="heading"
        aria-disabled=${null==this.editor||!this.editor.can().toggleHeading({level:1})}
        aria-pressed=${this.editor?.isActive("heading")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleHeading({level:1}).run()}}
      >
        <slot name="heading-tooltip">
          <role-tooltip
            id="heading"
            hoist
            part="toolbar-tooltip toolbar-tooltip__heading"
            >${this.translations.heading}</role-tooltip
          >
        </slot>
        <slot name="heading-icon">${this.icons.heading}</slot>
      </button>
    `}renderBlockQuoteButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--blockquote":!0,"toolbar__button--active":Boolean(this.editor?.isActive("blockquote")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleBlockquote()})}
        aria-describedby="block-quote"
        aria-disabled=${null==this.editor||!this.editor.can().toggleBlockquote()}
        aria-pressed=${this.editor?.isActive("blockquote")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleBlockquote().run()}}
      >
        <slot name="block-quote-tooltip">
          <role-tooltip
            id="block-quote"
            hoist
            part="toolbar-tooltip toolbar-tooltip__block-quote"
            >${this.translations.blockQuote}</role-tooltip
          >
        </slot>
        <slot name="block-quote-icon">${this.icons.blockQuote}</slot>
      </button>
    `}renderCodeBlockButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--code-block":!0,"toolbar__button--active":Boolean(this.editor?.isActive("codeBlock")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleCodeBlock()})}
        aria-describedby="code-block"
        aria-disabled=${null==this.editor||!this.editor.can().toggleCodeBlock()}
        aria-pressed=${this.editor?.isActive("codeBlock")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleCodeBlock().run()}}
      >
        <slot name="code-block-tooltip">
          <role-tooltip
            id="code-block"
            hoist
            part="toolbar-tooltip toolbar-tooltip__code-block"
            >${this.translations.codeBlock}</role-tooltip
          >
        </slot>
        <slot name="code-block-icon">${this.icons.codeBlock}</slot>
      </button>
    `}renderBulletListButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--bullet-list":!0,"toolbar__button--active":Boolean(this.editor?.isActive("bulletList")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleBulletList()})}
        aria-describedby="bullet-list"
        aria-disabled=${null==this.editor||!this.editor.can().toggleBulletList()}
        aria-pressed=${this.editor?.isActive("bulletList")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleBulletList().run()}}
      >
        <slot name="bullet-list-tooltip">
          <role-tooltip
            id="bullet-list"
            hoist
            part="toolbar-tooltip toolbar-tooltip__bullet-list"
            >${this.translations.bulletList}</role-tooltip
          >
        </slot>
        <slot name="bullet-list-icon">${this.icons.bulletList}</slot>
      </button>
    `}renderOrderedListButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--ordered-list":!0,"toolbar__button--active":Boolean(this.editor?.isActive("orderedList")),"toolbar__button--disabled":null==this.editor||!this.editor.can().toggleOrderedList()})}
        aria-describedby="ordered-list"
        aria-disabled=${null==this.editor||!this.editor.can().toggleOrderedList()}
        aria-pressed=${this.editor?.isActive("orderedList")}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().toggleOrderedList().run()}}
      >
        <slot name="ordered-list-tooltip">
          <role-tooltip
            id="ordered-list"
            hoist
            part="toolbar-tooltip toolbar-tooltip__ordered-list"
            >${this.translations.orderedList}</role-tooltip
          >
        </slot>
        <slot name="ordered-list-icon">${this.icons.orderedList}</slot>
      </button>
    `}renderAttachmentButton(){return mc`
      <button
        class="toolbar__button toolbar__button--attach-files"
        tabindex="-1"
        type="button"
        part=${sp({toolbar__button:!0,"toolbar__button--attach-files":!0,"toolbar__button--disabled":null==this.editor})}
        aria-describedby="attach-files"
        aria-disabled=${null==this.editor}
        data-role="toolbar-item"
        @click=${this.attachFiles}
      >
        <slot name="attach-files-tooltip">
          <role-tooltip
            id="attach-files"
            hoist
            part="toolbar-tooltip toolbar-tooltip__attach-files"
            >${this.translations.attachFiles}</role-tooltip
          >
        </slot>
        <slot name="attach-files-icon">${this.icons.attachFiles}</slot>

        <!-- @TODO: Write documentation. Hookup onchange to the slotted elements -->
        <slot name="attach-files-input">
          <input
            id="file-input"
            type="file"
            hidden
            multiple
            accept=${this.accept||"*"}
            @change=${async()=>await this.handleFileUpload()}
          />
        </slot>
      </button>
    `}renderUndoButton(){return mc`
      <button
        class="toolbar__button"
        type="button"
        tabindex="-1"
        part=${sp({toolbar__button:!0,"toolbar__button--undo":!0,"toolbar__button--disabled":null==this.editor||!this.editor.can().undo()})}
        aria-describedby="undo"
        aria-disabled=${null==this.editor||!this.editor.can().undo()}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().undo().run()}}
      >
        <slot name="undo-tooltip">
          <role-tooltip
            id="undo"
            hoist
            part="toolbar-tooltip toolbar-tooltip__undo"
            >${this.translations.undo}</role-tooltip
          >
        </slot>
        <slot name="undo-icon">${this.icons.undo}</slot>
      </button>
    `}renderRedoButton(){return mc`
      <button
        class="toolbar__button"
        tabindex="-1"
        type="button"
        part=${sp({toolbar__button:!0,"toolbar__button--redo":!0,"toolbar__button--disabled":null==this.editor||!this.editor.can().redo()})}
        aria-describedby="redo"
        aria-disabled=${null==this.editor||!this.editor.can().redo()}
        data-role="toolbar-item"
        @click=${t=>{"true"!==t.currentTarget.getAttribute("aria-disabled")&&this.editor?.chain().focus().redo().run()}}
      >
        <slot name="redo-tooltip">
          <role-tooltip
            id="redo"
            hoist
            part="toolbar-tooltip toolbar-tooltip__redo"
            >${this.translations.redo}</role-tooltip
          >
        </slot>
        <slot name="redo-icon">${this.icons.redo}</slot>
      </button>
    `}renderStart(){return mc``}renderEnd(){return mc``}renderToolbar(){return this.readonly?mc``:mc`
      <slot name="toolbar">
        <role-toolbar class="toolbar" part="toolbar" role="toolbar">
          <slot name="toolbar-start">${this.renderStart()}</slot>

          <!-- Bold -->
          <slot name="before-bold-button"></slot>
          <slot name="bold-button">${this.renderBoldButton()}</slot>
          <slot name="after-bold-button"></slot>

          <!-- Italic -->
          <slot name="before-italic-button"></slot>
          <slot name="italic-button">${this.renderItalicButton()}</slot>
          <slot name="after-italic-button"></slot>

          <!-- Strike -->
          <slot name="before-strike-button"></slot>
          <slot name="strike-button">${this.renderStrikeButton()}</slot>
          <slot name="after-strike-button"></slot>

          <!-- Link -->
          <slot name="before-link-button"></slot>
          <slot name="link-button">${this.renderLinkButton()}</slot>
          <slot name="after-link-button"></slot>

          <!-- Heading -->
          <slot name="before-heading-button"></slot>
          <slot name="heading-button">${this.renderHeadingButton()}</slot>
          <slot name="after-heading-button"></slot>

          <!-- Blockquote -->
          <slot name="before-block-quote-button"></slot>
          <slot name="block-quote-button"
            >${this.renderBlockQuoteButton()}</slot
          >
          <slot name="after-block-quote-button"></slot>

          <!-- Code block -->
          <slot name="before-code-block-button"></slot>
          <slot name="code-block-button">${this.renderCodeBlockButton()}</slot>
          <slot name="after-code-block-button"></slot>

          <!-- Bullet List -->
          <slot name="before-bullet-list-button"></slot>
          <slot name="bullet-list-button"
            >${this.renderBulletListButton()}</slot
          >
          <slot name="after-bullet-list-button"></slot>

          <!-- Ordered list -->
          <slot name="before-ordered-list-button"></slot>
          <slot name="ordered-list-button">
            ${this.renderOrderedListButton()}
          </slot>
          <slot name="after-ordered-list-button"></slot>

          <!-- Attachments -->
          <slot name="before-attach-files-button"></slot>
          <slot name="attach-files-button"
            >${this.renderAttachmentButton()}</slot
          >
          <slot name="after-attach-files-button"></slot>

          <!-- Undo -->
          <slot name="before-undo-button"></slot>
          <slot name="undo-button">${this.renderUndoButton()}</slot>
          <slot name="after-undo-button"></slot>

          <!-- Redo -->
          <slot name="before-redo-button"></slot>
          <slot name="redo-button">${this.renderRedoButton()}</slot>
          <slot name="after-redo-button"></slot>

          <slot name="toolbar-end">${this.renderEnd()}</slot>
        </role-toolbar>
      </slot>
    `}renderLinkCreationDialog(){return this.readonly?mc``:mc` <div
      id="link-dialog"
      class="link-dialog"
      part="link-dialog"
      hidden
      @click=${t=>{const e=t.target,n=t.currentTarget;n.contains(e)&&n!==e||this.closeLinkDialog()}}
    >
      <div class="link-dialog__container" part="link-dialog__container">
        <input
          id="link-dialog__input"
          class="link-dialog__input"
          part="link-dialog__input"
          type="text"
          placeholder="Enter a URL..."
          aria-label="Enter a URL"
          required
          type="url"
          ${nu(this.linkInputRef)}
          @input=${()=>{const t=this.linkInputRef.value;null!=t&&t.setCustomValidity("")}}
          @blur=${()=>{const t=this.linkInputRef.value;null!=t&&t.classList.remove("link-validate")}}
          @keydown=${t=>{"enter"===t.key?.toLowerCase()&&(t.preventDefault(),this.addLink())}}
        />
        <div class="link-dialog__buttons" part="link-dialog__buttons">
          <button
            class="link-dialog__button"
            part="link-dialog__button link-dialog__button-add-link"
            @click=${this.addLink}
          >
            ${this.translations.linkDialogLink}
          </button>
          <button
            class="link-dialog__button"
            part="link-dialog__button link-dialog__button-unlink"
            @click=${()=>{this.editor?.chain().focus().extendMarkRange("link").unsetLink().run()}}
          >
            ${this.translations.linkDialogUnlink}
          </button>
        </div>
      </div>
    </div>`}render(){return mc`
      ${this.renderToolbar()}
      <div
        ${nu(this.editorElementChanged)}
        class="editor-wrapper"
        part="editor-wrapper"
      >
        ${this.renderLinkCreationDialog()}
        <div class="editor" part="editor"><slot name="editor"></slot></div>
      </div>
    `}normalizeDOM(t,e=new DOMParser){if(null==t||null==t.value)return;const n=e.parseFromString(t.value,"text/html"),i=[...n.querySelectorAll("figure[data-trix-attachment]")].filter((t=>null==t.querySelector("figcaption")));n.querySelectorAll("div > figure:first-child").forEach((t=>{t.parentElement?.classList.add("attachment-gallery")})),i.forEach((t=>{const e=t.getAttribute("data-trix-attributes");if(!e)return;const{caption:n}=JSON.parse(e);n&&t.insertAdjacentHTML("beforeend",`<figcaption class="attachment__caption">${n}</figcaption>`)})),n.querySelectorAll("figure .attachment__name").forEach((t=>{!1!==t.textContent?.includes(" · ")&&t.insertAdjacentText("beforeend"," · ")}));const r=n.querySelector("body");r&&(t.value=r.innerHTML)}};op=new WeakSet,ap=function(t){let e=this.inputElement?.value||"";return e&&"json"===this.serializer?.toLowerCase()&&(e=JSON.parse(e)),{injectCSS:!1,extensions:this.extensions(),autofocus:!1,element:t,content:e,editable:!this.readonly}},lp=new WeakMap,cp=new WeakMap,dp=new WeakMap,hp=new WeakMap,up=new WeakMap,pp=new WeakMap,fp=new WeakSet,mp=function(){null!=this.editor&&(this.editor.on("focus",pd(this,dp)),this.editor.on("create",pd(this,lp)),this.editor.on("update",pd(this,cp)),this.editor.on("selectionUpdate",pd(this,up)),this.editor.on("transaction",pd(this,pp)),this.editor.on("blur",pd(this,hp)))},gp=new WeakSet,bp=function(){null!=this.editor&&(this.editor.off("focus",pd(this,dp)),this.editor.off("create",pd(this,lp)),this.editor.off("update",pd(this,cp)),this.editor.off("selectionUpdate",pd(this,up)),this.editor.off("transaction",pd(this,pp)),this.editor.off("blur",pd(this,hp)))},vp=new WeakSet,yp=function(t){return this.serializer&&"html"!==this.serializer||this.normalizeDOM(this.inputElement),new mo({...md(this,op,ap).call(this,t),...this.editorOptions})},kp.baseName="rhino-editor",kp.define(),function(){if(void 0===window.Reflect||void 0===window.customElements||window.customElements.polyfillWrapFlushCallback)return;const t=HTMLElement,e=function(){return Reflect.construct(t,[],this.constructor)};window.HTMLElement=e,HTMLElement.prototype=t.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,t)}(),function(t){function e(t,e,n){throw new t("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+e+".",n)}"function"!=typeof t.requestSubmit&&(t.requestSubmit=function(t){t?(!function(t,n){t instanceof HTMLElement||e(TypeError,"parameter 1 is not of type 'HTMLElement'"),"submit"==t.type||e(TypeError,"The specified element is not a submit button"),t.form==n||e(DOMException,"The specified element is not owned by this form element","NotFoundError")}(t,this),t.click()):((t=document.createElement("input")).type="submit",t.hidden=!0,this.appendChild(t),t.click(),this.removeChild(t))})}(HTMLFormElement.prototype);const Sp=new WeakMap;function xp(t){const e=function(t){const e=t instanceof Element?t:t instanceof Node?t.parentElement:null,n=e?e.closest("input, button"):null;return"submit"==(null==n?void 0:n.type)?n:null}(t.target);e&&e.form&&Sp.set(e.form,e)}var Ep,Cp,_p,Ap,Op,Tp;!function(){if("submitter"in Event.prototype)return;let t=window.Event.prototype;if("SubmitEvent"in window&&/Apple Computer/.test(navigator.vendor))t=window.SubmitEvent.prototype;else if("SubmitEvent"in window)return;addEventListener("click",xp,!0),Object.defineProperty(t,"submitter",{get(){if("submit"==this.type&&this.target instanceof HTMLFormElement)return Sp.get(this.target)}})}(),function(t){t.eager="eager",t.lazy="lazy"}(Ep||(Ep={}));class Mp extends HTMLElement{static get observedAttributes(){return["disabled","complete","loading","src"]}constructor(){super(),this.loaded=Promise.resolve(),this.delegate=new Mp.delegateConstructor(this)}connectedCallback(){this.delegate.connect()}disconnectedCallback(){this.delegate.disconnect()}reload(){return this.delegate.sourceURLReloaded()}attributeChangedCallback(t){"loading"==t?this.delegate.loadingStyleChanged():"complete"==t?this.delegate.completeChanged():"src"==t?this.delegate.sourceURLChanged():this.delegate.disabledChanged()}get src(){return this.getAttribute("src")}set src(t){t?this.setAttribute("src",t):this.removeAttribute("src")}get loading(){return function(t){if("lazy"===t.toLowerCase())return Ep.lazy;return Ep.eager}(this.getAttribute("loading")||"")}set loading(t){t?this.setAttribute("loading",t):this.removeAttribute("loading")}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get autoscroll(){return this.hasAttribute("autoscroll")}set autoscroll(t){t?this.setAttribute("autoscroll",""):this.removeAttribute("autoscroll")}get complete(){return!this.delegate.isLoading}get isActive(){return this.ownerDocument===document&&!this.isPreview}get isPreview(){var t,e;return null===(e=null===(t=this.ownerDocument)||void 0===t?void 0:t.documentElement)||void 0===e?void 0:e.hasAttribute("data-turbo-preview")}}function Dp(t){return new URL(t.toString(),document.baseURI)}function Lp(t){let e;return t.hash?t.hash.slice(1):(e=t.href.match(/#(.*)$/))?e[1]:void 0}function Np(t,e){return Dp((null==e?void 0:e.getAttribute("formaction"))||t.getAttribute("action")||t.action)}function Ip(t){return(function(t){return function(t){return t.pathname.split("/").slice(1)}(t).slice(-1)[0]}(t).match(/\.[^.]*$/)||[])[0]||""}function Pp(t,e){const n=function(t){return e=t.origin+t.pathname,e.endsWith("/")?e:e+"/";var e}(e);return t.href===Dp(n).href||t.href.startsWith(n)}function $p(t,e){return Pp(t,e)&&!!Ip(t).match(/^(?:|\.(?:htm|html|xhtml|php))$/)}function Rp(t){const e=Lp(t);return null!=e?t.href.slice(0,-(e.length+1)):t.href}function Fp(t){return Rp(t)}class Bp{constructor(t){this.response=t}get succeeded(){return this.response.ok}get failed(){return!this.succeeded}get clientError(){return this.statusCode>=400&&this.statusCode<=499}get serverError(){return this.statusCode>=500&&this.statusCode<=599}get redirected(){return this.response.redirected}get location(){return Dp(this.response.url)}get isHTML(){return this.contentType&&this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)}get statusCode(){return this.response.status}get contentType(){return this.header("Content-Type")}get responseText(){return this.response.clone().text()}get responseHTML(){return this.isHTML?this.response.clone().text():Promise.resolve(void 0)}header(t){return this.response.headers.get(t)}}function jp(t){if("false"==t.getAttribute("data-turbo-eval"))return t;{const e=document.createElement("script"),n=Zp("csp-nonce");return n&&(e.nonce=n),e.textContent=t.textContent,e.async=!1,function(t,e){for(const{name:n,value:i}of e.attributes)t.setAttribute(n,i)}(e,t),e}}function Hp(t,{target:e,cancelable:n,detail:i}={}){const r=new CustomEvent(t,{cancelable:n,bubbles:!0,composed:!0,detail:i});return e&&e.isConnected?e.dispatchEvent(r):document.documentElement.dispatchEvent(r),r}function zp(){return new Promise((t=>requestAnimationFrame((()=>t()))))}function Vp(t=""){return(new DOMParser).parseFromString(t,"text/html")}function qp(t,...e){const n=function(t,e){return t.reduce(((t,n,i)=>t+n+(null==e[i]?"":e[i])),"")}(t,e).replace(/^\n/,"").split("\n"),i=n[0].match(/^\s+/),r=i?i[0].length:0;return n.map((t=>t.slice(r))).join("\n")}function Up(){return Array.from({length:36}).map(((t,e)=>8==e||13==e||18==e||23==e?"-":14==e?"4":19==e?(Math.floor(4*Math.random())+8).toString(16):Math.floor(15*Math.random()).toString(16))).join("")}function Wp(t,...e){for(const n of e.map((e=>null==e?void 0:e.getAttribute(t))))if("string"==typeof n)return n;return null}function Kp(...t){for(const e of t)"turbo-frame"==e.localName&&e.setAttribute("busy",""),e.setAttribute("aria-busy","true")}function Yp(...t){for(const e of t)"turbo-frame"==e.localName&&e.removeAttribute("busy"),e.removeAttribute("aria-busy")}function Jp(t,e=2e3){return new Promise((n=>{const i=()=>{t.removeEventListener("error",i),t.removeEventListener("load",i),n()};t.addEventListener("load",i,{once:!0}),t.addEventListener("error",i,{once:!0}),setTimeout(n,e)}))}function Gp(t){switch(t){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}function Xp(...t){const e=Wp("data-turbo-action",...t);return function(t){return"advance"==t||"replace"==t||"restore"==t}(e)?e:null}function Qp(t){return document.querySelector(`meta[name="${t}"]`)}function Zp(t){const e=Qp(t);return e&&e.content}function tf(t,e){var n;if(t instanceof Element)return t.closest(e)||tf(t.assignedSlot||(null===(n=t.getRootNode())||void 0===n?void 0:n.host),e)}!function(t){t[t.get=0]="get",t[t.post=1]="post",t[t.put=2]="put",t[t.patch=3]="patch",t[t.delete=4]="delete"}(Cp||(Cp={}));class ef{constructor(t,e,n,i=new URLSearchParams,r=null){this.abortController=new AbortController,this.resolveRequestPromise=t=>{},this.delegate=t,this.method=e,this.headers=this.defaultHeaders,this.body=i,this.url=n,this.target=r}get location(){return this.url}get params(){return this.url.searchParams}get entries(){return this.body?Array.from(this.body.entries()):[]}cancel(){this.abortController.abort()}async perform(){const{fetchOptions:t}=this;this.delegate.prepareRequest(this),await this.allowRequestToBeIntercepted(t);try{this.delegate.requestStarted(this);const e=await fetch(this.url.href,t);return await this.receive(e)}catch(t){if("AbortError"!==t.name)throw this.willDelegateErrorHandling(t)&&this.delegate.requestErrored(this,t),t}finally{this.delegate.requestFinished(this)}}async receive(t){const e=new Bp(t);return Hp("turbo:before-fetch-response",{cancelable:!0,detail:{fetchResponse:e},target:this.target}).defaultPrevented?this.delegate.requestPreventedHandlingResponse(this,e):e.succeeded?this.delegate.requestSucceededWithResponse(this,e):this.delegate.requestFailedWithResponse(this,e),e}get fetchOptions(){var t;return{method:Cp[this.method].toUpperCase(),credentials:"same-origin",headers:this.headers,redirect:"follow",body:this.isSafe?null:this.body,signal:this.abortSignal,referrer:null===(t=this.delegate.referrer)||void 0===t?void 0:t.href}}get defaultHeaders(){return{Accept:"text/html, application/xhtml+xml"}}get isSafe(){return this.method===Cp.get}get abortSignal(){return this.abortController.signal}acceptResponseType(t){this.headers.Accept=[t,this.headers.Accept].join(", ")}async allowRequestToBeIntercepted(t){const e=new Promise((t=>this.resolveRequestPromise=t));Hp("turbo:before-fetch-request",{cancelable:!0,detail:{fetchOptions:t,url:this.url,resume:this.resolveRequestPromise},target:this.target}).defaultPrevented&&await e}willDelegateErrorHandling(t){return!Hp("turbo:fetch-request-error",{target:this.target,cancelable:!0,detail:{request:this,error:t}}).defaultPrevented}}class nf{constructor(t,e){this.started=!1,this.intersect=t=>{const e=t.slice(-1)[0];(null==e?void 0:e.isIntersecting)&&this.delegate.elementAppearedInViewport(this.element)},this.delegate=t,this.element=e,this.intersectionObserver=new IntersectionObserver(this.intersect)}start(){this.started||(this.started=!0,this.intersectionObserver.observe(this.element))}stop(){this.started&&(this.started=!1,this.intersectionObserver.unobserve(this.element))}}class rf{static wrap(t){return"string"==typeof t?new this(function(t){const e=document.createElement("template");return e.innerHTML=t,e.content}(t)):t}constructor(t){this.fragment=function(t){for(const e of t.querySelectorAll("turbo-stream")){const t=document.importNode(e,!0);for(const e of t.templateElement.content.querySelectorAll("script"))e.replaceWith(jp(e));e.replaceWith(t)}return t}(t)}}rf.contentType="text/vnd.turbo-stream.html",function(t){t[t.initialized=0]="initialized",t[t.requesting=1]="requesting",t[t.waiting=2]="waiting",t[t.receiving=3]="receiving",t[t.stopping=4]="stopping",t[t.stopped=5]="stopped"}(_p||(_p={})),function(t){t.urlEncoded="application/x-www-form-urlencoded",t.multipart="multipart/form-data",t.plain="text/plain"}(Ap||(Ap={}));class sf{static confirmMethod(t,e,n){return Promise.resolve(confirm(t))}constructor(t,e,n,i=!1){this.state=_p.initialized,this.delegate=t,this.formElement=e,this.submitter=n,this.formData=function(t,e){const n=new FormData(t),i=null==e?void 0:e.getAttribute("name"),r=null==e?void 0:e.getAttribute("value");i&&n.append(i,r||"");return n}(e,n),this.location=Dp(this.action),this.method==Cp.get&&function(t,e){const n=new URLSearchParams;for(const[t,i]of e)i instanceof File||n.append(t,i);t.search=n.toString()}(this.location,[...this.body.entries()]),this.fetchRequest=new ef(this,this.method,this.location,this.body,this.formElement),this.mustRedirect=i}get method(){var t;return function(t){switch(t.toLowerCase()){case"get":return Cp.get;case"post":return Cp.post;case"put":return Cp.put;case"patch":return Cp.patch;case"delete":return Cp.delete}}(((null===(t=this.submitter)||void 0===t?void 0:t.getAttribute("formmethod"))||this.formElement.getAttribute("method")||"").toLowerCase())||Cp.get}get action(){var t;const e="string"==typeof this.formElement.action?this.formElement.action:null;return(null===(t=this.submitter)||void 0===t?void 0:t.hasAttribute("formaction"))?this.submitter.getAttribute("formaction")||"":this.formElement.getAttribute("action")||e||""}get body(){return this.enctype==Ap.urlEncoded||this.method==Cp.get?new URLSearchParams(this.stringFormData):this.formData}get enctype(){var t;return function(t){switch(t.toLowerCase()){case Ap.multipart:return Ap.multipart;case Ap.plain:return Ap.plain;default:return Ap.urlEncoded}}((null===(t=this.submitter)||void 0===t?void 0:t.getAttribute("formenctype"))||this.formElement.enctype)}get isSafe(){return this.fetchRequest.isSafe}get stringFormData(){return[...this.formData].reduce(((t,[e,n])=>t.concat("string"==typeof n?[[e,n]]:[])),[])}async start(){const{initialized:t,requesting:e}=_p,n=Wp("data-turbo-confirm",this.submitter,this.formElement);if("string"==typeof n){if(!await sf.confirmMethod(n,this.formElement,this.submitter))return}if(this.state==t)return this.state=e,this.fetchRequest.perform()}stop(){const{stopping:t,stopped:e}=_p;if(this.state!=t&&this.state!=e)return this.state=t,this.fetchRequest.cancel(),!0}prepareRequest(t){if(!t.isSafe){const e=function(t){if(null!=t){const e=(document.cookie?document.cookie.split("; "):[]).find((e=>e.startsWith(t)));if(e){const t=e.split("=").slice(1).join("=");return t?decodeURIComponent(t):void 0}}}(Zp("csrf-param"))||Zp("csrf-token");e&&(t.headers["X-CSRF-Token"]=e)}this.requestAcceptsTurboStreamResponse(t)&&t.acceptResponseType(rf.contentType)}requestStarted(t){var e;this.state=_p.waiting,null===(e=this.submitter)||void 0===e||e.setAttribute("disabled",""),this.setSubmitsWith(),Hp("turbo:submit-start",{target:this.formElement,detail:{formSubmission:this}}),this.delegate.formSubmissionStarted(this)}requestPreventedHandlingResponse(t,e){this.result={success:e.succeeded,fetchResponse:e}}requestSucceededWithResponse(t,e){if(e.clientError||e.serverError)this.delegate.formSubmissionFailedWithResponse(this,e);else if(this.requestMustRedirect(t)&&function(t){return 200==t.statusCode&&!t.redirected}(e)){const t=new Error("Form responses must redirect to another location");this.delegate.formSubmissionErrored(this,t)}else this.state=_p.receiving,this.result={success:!0,fetchResponse:e},this.delegate.formSubmissionSucceededWithResponse(this,e)}requestFailedWithResponse(t,e){this.result={success:!1,fetchResponse:e},this.delegate.formSubmissionFailedWithResponse(this,e)}requestErrored(t,e){this.result={success:!1,error:e},this.delegate.formSubmissionErrored(this,e)}requestFinished(t){var e;this.state=_p.stopped,null===(e=this.submitter)||void 0===e||e.removeAttribute("disabled"),this.resetSubmitterText(),Hp("turbo:submit-end",{target:this.formElement,detail:Object.assign({formSubmission:this},this.result)}),this.delegate.formSubmissionFinished(this)}setSubmitsWith(){if(this.submitter&&this.submitsWith)if(this.submitter.matches("button"))this.originalSubmitText=this.submitter.innerHTML,this.submitter.innerHTML=this.submitsWith;else if(this.submitter.matches("input")){const t=this.submitter;this.originalSubmitText=t.value,t.value=this.submitsWith}}resetSubmitterText(){if(this.submitter&&this.originalSubmitText)if(this.submitter.matches("button"))this.submitter.innerHTML=this.originalSubmitText;else if(this.submitter.matches("input")){this.submitter.value=this.originalSubmitText}}requestMustRedirect(t){return!t.isSafe&&this.mustRedirect}requestAcceptsTurboStreamResponse(t){return!t.isSafe||function(t,...e){return e.some((e=>e&&e.hasAttribute(t)))}("data-turbo-stream",this.submitter,this.formElement)}get submitsWith(){var t;return null===(t=this.submitter)||void 0===t?void 0:t.getAttribute("data-turbo-submits-with")}}class of{constructor(t){this.element=t}get activeElement(){return this.element.ownerDocument.activeElement}get children(){return[...this.element.children]}hasAnchor(t){return null!=this.getElementForAnchor(t)}getElementForAnchor(t){return t?this.element.querySelector(`[id='${t}'], a[name='${t}']`):null}get isConnected(){return this.element.isConnected}get firstAutofocusableElement(){for(const t of this.element.querySelectorAll("[autofocus]"))if(null==t.closest("[inert], :disabled, [hidden], details:not([open]), dialog:not([open])"))return t;return null}get permanentElements(){return lf(this.element)}getPermanentElementById(t){return af(this.element,t)}getPermanentElementMapForSnapshot(t){const e={};for(const n of this.permanentElements){const{id:i}=n,r=t.getPermanentElementById(i);r&&(e[i]=[n,r])}return e}}function af(t,e){return t.querySelector(`#${e}[data-turbo-permanent]`)}function lf(t){return t.querySelectorAll("[id][data-turbo-permanent]")}class cf{constructor(t,e){this.started=!1,this.submitCaptured=()=>{this.eventTarget.removeEventListener("submit",this.submitBubbled,!1),this.eventTarget.addEventListener("submit",this.submitBubbled,!1)},this.submitBubbled=t=>{if(!t.defaultPrevented){const e=t.target instanceof HTMLFormElement?t.target:void 0,n=t.submitter||void 0;e&&function(t,e){const n=(null==e?void 0:e.getAttribute("formmethod"))||t.getAttribute("method");return"dialog"!=n}(e,n)&&function(t,e){if((null==e?void 0:e.hasAttribute("formtarget"))||t.hasAttribute("target")){const n=(null==e?void 0:e.getAttribute("formtarget"))||t.target;for(const t of document.getElementsByName(n))if(t instanceof HTMLIFrameElement)return!1;return!0}return!0}(e,n)&&this.delegate.willSubmitForm(e,n)&&(t.preventDefault(),t.stopImmediatePropagation(),this.delegate.formSubmitted(e,n))}},this.delegate=t,this.eventTarget=e}start(){this.started||(this.eventTarget.addEventListener("submit",this.submitCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("submit",this.submitCaptured,!0),this.started=!1)}}class df{constructor(t,e){this.resolveRenderPromise=t=>{},this.resolveInterceptionPromise=t=>{},this.delegate=t,this.element=e}scrollToAnchor(t){const e=this.snapshot.getElementForAnchor(t);e?(this.scrollToElement(e),this.focusElement(e)):this.scrollToPosition({x:0,y:0})}scrollToAnchorFromLocation(t){this.scrollToAnchor(Lp(t))}scrollToElement(t){t.scrollIntoView()}focusElement(t){t instanceof HTMLElement&&(t.hasAttribute("tabindex")?t.focus():(t.setAttribute("tabindex","-1"),t.focus(),t.removeAttribute("tabindex")))}scrollToPosition({x:t,y:e}){this.scrollRoot.scrollTo(t,e)}scrollToTop(){this.scrollToPosition({x:0,y:0})}get scrollRoot(){return window}async render(t){const{isPreview:e,shouldRender:n,newSnapshot:i}=t;if(n)try{this.renderPromise=new Promise((t=>this.resolveRenderPromise=t)),this.renderer=t,await this.prepareToRenderSnapshot(t);const n=new Promise((t=>this.resolveInterceptionPromise=t)),r={resume:this.resolveInterceptionPromise,render:this.renderer.renderElement};this.delegate.allowsImmediateRender(i,r)||await n,await this.renderSnapshot(t),this.delegate.viewRenderedSnapshot(i,e),this.delegate.preloadOnLoadLinksForView(this.element),this.finishRenderingSnapshot(t)}finally{delete this.renderer,this.resolveRenderPromise(void 0),delete this.renderPromise}else this.invalidate(t.reloadReason)}invalidate(t){this.delegate.viewInvalidated(t)}async prepareToRenderSnapshot(t){this.markAsPreview(t.isPreview),await t.prepareToRender()}markAsPreview(t){t?this.element.setAttribute("data-turbo-preview",""):this.element.removeAttribute("data-turbo-preview")}async renderSnapshot(t){await t.render()}finishRenderingSnapshot(t){t.finishRendering()}}class hf extends df{missing(){this.element.innerHTML='<strong class="turbo-frame-error">Content missing</strong>'}get snapshot(){return new of(this.element)}}class uf{constructor(t,e){this.clickBubbled=t=>{this.respondsToEventTarget(t.target)?this.clickEvent=t:delete this.clickEvent},this.linkClicked=t=>{this.clickEvent&&this.respondsToEventTarget(t.target)&&t.target instanceof Element&&this.delegate.shouldInterceptLinkClick(t.target,t.detail.url,t.detail.originalEvent)&&(this.clickEvent.preventDefault(),t.preventDefault(),this.delegate.linkClickIntercepted(t.target,t.detail.url,t.detail.originalEvent)),delete this.clickEvent},this.willVisit=t=>{delete this.clickEvent},this.delegate=t,this.element=e}start(){this.element.addEventListener("click",this.clickBubbled),document.addEventListener("turbo:click",this.linkClicked),document.addEventListener("turbo:before-visit",this.willVisit)}stop(){this.element.removeEventListener("click",this.clickBubbled),document.removeEventListener("turbo:click",this.linkClicked),document.removeEventListener("turbo:before-visit",this.willVisit)}respondsToEventTarget(t){const e=t instanceof Element?t:t instanceof Node?t.parentElement:null;return e&&e.closest("turbo-frame, html")==this.element}}class pf{constructor(t,e){this.started=!1,this.clickCaptured=()=>{this.eventTarget.removeEventListener("click",this.clickBubbled,!1),this.eventTarget.addEventListener("click",this.clickBubbled,!1)},this.clickBubbled=t=>{if(t instanceof MouseEvent&&this.clickEventIsSignificant(t)){const e=t.composedPath&&t.composedPath()[0]||t.target,n=this.findLinkFromClickTarget(e);if(n&&function(t){if(t.hasAttribute("target")){for(const e of document.getElementsByName(t.target))if(e instanceof HTMLIFrameElement)return!1;return!0}return!0}(n)){const e=this.getLocationForLink(n);this.delegate.willFollowLinkToLocation(n,e,t)&&(t.preventDefault(),this.delegate.followedLinkToLocation(n,e))}}},this.delegate=t,this.eventTarget=e}start(){this.started||(this.eventTarget.addEventListener("click",this.clickCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("click",this.clickCaptured,!0),this.started=!1)}clickEventIsSignificant(t){return!(t.target&&t.target.isContentEditable||t.defaultPrevented||t.which>1||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)}findLinkFromClickTarget(t){return tf(t,"a[href]:not([target^=_]):not([download])")}getLocationForLink(t){return Dp(t.getAttribute("href")||"")}}class ff{constructor(t,e){this.delegate=t,this.linkInterceptor=new pf(this,e)}start(){this.linkInterceptor.start()}stop(){this.linkInterceptor.stop()}willFollowLinkToLocation(t,e,n){return this.delegate.willSubmitFormLinkToLocation(t,e,n)&&t.hasAttribute("data-turbo-method")}followedLinkToLocation(t,e){const n=document.createElement("form");for(const[t,i]of e.searchParams)n.append(Object.assign(document.createElement("input"),{type:"hidden",name:t,value:i}));const i=Object.assign(e,{search:""});n.setAttribute("data-turbo","true"),n.setAttribute("action",i.href),n.setAttribute("hidden","");const r=t.getAttribute("data-turbo-method");r&&n.setAttribute("method",r);const s=t.getAttribute("data-turbo-frame");s&&n.setAttribute("data-turbo-frame",s);const o=Xp(t);o&&n.setAttribute("data-turbo-action",o);const a=t.getAttribute("data-turbo-confirm");a&&n.setAttribute("data-turbo-confirm",a);t.hasAttribute("data-turbo-stream")&&n.setAttribute("data-turbo-stream",""),this.delegate.submittedFormLinkToLocation(t,e,n),document.body.appendChild(n),n.addEventListener("turbo:submit-end",(()=>n.remove()),{once:!0}),requestAnimationFrame((()=>n.requestSubmit()))}}class mf{static async preservingPermanentElements(t,e,n){const i=new this(t,e);i.enter(),await n(),i.leave()}constructor(t,e){this.delegate=t,this.permanentElementMap=e}enter(){for(const t in this.permanentElementMap){const[e,n]=this.permanentElementMap[t];this.delegate.enteringBardo(e,n),this.replaceNewPermanentElementWithPlaceholder(n)}}leave(){for(const t in this.permanentElementMap){const[e]=this.permanentElementMap[t];this.replaceCurrentPermanentElementWithClone(e),this.replacePlaceholderWithPermanentElement(e),this.delegate.leavingBardo(e)}}replaceNewPermanentElementWithPlaceholder(t){const e=function(t){const e=document.createElement("meta");return e.setAttribute("name","turbo-permanent-placeholder"),e.setAttribute("content",t.id),e}(t);t.replaceWith(e)}replaceCurrentPermanentElementWithClone(t){const e=t.cloneNode(!0);t.replaceWith(e)}replacePlaceholderWithPermanentElement(t){const e=this.getPlaceholderById(t.id);null==e||e.replaceWith(t)}getPlaceholderById(t){return this.placeholders.find((e=>e.content==t))}get placeholders(){return[...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]}}class gf{constructor(t,e,n,i,r=!0){this.activeElement=null,this.currentSnapshot=t,this.newSnapshot=e,this.isPreview=i,this.willRender=r,this.renderElement=n,this.promise=new Promise(((t,e)=>this.resolvingFunctions={resolve:t,reject:e}))}get shouldRender(){return!0}get reloadReason(){}prepareToRender(){}finishRendering(){this.resolvingFunctions&&(this.resolvingFunctions.resolve(),delete this.resolvingFunctions)}async preservingPermanentElements(t){await mf.preservingPermanentElements(this,this.permanentElementMap,t)}focusFirstAutofocusableElement(){const t=this.connectedSnapshot.firstAutofocusableElement;(function(t){return t&&"function"==typeof t.focus})(t)&&t.focus()}enteringBardo(t){this.activeElement||t.contains(this.currentSnapshot.activeElement)&&(this.activeElement=this.currentSnapshot.activeElement)}leavingBardo(t){t.contains(this.activeElement)&&this.activeElement instanceof HTMLElement&&(this.activeElement.focus(),this.activeElement=null)}get connectedSnapshot(){return this.newSnapshot.isConnected?this.newSnapshot:this.currentSnapshot}get currentElement(){return this.currentSnapshot.element}get newElement(){return this.newSnapshot.element}get permanentElementMap(){return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)}}class bf extends gf{static renderElement(t,e){var n;const i=document.createRange();i.selectNodeContents(t),i.deleteContents();const r=e,s=null===(n=r.ownerDocument)||void 0===n?void 0:n.createRange();s&&(s.selectNodeContents(r),t.appendChild(s.extractContents()))}constructor(t,e,n,i,r,s=!0){super(e,n,i,r,s),this.delegate=t}get shouldRender(){return!0}async render(){await zp(),this.preservingPermanentElements((()=>{this.loadFrameElement()})),this.scrollFrameIntoView(),await zp(),this.focusFirstAutofocusableElement(),await zp(),this.activateScriptElements()}loadFrameElement(){this.delegate.willRenderFrame(this.currentElement,this.newElement),this.renderElement(this.currentElement,this.newElement)}scrollFrameIntoView(){if(this.currentElement.autoscroll||this.newElement.autoscroll){const n=this.currentElement.firstElementChild,i=(t=this.currentElement.getAttribute("data-autoscroll-block"),e="end","end"==t||"start"==t||"center"==t||"nearest"==t?t:e),r=function(t,e){return"auto"==t||"smooth"==t?t:e}(this.currentElement.getAttribute("data-autoscroll-behavior"),"auto");if(n)return n.scrollIntoView({block:i,behavior:r}),!0}var t,e;return!1}activateScriptElements(){for(const t of this.newScriptElements){const e=jp(t);t.replaceWith(e)}}get newScriptElements(){return this.currentElement.querySelectorAll("script")}}class vf{static get defaultCSS(){return qp`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${vf.animationDuration}ms ease-out,
          opacity ${vf.animationDuration/2}ms ${vf.animationDuration/2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `}constructor(){this.hiding=!1,this.value=0,this.visible=!1,this.trickle=()=>{this.setValue(this.value+Math.random()/100)},this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement(),this.installStylesheetElement(),this.setValue(0)}show(){this.visible||(this.visible=!0,this.installProgressElement(),this.startTrickling())}hide(){this.visible&&!this.hiding&&(this.hiding=!0,this.fadeProgressElement((()=>{this.uninstallProgressElement(),this.stopTrickling(),this.visible=!1,this.hiding=!1})))}setValue(t){this.value=t,this.refresh()}installStylesheetElement(){document.head.insertBefore(this.stylesheetElement,document.head.firstChild)}installProgressElement(){this.progressElement.style.width="0",this.progressElement.style.opacity="1",document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()}fadeProgressElement(t){this.progressElement.style.opacity="0",setTimeout(t,1.5*vf.animationDuration)}uninstallProgressElement(){this.progressElement.parentNode&&document.documentElement.removeChild(this.progressElement)}startTrickling(){this.trickleInterval||(this.trickleInterval=window.setInterval(this.trickle,vf.animationDuration))}stopTrickling(){window.clearInterval(this.trickleInterval),delete this.trickleInterval}refresh(){requestAnimationFrame((()=>{this.progressElement.style.width=10+90*this.value+"%"}))}createStylesheetElement(){const t=document.createElement("style");return t.type="text/css",t.textContent=vf.defaultCSS,this.cspNonce&&(t.nonce=this.cspNonce),t}createProgressElement(){const t=document.createElement("div");return t.className="turbo-progress-bar",t}get cspNonce(){return Zp("csp-nonce")}}vf.animationDuration=300;class yf extends of{constructor(){super(...arguments),this.detailsByOuterHTML=this.children.filter((t=>!function(t){const e=t.localName;return"noscript"==e}(t))).map((t=>function(t){t.hasAttribute("nonce")&&t.setAttribute("nonce","");return t}(t))).reduce(((t,e)=>{const{outerHTML:n}=e,i=n in t?t[n]:{type:wf(e),tracked:kf(e),elements:[]};return Object.assign(Object.assign({},t),{[n]:Object.assign(Object.assign({},i),{elements:[...i.elements,e]})})}),{})}get trackedElementSignature(){return Object.keys(this.detailsByOuterHTML).filter((t=>this.detailsByOuterHTML[t].tracked)).join("")}getScriptElementsNotInSnapshot(t){return this.getElementsMatchingTypeNotInSnapshot("script",t)}getStylesheetElementsNotInSnapshot(t){return this.getElementsMatchingTypeNotInSnapshot("stylesheet",t)}getElementsMatchingTypeNotInSnapshot(t,e){return Object.keys(this.detailsByOuterHTML).filter((t=>!(t in e.detailsByOuterHTML))).map((t=>this.detailsByOuterHTML[t])).filter((({type:e})=>e==t)).map((({elements:[t]})=>t))}get provisionalElements(){return Object.keys(this.detailsByOuterHTML).reduce(((t,e)=>{const{type:n,tracked:i,elements:r}=this.detailsByOuterHTML[e];return null!=n||i?r.length>1?[...t,...r.slice(1)]:t:[...t,...r]}),[])}getMetaValue(t){const e=this.findMetaElementByName(t);return e?e.getAttribute("content"):null}findMetaElementByName(t){return Object.keys(this.detailsByOuterHTML).reduce(((e,n)=>{const{elements:[i]}=this.detailsByOuterHTML[n];return function(t,e){const n=t.localName;return"meta"==n&&t.getAttribute("name")==e}(i,t)?i:e}),void 0)}}function wf(t){return function(t){const e=t.localName;return"script"==e}(t)?"script":function(t){const e=t.localName;return"style"==e||"link"==e&&"stylesheet"==t.getAttribute("rel")}(t)?"stylesheet":void 0}function kf(t){return"reload"==t.getAttribute("data-turbo-track")}class Sf extends of{static fromHTMLString(t=""){return this.fromDocument(Vp(t))}static fromElement(t){return this.fromDocument(t.ownerDocument)}static fromDocument({head:t,body:e}){return new this(e,new yf(t))}constructor(t,e){super(t),this.headSnapshot=e}clone(){const t=this.element.cloneNode(!0),e=this.element.querySelectorAll("select"),n=t.querySelectorAll("select");for(const[t,i]of e.entries()){const e=n[t];for(const t of e.selectedOptions)t.selected=!1;for(const t of i.selectedOptions)e.options[t.index].selected=!0}for(const e of t.querySelectorAll('input[type="password"]'))e.value="";return new Sf(t,this.headSnapshot)}get headElement(){return this.headSnapshot.element}get rootLocation(){var t;return Dp(null!==(t=this.getSetting("root"))&&void 0!==t?t:"/")}get cacheControlValue(){return this.getSetting("cache-control")}get isPreviewable(){return"no-preview"!=this.cacheControlValue}get isCacheable(){return"no-cache"!=this.cacheControlValue}get isVisitable(){return"reload"!=this.getSetting("visit-control")}getSetting(t){return this.headSnapshot.getMetaValue(`turbo-${t}`)}}!function(t){t.visitStart="visitStart",t.requestStart="requestStart",t.requestEnd="requestEnd",t.visitEnd="visitEnd"}(Op||(Op={})),function(t){t.initialized="initialized",t.started="started",t.canceled="canceled",t.failed="failed",t.completed="completed"}(Tp||(Tp={}));const xf={action:"advance",historyChanged:!1,visitCachedSnapshot:()=>{},willRender:!0,updateHistory:!0,shouldCacheSnapshot:!0,acceptsStreamResponse:!1};var Ef,Cf;!function(t){t[t.networkFailure=0]="networkFailure",t[t.timeoutFailure=-1]="timeoutFailure",t[t.contentTypeMismatch=-2]="contentTypeMismatch"}(Ef||(Ef={}));class _f{constructor(t,e,n,i={}){this.identifier=Up(),this.timingMetrics={},this.followedRedirect=!1,this.historyChanged=!1,this.scrolled=!1,this.shouldCacheSnapshot=!0,this.acceptsStreamResponse=!1,this.snapshotCached=!1,this.state=Tp.initialized,this.delegate=t,this.location=e,this.restorationIdentifier=n||Up();const{action:r,historyChanged:s,referrer:o,snapshot:a,snapshotHTML:l,response:c,visitCachedSnapshot:d,willRender:h,updateHistory:u,shouldCacheSnapshot:p,acceptsStreamResponse:f}=Object.assign(Object.assign({},xf),i);this.action=r,this.historyChanged=s,this.referrer=o,this.snapshot=a,this.snapshotHTML=l,this.response=c,this.isSamePage=this.delegate.locationWithActionIsSamePage(this.location,this.action),this.visitCachedSnapshot=d,this.willRender=h,this.updateHistory=u,this.scrolled=!h,this.shouldCacheSnapshot=p,this.acceptsStreamResponse=f}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}get restorationData(){return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)}get silent(){return this.isSamePage}start(){this.state==Tp.initialized&&(this.recordTimingMetric(Op.visitStart),this.state=Tp.started,this.adapter.visitStarted(this),this.delegate.visitStarted(this))}cancel(){this.state==Tp.started&&(this.request&&this.request.cancel(),this.cancelRender(),this.state=Tp.canceled)}complete(){this.state==Tp.started&&(this.recordTimingMetric(Op.visitEnd),this.state=Tp.completed,this.followRedirect(),this.followedRedirect||(this.adapter.visitCompleted(this),this.delegate.visitCompleted(this)))}fail(){this.state==Tp.started&&(this.state=Tp.failed,this.adapter.visitFailed(this))}changeHistory(){var t;if(!this.historyChanged&&this.updateHistory){const e=Gp(this.location.href===(null===(t=this.referrer)||void 0===t?void 0:t.href)?"replace":this.action);this.history.update(e,this.location,this.restorationIdentifier),this.historyChanged=!0}}issueRequest(){this.hasPreloadedResponse()?this.simulateRequest():this.shouldIssueRequest()&&!this.request&&(this.request=new ef(this,Cp.get,this.location),this.request.perform())}simulateRequest(){this.response&&(this.startRequest(),this.recordResponse(),this.finishRequest())}startRequest(){this.recordTimingMetric(Op.requestStart),this.adapter.visitRequestStarted(this)}recordResponse(t=this.response){if(this.response=t,t){const{statusCode:e}=t;Af(e)?this.adapter.visitRequestCompleted(this):this.adapter.visitRequestFailedWithStatusCode(this,e)}}finishRequest(){this.recordTimingMetric(Op.requestEnd),this.adapter.visitRequestFinished(this)}loadResponse(){if(this.response){const{statusCode:t,responseHTML:e}=this.response;this.render((async()=>{this.shouldCacheSnapshot&&this.cacheSnapshot(),this.view.renderPromise&&await this.view.renderPromise,Af(t)&&null!=e?(await this.view.renderPage(Sf.fromHTMLString(e),!1,this.willRender,this),this.performScroll(),this.adapter.visitRendered(this),this.complete()):(await this.view.renderError(Sf.fromHTMLString(e),this),this.adapter.visitRendered(this),this.fail())}))}}getCachedSnapshot(){const t=this.view.getCachedSnapshotForLocation(this.location)||this.getPreloadedSnapshot();if(t&&(!Lp(this.location)||t.hasAnchor(Lp(this.location)))&&("restore"==this.action||t.isPreviewable))return t}getPreloadedSnapshot(){if(this.snapshotHTML)return Sf.fromHTMLString(this.snapshotHTML)}hasCachedSnapshot(){return null!=this.getCachedSnapshot()}loadCachedSnapshot(){const t=this.getCachedSnapshot();if(t){const e=this.shouldIssueRequest();this.render((async()=>{this.cacheSnapshot(),this.isSamePage?this.adapter.visitRendered(this):(this.view.renderPromise&&await this.view.renderPromise,await this.view.renderPage(t,e,this.willRender,this),this.performScroll(),this.adapter.visitRendered(this),e||this.complete())}))}}followRedirect(){var t;this.redirectedToLocation&&!this.followedRedirect&&(null===(t=this.response)||void 0===t?void 0:t.redirected)&&(this.adapter.visitProposedToLocation(this.redirectedToLocation,{action:"replace",response:this.response,shouldCacheSnapshot:!1,willRender:!1}),this.followedRedirect=!0)}goToSamePageAnchor(){this.isSamePage&&this.render((async()=>{this.cacheSnapshot(),this.performScroll(),this.changeHistory(),this.adapter.visitRendered(this)}))}prepareRequest(t){this.acceptsStreamResponse&&t.acceptResponseType(rf.contentType)}requestStarted(){this.startRequest()}requestPreventedHandlingResponse(t,e){}async requestSucceededWithResponse(t,e){const n=await e.responseHTML,{redirected:i,statusCode:r}=e;null==n?this.recordResponse({statusCode:Ef.contentTypeMismatch,redirected:i}):(this.redirectedToLocation=e.redirected?e.location:void 0,this.recordResponse({statusCode:r,responseHTML:n,redirected:i}))}async requestFailedWithResponse(t,e){const n=await e.responseHTML,{redirected:i,statusCode:r}=e;null==n?this.recordResponse({statusCode:Ef.contentTypeMismatch,redirected:i}):this.recordResponse({statusCode:r,responseHTML:n,redirected:i})}requestErrored(t,e){this.recordResponse({statusCode:Ef.networkFailure,redirected:!1})}requestFinished(){this.finishRequest()}performScroll(){this.scrolled||this.view.forceReloaded||("restore"==this.action?this.scrollToRestoredPosition()||this.scrollToAnchor()||this.view.scrollToTop():this.scrollToAnchor()||this.view.scrollToTop(),this.isSamePage&&this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation,this.location),this.scrolled=!0)}scrollToRestoredPosition(){const{scrollPosition:t}=this.restorationData;if(t)return this.view.scrollToPosition(t),!0}scrollToAnchor(){const t=Lp(this.location);if(null!=t)return this.view.scrollToAnchor(t),!0}recordTimingMetric(t){this.timingMetrics[t]=(new Date).getTime()}getTimingMetrics(){return Object.assign({},this.timingMetrics)}getHistoryMethodForAction(t){switch(t){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}hasPreloadedResponse(){return"object"==typeof this.response}shouldIssueRequest(){return!this.isSamePage&&("restore"==this.action?!this.hasCachedSnapshot():this.willRender)}cacheSnapshot(){this.snapshotCached||(this.view.cacheSnapshot(this.snapshot).then((t=>t&&this.visitCachedSnapshot(t))),this.snapshotCached=!0)}async render(t){this.cancelRender(),await new Promise((t=>{this.frame=requestAnimationFrame((()=>t()))})),await t(),delete this.frame}cancelRender(){this.frame&&(cancelAnimationFrame(this.frame),delete this.frame)}}function Af(t){return t>=200&&t<300}class Of{constructor(t){this.progressBar=new vf,this.showProgressBar=()=>{this.progressBar.show()},this.session=t}visitProposedToLocation(t,e){this.navigator.startVisit(t,(null==e?void 0:e.restorationIdentifier)||Up(),e)}visitStarted(t){this.location=t.location,t.loadCachedSnapshot(),t.issueRequest(),t.goToSamePageAnchor()}visitRequestStarted(t){this.progressBar.setValue(0),t.hasCachedSnapshot()||"restore"!=t.action?this.showVisitProgressBarAfterDelay():this.showProgressBar()}visitRequestCompleted(t){t.loadResponse()}visitRequestFailedWithStatusCode(t,e){switch(e){case Ef.networkFailure:case Ef.timeoutFailure:case Ef.contentTypeMismatch:return this.reload({reason:"request_failed",context:{statusCode:e}});default:return t.loadResponse()}}visitRequestFinished(t){this.progressBar.setValue(1),this.hideVisitProgressBar()}visitCompleted(t){}pageInvalidated(t){this.reload(t)}visitFailed(t){}visitRendered(t){}formSubmissionStarted(t){this.progressBar.setValue(0),this.showFormProgressBarAfterDelay()}formSubmissionFinished(t){this.progressBar.setValue(1),this.hideFormProgressBar()}showVisitProgressBarAfterDelay(){this.visitProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay)}hideVisitProgressBar(){this.progressBar.hide(),null!=this.visitProgressBarTimeout&&(window.clearTimeout(this.visitProgressBarTimeout),delete this.visitProgressBarTimeout)}showFormProgressBarAfterDelay(){null==this.formProgressBarTimeout&&(this.formProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay))}hideFormProgressBar(){this.progressBar.hide(),null!=this.formProgressBarTimeout&&(window.clearTimeout(this.formProgressBarTimeout),delete this.formProgressBarTimeout)}reload(t){var e;Hp("turbo:reload",{detail:t}),window.location.href=(null===(e=this.location)||void 0===e?void 0:e.toString())||window.location.href}get navigator(){return this.session.navigator}}class Tf{constructor(){this.selector="[data-turbo-temporary]",this.deprecatedSelector="[data-turbo-cache=false]",this.started=!1,this.removeTemporaryElements=t=>{for(const t of this.temporaryElements)t.remove()}}start(){this.started||(this.started=!0,addEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}get temporaryElements(){return[...document.querySelectorAll(this.selector),...this.temporaryElementsWithDeprecation]}get temporaryElementsWithDeprecation(){const t=document.querySelectorAll(this.deprecatedSelector);return t.length&&console.warn(`The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`),[...t]}}class Mf{constructor(t,e){this.session=t,this.element=e,this.linkInterceptor=new uf(this,e),this.formSubmitObserver=new cf(this,e)}start(){this.linkInterceptor.start(),this.formSubmitObserver.start()}stop(){this.linkInterceptor.stop(),this.formSubmitObserver.stop()}shouldInterceptLinkClick(t,e,n){return this.shouldRedirect(t)}linkClickIntercepted(t,e,n){const i=this.findFrameElement(t);i&&i.delegate.linkClickIntercepted(t,e,n)}willSubmitForm(t,e){return null==t.closest("turbo-frame")&&this.shouldSubmit(t,e)&&this.shouldRedirect(t,e)}formSubmitted(t,e){const n=this.findFrameElement(t,e);n&&n.delegate.formSubmitted(t,e)}shouldSubmit(t,e){var n;const i=Np(t,e),r=this.element.ownerDocument.querySelector('meta[name="turbo-root"]'),s=Dp(null!==(n=null==r?void 0:r.content)&&void 0!==n?n:"/");return this.shouldRedirect(t,e)&&$p(i,s)}shouldRedirect(t,e){if(t instanceof HTMLFormElement?this.session.submissionIsNavigatable(t,e):this.session.elementIsNavigatable(t)){const n=this.findFrameElement(t,e);return!!n&&n!=t.closest("turbo-frame")}return!1}findFrameElement(t,e){const n=(null==e?void 0:e.getAttribute("data-turbo-frame"))||t.getAttribute("data-turbo-frame");if(n&&"_top"!=n){const t=this.element.querySelector(`#${n}:not([disabled])`);if(t instanceof Mp)return t}}}class Df{constructor(t){this.restorationIdentifier=Up(),this.restorationData={},this.started=!1,this.pageLoaded=!1,this.onPopState=t=>{if(this.shouldHandlePopState()){const{turbo:e}=t.state||{};if(e){this.location=new URL(window.location.href);const{restorationIdentifier:t}=e;this.restorationIdentifier=t,this.delegate.historyPoppedToLocationWithRestorationIdentifier(this.location,t)}}},this.onPageLoad=async t=>{await Promise.resolve(),this.pageLoaded=!0},this.delegate=t}start(){this.started||(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.started=!0,this.replace(new URL(window.location.href)))}stop(){this.started&&(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1)}push(t,e){this.update(history.pushState,t,e)}replace(t,e){this.update(history.replaceState,t,e)}update(t,e,n=Up()){const i={turbo:{restorationIdentifier:n}};t.call(history,i,"",e.href),this.location=e,this.restorationIdentifier=n}getRestorationDataForIdentifier(t){return this.restorationData[t]||{}}updateRestorationData(t){const{restorationIdentifier:e}=this,n=this.restorationData[e];this.restorationData[e]=Object.assign(Object.assign({},n),t)}assumeControlOfScrollRestoration(){var t;this.previousScrollRestoration||(this.previousScrollRestoration=null!==(t=history.scrollRestoration)&&void 0!==t?t:"auto",history.scrollRestoration="manual")}relinquishControlOfScrollRestoration(){this.previousScrollRestoration&&(history.scrollRestoration=this.previousScrollRestoration,delete this.previousScrollRestoration)}shouldHandlePopState(){return this.pageIsLoaded()}pageIsLoaded(){return this.pageLoaded||"complete"==document.readyState}}class Lf{constructor(t){this.delegate=t}proposeVisit(t,e={}){this.delegate.allowsVisitingLocationWithAction(t,e.action)&&($p(t,this.view.snapshot.rootLocation)?this.delegate.visitProposedToLocation(t,e):window.location.href=t.toString())}startVisit(t,e,n={}){this.stop(),this.currentVisit=new _f(this,Dp(t),e,Object.assign({referrer:this.location},n)),this.currentVisit.start()}submitForm(t,e){this.stop(),this.formSubmission=new sf(this,t,e,!0),this.formSubmission.start()}stop(){this.formSubmission&&(this.formSubmission.stop(),delete this.formSubmission),this.currentVisit&&(this.currentVisit.cancel(),delete this.currentVisit)}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}formSubmissionStarted(t){"function"==typeof this.adapter.formSubmissionStarted&&this.adapter.formSubmissionStarted(t)}async formSubmissionSucceededWithResponse(t,e){if(t==this.formSubmission){const n=await e.responseHTML;if(n){const i=t.isSafe;i||this.view.clearSnapshotCache();const{statusCode:r,redirected:s}=e,o={action:this.getActionForFormSubmission(t),shouldCacheSnapshot:i,response:{statusCode:r,responseHTML:n,redirected:s}};this.proposeVisit(e.location,o)}}}async formSubmissionFailedWithResponse(t,e){const n=await e.responseHTML;if(n){const t=Sf.fromHTMLString(n);e.serverError?await this.view.renderError(t,this.currentVisit):await this.view.renderPage(t,!1,!0,this.currentVisit),this.view.scrollToTop(),this.view.clearSnapshotCache()}}formSubmissionErrored(t,e){console.error(e)}formSubmissionFinished(t){"function"==typeof this.adapter.formSubmissionFinished&&this.adapter.formSubmissionFinished(t)}visitStarted(t){this.delegate.visitStarted(t)}visitCompleted(t){this.delegate.visitCompleted(t)}locationWithActionIsSamePage(t,e){const n=Lp(t),i=Lp(this.view.lastRenderedLocation),r="restore"===e&&void 0===n;return"replace"!==e&&Rp(t)===Rp(this.view.lastRenderedLocation)&&(r||null!=n&&n!==i)}visitScrolledToSamePageLocation(t,e){this.delegate.visitScrolledToSamePageLocation(t,e)}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}getActionForFormSubmission({submitter:t,formElement:e}){return Xp(t,e)||"advance"}}!function(t){t[t.initial=0]="initial",t[t.loading=1]="loading",t[t.interactive=2]="interactive",t[t.complete=3]="complete"}(Cf||(Cf={}));class Nf{constructor(t){this.stage=Cf.initial,this.started=!1,this.interpretReadyState=()=>{const{readyState:t}=this;"interactive"==t?this.pageIsInteractive():"complete"==t&&this.pageIsComplete()},this.pageWillUnload=()=>{this.delegate.pageWillUnload()},this.delegate=t}start(){this.started||(this.stage==Cf.initial&&(this.stage=Cf.loading),document.addEventListener("readystatechange",this.interpretReadyState,!1),addEventListener("pagehide",this.pageWillUnload,!1),this.started=!0)}stop(){this.started&&(document.removeEventListener("readystatechange",this.interpretReadyState,!1),removeEventListener("pagehide",this.pageWillUnload,!1),this.started=!1)}pageIsInteractive(){this.stage==Cf.loading&&(this.stage=Cf.interactive,this.delegate.pageBecameInteractive())}pageIsComplete(){this.pageIsInteractive(),this.stage==Cf.interactive&&(this.stage=Cf.complete,this.delegate.pageLoaded())}get readyState(){return document.readyState}}class If{constructor(t){this.started=!1,this.onScroll=()=>{this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})},this.delegate=t}start(){this.started||(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)}stop(){this.started&&(removeEventListener("scroll",this.onScroll,!1),this.started=!1)}updatePosition(t){this.delegate.scrollPositionChanged(t)}}class Pf{render({fragment:t}){mf.preservingPermanentElements(this,function(t){const e=lf(document.documentElement),n={};for(const i of e){const{id:e}=i;for(const r of t.querySelectorAll("turbo-stream")){const t=af(r.templateElement.content,e);t&&(n[e]=[i,t])}}return n}(t),(()=>document.documentElement.appendChild(t)))}enteringBardo(t,e){e.replaceWith(t.cloneNode(!0))}leavingBardo(){}}class $f{constructor(t){this.sources=new Set,this.started=!1,this.inspectFetchResponse=t=>{const e=function(t){var e;const n=null===(e=t.detail)||void 0===e?void 0:e.fetchResponse;if(n instanceof Bp)return n}(t);e&&function(t){var e;const n=null!==(e=t.contentType)&&void 0!==e?e:"";return n.startsWith(rf.contentType)}(e)&&(t.preventDefault(),this.receiveMessageResponse(e))},this.receiveMessageEvent=t=>{this.started&&"string"==typeof t.data&&this.receiveMessageHTML(t.data)},this.delegate=t}start(){this.started||(this.started=!0,addEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}connectStreamSource(t){this.streamSourceIsConnected(t)||(this.sources.add(t),t.addEventListener("message",this.receiveMessageEvent,!1))}disconnectStreamSource(t){this.streamSourceIsConnected(t)&&(this.sources.delete(t),t.removeEventListener("message",this.receiveMessageEvent,!1))}streamSourceIsConnected(t){return this.sources.has(t)}async receiveMessageResponse(t){const e=await t.responseHTML;e&&this.receiveMessageHTML(e)}receiveMessageHTML(t){this.delegate.receivedMessageFromStream(rf.wrap(t))}}class Rf extends gf{static renderElement(t,e){const{documentElement:n,body:i}=document;n.replaceChild(e,i)}async render(){this.replaceHeadAndBody(),this.activateScriptElements()}replaceHeadAndBody(){const{documentElement:t,head:e}=document;t.replaceChild(this.newHead,e),this.renderElement(this.currentElement,this.newElement)}activateScriptElements(){for(const t of this.scriptElements){const e=t.parentNode;if(e){const n=jp(t);e.replaceChild(n,t)}}}get newHead(){return this.newSnapshot.headSnapshot.element}get scriptElements(){return document.documentElement.querySelectorAll("script")}}class Ff extends gf{static renderElement(t,e){document.body&&e instanceof HTMLBodyElement?document.body.replaceWith(e):document.documentElement.appendChild(e)}get shouldRender(){return this.newSnapshot.isVisitable&&this.trackedElementsAreIdentical}get reloadReason(){return this.newSnapshot.isVisitable?this.trackedElementsAreIdentical?void 0:{reason:"tracked_element_mismatch"}:{reason:"turbo_visit_control_is_reload"}}async prepareToRender(){await this.mergeHead()}async render(){this.willRender&&await this.replaceBody()}finishRendering(){super.finishRendering(),this.isPreview||this.focusFirstAutofocusableElement()}get currentHeadSnapshot(){return this.currentSnapshot.headSnapshot}get newHeadSnapshot(){return this.newSnapshot.headSnapshot}get newElement(){return this.newSnapshot.element}async mergeHead(){const t=this.mergeProvisionalElements(),e=this.copyNewHeadStylesheetElements();this.copyNewHeadScriptElements(),await t,await e}async replaceBody(){await this.preservingPermanentElements((async()=>{this.activateNewBody(),await this.assignNewBody()}))}get trackedElementsAreIdentical(){return this.currentHeadSnapshot.trackedElementSignature==this.newHeadSnapshot.trackedElementSignature}async copyNewHeadStylesheetElements(){const t=[];for(const e of this.newHeadStylesheetElements)t.push(Jp(e)),document.head.appendChild(e);await Promise.all(t)}copyNewHeadScriptElements(){for(const t of this.newHeadScriptElements)document.head.appendChild(jp(t))}async mergeProvisionalElements(){const t=[...this.newHeadProvisionalElements];for(const e of this.currentHeadProvisionalElements)this.isCurrentElementInElementList(e,t)||document.head.removeChild(e);for(const e of t)document.head.appendChild(e)}isCurrentElementInElementList(t,e){for(const[n,i]of e.entries()){if("TITLE"==t.tagName){if("TITLE"!=i.tagName)continue;if(t.innerHTML==i.innerHTML)return e.splice(n,1),!0}if(i.isEqualNode(t))return e.splice(n,1),!0}return!1}removeCurrentHeadProvisionalElements(){for(const t of this.currentHeadProvisionalElements)document.head.removeChild(t)}copyNewHeadProvisionalElements(){for(const t of this.newHeadProvisionalElements)document.head.appendChild(t)}activateNewBody(){document.adoptNode(this.newElement),this.activateNewBodyScriptElements()}activateNewBodyScriptElements(){for(const t of this.newBodyScriptElements){const e=jp(t);t.replaceWith(e)}}async assignNewBody(){await this.renderElement(this.currentElement,this.newElement)}get newHeadStylesheetElements(){return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)}get newHeadScriptElements(){return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)}get currentHeadProvisionalElements(){return this.currentHeadSnapshot.provisionalElements}get newHeadProvisionalElements(){return this.newHeadSnapshot.provisionalElements}get newBodyScriptElements(){return this.newElement.querySelectorAll("script")}}class Bf{constructor(t){this.keys=[],this.snapshots={},this.size=t}has(t){return Fp(t)in this.snapshots}get(t){if(this.has(t)){const e=this.read(t);return this.touch(t),e}}put(t,e){return this.write(t,e),this.touch(t),e}clear(){this.snapshots={}}read(t){return this.snapshots[Fp(t)]}write(t,e){this.snapshots[Fp(t)]=e}touch(t){const e=Fp(t),n=this.keys.indexOf(e);n>-1&&this.keys.splice(n,1),this.keys.unshift(e),this.trim()}trim(){for(const t of this.keys.splice(this.size))delete this.snapshots[t]}}class jf extends df{constructor(){super(...arguments),this.snapshotCache=new Bf(10),this.lastRenderedLocation=new URL(location.href),this.forceReloaded=!1}renderPage(t,e=!1,n=!0,i){const r=new Ff(this.snapshot,t,Ff.renderElement,e,n);return r.shouldRender?null==i||i.changeHistory():this.forceReloaded=!0,this.render(r)}renderError(t,e){null==e||e.changeHistory();const n=new Rf(this.snapshot,t,Rf.renderElement,!1);return this.render(n)}clearSnapshotCache(){this.snapshotCache.clear()}async cacheSnapshot(t=this.snapshot){if(t.isCacheable){this.delegate.viewWillCacheSnapshot();const{lastRenderedLocation:e}=this;await new Promise((t=>setTimeout((()=>t()),0)));const n=t.clone();return this.snapshotCache.put(e,n),n}}getCachedSnapshotForLocation(t){return this.snapshotCache.get(t)}get snapshot(){return Sf.fromElement(this.element)}}class Hf{constructor(t){this.selector="a[data-turbo-preload]",this.delegate=t}get snapshotCache(){return this.delegate.navigator.view.snapshotCache}start(){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",(()=>{this.preloadOnLoadLinksForView(document.body)}));this.preloadOnLoadLinksForView(document.body)}preloadOnLoadLinksForView(t){for(const e of t.querySelectorAll(this.selector))this.preloadURL(e)}async preloadURL(t){const e=new URL(t.href);if(!this.snapshotCache.has(e))try{const t=await fetch(e.toString(),{headers:{"VND.PREFETCH":"true",Accept:"text/html"}}),n=await t.text(),i=Sf.fromHTMLString(n);this.snapshotCache.put(e,i)}catch(t){}}}function zf(t){Object.defineProperties(t,Vf)}const Vf={absoluteURL:{get(){return this.toString()}}};const qf={after(){this.targetElements.forEach((t=>{var e;return null===(e=t.parentElement)||void 0===e?void 0:e.insertBefore(this.templateContent,t.nextSibling)}))},append(){this.removeDuplicateTargetChildren(),this.targetElements.forEach((t=>t.append(this.templateContent)))},before(){this.targetElements.forEach((t=>{var e;return null===(e=t.parentElement)||void 0===e?void 0:e.insertBefore(this.templateContent,t)}))},prepend(){this.removeDuplicateTargetChildren(),this.targetElements.forEach((t=>t.prepend(this.templateContent)))},remove(){this.targetElements.forEach((t=>t.remove()))},replace(){this.targetElements.forEach((t=>t.replaceWith(this.templateContent)))},update(){this.targetElements.forEach((t=>{t.innerHTML="",t.append(this.templateContent)}))}},Uf=new class{constructor(){this.navigator=new Lf(this),this.history=new Df(this),this.preloader=new Hf(this),this.view=new jf(this,document.documentElement),this.adapter=new Of(this),this.pageObserver=new Nf(this),this.cacheObserver=new Tf,this.linkClickObserver=new pf(this,window),this.formSubmitObserver=new cf(this,document),this.scrollObserver=new If(this),this.streamObserver=new $f(this),this.formLinkClickObserver=new ff(this,document.documentElement),this.frameRedirector=new Mf(this,document.documentElement),this.streamMessageRenderer=new Pf,this.drive=!0,this.enabled=!0,this.progressBarDelay=500,this.started=!1,this.formMode="on"}start(){this.started||(this.pageObserver.start(),this.cacheObserver.start(),this.formLinkClickObserver.start(),this.linkClickObserver.start(),this.formSubmitObserver.start(),this.scrollObserver.start(),this.streamObserver.start(),this.frameRedirector.start(),this.history.start(),this.preloader.start(),this.started=!0,this.enabled=!0)}disable(){this.enabled=!1}stop(){this.started&&(this.pageObserver.stop(),this.cacheObserver.stop(),this.formLinkClickObserver.stop(),this.linkClickObserver.stop(),this.formSubmitObserver.stop(),this.scrollObserver.stop(),this.streamObserver.stop(),this.frameRedirector.stop(),this.history.stop(),this.started=!1)}registerAdapter(t){this.adapter=t}visit(t,e={}){const n=e.frame?document.getElementById(e.frame):null;n instanceof Mp?(n.src=t.toString(),n.loaded):this.navigator.proposeVisit(Dp(t),e)}connectStreamSource(t){this.streamObserver.connectStreamSource(t)}disconnectStreamSource(t){this.streamObserver.disconnectStreamSource(t)}renderStreamMessage(t){this.streamMessageRenderer.render(rf.wrap(t))}clearCache(){this.view.clearSnapshotCache()}setProgressBarDelay(t){this.progressBarDelay=t}setFormMode(t){this.formMode=t}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}historyPoppedToLocationWithRestorationIdentifier(t,e){this.enabled?this.navigator.startVisit(t,e,{action:"restore",historyChanged:!0}):this.adapter.pageInvalidated({reason:"turbo_disabled"})}scrollPositionChanged(t){this.history.updateRestorationData({scrollPosition:t})}willSubmitFormLinkToLocation(t,e){return this.elementIsNavigatable(t)&&$p(e,this.snapshot.rootLocation)}submittedFormLinkToLocation(){}willFollowLinkToLocation(t,e,n){return this.elementIsNavigatable(t)&&$p(e,this.snapshot.rootLocation)&&this.applicationAllowsFollowingLinkToLocation(t,e,n)}followedLinkToLocation(t,e){const n=this.getActionForLink(t),i=t.hasAttribute("data-turbo-stream");this.visit(e.href,{action:n,acceptsStreamResponse:i})}allowsVisitingLocationWithAction(t,e){return this.locationWithActionIsSamePage(t,e)||this.applicationAllowsVisitingLocation(t)}visitProposedToLocation(t,e){zf(t),this.adapter.visitProposedToLocation(t,e)}visitStarted(t){t.acceptsStreamResponse||Kp(document.documentElement),zf(t.location),t.silent||this.notifyApplicationAfterVisitingLocation(t.location,t.action)}visitCompleted(t){Yp(document.documentElement),this.notifyApplicationAfterPageLoad(t.getTimingMetrics())}locationWithActionIsSamePage(t,e){return this.navigator.locationWithActionIsSamePage(t,e)}visitScrolledToSamePageLocation(t,e){this.notifyApplicationAfterVisitingSamePageLocation(t,e)}willSubmitForm(t,e){const n=Np(t,e);return this.submissionIsNavigatable(t,e)&&$p(Dp(n),this.snapshot.rootLocation)}formSubmitted(t,e){this.navigator.submitForm(t,e)}pageBecameInteractive(){this.view.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()}pageLoaded(){this.history.assumeControlOfScrollRestoration()}pageWillUnload(){this.history.relinquishControlOfScrollRestoration()}receivedMessageFromStream(t){this.renderStreamMessage(t)}viewWillCacheSnapshot(){var t;(null===(t=this.navigator.currentVisit)||void 0===t?void 0:t.silent)||this.notifyApplicationBeforeCachingSnapshot()}allowsImmediateRender({element:t},e){const n=this.notifyApplicationBeforeRender(t,e),{defaultPrevented:i,detail:{render:r}}=n;return this.view.renderer&&r&&(this.view.renderer.renderElement=r),!i}viewRenderedSnapshot(t,e){this.view.lastRenderedLocation=this.history.location,this.notifyApplicationAfterRender()}preloadOnLoadLinksForView(t){this.preloader.preloadOnLoadLinksForView(t)}viewInvalidated(t){this.adapter.pageInvalidated(t)}frameLoaded(t){this.notifyApplicationAfterFrameLoad(t)}frameRendered(t,e){this.notifyApplicationAfterFrameRender(t,e)}applicationAllowsFollowingLinkToLocation(t,e,n){return!this.notifyApplicationAfterClickingLinkToLocation(t,e,n).defaultPrevented}applicationAllowsVisitingLocation(t){return!this.notifyApplicationBeforeVisitingLocation(t).defaultPrevented}notifyApplicationAfterClickingLinkToLocation(t,e,n){return Hp("turbo:click",{target:t,detail:{url:e.href,originalEvent:n},cancelable:!0})}notifyApplicationBeforeVisitingLocation(t){return Hp("turbo:before-visit",{detail:{url:t.href},cancelable:!0})}notifyApplicationAfterVisitingLocation(t,e){return Hp("turbo:visit",{detail:{url:t.href,action:e}})}notifyApplicationBeforeCachingSnapshot(){return Hp("turbo:before-cache")}notifyApplicationBeforeRender(t,e){return Hp("turbo:before-render",{detail:Object.assign({newBody:t},e),cancelable:!0})}notifyApplicationAfterRender(){return Hp("turbo:render")}notifyApplicationAfterPageLoad(t={}){return Hp("turbo:load",{detail:{url:this.location.href,timing:t}})}notifyApplicationAfterVisitingSamePageLocation(t,e){dispatchEvent(new HashChangeEvent("hashchange",{oldURL:t.toString(),newURL:e.toString()}))}notifyApplicationAfterFrameLoad(t){return Hp("turbo:frame-load",{target:t})}notifyApplicationAfterFrameRender(t,e){return Hp("turbo:frame-render",{detail:{fetchResponse:t},target:e,cancelable:!0})}submissionIsNavigatable(t,e){if("off"==this.formMode)return!1;{const n=!e||this.elementIsNavigatable(e);return"optin"==this.formMode?n&&null!=t.closest('[data-turbo="true"]'):n&&this.elementIsNavigatable(t)}}elementIsNavigatable(t){const e=tf(t,"[data-turbo]"),n=tf(t,"turbo-frame");return this.drive||n?!e||"false"!=e.getAttribute("data-turbo"):!!e&&"true"==e.getAttribute("data-turbo")}getActionForLink(t){return Xp(t)||"advance"}get snapshot(){return this.view.snapshot}},Wf=new class{constructor(t){this.session=t}clear(){this.session.clearCache()}resetCacheControl(){this.setCacheControl("")}exemptPageFromCache(){this.setCacheControl("no-cache")}exemptPageFromPreview(){this.setCacheControl("no-preview")}setCacheControl(t){!function(t,e){let n=Qp(t);n||(n=document.createElement("meta"),n.setAttribute("name",t),document.head.appendChild(n)),n.setAttribute("content",e)}("turbo-cache-control",t)}}(Uf),{navigator:Kf}=Uf;function Yf(){Uf.start()}function Jf(t){Uf.connectStreamSource(t)}function Gf(t){Uf.disconnectStreamSource(t)}var Xf=Object.freeze({__proto__:null,navigator:Kf,session:Uf,cache:Wf,PageRenderer:Ff,PageSnapshot:Sf,FrameRenderer:bf,start:Yf,registerAdapter:function(t){Uf.registerAdapter(t)},visit:function(t,e){Uf.visit(t,e)},connectStreamSource:Jf,disconnectStreamSource:Gf,renderStreamMessage:function(t){Uf.renderStreamMessage(t)},clearCache:function(){console.warn("Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Uf.clearCache()},setProgressBarDelay:function(t){Uf.setProgressBarDelay(t)},setConfirmMethod:function(t){sf.confirmMethod=t},setFormMode:function(t){Uf.setFormMode(t)},StreamActions:qf});class Qf extends Error{}function Zf(t){if(null!=t){const e=document.getElementById(t);if(e instanceof Mp)return e}}function tm(t,e){if(t){const n=t.getAttribute("src");if(null!=n&&null!=e&&function(t,e){return Dp(t).href==Dp(e).href}(n,e))throw new Error(`Matching <turbo-frame id="${t.id}"> element has a source URL which references itself`);if(t.ownerDocument!==document&&(t=document.importNode(t,!0)),t instanceof Mp)return t.connectedCallback(),t.disconnectedCallback(),t}}class em extends HTMLElement{static async renderElement(t){await t.performAction()}async connectedCallback(){try{await this.render()}catch(t){console.error(t)}finally{this.disconnect()}}async render(){var t;return null!==(t=this.renderPromise)&&void 0!==t?t:this.renderPromise=(async()=>{const t=this.beforeRenderEvent;this.dispatchEvent(t)&&(await zp(),await t.detail.render(this))})()}disconnect(){try{this.remove()}catch(t){}}removeDuplicateTargetChildren(){this.duplicateChildren.forEach((t=>t.remove()))}get duplicateChildren(){var t;const e=this.targetElements.flatMap((t=>[...t.children])).filter((t=>!!t.id)),n=[...(null===(t=this.templateContent)||void 0===t?void 0:t.children)||[]].filter((t=>!!t.id)).map((t=>t.id));return e.filter((t=>n.includes(t.id)))}get performAction(){if(this.action){const t=qf[this.action];if(t)return t;this.raise("unknown action")}this.raise("action attribute is missing")}get targetElements(){return this.target?this.targetElementsById:this.targets?this.targetElementsByQuery:void this.raise("target or targets attribute is missing")}get templateContent(){return this.templateElement.content.cloneNode(!0)}get templateElement(){if(null===this.firstElementChild){const t=this.ownerDocument.createElement("template");return this.appendChild(t),t}if(this.firstElementChild instanceof HTMLTemplateElement)return this.firstElementChild;this.raise("first child element must be a <template> element")}get action(){return this.getAttribute("action")}get target(){return this.getAttribute("target")}get targets(){return this.getAttribute("targets")}raise(t){throw new Error(`${this.description}: ${t}`)}get description(){var t,e;return null!==(e=(null!==(t=this.outerHTML.match(/<[^>]+>/))&&void 0!==t?t:[])[0])&&void 0!==e?e:"<turbo-stream>"}get beforeRenderEvent(){return new CustomEvent("turbo:before-stream-render",{bubbles:!0,cancelable:!0,detail:{newStream:this,render:em.renderElement}})}get targetElementsById(){var t;const e=null===(t=this.ownerDocument)||void 0===t?void 0:t.getElementById(this.target);return null!==e?[e]:[]}get targetElementsByQuery(){var t;const e=null===(t=this.ownerDocument)||void 0===t?void 0:t.querySelectorAll(this.targets);return 0!==e.length?Array.prototype.slice.call(e):[]}}class nm extends HTMLElement{constructor(){super(...arguments),this.streamSource=null}connectedCallback(){this.streamSource=this.src.match(/^ws{1,2}:/)?new WebSocket(this.src):new EventSource(this.src),Jf(this.streamSource)}disconnectedCallback(){this.streamSource&&Gf(this.streamSource)}get src(){return this.getAttribute("src")||""}}let im;async function rm(){return im||sm(async function(){const{createConsumer:t}=await Promise.resolve().then((function(){return $T}));return t()}().then(sm))}function sm(t){return im=t}function om(t){return t&&"object"==typeof t?t instanceof Date||t instanceof RegExp?t:Array.isArray(t)?t.map(om):Object.keys(t).reduce((function(e,n){var i=n[0].toLowerCase()+n.slice(1).replace(/([A-Z]+)/g,(function(t,e){return"_"+e.toLowerCase()}));return e[i]=om(t[n]),e}),{}):t}Mp.delegateConstructor=class{constructor(t){this.fetchResponseLoaded=t=>{},this.currentFetchRequest=null,this.resolveVisitPromise=()=>{},this.connected=!1,this.hasBeenLoaded=!1,this.ignoredAttributes=new Set,this.action=null,this.visitCachedSnapshot=({element:t})=>{const e=t.querySelector("#"+this.element.id);e&&this.previousFrameElement&&e.replaceChildren(...this.previousFrameElement.children),delete this.previousFrameElement},this.element=t,this.view=new hf(this,this.element),this.appearanceObserver=new nf(this,this.element),this.formLinkClickObserver=new ff(this,this.element),this.linkInterceptor=new uf(this,this.element),this.restorationIdentifier=Up(),this.formSubmitObserver=new cf(this,this.element)}connect(){this.connected||(this.connected=!0,this.loadingStyle==Ep.lazy?this.appearanceObserver.start():this.loadSourceURL(),this.formLinkClickObserver.start(),this.linkInterceptor.start(),this.formSubmitObserver.start())}disconnect(){this.connected&&(this.connected=!1,this.appearanceObserver.stop(),this.formLinkClickObserver.stop(),this.linkInterceptor.stop(),this.formSubmitObserver.stop())}disabledChanged(){this.loadingStyle==Ep.eager&&this.loadSourceURL()}sourceURLChanged(){this.isIgnoringChangesTo("src")||(this.element.isConnected&&(this.complete=!1),(this.loadingStyle==Ep.eager||this.hasBeenLoaded)&&this.loadSourceURL())}sourceURLReloaded(){const{src:t}=this.element;return this.ignoringChangesToAttribute("complete",(()=>{this.element.removeAttribute("complete")})),this.element.src=null,this.element.src=t,this.element.loaded}completeChanged(){this.isIgnoringChangesTo("complete")||this.loadSourceURL()}loadingStyleChanged(){this.loadingStyle==Ep.lazy?this.appearanceObserver.start():(this.appearanceObserver.stop(),this.loadSourceURL())}async loadSourceURL(){this.enabled&&this.isActive&&!this.complete&&this.sourceURL&&(this.element.loaded=this.visit(Dp(this.sourceURL)),this.appearanceObserver.stop(),await this.element.loaded,this.hasBeenLoaded=!0)}async loadResponse(t){(t.redirected||t.succeeded&&t.isHTML)&&(this.sourceURL=t.response.url);try{const e=await t.responseHTML;if(e){const n=Vp(e);Sf.fromDocument(n).isVisitable?await this.loadFrameResponse(t,n):await this.handleUnvisitableFrameResponse(t)}}finally{this.fetchResponseLoaded=()=>{}}}elementAppearedInViewport(t){this.proposeVisitIfNavigatedWithAction(t,t),this.loadSourceURL()}willSubmitFormLinkToLocation(t){return this.shouldInterceptNavigation(t)}submittedFormLinkToLocation(t,e,n){const i=this.findFrameElement(t);i&&n.setAttribute("data-turbo-frame",i.id)}shouldInterceptLinkClick(t,e,n){return this.shouldInterceptNavigation(t)}linkClickIntercepted(t,e){this.navigateFrame(t,e)}willSubmitForm(t,e){return t.closest("turbo-frame")==this.element&&this.shouldInterceptNavigation(t,e)}formSubmitted(t,e){this.formSubmission&&this.formSubmission.stop(),this.formSubmission=new sf(this,t,e);const{fetchRequest:n}=this.formSubmission;this.prepareRequest(n),this.formSubmission.start()}prepareRequest(t){var e;t.headers["Turbo-Frame"]=this.id,(null===(e=this.currentNavigationElement)||void 0===e?void 0:e.hasAttribute("data-turbo-stream"))&&t.acceptResponseType(rf.contentType)}requestStarted(t){Kp(this.element)}requestPreventedHandlingResponse(t,e){this.resolveVisitPromise()}async requestSucceededWithResponse(t,e){await this.loadResponse(e),this.resolveVisitPromise()}async requestFailedWithResponse(t,e){await this.loadResponse(e),this.resolveVisitPromise()}requestErrored(t,e){console.error(e),this.resolveVisitPromise()}requestFinished(t){Yp(this.element)}formSubmissionStarted({formElement:t}){Kp(t,this.findFrameElement(t))}formSubmissionSucceededWithResponse(t,e){const n=this.findFrameElement(t.formElement,t.submitter);n.delegate.proposeVisitIfNavigatedWithAction(n,t.formElement,t.submitter),n.delegate.loadResponse(e),t.isSafe||Uf.clearCache()}formSubmissionFailedWithResponse(t,e){this.element.delegate.loadResponse(e),Uf.clearCache()}formSubmissionErrored(t,e){console.error(e)}formSubmissionFinished({formElement:t}){Yp(t,this.findFrameElement(t))}allowsImmediateRender({element:t},e){const n=Hp("turbo:before-frame-render",{target:this.element,detail:Object.assign({newFrame:t},e),cancelable:!0}),{defaultPrevented:i,detail:{render:r}}=n;return this.view.renderer&&r&&(this.view.renderer.renderElement=r),!i}viewRenderedSnapshot(t,e){}preloadOnLoadLinksForView(t){Uf.preloadOnLoadLinksForView(t)}viewInvalidated(){}willRenderFrame(t,e){this.previousFrameElement=t.cloneNode(!0)}async loadFrameResponse(t,e){const n=await this.extractForeignFrameElement(e.body);if(n){const e=new of(n),i=new bf(this,this.view.snapshot,e,bf.renderElement,!1,!1);this.view.renderPromise&&await this.view.renderPromise,this.changeHistory(),await this.view.render(i),this.complete=!0,Uf.frameRendered(t,this.element),Uf.frameLoaded(this.element),this.fetchResponseLoaded(t)}else this.willHandleFrameMissingFromResponse(t)&&this.handleFrameMissingFromResponse(t)}async visit(t){var e;const n=new ef(this,Cp.get,t,new URLSearchParams,this.element);return null===(e=this.currentFetchRequest)||void 0===e||e.cancel(),this.currentFetchRequest=n,new Promise((t=>{this.resolveVisitPromise=()=>{this.resolveVisitPromise=()=>{},this.currentFetchRequest=null,t()},n.perform()}))}navigateFrame(t,e,n){const i=this.findFrameElement(t,n);i.delegate.proposeVisitIfNavigatedWithAction(i,t,n),this.withCurrentNavigationElement(t,(()=>{i.src=e}))}proposeVisitIfNavigatedWithAction(t,e,n){if(this.action=Xp(n,e,t),this.action){const e=Sf.fromElement(t).clone(),{visitCachedSnapshot:n}=t.delegate;t.delegate.fetchResponseLoaded=i=>{if(t.src){const{statusCode:r,redirected:s}=i,o={response:{statusCode:r,redirected:s,responseHTML:t.ownerDocument.documentElement.outerHTML},visitCachedSnapshot:n,willRender:!1,updateHistory:!1,restorationIdentifier:this.restorationIdentifier,snapshot:e};this.action&&(o.action=this.action),Uf.visit(t.src,o)}}}}changeHistory(){if(this.action){const t=Gp(this.action);Uf.history.update(t,Dp(this.element.src||""),this.restorationIdentifier)}}async handleUnvisitableFrameResponse(t){console.warn(`The response (${t.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`),await this.visitResponse(t.response)}willHandleFrameMissingFromResponse(t){this.element.setAttribute("complete","");const e=t.response,n=Hp("turbo:frame-missing",{target:this.element,detail:{response:e,visit:async(t,e={})=>{t instanceof Response?this.visitResponse(t):Uf.visit(t,e)}},cancelable:!0});return!n.defaultPrevented}handleFrameMissingFromResponse(t){this.view.missing(),this.throwFrameMissingError(t)}throwFrameMissingError(t){const e=`The response (${t.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;throw new Qf(e)}async visitResponse(t){const e=new Bp(t),n=await e.responseHTML,{location:i,redirected:r,statusCode:s}=e;return Uf.visit(i,{response:{redirected:r,statusCode:s,responseHTML:n}})}findFrameElement(t,e){var n;return null!==(n=Zf(Wp("data-turbo-frame",e,t)||this.element.getAttribute("target")))&&void 0!==n?n:this.element}async extractForeignFrameElement(t){let e;const n=CSS.escape(this.id);try{if(e=tm(t.querySelector(`turbo-frame#${n}`),this.sourceURL),e)return e;if(e=tm(t.querySelector(`turbo-frame[src][recurse~=${n}]`),this.sourceURL),e)return await e.loaded,await this.extractForeignFrameElement(e)}catch(t){return console.error(t),new Mp}return null}formActionIsVisitable(t,e){return $p(Dp(Np(t,e)),this.rootLocation)}shouldInterceptNavigation(t,e){const n=Wp("data-turbo-frame",e,t)||this.element.getAttribute("target");if(t instanceof HTMLFormElement&&!this.formActionIsVisitable(t,e))return!1;if(!this.enabled||"_top"==n)return!1;if(n){const t=Zf(n);if(t)return!t.disabled}return!!Uf.elementIsNavigatable(t)&&!(e&&!Uf.elementIsNavigatable(e))}get id(){return this.element.id}get enabled(){return!this.element.disabled}get sourceURL(){if(this.element.src)return this.element.src}set sourceURL(t){this.ignoringChangesToAttribute("src",(()=>{this.element.src=null!=t?t:null}))}get loadingStyle(){return this.element.loading}get isLoading(){return void 0!==this.formSubmission||void 0!==this.resolveVisitPromise()}get complete(){return this.element.hasAttribute("complete")}set complete(t){this.ignoringChangesToAttribute("complete",(()=>{t?this.element.setAttribute("complete",""):this.element.removeAttribute("complete")}))}get isActive(){return this.element.isActive&&this.connected}get rootLocation(){var t;const e=this.element.ownerDocument.querySelector('meta[name="turbo-root"]');return Dp(null!==(t=null==e?void 0:e.content)&&void 0!==t?t:"/")}isIgnoringChangesTo(t){return this.ignoredAttributes.has(t)}ignoringChangesToAttribute(t,e){this.ignoredAttributes.add(t),e(),this.ignoredAttributes.delete(t)}withCurrentNavigationElement(t,e){this.currentNavigationElement=t,e(),delete this.currentNavigationElement}},void 0===customElements.get("turbo-frame")&&customElements.define("turbo-frame",Mp),void 0===customElements.get("turbo-stream")&&customElements.define("turbo-stream",em),void 0===customElements.get("turbo-stream-source")&&customElements.define("turbo-stream-source",nm),(()=>{let t=document.currentScript;if(t&&!t.hasAttribute("data-turbo-suppress-warning"))for(t=t.parentElement;t;){if(t==document.body)return console.warn(qp`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,t.outerHTML);t=t.parentElement}})(),window.Turbo=Xf,Yf();class am extends HTMLElement{async connectedCallback(){Jf(this),this.subscription=await async function(t,e){const{subscriptions:n}=await rm();return n.create(t,e)}(this.channel,{received:this.dispatchMessageEvent.bind(this),connected:this.subscriptionConnected.bind(this),disconnected:this.subscriptionDisconnected.bind(this)})}disconnectedCallback(){Gf(this),this.subscription&&this.subscription.unsubscribe()}dispatchMessageEvent(t){const e=new MessageEvent("message",{data:t});return this.dispatchEvent(e)}subscriptionConnected(){this.setAttribute("connected","")}subscriptionDisconnected(){this.removeAttribute("connected")}get channel(){return{channel:this.getAttribute("channel"),signed_stream_name:this.getAttribute("signed-stream-name"),...om({...this.dataset})}}}void 0===customElements.get("turbo-cable-stream-source")&&customElements.define("turbo-cable-stream-source",am),addEventListener("turbo:before-fetch-request",(function(t){if(t.target instanceof HTMLFormElement){const{target:e,detail:{fetchOptions:n}}=t;e.addEventListener("turbo:submit-start",(({detail:{formSubmission:{submitter:t}}})=>{const i=function(t){return t instanceof FormData||t instanceof URLSearchParams}(n.body)?n.body:new URLSearchParams,r=function(t,e,n){const i=function(t){return(t instanceof HTMLButtonElement||t instanceof HTMLInputElement)&&t.hasAttribute("formmethod")?t.formMethod:null}(t),r=e.get("_method"),s=n.getAttribute("method")||"get";return"string"==typeof i?i:"string"==typeof r?r:s}(t,i,e);/get/i.test(r)||(/post/i.test(r)?i.delete("_method"):i.set("_method",r),n.method="post")}),{once:!0})}}));var lm="top",cm="bottom",dm="right",hm="left",um="auto",pm=[lm,cm,dm,hm],fm="start",mm="end",gm="clippingParents",bm="viewport",vm="popper",ym="reference",wm=pm.reduce((function(t,e){return t.concat([e+"-"+fm,e+"-"+mm])}),[]),km=[].concat(pm,[um]).reduce((function(t,e){return t.concat([e,e+"-"+fm,e+"-"+mm])}),[]),Sm="beforeRead",xm="read",Em="afterRead",Cm="beforeMain",_m="main",Am="afterMain",Om="beforeWrite",Tm="write",Mm="afterWrite",Dm=[Sm,xm,Em,Cm,_m,Am,Om,Tm,Mm];function Lm(t){return t?(t.nodeName||"").toLowerCase():null}function Nm(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Im(t){return t instanceof Nm(t).Element||t instanceof Element}function Pm(t){return t instanceof Nm(t).HTMLElement||t instanceof HTMLElement}function $m(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Nm(t).ShadowRoot||t instanceof ShadowRoot)}var Rm={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var n=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];Pm(r)&&Lm(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(t){var e=i[t];!1===e?r.removeAttribute(t):r.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach((function(t){var i=e.elements[t],r=e.attributes[t]||{},s=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce((function(t,e){return t[e]="",t}),{});Pm(i)&&Lm(i)&&(Object.assign(i.style,s),Object.keys(r).forEach((function(t){i.removeAttribute(t)})))}))}},requires:["computeStyles"]};function Fm(t){return t.split("-")[0]}var Bm=Math.max,jm=Math.min,Hm=Math.round;function zm(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function Vm(){return!/^((?!chrome|android).)*safari/i.test(zm())}function qm(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=t.getBoundingClientRect(),r=1,s=1;e&&Pm(t)&&(r=t.offsetWidth>0&&Hm(i.width)/t.offsetWidth||1,s=t.offsetHeight>0&&Hm(i.height)/t.offsetHeight||1);var o=(Im(t)?Nm(t):window).visualViewport,a=!Vm()&&n,l=(i.left+(a&&o?o.offsetLeft:0))/r,c=(i.top+(a&&o?o.offsetTop:0))/s,d=i.width/r,h=i.height/s;return{width:d,height:h,top:c,right:l+d,bottom:c+h,left:l,x:l,y:c}}function Um(t){var e=qm(t),n=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:i}}function Wm(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&$m(n)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Km(t){return Nm(t).getComputedStyle(t)}function Ym(t){return["table","td","th"].indexOf(Lm(t))>=0}function Jm(t){return((Im(t)?t.ownerDocument:t.document)||window.document).documentElement}function Gm(t){return"html"===Lm(t)?t:t.assignedSlot||t.parentNode||($m(t)?t.host:null)||Jm(t)}function Xm(t){return Pm(t)&&"fixed"!==Km(t).position?t.offsetParent:null}function Qm(t){for(var e=Nm(t),n=Xm(t);n&&Ym(n)&&"static"===Km(n).position;)n=Xm(n);return n&&("html"===Lm(n)||"body"===Lm(n)&&"static"===Km(n).position)?e:n||function(t){var e=/firefox/i.test(zm());if(/Trident/i.test(zm())&&Pm(t)&&"fixed"===Km(t).position)return null;var n=Gm(t);for($m(n)&&(n=n.host);Pm(n)&&["html","body"].indexOf(Lm(n))<0;){var i=Km(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||e&&"filter"===i.willChange||e&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(t)||e}function Zm(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function tg(t,e,n){return Bm(t,jm(e,n))}function eg(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ng(t,e){return e.reduce((function(e,n){return e[n]=t,e}),{})}var ig={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,i=t.name,r=t.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=Fm(n.placement),l=Zm(a),c=[hm,dm].indexOf(a)>=0?"height":"width";if(s&&o){var d=function(t,e){return eg("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:ng(t,pm))}(r.padding,n),h=Um(s),u="y"===l?lm:hm,p="y"===l?cm:dm,f=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],m=o[l]-n.rects.reference[l],g=Qm(s),b=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=f/2-m/2,y=d[u],w=b-h[c]-d[p],k=b/2-h[c]/2+v,S=tg(y,k,w),x=l;n.modifiersData[i]=((e={})[x]=S,e.centerOffset=S-k,e)}},effect:function(t){var e=t.state,n=t.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=e.elements.popper.querySelector(i)))&&Wm(e.elements.popper,i)&&(e.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function rg(t){return t.split("-")[1]}var sg={top:"auto",right:"auto",bottom:"auto",left:"auto"};function og(t){var e,n=t.popper,i=t.popperRect,r=t.placement,s=t.variation,o=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,d=t.roundOffsets,h=t.isFixed,u=o.x,p=void 0===u?0:u,f=o.y,m=void 0===f?0:f,g="function"==typeof d?d({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var b=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),y=hm,w=lm,k=window;if(c){var S=Qm(n),x="clientHeight",E="clientWidth";if(S===Nm(n)&&"static"!==Km(S=Jm(n)).position&&"absolute"===a&&(x="scrollHeight",E="scrollWidth"),r===lm||(r===hm||r===dm)&&s===mm)w=cm,m-=(h&&S===k&&k.visualViewport?k.visualViewport.height:S[x])-i.height,m*=l?1:-1;if(r===hm||(r===lm||r===cm)&&s===mm)y=dm,p-=(h&&S===k&&k.visualViewport?k.visualViewport.width:S[E])-i.width,p*=l?1:-1}var C,_=Object.assign({position:a},c&&sg),A=!0===d?function(t,e){var n=t.x,i=t.y,r=e.devicePixelRatio||1;return{x:Hm(n*r)/r||0,y:Hm(i*r)/r||0}}({x:p,y:m},Nm(n)):{x:p,y:m};return p=A.x,m=A.y,l?Object.assign({},_,((C={})[w]=v?"0":"",C[y]=b?"0":"",C.transform=(k.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",C)):Object.assign({},_,((e={})[w]=v?m+"px":"",e[y]=b?p+"px":"",e.transform="",e))}var ag={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,i=n.gpuAcceleration,r=void 0===i||i,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,c={placement:Fm(e.placement),variation:rg(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,og(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,og(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},lg={passive:!0};var cg={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,i=t.options,r=i.scroll,s=void 0===r||r,o=i.resize,a=void 0===o||o,l=Nm(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach((function(t){t.addEventListener("scroll",n.update,lg)})),a&&l.addEventListener("resize",n.update,lg),function(){s&&c.forEach((function(t){t.removeEventListener("scroll",n.update,lg)})),a&&l.removeEventListener("resize",n.update,lg)}},data:{}},dg={left:"right",right:"left",bottom:"top",top:"bottom"};function hg(t){return t.replace(/left|right|bottom|top/g,(function(t){return dg[t]}))}var ug={start:"end",end:"start"};function pg(t){return t.replace(/start|end/g,(function(t){return ug[t]}))}function fg(t){var e=Nm(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function mg(t){return qm(Jm(t)).left+fg(t).scrollLeft}function gg(t){var e=Km(t),n=e.overflow,i=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function bg(t){return["html","body","#document"].indexOf(Lm(t))>=0?t.ownerDocument.body:Pm(t)&&gg(t)?t:bg(Gm(t))}function vg(t,e){var n;void 0===e&&(e=[]);var i=bg(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),s=Nm(i),o=r?[s].concat(s.visualViewport||[],gg(i)?i:[]):i,a=e.concat(o);return r?a:a.concat(vg(Gm(o)))}function yg(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function wg(t,e,n){return e===bm?yg(function(t,e){var n=Nm(t),i=Jm(t),r=n.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=Vm();(c||!c&&"fixed"===e)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+mg(t),y:l}}(t,n)):Im(e)?function(t,e){var n=qm(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(e,n):yg(function(t){var e,n=Jm(t),i=fg(t),r=null==(e=t.ownerDocument)?void 0:e.body,s=Bm(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Bm(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+mg(t),l=-i.scrollTop;return"rtl"===Km(r||n).direction&&(a+=Bm(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(Jm(t)))}function kg(t,e,n,i){var r="clippingParents"===e?function(t){var e=vg(Gm(t)),n=["absolute","fixed"].indexOf(Km(t).position)>=0&&Pm(t)?Qm(t):t;return Im(n)?e.filter((function(t){return Im(t)&&Wm(t,n)&&"body"!==Lm(t)})):[]}(t):[].concat(e),s=[].concat(r,[n]),o=s[0],a=s.reduce((function(e,n){var r=wg(t,n,i);return e.top=Bm(r.top,e.top),e.right=jm(r.right,e.right),e.bottom=jm(r.bottom,e.bottom),e.left=Bm(r.left,e.left),e}),wg(t,o,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function Sg(t){var e,n=t.reference,i=t.element,r=t.placement,s=r?Fm(r):null,o=r?rg(r):null,a=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(s){case lm:e={x:a,y:n.y-i.height};break;case cm:e={x:a,y:n.y+n.height};break;case dm:e={x:n.x+n.width,y:l};break;case hm:e={x:n.x-i.width,y:l};break;default:e={x:n.x,y:n.y}}var c=s?Zm(s):null;if(null!=c){var d="y"===c?"height":"width";switch(o){case fm:e[c]=e[c]-(n[d]/2-i[d]/2);break;case mm:e[c]=e[c]+(n[d]/2-i[d]/2)}}return e}function xg(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=void 0===i?t.placement:i,s=n.strategy,o=void 0===s?t.strategy:s,a=n.boundary,l=void 0===a?gm:a,c=n.rootBoundary,d=void 0===c?bm:c,h=n.elementContext,u=void 0===h?vm:h,p=n.altBoundary,f=void 0!==p&&p,m=n.padding,g=void 0===m?0:m,b=eg("number"!=typeof g?g:ng(g,pm)),v=u===vm?ym:vm,y=t.rects.popper,w=t.elements[f?v:u],k=kg(Im(w)?w:w.contextElement||Jm(t.elements.popper),l,d,o),S=qm(t.elements.reference),x=Sg({reference:S,element:y,strategy:"absolute",placement:r}),E=yg(Object.assign({},y,x)),C=u===vm?E:S,_={top:k.top-C.top+b.top,bottom:C.bottom-k.bottom+b.bottom,left:k.left-C.left+b.left,right:C.right-k.right+b.right},A=t.modifiersData.offset;if(u===vm&&A){var O=A[r];Object.keys(_).forEach((function(t){var e=[dm,cm].indexOf(t)>=0?1:-1,n=[lm,cm].indexOf(t)>=0?"y":"x";_[t]+=O[n]*e}))}return _}function Eg(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=n.boundary,s=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?km:l,d=rg(i),h=d?a?wm:wm.filter((function(t){return rg(t)===d})):pm,u=h.filter((function(t){return c.indexOf(t)>=0}));0===u.length&&(u=h);var p=u.reduce((function(e,n){return e[n]=xg(t,{placement:n,boundary:r,rootBoundary:s,padding:o})[Fm(n)],e}),{});return Object.keys(p).sort((function(t,e){return p[t]-p[e]}))}var Cg={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,c=n.padding,d=n.boundary,h=n.rootBoundary,u=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=e.options.placement,b=Fm(g),v=l||(b===g||!f?[hg(g)]:function(t){if(Fm(t)===um)return[];var e=hg(t);return[pg(t),e,pg(e)]}(g)),y=[g].concat(v).reduce((function(t,n){return t.concat(Fm(n)===um?Eg(e,{placement:n,boundary:d,rootBoundary:h,padding:c,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),w=e.rects.reference,k=e.rects.popper,S=new Map,x=!0,E=y[0],C=0;C<y.length;C++){var _=y[C],A=Fm(_),O=rg(_)===fm,T=[lm,cm].indexOf(A)>=0,M=T?"width":"height",D=xg(e,{placement:_,boundary:d,rootBoundary:h,altBoundary:u,padding:c}),L=T?O?dm:hm:O?cm:lm;w[M]>k[M]&&(L=hg(L));var N=hg(L),I=[];if(s&&I.push(D[A]<=0),a&&I.push(D[L]<=0,D[N]<=0),I.every((function(t){return t}))){E=_,x=!1;break}S.set(_,I)}if(x)for(var P=function(t){var e=y.find((function(e){var n=S.get(e);if(n)return n.slice(0,t).every((function(t){return t}))}));if(e)return E=e,"break"},$=f?3:1;$>0;$--){if("break"===P($))break}e.placement!==E&&(e.modifiersData[i]._skip=!0,e.placement=E,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function _g(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function Ag(t){return[lm,dm,cm,hm].some((function(e){return t[e]>=0}))}var Og={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,i=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,o=xg(e,{elementContext:"reference"}),a=xg(e,{altBoundary:!0}),l=_g(o,i),c=_g(a,r,s),d=Ag(l),h=Ag(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":h})}};var Tg={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.offset,s=void 0===r?[0,0]:r,o=km.reduce((function(t,n){return t[n]=function(t,e,n){var i=Fm(t),r=[hm,lm].indexOf(i)>=0?-1:1,s="function"==typeof n?n(Object.assign({},e,{placement:t})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[hm,dm].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}(n,e.rects,s),t}),{}),a=o[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=o}};var Mg={name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=Sg({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}};var Dg={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0!==o&&o,l=n.boundary,c=n.rootBoundary,d=n.altBoundary,h=n.padding,u=n.tether,p=void 0===u||u,f=n.tetherOffset,m=void 0===f?0:f,g=xg(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:d}),b=Fm(e.placement),v=rg(e.placement),y=!v,w=Zm(b),k="x"===w?"y":"x",S=e.modifiersData.popperOffsets,x=e.rects.reference,E=e.rects.popper,C="function"==typeof m?m(Object.assign({},e.rects,{placement:e.placement})):m,_="number"==typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),A=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,O={x:0,y:0};if(S){if(s){var T,M="y"===w?lm:hm,D="y"===w?cm:dm,L="y"===w?"height":"width",N=S[w],I=N+g[M],P=N-g[D],$=p?-E[L]/2:0,R=v===fm?x[L]:E[L],F=v===fm?-E[L]:-x[L],B=e.elements.arrow,j=p&&B?Um(B):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=H[M],V=H[D],q=tg(0,x[L],j[L]),U=y?x[L]/2-$-q-z-_.mainAxis:R-q-z-_.mainAxis,W=y?-x[L]/2+$+q+V+_.mainAxis:F+q+V+_.mainAxis,K=e.elements.arrow&&Qm(e.elements.arrow),Y=K?"y"===w?K.clientTop||0:K.clientLeft||0:0,J=null!=(T=null==A?void 0:A[w])?T:0,G=N+W-J,X=tg(p?jm(I,N+U-J-Y):I,N,p?Bm(P,G):P);S[w]=X,O[w]=X-N}if(a){var Q,Z="x"===w?lm:hm,tt="x"===w?cm:dm,et=S[k],nt="y"===k?"height":"width",it=et+g[Z],rt=et-g[tt],st=-1!==[lm,hm].indexOf(b),ot=null!=(Q=null==A?void 0:A[k])?Q:0,at=st?it:et-x[nt]-E[nt]-ot+_.altAxis,lt=st?et+x[nt]+E[nt]-ot-_.altAxis:rt,ct=p&&st?function(t,e,n){var i=tg(t,e,n);return i>n?n:i}(at,et,lt):tg(p?at:it,et,p?lt:rt);S[k]=ct,O[k]=ct-et}e.modifiersData[i]=O}},requiresIfExists:["offset"]};function Lg(t,e,n){void 0===n&&(n=!1);var i,r,s=Pm(e),o=Pm(e)&&function(t){var e=t.getBoundingClientRect(),n=Hm(e.width)/t.offsetWidth||1,i=Hm(e.height)/t.offsetHeight||1;return 1!==n||1!==i}(e),a=Jm(e),l=qm(t,o,n),c={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(s||!s&&!n)&&(("body"!==Lm(e)||gg(a))&&(c=(i=e)!==Nm(i)&&Pm(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:fg(i)),Pm(e)?((d=qm(e,!0)).x+=e.clientLeft,d.y+=e.clientTop):a&&(d.x=mg(a))),{x:l.left+c.scrollLeft-d.x,y:l.top+c.scrollTop-d.y,width:l.width,height:l.height}}function Ng(t){var e=new Map,n=new Set,i=[];function r(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!n.has(t)){var i=e.get(t);i&&r(i)}})),i.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){n.has(t.name)||r(t)})),i}var Ig={placement:"bottom",modifiers:[],strategy:"absolute"};function Pg(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function $g(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,i=void 0===n?[]:n,r=e.defaultOptions,s=void 0===r?Ig:r;return function(t,e,n){void 0===n&&(n=s);var r,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ig,s),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],c=!1,d={state:a,setOptions:function(n){var r="function"==typeof n?n(a.options):n;h(),a.options=Object.assign({},s,a.options,r),a.scrollParents={reference:Im(t)?vg(t):t.contextElement?vg(t.contextElement):[],popper:vg(e)};var o=function(t){var e=Ng(t);return Dm.reduce((function(t,n){return t.concat(e.filter((function(t){return t.phase===n})))}),[])}(function(t){var e=t.reduce((function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t}),{});return Object.keys(e).map((function(t){return e[t]}))}([].concat(i,a.options.modifiers)));return a.orderedModifiers=o.filter((function(t){return t.enabled})),a.orderedModifiers.forEach((function(t){var e=t.name,n=t.options,i=void 0===n?{}:n,r=t.effect;if("function"==typeof r){var s=r({state:a,name:e,instance:d,options:i}),o=function(){};l.push(s||o)}})),d.update()},forceUpdate:function(){if(!c){var t=a.elements,e=t.reference,n=t.popper;if(Pg(e,n)){a.rects={reference:Lg(e,Qm(n),"fixed"===a.options.strategy),popper:Um(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(t){return a.modifiersData[t.name]=Object.assign({},t.data)}));for(var i=0;i<a.orderedModifiers.length;i++)if(!0!==a.reset){var r=a.orderedModifiers[i],s=r.fn,o=r.options,l=void 0===o?{}:o,h=r.name;"function"==typeof s&&(a=s({state:a,options:l,name:h,instance:d})||a)}else a.reset=!1,i=-1}}},update:(r=function(){return new Promise((function(t){d.forceUpdate(),t(a)}))},function(){return o||(o=new Promise((function(t){Promise.resolve().then((function(){o=void 0,t(r())}))}))),o}),destroy:function(){h(),c=!0}};if(!Pg(t,e))return d;function h(){l.forEach((function(t){return t()})),l=[]}return d.setOptions(n).then((function(t){!c&&n.onFirstUpdate&&n.onFirstUpdate(t)})),d}}var Rg=$g(),Fg=$g({defaultModifiers:[cg,Mg,ag,Rm]}),Bg=$g({defaultModifiers:[cg,Mg,ag,Rm,Tg,Cg,Dg,ig,Og]}),jg=Object.freeze({__proto__:null,popperGenerator:$g,detectOverflow:xg,createPopperBase:Rg,createPopper:Bg,createPopperLite:Fg,top:lm,bottom:cm,right:dm,left:hm,auto:um,basePlacements:pm,start:fm,end:mm,clippingParents:gm,viewport:bm,popper:vm,reference:ym,variationPlacements:wm,placements:km,beforeRead:Sm,read:xm,afterRead:Em,beforeMain:Cm,main:_m,afterMain:Am,beforeWrite:Om,write:Tm,afterWrite:Mm,modifierPhases:Dm,applyStyles:Rm,arrow:ig,computeStyles:ag,eventListeners:cg,flip:Cg,hide:Og,offset:Tg,popperOffsets:Mg,preventOverflow:Dg});
/*!
    * Bootstrap v5.3.0-alpha3 (https://getbootstrap.com/)
    * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    */
const Hg=new Map,zg={set(t,e,n){Hg.has(t)||Hg.set(t,new Map);const i=Hg.get(t);i.has(e)||0===i.size?i.set(e,n):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`)},get:(t,e)=>Hg.has(t)&&Hg.get(t).get(e)||null,remove(t,e){if(!Hg.has(t))return;const n=Hg.get(t);n.delete(e),0===n.size&&Hg.delete(t)}},Vg="transitionend",qg=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,((t,e)=>`#${CSS.escape(e)}`))),t),Ug=t=>{t.dispatchEvent(new Event(Vg))},Wg=t=>!(!t||"object"!=typeof t)&&(void 0!==t.jquery&&(t=t[0]),void 0!==t.nodeType),Kg=t=>Wg(t)?t.jquery?t[0]:t:"string"==typeof t&&t.length>0?document.querySelector(qg(t)):null,Yg=t=>{if(!Wg(t)||0===t.getClientRects().length)return!1;const e="visible"===getComputedStyle(t).getPropertyValue("visibility"),n=t.closest("details:not([open])");if(!n)return e;if(n!==t){const e=t.closest("summary");if(e&&e.parentNode!==n)return!1;if(null===e)return!1}return e},Jg=t=>!t||t.nodeType!==Node.ELEMENT_NODE||(!!t.classList.contains("disabled")||(void 0!==t.disabled?t.disabled:t.hasAttribute("disabled")&&"false"!==t.getAttribute("disabled"))),Gg=t=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?Gg(t.parentNode):null},Xg=()=>{},Qg=t=>{t.offsetHeight},Zg=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,tb=[],eb=()=>"rtl"===document.documentElement.dir,nb=t=>{var e;e=()=>{const e=Zg();if(e){const n=t.NAME,i=e.fn[n];e.fn[n]=t.jQueryInterface,e.fn[n].Constructor=t,e.fn[n].noConflict=()=>(e.fn[n]=i,t.jQueryInterface)}},"loading"===document.readyState?(tb.length||document.addEventListener("DOMContentLoaded",(()=>{for(const t of tb)t()})),tb.push(e)):e()},ib=(t,e=[],n=t)=>"function"==typeof t?t(...e):n,rb=(t,e,n=!0)=>{if(!n)return void ib(t);const i=(t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:n}=window.getComputedStyle(t);const i=Number.parseFloat(e),r=Number.parseFloat(n);return i||r?(e=e.split(",")[0],n=n.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(n))):0})(e)+5;let r=!1;const s=({target:n})=>{n===e&&(r=!0,e.removeEventListener(Vg,s),ib(t))};e.addEventListener(Vg,s),setTimeout((()=>{r||Ug(e)}),i)},sb=(t,e,n,i)=>{const r=t.length;let s=t.indexOf(e);return-1===s?!n&&i?t[r-1]:t[0]:(s+=n?1:-1,i&&(s=(s+r)%r),t[Math.max(0,Math.min(s,r-1))])},ob=/[^.]*(?=\..*)\.|.*/,ab=/\..*/,lb=/::\d+$/,cb={};let db=1;const hb={mouseenter:"mouseover",mouseleave:"mouseout"},ub=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function pb(t,e){return e&&`${e}::${db++}`||t.uidEvent||db++}function fb(t){const e=pb(t);return t.uidEvent=e,cb[e]=cb[e]||{},cb[e]}function mb(t,e,n=null){return Object.values(t).find((t=>t.callable===e&&t.delegationSelector===n))}function gb(t,e,n){const i="string"==typeof e,r=i?n:e||n;let s=wb(t);return ub.has(s)||(s=t),[i,r,s]}function bb(t,e,n,i,r){if("string"!=typeof e||!t)return;let[s,o,a]=gb(e,n,i);if(e in hb){const t=t=>function(e){if(!e.relatedTarget||e.relatedTarget!==e.delegateTarget&&!e.delegateTarget.contains(e.relatedTarget))return t.call(this,e)};o=t(o)}const l=fb(t),c=l[a]||(l[a]={}),d=mb(c,o,s?n:null);if(d)return void(d.oneOff=d.oneOff&&r);const h=pb(o,e.replace(ob,"")),u=s?function(t,e,n){return function i(r){const s=t.querySelectorAll(e);for(let{target:o}=r;o&&o!==this;o=o.parentNode)for(const a of s)if(a===o)return Sb(r,{delegateTarget:o}),i.oneOff&&kb.off(t,r.type,e,n),n.apply(o,[r])}}(t,n,o):function(t,e){return function n(i){return Sb(i,{delegateTarget:t}),n.oneOff&&kb.off(t,i.type,e),e.apply(t,[i])}}(t,o);u.delegationSelector=s?n:null,u.callable=o,u.oneOff=r,u.uidEvent=h,c[h]=u,t.addEventListener(a,u,s)}function vb(t,e,n,i,r){const s=mb(e[n],i,r);s&&(t.removeEventListener(n,s,Boolean(r)),delete e[n][s.uidEvent])}function yb(t,e,n,i){const r=e[n]||{};for(const[s,o]of Object.entries(r))s.includes(i)&&vb(t,e,n,o.callable,o.delegationSelector)}function wb(t){return t=t.replace(ab,""),hb[t]||t}const kb={on(t,e,n,i){bb(t,e,n,i,!1)},one(t,e,n,i){bb(t,e,n,i,!0)},off(t,e,n,i){if("string"!=typeof e||!t)return;const[r,s,o]=gb(e,n,i),a=o!==e,l=fb(t),c=l[o]||{},d=e.startsWith(".");if(void 0===s){if(d)for(const n of Object.keys(l))yb(t,l,n,e.slice(1));for(const[n,i]of Object.entries(c)){const r=n.replace(lb,"");a&&!e.includes(r)||vb(t,l,o,i.callable,i.delegationSelector)}}else{if(!Object.keys(c).length)return;vb(t,l,o,s,r?n:null)}},trigger(t,e,n){if("string"!=typeof e||!t)return null;const i=Zg();let r=null,s=!0,o=!0,a=!1;e!==wb(e)&&i&&(r=i.Event(e,n),i(t).trigger(r),s=!r.isPropagationStopped(),o=!r.isImmediatePropagationStopped(),a=r.isDefaultPrevented());const l=Sb(new Event(e,{bubbles:s,cancelable:!0}),n);return a&&l.preventDefault(),o&&t.dispatchEvent(l),l.defaultPrevented&&r&&r.preventDefault(),l}};function Sb(t,e={}){for(const[n,i]of Object.entries(e))try{t[n]=i}catch(e){Object.defineProperty(t,n,{configurable:!0,get:()=>i})}return t}function xb(t){if("true"===t)return!0;if("false"===t)return!1;if(t===Number(t).toString())return Number(t);if(""===t||"null"===t)return null;if("string"!=typeof t)return t;try{return JSON.parse(decodeURIComponent(t))}catch(e){return t}}function Eb(t){return t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))}const Cb={setDataAttribute(t,e,n){t.setAttribute(`data-bs-${Eb(e)}`,n)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${Eb(e)}`)},getDataAttributes(t){if(!t)return{};const e={},n=Object.keys(t.dataset).filter((t=>t.startsWith("bs")&&!t.startsWith("bsConfig")));for(const i of n){let n=i.replace(/^bs/,"");n=n.charAt(0).toLowerCase()+n.slice(1,n.length),e[n]=xb(t.dataset[i])}return e},getDataAttribute:(t,e)=>xb(t.getAttribute(`data-bs-${Eb(e)}`))};class _b{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const n=Wg(e)?Cb.getDataAttribute(e,"config"):{};return{...this.constructor.Default,..."object"==typeof n?n:{},...Wg(e)?Cb.getDataAttributes(e):{},..."object"==typeof t?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[i,r]of Object.entries(e)){const e=t[i],s=Wg(e)?"element":null==(n=e)?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(s))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${s}" but expected type "${r}".`)}var n}}class Ab extends _b{constructor(t,e){super(),(t=Kg(t))&&(this._element=t,this._config=this._getConfig(e),zg.set(this._element,this.constructor.DATA_KEY,this))}dispose(){zg.remove(this._element,this.constructor.DATA_KEY),kb.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,n=!0){rb(t,e,n)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return zg.get(Kg(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,"object"==typeof e?e:null)}static get VERSION(){return"5.3.0-alpha2"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const Ob=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){let n=t.getAttribute("href");if(!n||!n.includes("#")&&!n.startsWith("."))return null;n.includes("#")&&!n.startsWith("#")&&(n=`#${n.split("#")[1]}`),e=n&&"#"!==n?n.trim():null}return qg(e)},Tb={find:(t,e=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(e,t)),findOne:(t,e=document.documentElement)=>Element.prototype.querySelector.call(e,t),children:(t,e)=>[].concat(...t.children).filter((t=>t.matches(e))),parents(t,e){const n=[];let i=t.parentNode.closest(e);for(;i;)n.push(i),i=i.parentNode.closest(e);return n},prev(t,e){let n=t.previousElementSibling;for(;n;){if(n.matches(e))return[n];n=n.previousElementSibling}return[]},next(t,e){let n=t.nextElementSibling;for(;n;){if(n.matches(e))return[n];n=n.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((t=>`${t}:not([tabindex^="-"])`)).join(",");return this.find(e,t).filter((t=>!Jg(t)&&Yg(t)))},getSelectorFromElement(t){const e=Ob(t);return e&&Tb.findOne(e)?e:null},getElementFromSelector(t){const e=Ob(t);return e?Tb.findOne(e):null},getMultipleElementsFromSelector(t){const e=Ob(t);return e?Tb.find(e):[]}},Mb=(t,e="hide")=>{const n=`click.dismiss${t.EVENT_KEY}`,i=t.NAME;kb.on(document,n,`[data-bs-dismiss="${i}"]`,(function(n){if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Jg(this))return;const r=Tb.getElementFromSelector(this)||this.closest(`.${i}`);t.getOrCreateInstance(r)[e]()}))},Db=".bs.alert",Lb=`close${Db}`,Nb=`closed${Db}`;class Ib extends Ab{static get NAME(){return"alert"}close(){if(kb.trigger(this._element,Lb).defaultPrevented)return;this._element.classList.remove("show");const t=this._element.classList.contains("fade");this._queueCallback((()=>this._destroyElement()),this._element,t)}_destroyElement(){this._element.remove(),kb.trigger(this._element,Nb),this.dispose()}static jQueryInterface(t){return this.each((function(){const e=Ib.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}Mb(Ib,"close"),nb(Ib);const Pb='[data-bs-toggle="button"]';class $b extends Ab{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(t){return this.each((function(){const e=$b.getOrCreateInstance(this);"toggle"===t&&e[t]()}))}}kb.on(document,"click.bs.button.data-api",Pb,(t=>{t.preventDefault();const e=t.target.closest(Pb);$b.getOrCreateInstance(e).toggle()})),nb($b);const Rb=".bs.swipe",Fb=`touchstart${Rb}`,Bb=`touchmove${Rb}`,jb=`touchend${Rb}`,Hb=`pointerdown${Rb}`,zb=`pointerup${Rb}`,Vb={endCallback:null,leftCallback:null,rightCallback:null},qb={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ub extends _b{constructor(t,e){super(),this._element=t,t&&Ub.isSupported()&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return Vb}static get DefaultType(){return qb}static get NAME(){return"swipe"}dispose(){kb.off(this._element,Rb)}_start(t){this._supportPointerEvents?this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX):this._deltaX=t.touches[0].clientX}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),ib(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=40)return;const e=t/this._deltaX;this._deltaX=0,e&&ib(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(kb.on(this._element,Hb,(t=>this._start(t))),kb.on(this._element,zb,(t=>this._end(t))),this._element.classList.add("pointer-event")):(kb.on(this._element,Fb,(t=>this._start(t))),kb.on(this._element,Bb,(t=>this._move(t))),kb.on(this._element,jb,(t=>this._end(t))))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&("pen"===t.pointerType||"touch"===t.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Wb=".bs.carousel",Kb=".data-api",Yb="next",Jb="prev",Gb="left",Xb="right",Qb=`slide${Wb}`,Zb=`slid${Wb}`,tv=`keydown${Wb}`,ev=`mouseenter${Wb}`,nv=`mouseleave${Wb}`,iv=`dragstart${Wb}`,rv=`load${Wb}${Kb}`,sv=`click${Wb}${Kb}`,ov="carousel",av="active",lv=".active",cv=".carousel-item",dv=lv+cv,hv={ArrowLeft:Xb,ArrowRight:Gb},uv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class fv extends Ab{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Tb.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===ov&&this.cycle()}static get Default(){return uv}static get DefaultType(){return pv}static get NAME(){return"carousel"}next(){this._slide(Yb)}nextWhenVisible(){!document.hidden&&Yg(this._element)&&this.next()}prev(){this._slide(Jb)}pause(){this._isSliding&&Ug(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval((()=>this.nextWhenVisible()),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?kb.one(this._element,Zb,(()=>this.cycle())):this.cycle())}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding)return void kb.one(this._element,Zb,(()=>this.to(t)));const n=this._getItemIndex(this._getActive());if(n===t)return;const i=t>n?Yb:Jb;this._slide(i,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&kb.on(this._element,tv,(t=>this._keydown(t))),"hover"===this._config.pause&&(kb.on(this._element,ev,(()=>this.pause())),kb.on(this._element,nv,(()=>this._maybeEnableCycle()))),this._config.touch&&Ub.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const t of Tb.find(".carousel-item img",this._element))kb.on(t,iv,(t=>t.preventDefault()));const t={leftCallback:()=>this._slide(this._directionToOrder(Gb)),rightCallback:()=>this._slide(this._directionToOrder(Xb)),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout((()=>this._maybeEnableCycle()),500+this._config.interval))}};this._swipeHelper=new Ub(this._element,t)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=hv[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=Tb.findOne(lv,this._indicatorsElement);e.classList.remove(av),e.removeAttribute("aria-current");const n=Tb.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);n&&(n.classList.add(av),n.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const n=this._getActive(),i=t===Yb,r=e||sb(this._getItems(),n,i,this._config.wrap);if(r===n)return;const s=this._getItemIndex(r),o=e=>kb.trigger(this._element,e,{relatedTarget:r,direction:this._orderToDirection(t),from:this._getItemIndex(n),to:s});if(o(Qb).defaultPrevented)return;if(!n||!r)return;const a=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(s),this._activeElement=r;const l=i?"carousel-item-start":"carousel-item-end",c=i?"carousel-item-next":"carousel-item-prev";r.classList.add(c),Qg(r),n.classList.add(l),r.classList.add(l);this._queueCallback((()=>{r.classList.remove(l,c),r.classList.add(av),n.classList.remove(av,c,l),this._isSliding=!1,o(Zb)}),n,this._isAnimated()),a&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Tb.findOne(dv,this._element)}_getItems(){return Tb.find(cv,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return eb()?t===Gb?Jb:Yb:t===Gb?Yb:Jb}_orderToDirection(t){return eb()?t===Jb?Gb:Xb:t===Jb?Xb:Gb}static jQueryInterface(t){return this.each((function(){const e=fv.getOrCreateInstance(this,t);if("number"!=typeof t){if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}else e.to(t)}))}}kb.on(document,sv,"[data-bs-slide], [data-bs-slide-to]",(function(t){const e=Tb.getElementFromSelector(this);if(!e||!e.classList.contains(ov))return;t.preventDefault();const n=fv.getOrCreateInstance(e),i=this.getAttribute("data-bs-slide-to");return i?(n.to(i),void n._maybeEnableCycle()):"next"===Cb.getDataAttribute(this,"slide")?(n.next(),void n._maybeEnableCycle()):(n.prev(),void n._maybeEnableCycle())})),kb.on(window,rv,(()=>{const t=Tb.find('[data-bs-ride="carousel"]');for(const e of t)fv.getOrCreateInstance(e)})),nb(fv);const mv=".bs.collapse",gv=`show${mv}`,bv=`shown${mv}`,vv=`hide${mv}`,yv=`hidden${mv}`,wv=`click${mv}.data-api`,kv="show",Sv="collapse",xv="collapsing",Ev=`:scope .${Sv} .${Sv}`,Cv='[data-bs-toggle="collapse"]',_v={parent:null,toggle:!0},Av={parent:"(null|element)",toggle:"boolean"};class Ov extends Ab{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const n=Tb.find(Cv);for(const t of n){const e=Tb.getSelectorFromElement(t),n=Tb.find(e).filter((t=>t===this._element));null!==e&&n.length&&this._triggerArray.push(t)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return _v}static get DefaultType(){return Av}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter((t=>t!==this._element)).map((t=>Ov.getOrCreateInstance(t,{toggle:!1})))),t.length&&t[0]._isTransitioning)return;if(kb.trigger(this._element,gv).defaultPrevented)return;for(const e of t)e.hide();const e=this._getDimension();this._element.classList.remove(Sv),this._element.classList.add(xv),this._element.style[e]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const n=`scroll${e[0].toUpperCase()+e.slice(1)}`;this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(xv),this._element.classList.add(Sv,kv),this._element.style[e]="",kb.trigger(this._element,bv)}),this._element,!0),this._element.style[e]=`${this._element[n]}px`}hide(){if(this._isTransitioning||!this._isShown())return;if(kb.trigger(this._element,vv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Qg(this._element),this._element.classList.add(xv),this._element.classList.remove(Sv,kv);for(const t of this._triggerArray){const e=Tb.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0;this._element.style[t]="",this._queueCallback((()=>{this._isTransitioning=!1,this._element.classList.remove(xv),this._element.classList.add(Sv),kb.trigger(this._element,yv)}),this._element,!0)}_isShown(t=this._element){return t.classList.contains(kv)}_configAfterMerge(t){return t.toggle=Boolean(t.toggle),t.parent=Kg(t.parent),t}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Cv);for(const e of t){const t=Tb.getElementFromSelector(e);t&&this._addAriaAndCollapsedClass([e],this._isShown(t))}}_getFirstLevelChildren(t){const e=Tb.find(Ev,this._config.parent);return Tb.find(t,this._config.parent).filter((t=>!e.includes(t)))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const n of t)n.classList.toggle("collapsed",!e),n.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return"string"==typeof t&&/show|hide/.test(t)&&(e.toggle=!1),this.each((function(){const n=Ov.getOrCreateInstance(this,e);if("string"==typeof t){if(void 0===n[t])throw new TypeError(`No method named "${t}"`);n[t]()}}))}}kb.on(document,wv,Cv,(function(t){("A"===t.target.tagName||t.delegateTarget&&"A"===t.delegateTarget.tagName)&&t.preventDefault();for(const t of Tb.getMultipleElementsFromSelector(this))Ov.getOrCreateInstance(t,{toggle:!1}).toggle()})),nb(Ov);const Tv="dropdown",Mv=".bs.dropdown",Dv=".data-api",Lv="ArrowUp",Nv="ArrowDown",Iv=`hide${Mv}`,Pv=`hidden${Mv}`,$v=`show${Mv}`,Rv=`shown${Mv}`,Fv=`click${Mv}${Dv}`,Bv=`keydown${Mv}${Dv}`,jv=`keyup${Mv}${Dv}`,Hv="show",zv='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Vv=`${zv}.${Hv}`,qv=".dropdown-menu",Uv=eb()?"top-end":"top-start",Wv=eb()?"top-start":"top-end",Kv=eb()?"bottom-end":"bottom-start",Yv=eb()?"bottom-start":"bottom-end",Jv=eb()?"left-start":"right-start",Gv=eb()?"right-start":"left-start",Xv={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Qv={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Zv extends Ab{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=Tb.next(this._element,qv)[0]||Tb.prev(this._element,qv)[0]||Tb.findOne(qv,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Xv}static get DefaultType(){return Qv}static get NAME(){return Tv}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Jg(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!kb.trigger(this._element,$v,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const t of[].concat(...document.body.children))kb.on(t,"mouseover",Xg);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Hv),this._element.classList.add(Hv),kb.trigger(this._element,Rv,t)}}hide(){if(Jg(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!kb.trigger(this._element,Iv,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))kb.off(t,"mouseover",Xg);this._popper&&this._popper.destroy(),this._menu.classList.remove(Hv),this._element.classList.remove(Hv),this._element.setAttribute("aria-expanded","false"),Cb.removeDataAttribute(this._menu,"popper"),kb.trigger(this._element,Pv,t)}}_getConfig(t){if("object"==typeof(t=super._getConfig(t)).reference&&!Wg(t.reference)&&"function"!=typeof t.reference.getBoundingClientRect)throw new TypeError(`${Tv.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(void 0===jg)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let t=this._element;"parent"===this._config.reference?t=this._parent:Wg(this._config.reference)?t=Kg(this._config.reference):"object"==typeof this._config.reference&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=Bg(t,this._menu,e)}_isShown(){return this._menu.classList.contains(Hv)}_getPlacement(){const t=this._parent;if(t.classList.contains("dropend"))return Jv;if(t.classList.contains("dropstart"))return Gv;if(t.classList.contains("dropup-center"))return"top";if(t.classList.contains("dropdown-center"))return"bottom";const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?Wv:Uv:e?Yv:Kv}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(Cb.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...ib(this._config.popperConfig,[t])}}_selectMenuItem({key:t,target:e}){const n=Tb.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter((t=>Yg(t)));n.length&&sb(n,e,t===Nv,!n.includes(e)).focus()}static jQueryInterface(t){return this.each((function(){const e=Zv.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}static clearMenus(t){if(2===t.button||"keyup"===t.type&&"Tab"!==t.key)return;const e=Tb.find(Vv);for(const n of e){const e=Zv.getInstance(n);if(!e||!1===e._config.autoClose)continue;const i=t.composedPath(),r=i.includes(e._menu);if(i.includes(e._element)||"inside"===e._config.autoClose&&!r||"outside"===e._config.autoClose&&r)continue;if(e._menu.contains(t.target)&&("keyup"===t.type&&"Tab"===t.key||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const s={relatedTarget:e._element};"click"===t.type&&(s.clickEvent=t),e._completeHide(s)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),n="Escape"===t.key,i=[Lv,Nv].includes(t.key);if(!i&&!n)return;if(e&&!n)return;t.preventDefault();const r=this.matches(zv)?this:Tb.prev(this,zv)[0]||Tb.next(this,zv)[0]||Tb.findOne(zv,t.delegateTarget.parentNode),s=Zv.getOrCreateInstance(r);if(i)return t.stopPropagation(),s.show(),void s._selectMenuItem(t);s._isShown()&&(t.stopPropagation(),s.hide(),r.focus())}}kb.on(document,Bv,zv,Zv.dataApiKeydownHandler),kb.on(document,Bv,qv,Zv.dataApiKeydownHandler),kb.on(document,Fv,Zv.clearMenus),kb.on(document,jv,Zv.clearMenus),kb.on(document,Fv,zv,(function(t){t.preventDefault(),Zv.getOrCreateInstance(this).toggle()})),nb(Zv);const ty="backdrop",ey="show",ny=`mousedown.bs.${ty}`,iy={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},ry={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class sy extends _b{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return iy}static get DefaultType(){return ry}static get NAME(){return ty}show(t){if(!this._config.isVisible)return void ib(t);this._append();const e=this._getElement();this._config.isAnimated&&Qg(e),e.classList.add(ey),this._emulateAnimation((()=>{ib(t)}))}hide(t){this._config.isVisible?(this._getElement().classList.remove(ey),this._emulateAnimation((()=>{this.dispose(),ib(t)}))):ib(t)}dispose(){this._isAppended&&(kb.off(this._element,ny),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add("fade"),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=Kg(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),kb.on(t,ny,(()=>{ib(this._config.clickCallback)})),this._isAppended=!0}_emulateAnimation(t){rb(t,this._getElement(),this._config.isAnimated)}}const oy=".bs.focustrap",ay=`focusin${oy}`,ly=`keydown.tab${oy}`,cy="backward",dy={autofocus:!0,trapElement:null},hy={autofocus:"boolean",trapElement:"element"};class uy extends _b{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return dy}static get DefaultType(){return hy}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),kb.off(document,oy),kb.on(document,ay,(t=>this._handleFocusin(t))),kb.on(document,ly,(t=>this._handleKeydown(t))),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,kb.off(document,oy))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const n=Tb.focusableChildren(e);0===n.length?e.focus():this._lastTabNavDirection===cy?n[n.length-1].focus():n[0].focus()}_handleKeydown(t){"Tab"===t.key&&(this._lastTabNavDirection=t.shiftKey?cy:"forward")}}const py=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",fy=".sticky-top",my="padding-right",gy="margin-right";class by{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,my,(e=>e+t)),this._setElementAttributes(py,my,(e=>e+t)),this._setElementAttributes(fy,gy,(e=>e-t))}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,my),this._resetElementAttributes(py,my),this._resetElementAttributes(fy,gy)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,n){const i=this.getWidth();this._applyManipulationCallback(t,(t=>{if(t!==this._element&&window.innerWidth>t.clientWidth+i)return;this._saveInitialAttribute(t,e);const r=window.getComputedStyle(t).getPropertyValue(e);t.style.setProperty(e,`${n(Number.parseFloat(r))}px`)}))}_saveInitialAttribute(t,e){const n=t.style.getPropertyValue(e);n&&Cb.setDataAttribute(t,e,n)}_resetElementAttributes(t,e){this._applyManipulationCallback(t,(t=>{const n=Cb.getDataAttribute(t,e);null!==n?(Cb.removeDataAttribute(t,e),t.style.setProperty(e,n)):t.style.removeProperty(e)}))}_applyManipulationCallback(t,e){if(Wg(t))e(t);else for(const n of Tb.find(t,this._element))e(n)}}const vy=".bs.modal",yy=`hide${vy}`,wy=`hidePrevented${vy}`,ky=`hidden${vy}`,Sy=`show${vy}`,xy=`shown${vy}`,Ey=`resize${vy}`,Cy=`click.dismiss${vy}`,_y=`mousedown.dismiss${vy}`,Ay=`keydown.dismiss${vy}`,Oy=`click${vy}.data-api`,Ty="modal-open",My="show",Dy="modal-static",Ly={backdrop:!0,focus:!0,keyboard:!0},Ny={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Iy extends Ab{constructor(t,e){super(t,e),this._dialog=Tb.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new by,this._addEventListeners()}static get Default(){return Ly}static get DefaultType(){return Ny}static get NAME(){return"modal"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||this._isTransitioning)return;kb.trigger(this._element,Sy,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Ty),this._adjustDialog(),this._backdrop.show((()=>this._showElement(t))))}hide(){if(!this._isShown||this._isTransitioning)return;kb.trigger(this._element,yy).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(My),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated()))}dispose(){kb.off(window,vy),kb.off(this._dialog,vy),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new sy({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new uy({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=Tb.findOne(".modal-body",this._dialog);e&&(e.scrollTop=0),Qg(this._element),this._element.classList.add(My);this._queueCallback((()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,kb.trigger(this._element,xy,{relatedTarget:t})}),this._dialog,this._isAnimated())}_addEventListeners(){kb.on(this._element,Ay,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),kb.on(window,Ey,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),kb.on(this._element,_y,(t=>{kb.one(this._element,Cy,(e=>{this._element===t.target&&this._element===e.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove(Ty),this._resetAdjustments(),this._scrollBar.reset(),kb.trigger(this._element,ky)}))}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(kb.trigger(this._element,wy).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._element.style.overflowY;"hidden"===e||this._element.classList.contains(Dy)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Dy),this._queueCallback((()=>{this._element.classList.remove(Dy),this._queueCallback((()=>{this._element.style.overflowY=e}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),n=e>0;if(n&&!t){const t=eb()?"paddingLeft":"paddingRight";this._element.style[t]=`${e}px`}if(!n&&t){const t=eb()?"paddingRight":"paddingLeft";this._element.style[t]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each((function(){const n=Iy.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===n[t])throw new TypeError(`No method named "${t}"`);n[t](e)}}))}}kb.on(document,Oy,'[data-bs-toggle="modal"]',(function(t){const e=Tb.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),kb.one(e,Sy,(t=>{t.defaultPrevented||kb.one(e,ky,(()=>{Yg(this)&&this.focus()}))}));const n=Tb.findOne(".modal.show");n&&Iy.getInstance(n).hide();Iy.getOrCreateInstance(e).toggle(this)})),Mb(Iy),nb(Iy);const Py=".bs.offcanvas",$y=".data-api",Ry=`load${Py}${$y}`,Fy="show",By="showing",jy="hiding",Hy=".offcanvas.show",zy=`show${Py}`,Vy=`shown${Py}`,qy=`hide${Py}`,Uy=`hidePrevented${Py}`,Wy=`hidden${Py}`,Ky=`resize${Py}`,Yy=`click${Py}${$y}`,Jy=`keydown.dismiss${Py}`,Gy={backdrop:!0,keyboard:!0,scroll:!1},Xy={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Qy extends Ab{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Gy}static get DefaultType(){return Xy}static get NAME(){return"offcanvas"}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown)return;if(kb.trigger(this._element,zy,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||(new by).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(By);this._queueCallback((()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Fy),this._element.classList.remove(By),kb.trigger(this._element,Vy,{relatedTarget:t})}),this._element,!0)}hide(){if(!this._isShown)return;if(kb.trigger(this._element,qy).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(jy),this._backdrop.hide();this._queueCallback((()=>{this._element.classList.remove(Fy,jy),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||(new by).reset(),kb.trigger(this._element,Wy)}),this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=Boolean(this._config.backdrop);return new sy({className:"offcanvas-backdrop",isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?()=>{"static"!==this._config.backdrop?this.hide():kb.trigger(this._element,Uy)}:null})}_initializeFocusTrap(){return new uy({trapElement:this._element})}_addEventListeners(){kb.on(this._element,Jy,(t=>{"Escape"===t.key&&(this._config.keyboard?this.hide():kb.trigger(this._element,Uy))}))}static jQueryInterface(t){return this.each((function(){const e=Qy.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}kb.on(document,Yy,'[data-bs-toggle="offcanvas"]',(function(t){const e=Tb.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),Jg(this))return;kb.one(e,Wy,(()=>{Yg(this)&&this.focus()}));const n=Tb.findOne(Hy);n&&n!==e&&Qy.getInstance(n).hide();Qy.getOrCreateInstance(e).toggle(this)})),kb.on(window,Ry,(()=>{for(const t of Tb.find(Hy))Qy.getOrCreateInstance(t).show()})),kb.on(window,Ky,(()=>{for(const t of Tb.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(t).position&&Qy.getOrCreateInstance(t).hide()})),Mb(Qy),nb(Qy);const Zy=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),tw=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,ew=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,nw=(t,e)=>{const n=t.nodeName.toLowerCase();return e.includes(n)?!Zy.has(n)||Boolean(tw.test(t.nodeValue)||ew.test(t.nodeValue)):e.filter((t=>t instanceof RegExp)).some((t=>t.test(n)))},iw={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};const rw={allowList:iw,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},sw={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},ow={entry:"(string|element|function|null)",selector:"(string|element)"};class aw extends _b{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return rw}static get DefaultType(){return sw}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map((t=>this._resolvePossibleFunction(t))).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[e,n]of Object.entries(this._config.content))this._setContent(t,n,e);const e=t.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&e.classList.add(...n.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,n]of Object.entries(t))super._typeCheckConfig({selector:e,entry:n},ow)}_setContent(t,e,n){const i=Tb.findOne(n,t);i&&((e=this._resolvePossibleFunction(e))?Wg(e)?this._putElementInTemplate(Kg(e),i):this._config.html?i.innerHTML=this._maybeSanitize(e):i.textContent=e:i.remove())}_maybeSanitize(t){return this._config.sanitize?function(t,e,n){if(!t.length)return t;if(n&&"function"==typeof n)return n(t);const i=(new window.DOMParser).parseFromString(t,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const t of r){const n=t.nodeName.toLowerCase();if(!Object.keys(e).includes(n)){t.remove();continue}const i=[].concat(...t.attributes),r=[].concat(e["*"]||[],e[n]||[]);for(const e of i)nw(e,r)||t.removeAttribute(e.nodeName)}return i.body.innerHTML}(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return ib(t,[this])}_putElementInTemplate(t,e){if(this._config.html)return e.innerHTML="",void e.append(t);e.textContent=t.textContent}}const lw=new Set(["sanitize","allowList","sanitizeFn"]),cw="fade",dw="show",hw=".modal",uw="hide.bs.modal",pw="hover",fw="focus",mw={AUTO:"auto",TOP:"top",RIGHT:eb()?"left":"right",BOTTOM:"bottom",LEFT:eb()?"right":"left"},gw={allowList:iw,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},bw={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class vw extends Ab{constructor(t,e){if(void 0===jg)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return gw}static get DefaultType(){return bw}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),kb.off(this._element.closest(hw),uw,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const t=kb.trigger(this._element,this.constructor.eventName("show")),e=(Gg(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!e)return;this._disposePopper();const n=this._getTipElement();this._element.setAttribute("aria-describedby",n.getAttribute("id"));const{container:i}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(i.append(n),kb.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(n),n.classList.add(dw),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))kb.on(t,"mouseover",Xg);this._queueCallback((()=>{kb.trigger(this._element,this.constructor.eventName("shown")),!1===this._isHovered&&this._leave(),this._isHovered=!1}),this.tip,this._isAnimated())}hide(){if(!this._isShown())return;if(kb.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented)return;if(this._getTipElement().classList.remove(dw),"ontouchstart"in document.documentElement)for(const t of[].concat(...document.body.children))kb.off(t,"mouseover",Xg);this._activeTrigger.click=!1,this._activeTrigger[fw]=!1,this._activeTrigger[pw]=!1,this._isHovered=null;this._queueCallback((()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),kb.trigger(this._element,this.constructor.eventName("hidden")))}),this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(cw,dw),e.classList.add(`bs-${this.constructor.NAME}-auto`);const n=(t=>{do{t+=Math.floor(1e6*Math.random())}while(document.getElementById(t));return t})(this.constructor.NAME).toString();return e.setAttribute("id",n),this._isAnimated()&&e.classList.add(cw),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new aw({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(cw)}_isShown(){return this.tip&&this.tip.classList.contains(dw)}_createPopper(t){const e=ib(this._config.placement,[this,t,this._element]),n=mw[e.toUpperCase()];return Bg(this._element,t,this._getPopperConfig(n))}_getOffset(){const{offset:t}=this._config;return"string"==typeof t?t.split(",").map((t=>Number.parseInt(t,10))):"function"==typeof t?e=>t(e,this._element):t}_resolvePossibleFunction(t){return ib(t,[this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:t=>{this._getTipElement().setAttribute("data-popper-placement",t.state.placement)}}]};return{...e,...ib(this._config.popperConfig,[e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if("click"===e)kb.on(this._element,this.constructor.eventName("click"),this._config.selector,(t=>{this._initializeOnDelegatedTarget(t).toggle()}));else if("manual"!==e){const t=e===pw?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),n=e===pw?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");kb.on(this._element,t,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusin"===t.type?fw:pw]=!0,e._enter()})),kb.on(this._element,n,this._config.selector,(t=>{const e=this._initializeOnDelegatedTarget(t);e._activeTrigger["focusout"===t.type?fw:pw]=e._element.contains(t.relatedTarget),e._leave()}))}this._hideModalHandler=()=>{this._element&&this.hide()},kb.on(this._element.closest(hw),uw,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout((()=>{this._isHovered&&this.show()}),this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout((()=>{this._isHovered||this.hide()}),this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=Cb.getDataAttributes(this._element);for(const t of Object.keys(e))lw.has(t)&&delete e[t];return t={...e,..."object"==typeof t&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=!1===t.container?document.body:Kg(t.container),"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,n]of Object.entries(this._config))this.constructor.Default[e]!==n&&(t[e]=n);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each((function(){const e=vw.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}nb(vw);const yw={...vw.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ww={...vw.DefaultType,content:"(null|string|element|function)"};class kw extends vw{static get Default(){return yw}static get DefaultType(){return ww}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each((function(){const e=kw.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t]()}}))}}nb(kw);const Sw=".bs.scrollspy",xw=`activate${Sw}`,Ew=`click${Sw}`,Cw=`load${Sw}.data-api`,_w="active",Aw="[href]",Ow=".nav-link",Tw=`${Ow}, .nav-item > ${Ow}, .list-group-item`,Mw={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Dw={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Lw extends Ab{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Mw}static get DefaultType(){return Dw}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=Kg(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,"string"==typeof t.threshold&&(t.threshold=t.threshold.split(",").map((t=>Number.parseFloat(t)))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(kb.off(this._config.target,Ew),kb.on(this._config.target,Ew,Aw,(t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const n=this._rootElement||window,i=e.offsetTop-this._element.offsetTop;if(n.scrollTo)return void n.scrollTo({top:i,behavior:"smooth"});n.scrollTop=i}})))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver((t=>this._observerCallback(t)),t)}_observerCallback(t){const e=t=>this._targetLinks.get(`#${t.target.id}`),n=t=>{this._previousScrollData.visibleEntryTop=t.target.offsetTop,this._process(e(t))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const s of t){if(!s.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(s));continue}const t=s.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&t){if(n(s),!i)return}else r||t||n(s)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=Tb.find(Aw,this._config.target);for(const e of t){if(!e.hash||Jg(e))continue;const t=Tb.findOne(e.hash,this._element);Yg(t)&&(this._targetLinks.set(e.hash,e),this._observableSections.set(e.hash,t))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(_w),this._activateParents(t),kb.trigger(this._element,xw,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains("dropdown-item"))Tb.findOne(".dropdown-toggle",t.closest(".dropdown")).classList.add(_w);else for(const e of Tb.parents(t,".nav, .list-group"))for(const t of Tb.prev(e,Tw))t.classList.add(_w)}_clearActiveClass(t){t.classList.remove(_w);const e=Tb.find(`${Aw}.${_w}`,t);for(const t of e)t.classList.remove(_w)}static jQueryInterface(t){return this.each((function(){const e=Lw.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}kb.on(window,Cw,(()=>{for(const t of Tb.find('[data-bs-spy="scroll"]'))Lw.getOrCreateInstance(t)})),nb(Lw);const Nw=".bs.tab",Iw=`hide${Nw}`,Pw=`hidden${Nw}`,$w=`show${Nw}`,Rw=`shown${Nw}`,Fw=`click${Nw}`,Bw=`keydown${Nw}`,jw=`load${Nw}`,Hw="ArrowLeft",zw="ArrowRight",Vw="ArrowUp",qw="ArrowDown",Uw="active",Ww="fade",Kw="show",Yw=":not(.dropdown-toggle)",Jw='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Gw=`${`.nav-link${Yw}, .list-group-item${Yw}, [role="tab"]${Yw}`}, ${Jw}`,Xw=`.${Uw}[data-bs-toggle="tab"], .${Uw}[data-bs-toggle="pill"], .${Uw}[data-bs-toggle="list"]`;class Qw extends Ab{constructor(t){super(t),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),kb.on(this._element,Bw,(t=>this._keydown(t))))}static get NAME(){return"tab"}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),n=e?kb.trigger(e,Iw,{relatedTarget:t}):null;kb.trigger(t,$w,{relatedTarget:e}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(Uw),this._activate(Tb.getElementFromSelector(t));this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),kb.trigger(t,Rw,{relatedTarget:e})):t.classList.add(Kw)}),t,t.classList.contains(Ww))}_deactivate(t,e){if(!t)return;t.classList.remove(Uw),t.blur(),this._deactivate(Tb.getElementFromSelector(t));this._queueCallback((()=>{"tab"===t.getAttribute("role")?(t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),kb.trigger(t,Pw,{relatedTarget:e})):t.classList.remove(Kw)}),t,t.classList.contains(Ww))}_keydown(t){if(![Hw,zw,Vw,qw].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=[zw,qw].includes(t.key),n=sb(this._getChildren().filter((t=>!Jg(t))),t.target,e,!0);n&&(n.focus({preventScroll:!0}),Qw.getOrCreateInstance(n).show())}_getChildren(){return Tb.find(Gw,this._parent)}_getActiveElem(){return this._getChildren().find((t=>this._elemIsActive(t)))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const t of e)this._setInitialAttributesOnChild(t)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),n=this._getOuterElement(t);t.setAttribute("aria-selected",e),n!==t&&this._setAttributeIfNotExists(n,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=Tb.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const n=this._getOuterElement(t);if(!n.classList.contains("dropdown"))return;const i=(t,i)=>{const r=Tb.findOne(t,n);r&&r.classList.toggle(i,e)};i(".dropdown-toggle",Uw),i(".dropdown-menu",Kw),n.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,n){t.hasAttribute(e)||t.setAttribute(e,n)}_elemIsActive(t){return t.classList.contains(Uw)}_getInnerElement(t){return t.matches(Gw)?t:Tb.findOne(Gw,t)}_getOuterElement(t){return t.closest(".nav-item, .list-group-item")||t}static jQueryInterface(t){return this.each((function(){const e=Qw.getOrCreateInstance(this);if("string"==typeof t){if(void 0===e[t]||t.startsWith("_")||"constructor"===t)throw new TypeError(`No method named "${t}"`);e[t]()}}))}}kb.on(document,Fw,Jw,(function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),Jg(this)||Qw.getOrCreateInstance(this).show()})),kb.on(window,jw,(()=>{for(const t of Tb.find(Xw))Qw.getOrCreateInstance(t)})),nb(Qw);const Zw=".bs.toast",tk=`mouseover${Zw}`,ek=`mouseout${Zw}`,nk=`focusin${Zw}`,ik=`focusout${Zw}`,rk=`hide${Zw}`,sk=`hidden${Zw}`,ok=`show${Zw}`,ak=`shown${Zw}`,lk="hide",ck="show",dk="showing",hk={animation:"boolean",autohide:"boolean",delay:"number"},uk={animation:!0,autohide:!0,delay:5e3};class pk extends Ab{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return uk}static get DefaultType(){return hk}static get NAME(){return"toast"}show(){if(kb.trigger(this._element,ok).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");this._element.classList.remove(lk),Qg(this._element),this._element.classList.add(ck,dk),this._queueCallback((()=>{this._element.classList.remove(dk),kb.trigger(this._element,ak),this._maybeScheduleHide()}),this._element,this._config.animation)}hide(){if(!this.isShown())return;if(kb.trigger(this._element,rk).defaultPrevented)return;this._element.classList.add(dk),this._queueCallback((()=>{this._element.classList.add(lk),this._element.classList.remove(dk,ck),kb.trigger(this._element,sk)}),this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ck),super.dispose()}isShown(){return this._element.classList.contains(ck)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout((()=>{this.hide()}),this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":this._hasMouseInteraction=e;break;case"focusin":case"focusout":this._hasKeyboardInteraction=e}if(e)return void this._clearTimeout();const n=t.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){kb.on(this._element,tk,(t=>this._onInteraction(t,!0))),kb.on(this._element,ek,(t=>this._onInteraction(t,!1))),kb.on(this._element,nk,(t=>this._onInteraction(t,!0))),kb.on(this._element,ik,(t=>this._onInteraction(t,!1)))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each((function(){const e=pk.getOrCreateInstance(this,t);if("string"==typeof t){if(void 0===e[t])throw new TypeError(`No method named "${t}"`);e[t](this)}}))}}Mb(pk),nb(pk);var fk=Object.freeze({__proto__:null,Alert:Ib,Button:$b,Carousel:fv,Collapse:Ov,Dropdown:Zv,Modal:Iy,Offcanvas:Qy,Popover:kw,ScrollSpy:Lw,Tab:Qw,Toast:pk,Tooltip:vw});window.bootstrap||(window.bootstrap=fk);class mk{constructor(t,e,n){this.eventTarget=t,this.eventName=e,this.eventOptions=n,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(t){this.unorderedBindings.add(t)}bindingDisconnected(t){this.unorderedBindings.delete(t)}handleEvent(t){const e=function(t){if("immediatePropagationStopped"in t)return t;{const{stopImmediatePropagation:e}=t;return Object.assign(t,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}(t);for(const t of this.bindings){if(e.immediatePropagationStopped)break;t.handleEvent(e)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort(((t,e)=>{const n=t.index,i=e.index;return n<i?-1:n>i?1:0}))}}class gk{constructor(t){this.application=t,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach((t=>t.connect())))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach((t=>t.disconnect())))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce(((t,e)=>t.concat(Array.from(e.values()))),[])}bindingConnected(t){this.fetchEventListenerForBinding(t).bindingConnected(t)}bindingDisconnected(t,e=!1){this.fetchEventListenerForBinding(t).bindingDisconnected(t),e&&this.clearEventListenersForBinding(t)}handleError(t,e,n={}){this.application.handleError(t,`Error ${e}`,n)}clearEventListenersForBinding(t){const e=this.fetchEventListenerForBinding(t);e.hasBindings()||(e.disconnect(),this.removeMappedEventListenerFor(t))}removeMappedEventListenerFor(t){const{eventTarget:e,eventName:n,eventOptions:i}=t,r=this.fetchEventListenerMapForEventTarget(e),s=this.cacheKey(n,i);r.delete(s),0==r.size&&this.eventListenerMaps.delete(e)}fetchEventListenerForBinding(t){const{eventTarget:e,eventName:n,eventOptions:i}=t;return this.fetchEventListener(e,n,i)}fetchEventListener(t,e,n){const i=this.fetchEventListenerMapForEventTarget(t),r=this.cacheKey(e,n);let s=i.get(r);return s||(s=this.createEventListener(t,e,n),i.set(r,s)),s}createEventListener(t,e,n){const i=new mk(t,e,n);return this.started&&i.connect(),i}fetchEventListenerMapForEventTarget(t){let e=this.eventListenerMaps.get(t);return e||(e=new Map,this.eventListenerMaps.set(t,e)),e}cacheKey(t,e){const n=[t];return Object.keys(e).sort().forEach((t=>{n.push(`${e[t]?"":"!"}${t}`)})),n.join(":")}}const bk={stop:({event:t,value:e})=>(e&&t.stopPropagation(),!0),prevent:({event:t,value:e})=>(e&&t.preventDefault(),!0),self:({event:t,value:e,element:n})=>!e||n===t.target},vk=/^(?:(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function yk(t){return"window"==t?window:"document"==t?document:void 0}function wk(t){return t.replace(/(?:[_-])([a-z0-9])/g,((t,e)=>e.toUpperCase()))}function kk(t){return wk(t.replace(/--/g,"-").replace(/__/g,"_"))}function Sk(t){return t.charAt(0).toUpperCase()+t.slice(1)}function xk(t){return t.replace(/([A-Z])/g,((t,e)=>`-${e.toLowerCase()}`))}class Ek{constructor(t,e,n,i){this.element=t,this.index=e,this.eventTarget=n.eventTarget||t,this.eventName=n.eventName||function(t){const e=t.tagName.toLowerCase();if(e in Ck)return Ck[e](t)}(t)||_k("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||_k("missing identifier"),this.methodName=n.methodName||_k("missing method name"),this.keyFilter=n.keyFilter||"",this.schema=i}static forToken(t,e){return new this(t.element,t.index,function(t){const e=t.trim().match(vk)||[];let n=e[1],i=e[2];return i&&!["keydown","keyup","keypress"].includes(n)&&(n+=`.${i}`,i=""),{eventTarget:yk(e[3]),eventName:n,eventOptions:e[6]?(r=e[6],r.split(":").reduce(((t,e)=>Object.assign(t,{[e.replace(/^!/,"")]:!/^!/.test(e)})),{})):{},identifier:e[4],methodName:e[5],keyFilter:i};var r}(t.content),e)}toString(){const t=this.keyFilter?`.${this.keyFilter}`:"",e=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${t}${e}->${this.identifier}#${this.methodName}`}isFilterTarget(t){if(!this.keyFilter)return!1;const e=this.keyFilter.split("+"),n=["meta","ctrl","alt","shift"],[i,r,s,o]=n.map((t=>e.includes(t)));if(t.metaKey!==i||t.ctrlKey!==r||t.altKey!==s||t.shiftKey!==o)return!0;const a=e.filter((t=>!n.includes(t)))[0];return!!a&&(Object.prototype.hasOwnProperty.call(this.keyMappings,a)||_k(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[a].toLowerCase()!==t.key.toLowerCase())}get params(){const t={},e=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:n,value:i}of Array.from(this.element.attributes)){const r=n.match(e),s=r&&r[1];s&&(t[wk(s)]=Ak(i))}return t}get eventTargetName(){return(t=this.eventTarget)==window?"window":t==document?"document":void 0;var t}get keyMappings(){return this.schema.keyMappings}}const Ck={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:t=>"submit"==t.getAttribute("type")?"click":"input",select:()=>"change",textarea:()=>"input"};function _k(t){throw new Error(t)}function Ak(t){try{return JSON.parse(t)}catch(e){return t}}class Ok{constructor(t,e){this.context=t,this.action=e}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(t){this.willBeInvokedByEvent(t)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const t=this.controller[this.methodName];if("function"==typeof t)return t;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(t){const{element:e}=this.action,{actionDescriptorFilters:n}=this.context.application;let i=!0;for(const[r,s]of Object.entries(this.eventOptions))if(r in n){const o=n[r];i=i&&o({name:r,value:s,event:t,element:e})}return i}invokeWithEvent(t){const{target:e,currentTarget:n}=t;try{const{params:i}=this.action,r=Object.assign(t,{params:i});this.method.call(this.controller,r),this.context.logDebugActivity(this.methodName,{event:t,target:e,currentTarget:n,action:this.methodName})}catch(e){const{identifier:n,controller:i,element:r,index:s}=this,o={identifier:n,controller:i,element:r,index:s,event:t};this.context.handleError(e,`invoking action "${this.action}"`,o)}}willBeInvokedByEvent(t){const e=t.target;return!(t instanceof KeyboardEvent&&this.action.isFilterTarget(t))&&(this.element===e||(e instanceof Element&&this.element.contains(e)?this.scope.containsElement(e):this.scope.containsElement(this.action.element)))}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class Tk{constructor(t,e){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=t,this.started=!1,this.delegate=e,this.elements=new Set,this.mutationObserver=new MutationObserver((t=>this.processMutations(t)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(t){this.started&&(this.mutationObserver.disconnect(),this.started=!1),t(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const t=new Set(this.matchElementsInTree());for(const e of Array.from(this.elements))t.has(e)||this.removeElement(e);for(const e of Array.from(t))this.addElement(e)}}processMutations(t){if(this.started)for(const e of t)this.processMutation(e)}processMutation(t){"attributes"==t.type?this.processAttributeChange(t.target,t.attributeName):"childList"==t.type&&(this.processRemovedNodes(t.removedNodes),this.processAddedNodes(t.addedNodes))}processAttributeChange(t,e){const n=t;this.elements.has(n)?this.delegate.elementAttributeChanged&&this.matchElement(n)?this.delegate.elementAttributeChanged(n,e):this.removeElement(n):this.matchElement(n)&&this.addElement(n)}processRemovedNodes(t){for(const e of Array.from(t)){const t=this.elementFromNode(e);t&&this.processTree(t,this.removeElement)}}processAddedNodes(t){for(const e of Array.from(t)){const t=this.elementFromNode(e);t&&this.elementIsActive(t)&&this.processTree(t,this.addElement)}}matchElement(t){return this.delegate.matchElement(t)}matchElementsInTree(t=this.element){return this.delegate.matchElementsInTree(t)}processTree(t,e){for(const n of this.matchElementsInTree(t))e.call(this,n)}elementFromNode(t){if(t.nodeType==Node.ELEMENT_NODE)return t}elementIsActive(t){return t.isConnected==this.element.isConnected&&this.element.contains(t)}addElement(t){this.elements.has(t)||this.elementIsActive(t)&&(this.elements.add(t),this.delegate.elementMatched&&this.delegate.elementMatched(t))}removeElement(t){this.elements.has(t)&&(this.elements.delete(t),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(t))}}class Mk{constructor(t,e,n){this.attributeName=e,this.delegate=n,this.elementObserver=new Tk(t,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(t){return t.hasAttribute(this.attributeName)}matchElementsInTree(t){const e=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector));return e.concat(n)}elementMatched(t){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(t,this.attributeName)}elementUnmatched(t){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(t,this.attributeName)}elementAttributeChanged(t,e){this.delegate.elementAttributeValueChanged&&this.attributeName==e&&this.delegate.elementAttributeValueChanged(t,e)}}function Dk(t,e){let n=t.get(e);return n||(n=new Set,t.set(e,n)),n}class Lk{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce(((t,e)=>t.concat(Array.from(e))),[])}get size(){return Array.from(this.valuesByKey.values()).reduce(((t,e)=>t+e.size),0)}add(t,e){!function(t,e,n){Dk(t,e).add(n)}(this.valuesByKey,t,e)}delete(t,e){!function(t,e,n){Dk(t,e).delete(n),function(t,e){const n=t.get(e);null!=n&&0==n.size&&t.delete(e)}(t,e)}(this.valuesByKey,t,e)}has(t,e){const n=this.valuesByKey.get(t);return null!=n&&n.has(e)}hasKey(t){return this.valuesByKey.has(t)}hasValue(t){return Array.from(this.valuesByKey.values()).some((e=>e.has(t)))}getValuesForKey(t){const e=this.valuesByKey.get(t);return e?Array.from(e):[]}getKeysForValue(t){return Array.from(this.valuesByKey).filter((([e,n])=>n.has(t))).map((([t,e])=>t))}}class Nk{constructor(t,e,n,i={}){this.selector=e,this.details=i,this.elementObserver=new Tk(t,this),this.delegate=n,this.matchesByElement=new Lk}get started(){return this.elementObserver.started}start(){this.elementObserver.start()}pause(t){this.elementObserver.pause(t)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(t){const e=t.matches(this.selector);return this.delegate.selectorMatchElement?e&&this.delegate.selectorMatchElement(t,this.details):e}matchElementsInTree(t){const e=this.matchElement(t)?[t]:[],n=Array.from(t.querySelectorAll(this.selector)).filter((t=>this.matchElement(t)));return e.concat(n)}elementMatched(t){this.selectorMatched(t)}elementUnmatched(t){this.selectorUnmatched(t)}elementAttributeChanged(t,e){const n=this.matchElement(t),i=this.matchesByElement.has(this.selector,t);!n&&i&&this.selectorUnmatched(t)}selectorMatched(t){this.delegate.selectorMatched&&(this.delegate.selectorMatched(t,this.selector,this.details),this.matchesByElement.add(this.selector,t))}selectorUnmatched(t){this.delegate.selectorUnmatched(t,this.selector,this.details),this.matchesByElement.delete(this.selector,t)}}class Ik{constructor(t,e){this.element=t,this.delegate=e,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver((t=>this.processMutations(t)))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const t of this.knownAttributeNames)this.refreshAttribute(t,null)}processMutations(t){if(this.started)for(const e of t)this.processMutation(e)}processMutation(t){const e=t.attributeName;e&&this.refreshAttribute(e,t.oldValue)}refreshAttribute(t,e){const n=this.delegate.getStringMapKeyForAttribute(t);if(null!=n){this.stringMap.has(t)||this.stringMapKeyAdded(n,t);const i=this.element.getAttribute(t);if(this.stringMap.get(t)!=i&&this.stringMapValueChanged(i,n,e),null==i){const e=this.stringMap.get(t);this.stringMap.delete(t),e&&this.stringMapKeyRemoved(n,t,e)}else this.stringMap.set(t,i)}}stringMapKeyAdded(t,e){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(t,e)}stringMapValueChanged(t,e,n){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(t,e,n)}stringMapKeyRemoved(t,e,n){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(t,e,n)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map((t=>t.name))}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class Pk{constructor(t,e,n){this.attributeObserver=new Mk(t,e,this),this.delegate=n,this.tokensByElement=new Lk}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(t){this.attributeObserver.pause(t)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(t){this.tokensMatched(this.readTokensForElement(t))}elementAttributeValueChanged(t){const[e,n]=this.refreshTokensForElement(t);this.tokensUnmatched(e),this.tokensMatched(n)}elementUnmatchedAttribute(t){this.tokensUnmatched(this.tokensByElement.getValuesForKey(t))}tokensMatched(t){t.forEach((t=>this.tokenMatched(t)))}tokensUnmatched(t){t.forEach((t=>this.tokenUnmatched(t)))}tokenMatched(t){this.delegate.tokenMatched(t),this.tokensByElement.add(t.element,t)}tokenUnmatched(t){this.delegate.tokenUnmatched(t),this.tokensByElement.delete(t.element,t)}refreshTokensForElement(t){const e=this.tokensByElement.getValuesForKey(t),n=this.readTokensForElement(t),i=function(t,e){const n=Math.max(t.length,e.length);return Array.from({length:n},((n,i)=>[t[i],e[i]]))}(e,n).findIndex((([t,e])=>!function(t,e){return t&&e&&t.index==e.index&&t.content==e.content}(t,e)));return-1==i?[[],[]]:[e.slice(i),n.slice(i)]}readTokensForElement(t){const e=this.attributeName;return function(t,e,n){return t.trim().split(/\s+/).filter((t=>t.length)).map(((t,i)=>({element:e,attributeName:n,content:t,index:i})))}(t.getAttribute(e)||"",t,e)}}class $k{constructor(t,e,n){this.tokenListObserver=new Pk(t,e,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(t){const{element:e}=t,{value:n}=this.fetchParseResultForToken(t);n&&(this.fetchValuesByTokenForElement(e).set(t,n),this.delegate.elementMatchedValue(e,n))}tokenUnmatched(t){const{element:e}=t,{value:n}=this.fetchParseResultForToken(t);n&&(this.fetchValuesByTokenForElement(e).delete(t),this.delegate.elementUnmatchedValue(e,n))}fetchParseResultForToken(t){let e=this.parseResultsByToken.get(t);return e||(e=this.parseToken(t),this.parseResultsByToken.set(t,e)),e}fetchValuesByTokenForElement(t){let e=this.valuesByTokenByElement.get(t);return e||(e=new Map,this.valuesByTokenByElement.set(t,e)),e}parseToken(t){try{return{value:this.delegate.parseValueForToken(t)}}catch(t){return{error:t}}}}class Rk{constructor(t,e){this.context=t,this.delegate=e,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new $k(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(t){const e=new Ok(this.context,t);this.bindingsByAction.set(t,e),this.delegate.bindingConnected(e)}disconnectAction(t){const e=this.bindingsByAction.get(t);e&&(this.bindingsByAction.delete(t),this.delegate.bindingDisconnected(e))}disconnectAllActions(){this.bindings.forEach((t=>this.delegate.bindingDisconnected(t,!0))),this.bindingsByAction.clear()}parseValueForToken(t){const e=Ek.forToken(t,this.schema);if(e.identifier==this.identifier)return e}elementMatchedValue(t,e){this.connectAction(e)}elementUnmatchedValue(t,e){this.disconnectAction(e)}}class Fk{constructor(t,e){this.context=t,this.receiver=e,this.stringMapObserver=new Ik(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(t){if(t in this.valueDescriptorMap)return this.valueDescriptorMap[t].name}stringMapKeyAdded(t,e){const n=this.valueDescriptorMap[e];this.hasValue(t)||this.invokeChangedCallback(t,n.writer(this.receiver[t]),n.writer(n.defaultValue))}stringMapValueChanged(t,e,n){const i=this.valueDescriptorNameMap[e];null!==t&&(null===n&&(n=i.writer(i.defaultValue)),this.invokeChangedCallback(e,t,n))}stringMapKeyRemoved(t,e,n){const i=this.valueDescriptorNameMap[t];this.hasValue(t)?this.invokeChangedCallback(t,i.writer(this.receiver[t]),n):this.invokeChangedCallback(t,i.writer(i.defaultValue),n)}invokeChangedCallbacksForDefaultValues(){for(const{key:t,name:e,defaultValue:n,writer:i}of this.valueDescriptors)null==n||this.controller.data.has(t)||this.invokeChangedCallback(e,i(n),void 0)}invokeChangedCallback(t,e,n){const i=`${t}Changed`,r=this.receiver[i];if("function"==typeof r){const i=this.valueDescriptorNameMap[t];try{const t=i.reader(e);let s=n;n&&(s=i.reader(n)),r.call(this.receiver,t,s)}catch(t){throw t instanceof TypeError&&(t.message=`Stimulus Value "${this.context.identifier}.${i.name}" - ${t.message}`),t}}}get valueDescriptors(){const{valueDescriptorMap:t}=this;return Object.keys(t).map((e=>t[e]))}get valueDescriptorNameMap(){const t={};return Object.keys(this.valueDescriptorMap).forEach((e=>{const n=this.valueDescriptorMap[e];t[n.name]=n})),t}hasValue(t){const e=`has${Sk(this.valueDescriptorNameMap[t].name)}`;return this.receiver[e]}}class Bk{constructor(t,e){this.context=t,this.delegate=e,this.targetsByName=new Lk}start(){this.tokenListObserver||(this.tokenListObserver=new Pk(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:t,content:e}){this.scope.containsElement(t)&&this.connectTarget(t,e)}tokenUnmatched({element:t,content:e}){this.disconnectTarget(t,e)}connectTarget(t,e){var n;this.targetsByName.has(e,t)||(this.targetsByName.add(e,t),null===(n=this.tokenListObserver)||void 0===n||n.pause((()=>this.delegate.targetConnected(t,e))))}disconnectTarget(t,e){var n;this.targetsByName.has(e,t)&&(this.targetsByName.delete(e,t),null===(n=this.tokenListObserver)||void 0===n||n.pause((()=>this.delegate.targetDisconnected(t,e))))}disconnectAllTargets(){for(const t of this.targetsByName.keys)for(const e of this.targetsByName.getValuesForKey(t))this.disconnectTarget(e,t)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function jk(t,e){const n=zk(t);return Array.from(n.reduce(((t,n)=>(function(t,e){const n=t[e];return Array.isArray(n)?n:[]}(n,e).forEach((e=>t.add(e))),t)),new Set))}function Hk(t,e){return zk(t).reduce(((t,n)=>(t.push(...function(t,e){const n=t[e];return n?Object.keys(n).map((t=>[t,n[t]])):[]}(n,e)),t)),[])}function zk(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}class Vk{constructor(t,e){this.context=t,this.delegate=e,this.outletsByName=new Lk,this.outletElementsByName=new Lk,this.selectorObserverMap=new Map}start(){0===this.selectorObserverMap.size&&(this.outletDefinitions.forEach((t=>{const e=this.selector(t),n={outletName:t};e&&this.selectorObserverMap.set(t,new Nk(document.body,e,this,n))})),this.selectorObserverMap.forEach((t=>t.start()))),this.dependentContexts.forEach((t=>t.refresh()))}stop(){this.selectorObserverMap.size>0&&(this.disconnectAllOutlets(),this.selectorObserverMap.forEach((t=>t.stop())),this.selectorObserverMap.clear())}refresh(){this.selectorObserverMap.forEach((t=>t.refresh()))}selectorMatched(t,e,{outletName:n}){const i=this.getOutlet(t,n);i&&this.connectOutlet(i,t,n)}selectorUnmatched(t,e,{outletName:n}){const i=this.getOutletFromMap(t,n);i&&this.disconnectOutlet(i,t,n)}selectorMatchElement(t,{outletName:e}){return this.hasOutlet(t,e)&&t.matches(`[${this.context.application.schema.controllerAttribute}~=${e}]`)}connectOutlet(t,e,n){var i;this.outletElementsByName.has(n,e)||(this.outletsByName.add(n,t),this.outletElementsByName.add(n,e),null===(i=this.selectorObserverMap.get(n))||void 0===i||i.pause((()=>this.delegate.outletConnected(t,e,n))))}disconnectOutlet(t,e,n){var i;this.outletElementsByName.has(n,e)&&(this.outletsByName.delete(n,t),this.outletElementsByName.delete(n,e),null===(i=this.selectorObserverMap.get(n))||void 0===i||i.pause((()=>this.delegate.outletDisconnected(t,e,n))))}disconnectAllOutlets(){for(const t of this.outletElementsByName.keys)for(const e of this.outletElementsByName.getValuesForKey(t))for(const n of this.outletsByName.getValuesForKey(t))this.disconnectOutlet(n,e,t)}selector(t){return this.scope.outlets.getSelectorForOutletName(t)}get outletDependencies(){const t=new Lk;return this.router.modules.forEach((e=>{jk(e.definition.controllerConstructor,"outlets").forEach((n=>t.add(n,e.identifier)))})),t}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const t=this.dependentControllerIdentifiers;return this.router.contexts.filter((e=>t.includes(e.identifier)))}hasOutlet(t,e){return!!this.getOutlet(t,e)||!!this.getOutletFromMap(t,e)}getOutlet(t,e){return this.application.getControllerForElementAndIdentifier(t,e)}getOutletFromMap(t,e){return this.outletsByName.getValuesForKey(e).find((e=>e.element===t))}get scope(){return this.context.scope}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class qk{constructor(t,e){this.logDebugActivity=(t,e={})=>{const{identifier:n,controller:i,element:r}=this;e=Object.assign({identifier:n,controller:i,element:r},e),this.application.logDebugActivity(this.identifier,t,e)},this.module=t,this.scope=e,this.controller=new t.controllerConstructor(this),this.bindingObserver=new Rk(this,this.dispatcher),this.valueObserver=new Fk(this,this.controller),this.targetObserver=new Bk(this,this),this.outletObserver=new Vk(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(t){this.handleError(t,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(t){this.handleError(t,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(t){this.handleError(t,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(t,e,n={}){const{identifier:i,controller:r,element:s}=this;n=Object.assign({identifier:i,controller:r,element:s},n),this.application.handleError(t,`Error ${e}`,n)}targetConnected(t,e){this.invokeControllerMethod(`${e}TargetConnected`,t)}targetDisconnected(t,e){this.invokeControllerMethod(`${e}TargetDisconnected`,t)}outletConnected(t,e,n){this.invokeControllerMethod(`${kk(n)}OutletConnected`,t,e)}outletDisconnected(t,e,n){this.invokeControllerMethod(`${kk(n)}OutletDisconnected`,t,e)}invokeControllerMethod(t,...e){const n=this.controller;"function"==typeof n[t]&&n[t](...e)}}function Uk(t){return function(t,e){const n=Kk(t),i=function(t,e){return Wk(e).reduce(((n,i)=>{const r=function(t,e,n){const i=Object.getOwnPropertyDescriptor(t,n);if(!i||!("value"in i)){const t=Object.getOwnPropertyDescriptor(e,n).value;return i&&(t.get=i.get||t.get,t.set=i.set||t.set),t}}(t,e,i);return r&&Object.assign(n,{[i]:r}),n}),{})}(t.prototype,e);return Object.defineProperties(n.prototype,i),n}(t,function(t){const e=jk(t,"blessings");return e.reduce(((e,n)=>{const i=n(t);for(const t in i){const n=e[t]||{};e[t]=Object.assign(n,i[t])}return e}),{})}(t))}const Wk="function"==typeof Object.getOwnPropertySymbols?t=>[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)]:Object.getOwnPropertyNames,Kk=(()=>{function t(t){function e(){return Reflect.construct(t,arguments,new.target)}return e.prototype=Object.create(t.prototype,{constructor:{value:e}}),Reflect.setPrototypeOf(e,t),e}try{return function(){const e=t((function(){this.a.call(this)}));e.prototype.a=function(){},new e}(),t}catch(t){return t=>class extends t{}}})();class Yk{constructor(t,e){this.application=t,this.definition=function(t){return{identifier:t.identifier,controllerConstructor:Uk(t.controllerConstructor)}}(e),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(t){const e=this.fetchContextForScope(t);this.connectedContexts.add(e),e.connect()}disconnectContextForScope(t){const e=this.contextsByScope.get(t);e&&(this.connectedContexts.delete(e),e.disconnect())}fetchContextForScope(t){let e=this.contextsByScope.get(t);return e||(e=new qk(this,t),this.contextsByScope.set(t,e)),e}}class Jk{constructor(t){this.scope=t}has(t){return this.data.has(this.getDataKey(t))}get(t){return this.getAll(t)[0]}getAll(t){const e=this.data.get(this.getDataKey(t))||"";return e.match(/[^\s]+/g)||[]}getAttributeName(t){return this.data.getAttributeNameForKey(this.getDataKey(t))}getDataKey(t){return`${t}-class`}get data(){return this.scope.data}}class Gk{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(t){const e=this.getAttributeNameForKey(t);return this.element.getAttribute(e)}set(t,e){const n=this.getAttributeNameForKey(t);return this.element.setAttribute(n,e),this.get(t)}has(t){const e=this.getAttributeNameForKey(t);return this.element.hasAttribute(e)}delete(t){if(this.has(t)){const e=this.getAttributeNameForKey(t);return this.element.removeAttribute(e),!0}return!1}getAttributeNameForKey(t){return`data-${this.identifier}-${xk(t)}`}}class Xk{constructor(t){this.warnedKeysByObject=new WeakMap,this.logger=t}warn(t,e,n){let i=this.warnedKeysByObject.get(t);i||(i=new Set,this.warnedKeysByObject.set(t,i)),i.has(e)||(i.add(e),this.logger.warn(n,t))}}function Qk(t,e){return`[${t}~="${e}"]`}class Zk{constructor(t){this.scope=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return null!=this.find(t)}find(...t){return t.reduce(((t,e)=>t||this.findTarget(e)||this.findLegacyTarget(e)),void 0)}findAll(...t){return t.reduce(((t,e)=>[...t,...this.findAllTargets(e),...this.findAllLegacyTargets(e)]),[])}findTarget(t){const e=this.getSelectorForTargetName(t);return this.scope.findElement(e)}findAllTargets(t){const e=this.getSelectorForTargetName(t);return this.scope.findAllElements(e)}getSelectorForTargetName(t){return Qk(this.schema.targetAttributeForScope(this.identifier),t)}findLegacyTarget(t){const e=this.getLegacySelectorForTargetName(t);return this.deprecate(this.scope.findElement(e),t)}findAllLegacyTargets(t){const e=this.getLegacySelectorForTargetName(t);return this.scope.findAllElements(e).map((e=>this.deprecate(e,t)))}getLegacySelectorForTargetName(t){const e=`${this.identifier}.${t}`;return Qk(this.schema.targetAttribute,e)}deprecate(t,e){if(t){const{identifier:n}=this,i=this.schema.targetAttribute,r=this.schema.targetAttributeForScope(n);this.guide.warn(t,`target:${e}`,`Please replace ${i}="${n}.${e}" with ${r}="${e}". The ${i} attribute is deprecated and will be removed in a future version of Stimulus.`)}return t}get guide(){return this.scope.guide}}class tS{constructor(t,e){this.scope=t,this.controllerElement=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(t){return null!=this.find(t)}find(...t){return t.reduce(((t,e)=>t||this.findOutlet(e)),void 0)}findAll(...t){return t.reduce(((t,e)=>[...t,...this.findAllOutlets(e)]),[])}getSelectorForOutletName(t){const e=this.schema.outletAttributeForScope(this.identifier,t);return this.controllerElement.getAttribute(e)}findOutlet(t){const e=this.getSelectorForOutletName(t);if(e)return this.findElement(e,t)}findAllOutlets(t){const e=this.getSelectorForOutletName(t);return e?this.findAllElements(e,t):[]}findElement(t,e){return this.scope.queryElements(t).filter((n=>this.matchesElement(n,t,e)))[0]}findAllElements(t,e){return this.scope.queryElements(t).filter((n=>this.matchesElement(n,t,e)))}matchesElement(t,e,n){const i=t.getAttribute(this.scope.schema.controllerAttribute)||"";return t.matches(e)&&i.split(" ").includes(n)}}class eS{constructor(t,e,n,i){this.targets=new Zk(this),this.classes=new Jk(this),this.data=new Gk(this),this.containsElement=t=>t.closest(this.controllerSelector)===this.element,this.schema=t,this.element=e,this.identifier=n,this.guide=new Xk(i),this.outlets=new tS(this.documentScope,e)}findElement(t){return this.element.matches(t)?this.element:this.queryElements(t).find(this.containsElement)}findAllElements(t){return[...this.element.matches(t)?[this.element]:[],...this.queryElements(t).filter(this.containsElement)]}queryElements(t){return Array.from(this.element.querySelectorAll(t))}get controllerSelector(){return Qk(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new eS(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class nS{constructor(t,e,n){this.element=t,this.schema=e,this.delegate=n,this.valueListObserver=new $k(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(t){const{element:e,content:n}=t,i=this.fetchScopesByIdentifierForElement(e);let r=i.get(n);return r||(r=this.delegate.createScopeForElementAndIdentifier(e,n),i.set(n,r)),r}elementMatchedValue(t,e){const n=(this.scopeReferenceCounts.get(e)||0)+1;this.scopeReferenceCounts.set(e,n),1==n&&this.delegate.scopeConnected(e)}elementUnmatchedValue(t,e){const n=this.scopeReferenceCounts.get(e);n&&(this.scopeReferenceCounts.set(e,n-1),1==n&&this.delegate.scopeDisconnected(e))}fetchScopesByIdentifierForElement(t){let e=this.scopesByIdentifierByElement.get(t);return e||(e=new Map,this.scopesByIdentifierByElement.set(t,e)),e}}class iS{constructor(t){this.application=t,this.scopeObserver=new nS(this.element,this.schema,this),this.scopesByIdentifier=new Lk,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce(((t,e)=>t.concat(e.contexts)),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(t){this.unloadIdentifier(t.identifier);const e=new Yk(this.application,t);this.connectModule(e);const n=t.controllerConstructor.afterLoad;n&&n(t.identifier,this.application)}unloadIdentifier(t){const e=this.modulesByIdentifier.get(t);e&&this.disconnectModule(e)}getContextForElementAndIdentifier(t,e){const n=this.modulesByIdentifier.get(e);if(n)return n.contexts.find((e=>e.element==t))}handleError(t,e,n){this.application.handleError(t,e,n)}createScopeForElementAndIdentifier(t,e){return new eS(this.schema,t,e,this.logger)}scopeConnected(t){this.scopesByIdentifier.add(t.identifier,t);const e=this.modulesByIdentifier.get(t.identifier);e&&e.connectContextForScope(t)}scopeDisconnected(t){this.scopesByIdentifier.delete(t.identifier,t);const e=this.modulesByIdentifier.get(t.identifier);e&&e.disconnectContextForScope(t)}connectModule(t){this.modulesByIdentifier.set(t.identifier,t);this.scopesByIdentifier.getValuesForKey(t.identifier).forEach((e=>t.connectContextForScope(e)))}disconnectModule(t){this.modulesByIdentifier.delete(t.identifier);this.scopesByIdentifier.getValuesForKey(t.identifier).forEach((e=>t.disconnectContextForScope(e)))}}const rS={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:t=>`data-${t}-target`,outletAttributeForScope:(t,e)=>`data-${t}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End"},sS("abcdefghijklmnopqrstuvwxyz".split("").map((t=>[t,t])))),sS("0123456789".split("").map((t=>[t,t]))))};function sS(t){return t.reduce(((t,[e,n])=>Object.assign(Object.assign({},t),{[e]:n})),{})}function oS([t,e],n){return function(t){const e=`${xk(t.token)}-value`,n=function(t){const e=function(t){const e=aS(t.typeObject.type);if(!e)return;const n=lS(t.typeObject.default);if(e!==n){const i=t.controller?`${t.controller}.${t.token}`:t.token;throw new Error(`The specified default value for the Stimulus Value "${i}" must match the defined type "${e}". The provided default value of "${t.typeObject.default}" is of type "${n}".`)}return e}({controller:t.controller,token:t.token,typeObject:t.typeDefinition}),n=lS(t.typeDefinition),i=aS(t.typeDefinition),r=e||n||i;if(r)return r;const s=t.controller?`${t.controller}.${t.typeDefinition}`:t.token;throw new Error(`Unknown value type "${s}" for "${t.token}" value`)}(t);return{type:n,key:e,name:wk(e),get defaultValue(){return function(t){const e=aS(t);if(e)return cS[e];const n=t.default;return void 0!==n?n:t}(t.typeDefinition)},get hasCustomDefaultValue(){return void 0!==lS(t.typeDefinition)},reader:dS[n],writer:hS[n]||hS.default}}({controller:n,token:t,typeDefinition:e})}function aS(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function lS(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(t)?"array":"[object Object]"===Object.prototype.toString.call(t)?"object":void 0}const cS={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},dS={array(t){const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${t}" of type "${lS(e)}"`);return e},boolean:t=>!("0"==t||"false"==String(t).toLowerCase()),number:t=>Number(t),object(t){const e=JSON.parse(t);if(null===e||"object"!=typeof e||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${t}" of type "${lS(e)}"`);return e},string:t=>t},hS={default:function(t){return`${t}`},array:uS,object:uS};function uS(t){return JSON.stringify(t)}class pS{constructor(t){this.context=t}static get shouldLoad(){return!0}static afterLoad(t,e){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:n={},prefix:i=this.identifier,bubbles:r=!0,cancelable:s=!0}={}){const o=new CustomEvent(i?`${i}:${t}`:t,{detail:n,bubbles:r,cancelable:s});return e.dispatchEvent(o),o}}pS.blessings=[function(t){return jk(t,"classes").reduce(((t,e)=>{return Object.assign(t,{[`${n=e}Class`]:{get(){const{classes:t}=this;if(t.has(n))return t.get(n);{const e=t.getAttributeName(n);throw new Error(`Missing attribute "${e}"`)}}},[`${n}Classes`]:{get(){return this.classes.getAll(n)}},[`has${Sk(n)}Class`]:{get(){return this.classes.has(n)}}});var n}),{})},function(t){return jk(t,"targets").reduce(((t,e)=>{return Object.assign(t,{[`${n=e}Target`]:{get(){const t=this.targets.find(n);if(t)return t;throw new Error(`Missing target element "${n}" for "${this.identifier}" controller`)}},[`${n}Targets`]:{get(){return this.targets.findAll(n)}},[`has${Sk(n)}Target`]:{get(){return this.targets.has(n)}}});var n}),{})},function(t){const e=Hk(t,"values"),n={valueDescriptorMap:{get(){return e.reduce(((t,e)=>{const n=oS(e,this.identifier),i=this.data.getAttributeNameForKey(n.key);return Object.assign(t,{[i]:n})}),{})}}};return e.reduce(((t,e)=>Object.assign(t,function(t,e){const n=oS(t,e),{key:i,name:r,reader:s,writer:o}=n;return{[r]:{get(){const t=this.data.get(i);return null!==t?s(t):n.defaultValue},set(t){void 0===t?this.data.delete(i):this.data.set(i,o(t))}},[`has${Sk(r)}`]:{get(){return this.data.has(i)||n.hasCustomDefaultValue}}}}(e))),n)},function(t){return jk(t,"outlets").reduce(((t,e)=>Object.assign(t,function(t){const e=kk(t);return{[`${e}Outlet`]:{get(){const e=this.outlets.find(t);if(e){const n=this.application.getControllerForElementAndIdentifier(e,t);if(n)return n;throw new Error(`Missing "data-controller=${t}" attribute on outlet element for "${this.identifier}" controller`)}throw new Error(`Missing outlet element "${t}" for "${this.identifier}" controller`)}},[`${e}Outlets`]:{get(){const e=this.outlets.findAll(t);return e.length>0?e.map((e=>{const n=this.application.getControllerForElementAndIdentifier(e,t);if(n)return n;console.warn(`The provided outlet element is missing the outlet controller "${t}" for "${this.identifier}"`,e)})).filter((t=>t)):[]}},[`${e}OutletElement`]:{get(){const e=this.outlets.find(t);if(e)return e;throw new Error(`Missing outlet element "${t}" for "${this.identifier}" controller`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(t)}},[`has${Sk(e)}Outlet`]:{get(){return this.outlets.has(t)}}}}(e))),{})}],pS.targets=[],pS.outlets=[],pS.values={};var fS="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},mS=function(t,e,n,i,r,s,o,a,l,c){var d=this;d.numeralDecimalMark=t||".",d.numeralIntegerScale=e>0?e:0,d.numeralDecimalScale=n>=0?n:2,d.numeralThousandsGroupStyle=i||mS.groupStyle.thousand,d.numeralPositiveOnly=!!r,d.stripLeadingZeroes=!1!==s,d.prefix=o||""===o?o:"",d.signBeforePrefix=!!a,d.tailPrefix=!!l,d.delimiter=c||""===c?c:",",d.delimiterRE=c?new RegExp("\\"+c,"g"):""};mS.groupStyle={thousand:"thousand",lakh:"lakh",wan:"wan",none:"none"},mS.prototype={getRawValue:function(t){return t.replace(this.delimiterRE,"").replace(this.numeralDecimalMark,".")},format:function(t){var e,n,i,r,s=this,o="";switch(t=t.replace(/[A-Za-z]/g,"").replace(s.numeralDecimalMark,"M").replace(/[^\dM-]/g,"").replace(/^\-/,"N").replace(/\-/g,"").replace("N",s.numeralPositiveOnly?"":"-").replace("M",s.numeralDecimalMark),s.stripLeadingZeroes&&(t=t.replace(/^(-)?0+(?=\d)/,"$1")),n="-"===t.slice(0,1)?"-":"",i=void 0!==s.prefix?s.signBeforePrefix?n+s.prefix:s.prefix+n:n,r=t,t.indexOf(s.numeralDecimalMark)>=0&&(r=(e=t.split(s.numeralDecimalMark))[0],o=s.numeralDecimalMark+e[1].slice(0,s.numeralDecimalScale)),"-"===n&&(r=r.slice(1)),s.numeralIntegerScale>0&&(r=r.slice(0,s.numeralIntegerScale)),s.numeralThousandsGroupStyle){case mS.groupStyle.lakh:r=r.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+s.delimiter);break;case mS.groupStyle.wan:r=r.replace(/(\d)(?=(\d{4})+$)/g,"$1"+s.delimiter);break;case mS.groupStyle.thousand:r=r.replace(/(\d)(?=(\d{3})+$)/g,"$1"+s.delimiter)}return s.tailPrefix?n+r.toString()+(s.numeralDecimalScale>0?o.toString():"")+s.prefix:i+r.toString()+(s.numeralDecimalScale>0?o.toString():"")}};var gS=mS,bS=function(t,e,n){var i=this;i.date=[],i.blocks=[],i.datePattern=t,i.dateMin=e.split("-").reverse().map((function(t){return parseInt(t,10)})),2===i.dateMin.length&&i.dateMin.unshift(0),i.dateMax=n.split("-").reverse().map((function(t){return parseInt(t,10)})),2===i.dateMax.length&&i.dateMax.unshift(0),i.initBlocks()};bS.prototype={initBlocks:function(){var t=this;t.datePattern.forEach((function(e){"Y"===e?t.blocks.push(4):t.blocks.push(2)}))},getISOFormatDate:function(){var t=this,e=t.date;return e[2]?e[2]+"-"+t.addLeadingZero(e[1])+"-"+t.addLeadingZero(e[0]):""},getBlocks:function(){return this.blocks},getValidatedDate:function(t){var e=this,n="";return t=t.replace(/[^\d]/g,""),e.blocks.forEach((function(i,r){if(t.length>0){var s=t.slice(0,i),o=s.slice(0,1),a=t.slice(i);switch(e.datePattern[r]){case"d":"00"===s?s="01":parseInt(o,10)>3?s="0"+o:parseInt(s,10)>31&&(s="31");break;case"m":"00"===s?s="01":parseInt(o,10)>1?s="0"+o:parseInt(s,10)>12&&(s="12")}n+=s,t=a}})),this.getFixedDateString(n)},getFixedDateString:function(t){var e,n,i,r=this,s=r.datePattern,o=[],a=0,l=0,c=0,d=0,h=0,u=0,p=!1;return 4===t.length&&"y"!==s[0].toLowerCase()&&"y"!==s[1].toLowerCase()&&(h=2-(d="d"===s[0]?0:2),e=parseInt(t.slice(d,d+2),10),n=parseInt(t.slice(h,h+2),10),o=this.getFixedDate(e,n,0)),8===t.length&&(s.forEach((function(t,e){switch(t){case"d":a=e;break;case"m":l=e;break;default:c=e}})),u=2*c,d=a<=c?2*a:2*a+2,h=l<=c?2*l:2*l+2,e=parseInt(t.slice(d,d+2),10),n=parseInt(t.slice(h,h+2),10),i=parseInt(t.slice(u,u+4),10),p=4===t.slice(u,u+4).length,o=this.getFixedDate(e,n,i)),4!==t.length||"y"!==s[0]&&"y"!==s[1]||(u=2-(h="m"===s[0]?0:2),n=parseInt(t.slice(h,h+2),10),i=parseInt(t.slice(u,u+2),10),p=2===t.slice(u,u+2).length,o=[0,n,i]),6!==t.length||"Y"!==s[0]&&"Y"!==s[1]||(u=2-.5*(h="m"===s[0]?0:4),n=parseInt(t.slice(h,h+2),10),i=parseInt(t.slice(u,u+4),10),p=4===t.slice(u,u+4).length,o=[0,n,i]),o=r.getRangeFixedDate(o),r.date=o,0===o.length?t:s.reduce((function(t,e){switch(e){case"d":return t+(0===o[0]?"":r.addLeadingZero(o[0]));case"m":return t+(0===o[1]?"":r.addLeadingZero(o[1]));case"y":return t+(p?r.addLeadingZeroForYear(o[2],!1):"");case"Y":return t+(p?r.addLeadingZeroForYear(o[2],!0):"")}}),"")},getRangeFixedDate:function(t){var e=this,n=e.datePattern,i=e.dateMin||[],r=e.dateMax||[];return!t.length||i.length<3&&r.length<3||n.find((function(t){return"y"===t.toLowerCase()}))&&0===t[2]?t:r.length&&(r[2]<t[2]||r[2]===t[2]&&(r[1]<t[1]||r[1]===t[1]&&r[0]<t[0]))?r:i.length&&(i[2]>t[2]||i[2]===t[2]&&(i[1]>t[1]||i[1]===t[1]&&i[0]>t[0]))?i:t},getFixedDate:function(t,e,n){return t=Math.min(t,31),e=Math.min(e,12),n=parseInt(n||0,10),(e<7&&e%2==0||e>8&&e%2==1)&&(t=Math.min(t,2===e?this.isLeapYear(n)?29:28:30)),[t,e,n]},isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},addLeadingZero:function(t){return(t<10?"0":"")+t},addLeadingZeroForYear:function(t,e){return e?(t<10?"000":t<100?"00":t<1e3?"0":"")+t:(t<10?"0":"")+t}};var vS=bS,yS=function(t,e){var n=this;n.time=[],n.blocks=[],n.timePattern=t,n.timeFormat=e,n.initBlocks()};yS.prototype={initBlocks:function(){var t=this;t.timePattern.forEach((function(){t.blocks.push(2)}))},getISOFormatTime:function(){var t=this,e=t.time;return e[2]?t.addLeadingZero(e[0])+":"+t.addLeadingZero(e[1])+":"+t.addLeadingZero(e[2]):""},getBlocks:function(){return this.blocks},getTimeFormatOptions:function(){return"12"===String(this.timeFormat)?{maxHourFirstDigit:1,maxHours:12,maxMinutesFirstDigit:5,maxMinutes:60}:{maxHourFirstDigit:2,maxHours:23,maxMinutesFirstDigit:5,maxMinutes:60}},getValidatedTime:function(t){var e=this,n="";t=t.replace(/[^\d]/g,"");var i=e.getTimeFormatOptions();return e.blocks.forEach((function(r,s){if(t.length>0){var o=t.slice(0,r),a=o.slice(0,1),l=t.slice(r);switch(e.timePattern[s]){case"h":parseInt(a,10)>i.maxHourFirstDigit?o="0"+a:parseInt(o,10)>i.maxHours&&(o=i.maxHours+"");break;case"m":case"s":parseInt(a,10)>i.maxMinutesFirstDigit?o="0"+a:parseInt(o,10)>i.maxMinutes&&(o=i.maxMinutes+"")}n+=o,t=l}})),this.getFixedTimeString(n)},getFixedTimeString:function(t){var e,n,i,r=this,s=r.timePattern,o=[],a=0,l=0,c=0,d=0,h=0,u=0;return 6===t.length&&(s.forEach((function(t,e){switch(t){case"s":a=2*e;break;case"m":l=2*e;break;case"h":c=2*e}})),u=c,h=l,d=a,e=parseInt(t.slice(d,d+2),10),n=parseInt(t.slice(h,h+2),10),i=parseInt(t.slice(u,u+2),10),o=this.getFixedTime(i,n,e)),4===t.length&&r.timePattern.indexOf("s")<0&&(s.forEach((function(t,e){switch(t){case"m":l=2*e;break;case"h":c=2*e}})),u=c,h=l,e=0,n=parseInt(t.slice(h,h+2),10),i=parseInt(t.slice(u,u+2),10),o=this.getFixedTime(i,n,e)),r.time=o,0===o.length?t:s.reduce((function(t,e){switch(e){case"s":return t+r.addLeadingZero(o[2]);case"m":return t+r.addLeadingZero(o[1]);case"h":return t+r.addLeadingZero(o[0])}}),"")},getFixedTime:function(t,e,n){return n=Math.min(parseInt(n||0,10),60),e=Math.min(e,60),[t=Math.min(t,60),e,n]},addLeadingZero:function(t){return(t<10?"0":"")+t}};var wS=yS,kS=function(t,e){var n=this;n.delimiter=e||""===e?e:" ",n.delimiterRE=e?new RegExp("\\"+e,"g"):"",n.formatter=t};kS.prototype={setFormatter:function(t){this.formatter=t},format:function(t){var e=this;e.formatter.clear();for(var n,i="",r=!1,s=0,o=(t=(t=(t=t.replace(/[^\d+]/g,"")).replace(/^\+/,"B").replace(/\+/g,"").replace("B","+")).replace(e.delimiterRE,"")).length;s<o;s++)n=e.formatter.inputDigit(t.charAt(s)),/[\s()-]/g.test(n)?(i=n,r=!0):r||(i=n);return i=(i=i.replace(/[()]/g,"")).replace(/[\s-]/g,e.delimiter)}};var SS=kS,xS={blocks:{uatp:[4,5,6],amex:[4,6,5],diners:[4,6,4],discover:[4,4,4,4],mastercard:[4,4,4,4],dankort:[4,4,4,4],instapayment:[4,4,4,4],jcb15:[4,6,5],jcb:[4,4,4,4],maestro:[4,4,4,4],visa:[4,4,4,4],mir:[4,4,4,4],unionPay:[4,4,4,4],general:[4,4,4,4]},re:{uatp:/^(?!1800)1\d{0,14}/,amex:/^3[47]\d{0,13}/,discover:/^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,diners:/^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,mastercard:/^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,dankort:/^(5019|4175|4571)\d{0,12}/,instapayment:/^63[7-9]\d{0,13}/,jcb15:/^(?:2131|1800)\d{0,11}/,jcb:/^(?:35\d{0,2})\d{0,12}/,maestro:/^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,mir:/^220[0-4]\d{0,12}/,visa:/^4\d{0,15}/,unionPay:/^(62|81)\d{0,14}/},getStrictBlocks:function(t){var e=t.reduce((function(t,e){return t+e}),0);return t.concat(19-e)},getInfo:function(t,e){var n=xS.blocks,i=xS.re;for(var r in e=!!e,i)if(i[r].test(t)){var s=n[r];return{type:r,blocks:e?this.getStrictBlocks(s):s}}return{type:"unknown",blocks:e?this.getStrictBlocks(n.general):n.general}}},ES=xS,CS={noop:function(){},strip:function(t,e){return t.replace(e,"")},getPostDelimiter:function(t,e,n){if(0===n.length)return t.slice(-e.length)===e?e:"";var i="";return n.forEach((function(e){t.slice(-e.length)===e&&(i=e)})),i},getDelimiterREByDelimiter:function(t){return new RegExp(t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g")},getNextCursorPosition:function(t,e,n,i,r){return e.length===t?n.length:t+this.getPositionOffset(t,e,n,i,r)},getPositionOffset:function(t,e,n,i,r){var s,o,a;return s=this.stripDelimiters(e.slice(0,t),i,r),o=this.stripDelimiters(n.slice(0,t),i,r),0!==(a=s.length-o.length)?a/Math.abs(a):0},stripDelimiters:function(t,e,n){var i=this;if(0===n.length){var r=e?i.getDelimiterREByDelimiter(e):"";return t.replace(r,"")}return n.forEach((function(e){e.split("").forEach((function(e){t=t.replace(i.getDelimiterREByDelimiter(e),"")}))})),t},headStr:function(t,e){return t.slice(0,e)},getMaxLength:function(t){return t.reduce((function(t,e){return t+e}),0)},getPrefixStrippedValue:function(t,e,n,i,r,s,o,a,l){if(0===n)return t;if(t===e&&""!==t)return"";if(l&&"-"==t.slice(0,1)){var c="-"==i.slice(0,1)?i.slice(1):i;return"-"+this.getPrefixStrippedValue(t.slice(1),e,n,c,r,s,o,a,l)}if(i.slice(0,n)!==e&&!a)return o&&!i&&t?t:"";if(i.slice(-n)!==e&&a)return o&&!i&&t?t:"";var d=this.stripDelimiters(i,r,s);return t.slice(0,n)===e||a?t.slice(-n)!==e&&a?d.slice(0,-n-1):a?t.slice(0,-n):t.slice(n):d.slice(n)},getFirstDiffIndex:function(t,e){for(var n=0;t.charAt(n)===e.charAt(n);)if(""===t.charAt(n++))return-1;return n},getFormattedValue:function(t,e,n,i,r,s){var o="",a=r.length>0,l="";return 0===n?t:(e.forEach((function(e,c){if(t.length>0){var d=t.slice(0,e),h=t.slice(e);l=a?r[s?c-1:c]||l:i,s?(c>0&&(o+=l),o+=d):(o+=d,d.length===e&&c<n-1&&(o+=l)),t=h}})),o)},fixPrefixCursor:function(t,e,n,i){if(t){var r=t.value,s=n||i[0]||" ";if(t.setSelectionRange&&e&&!(e.length+s.length<=r.length)){var o=2*r.length;setTimeout((function(){t.setSelectionRange(o,o)}),1)}}},checkFullSelection:function(t){try{return(window.getSelection()||document.getSelection()||{}).toString().length===t.length}catch(t){}return!1},setSelection:function(t,e,n){if(t===this.getActiveElement(n)&&!(t&&t.value.length<=e))if(t.createTextRange){var i=t.createTextRange();i.move("character",e),i.select()}else try{t.setSelectionRange(e,e)}catch(t){console.warn("The input element type does not support selection")}},getActiveElement:function(t){var e=t.activeElement;return e&&e.shadowRoot?this.getActiveElement(e.shadowRoot):e},isAndroid:function(){return navigator&&/android/i.test(navigator.userAgent)},isAndroidBackspaceKeydown:function(t,e){return!!(this.isAndroid()&&t&&e)&&e===t.slice(0,-1)}},_S=CS,AS={assign:function(t,e){return e=e||{},(t=t||{}).creditCard=!!e.creditCard,t.creditCardStrictMode=!!e.creditCardStrictMode,t.creditCardType="",t.onCreditCardTypeChanged=e.onCreditCardTypeChanged||function(){},t.phone=!!e.phone,t.phoneRegionCode=e.phoneRegionCode||"AU",t.phoneFormatter={},t.time=!!e.time,t.timePattern=e.timePattern||["h","m","s"],t.timeFormat=e.timeFormat||"24",t.timeFormatter={},t.date=!!e.date,t.datePattern=e.datePattern||["d","m","Y"],t.dateMin=e.dateMin||"",t.dateMax=e.dateMax||"",t.dateFormatter={},t.numeral=!!e.numeral,t.numeralIntegerScale=e.numeralIntegerScale>0?e.numeralIntegerScale:0,t.numeralDecimalScale=e.numeralDecimalScale>=0?e.numeralDecimalScale:2,t.numeralDecimalMark=e.numeralDecimalMark||".",t.numeralThousandsGroupStyle=e.numeralThousandsGroupStyle||"thousand",t.numeralPositiveOnly=!!e.numeralPositiveOnly,t.stripLeadingZeroes=!1!==e.stripLeadingZeroes,t.signBeforePrefix=!!e.signBeforePrefix,t.tailPrefix=!!e.tailPrefix,t.swapHiddenInput=!!e.swapHiddenInput,t.numericOnly=t.creditCard||t.date||!!e.numericOnly,t.uppercase=!!e.uppercase,t.lowercase=!!e.lowercase,t.prefix=t.creditCard||t.date?"":e.prefix||"",t.noImmediatePrefix=!!e.noImmediatePrefix,t.prefixLength=t.prefix.length,t.rawValueTrimPrefix=!!e.rawValueTrimPrefix,t.copyDelimiter=!!e.copyDelimiter,t.initValue=void 0!==e.initValue&&null!==e.initValue?e.initValue.toString():"",t.delimiter=e.delimiter||""===e.delimiter?e.delimiter:e.date?"/":e.time?":":e.numeral?",":(e.phone," "),t.delimiterLength=t.delimiter.length,t.delimiterLazyShow=!!e.delimiterLazyShow,t.delimiters=e.delimiters||[],t.blocks=e.blocks||[],t.blocksLength=t.blocks.length,t.root="object"==typeof fS&&fS?fS:window,t.document=e.document||t.root.document,t.maxLength=0,t.backspace=!1,t.result="",t.onValueChanged=e.onValueChanged||function(){},t}},OS=function(t,e){var n=this,i=!1;if("string"==typeof t?(n.element=document.querySelector(t),i=document.querySelectorAll(t).length>1):void 0!==t.length&&t.length>0?(n.element=t[0],i=t.length>1):n.element=t,!n.element)throw new Error("[cleave.js] Please check the element");if(i)try{console.warn("[cleave.js] Multiple input fields matched, cleave.js will only take the first one.")}catch(t){}e.initValue=n.element.value,n.properties=OS.DefaultProperties.assign({},e),n.init()};OS.prototype={init:function(){var t=this,e=t.properties;e.numeral||e.phone||e.creditCard||e.time||e.date||0!==e.blocksLength||e.prefix?(e.maxLength=OS.Util.getMaxLength(e.blocks),t.isAndroid=OS.Util.isAndroid(),t.lastInputValue="",t.isBackward="",t.onChangeListener=t.onChange.bind(t),t.onKeyDownListener=t.onKeyDown.bind(t),t.onFocusListener=t.onFocus.bind(t),t.onCutListener=t.onCut.bind(t),t.onCopyListener=t.onCopy.bind(t),t.initSwapHiddenInput(),t.element.addEventListener("input",t.onChangeListener),t.element.addEventListener("keydown",t.onKeyDownListener),t.element.addEventListener("focus",t.onFocusListener),t.element.addEventListener("cut",t.onCutListener),t.element.addEventListener("copy",t.onCopyListener),t.initPhoneFormatter(),t.initDateFormatter(),t.initTimeFormatter(),t.initNumeralFormatter(),(e.initValue||e.prefix&&!e.noImmediatePrefix)&&t.onInput(e.initValue)):t.onInput(e.initValue)},initSwapHiddenInput:function(){var t=this;if(t.properties.swapHiddenInput){var e=t.element.cloneNode(!0);t.element.parentNode.insertBefore(e,t.element),t.elementSwapHidden=t.element,t.elementSwapHidden.type="hidden",t.element=e,t.element.id=""}},initNumeralFormatter:function(){var t=this.properties;t.numeral&&(t.numeralFormatter=new OS.NumeralFormatter(t.numeralDecimalMark,t.numeralIntegerScale,t.numeralDecimalScale,t.numeralThousandsGroupStyle,t.numeralPositiveOnly,t.stripLeadingZeroes,t.prefix,t.signBeforePrefix,t.tailPrefix,t.delimiter))},initTimeFormatter:function(){var t=this.properties;t.time&&(t.timeFormatter=new OS.TimeFormatter(t.timePattern,t.timeFormat),t.blocks=t.timeFormatter.getBlocks(),t.blocksLength=t.blocks.length,t.maxLength=OS.Util.getMaxLength(t.blocks))},initDateFormatter:function(){var t=this.properties;t.date&&(t.dateFormatter=new OS.DateFormatter(t.datePattern,t.dateMin,t.dateMax),t.blocks=t.dateFormatter.getBlocks(),t.blocksLength=t.blocks.length,t.maxLength=OS.Util.getMaxLength(t.blocks))},initPhoneFormatter:function(){var t=this.properties;if(t.phone)try{t.phoneFormatter=new OS.PhoneFormatter(new t.root.Cleave.AsYouTypeFormatter(t.phoneRegionCode),t.delimiter)}catch(t){throw new Error("[cleave.js] Please include phone-type-formatter.{country}.js lib")}},onKeyDown:function(t){var e=this,n=t.which||t.keyCode;e.lastInputValue=e.element.value,e.isBackward=8===n},onChange:function(t){var e=this,n=e.properties,i=OS.Util;e.isBackward=e.isBackward||"deleteContentBackward"===t.inputType;var r=i.getPostDelimiter(e.lastInputValue,n.delimiter,n.delimiters);e.isBackward&&r?n.postDelimiterBackspace=r:n.postDelimiterBackspace=!1,this.onInput(this.element.value)},onFocus:function(){var t=this,e=t.properties;t.lastInputValue=t.element.value,e.prefix&&e.noImmediatePrefix&&!t.element.value&&this.onInput(e.prefix),OS.Util.fixPrefixCursor(t.element,e.prefix,e.delimiter,e.delimiters)},onCut:function(t){OS.Util.checkFullSelection(this.element.value)&&(this.copyClipboardData(t),this.onInput(""))},onCopy:function(t){OS.Util.checkFullSelection(this.element.value)&&this.copyClipboardData(t)},copyClipboardData:function(t){var e=this.properties,n=OS.Util,i=this.element.value,r="";r=e.copyDelimiter?i:n.stripDelimiters(i,e.delimiter,e.delimiters);try{t.clipboardData?t.clipboardData.setData("Text",r):window.clipboardData.setData("Text",r),t.preventDefault()}catch(t){}},onInput:function(t){var e=this,n=e.properties,i=OS.Util,r=i.getPostDelimiter(t,n.delimiter,n.delimiters);return n.numeral||!n.postDelimiterBackspace||r||(t=i.headStr(t,t.length-n.postDelimiterBackspace.length)),n.phone?(!n.prefix||n.noImmediatePrefix&&!t.length?n.result=n.phoneFormatter.format(t):n.result=n.prefix+n.phoneFormatter.format(t).slice(n.prefix.length),void e.updateValueState()):n.numeral?(n.prefix&&n.noImmediatePrefix&&0===t.length?n.result="":n.result=n.numeralFormatter.format(t),void e.updateValueState()):(n.date&&(t=n.dateFormatter.getValidatedDate(t)),n.time&&(t=n.timeFormatter.getValidatedTime(t)),t=i.stripDelimiters(t,n.delimiter,n.delimiters),t=i.getPrefixStrippedValue(t,n.prefix,n.prefixLength,n.result,n.delimiter,n.delimiters,n.noImmediatePrefix,n.tailPrefix,n.signBeforePrefix),t=n.numericOnly?i.strip(t,/[^\d]/g):t,t=n.uppercase?t.toUpperCase():t,t=n.lowercase?t.toLowerCase():t,n.prefix&&(n.tailPrefix?t+=n.prefix:t=n.prefix+t,0===n.blocksLength)?(n.result=t,void e.updateValueState()):(n.creditCard&&e.updateCreditCardPropsByValue(t),t=i.headStr(t,n.maxLength),n.result=i.getFormattedValue(t,n.blocks,n.blocksLength,n.delimiter,n.delimiters,n.delimiterLazyShow),void e.updateValueState()))},updateCreditCardPropsByValue:function(t){var e,n=this.properties,i=OS.Util;i.headStr(n.result,4)!==i.headStr(t,4)&&(e=OS.CreditCardDetector.getInfo(t,n.creditCardStrictMode),n.blocks=e.blocks,n.blocksLength=n.blocks.length,n.maxLength=i.getMaxLength(n.blocks),n.creditCardType!==e.type&&(n.creditCardType=e.type,n.onCreditCardTypeChanged.call(this,n.creditCardType)))},updateValueState:function(){var t=this,e=OS.Util,n=t.properties;if(t.element){var i=t.element.selectionEnd,r=t.element.value,s=n.result;i=e.getNextCursorPosition(i,r,s,n.delimiter,n.delimiters),t.isAndroid?window.setTimeout((function(){t.element.value=s,e.setSelection(t.element,i,n.document,!1),t.callOnValueChanged()}),1):(t.element.value=s,n.swapHiddenInput&&(t.elementSwapHidden.value=t.getRawValue()),e.setSelection(t.element,i,n.document,!1),t.callOnValueChanged())}},callOnValueChanged:function(){var t=this,e=t.properties;e.onValueChanged.call(t,{target:{name:t.element.name,value:e.result,rawValue:t.getRawValue()}})},setPhoneRegionCode:function(t){var e=this;e.properties.phoneRegionCode=t,e.initPhoneFormatter(),e.onChange()},setRawValue:function(t){var e=this,n=e.properties;t=null!=t?t.toString():"",n.numeral&&(t=t.replace(".",n.numeralDecimalMark)),n.postDelimiterBackspace=!1,e.element.value=t,e.onInput(t)},getRawValue:function(){var t=this.properties,e=OS.Util,n=this.element.value;return t.rawValueTrimPrefix&&(n=e.getPrefixStrippedValue(n,t.prefix,t.prefixLength,t.result,t.delimiter,t.delimiters,t.noImmediatePrefix,t.tailPrefix,t.signBeforePrefix)),n=t.numeral?t.numeralFormatter.getRawValue(n):e.stripDelimiters(n,t.delimiter,t.delimiters)},getISOFormatDate:function(){var t=this.properties;return t.date?t.dateFormatter.getISOFormatDate():""},getISOFormatTime:function(){var t=this.properties;return t.time?t.timeFormatter.getISOFormatTime():""},getFormattedValue:function(){return this.element.value},destroy:function(){var t=this;t.element.removeEventListener("input",t.onChangeListener),t.element.removeEventListener("keydown",t.onKeyDownListener),t.element.removeEventListener("focus",t.onFocusListener),t.element.removeEventListener("cut",t.onCutListener),t.element.removeEventListener("copy",t.onCopyListener)},toString:function(){return"[Cleave Object]"}},OS.NumeralFormatter=gS,OS.DateFormatter=vS,OS.TimeFormatter=wS,OS.PhoneFormatter=SS,OS.CreditCardDetector=ES,OS.Util=_S,OS.DefaultProperties=AS,("object"==typeof fS&&fS?fS:window).Cleave=OS;var TS=OS;function MS(t){document.querySelector("body").insertAdjacentHTML("beforeend",`<div class="toast-container position-fixed bottom-0 start-50 translate-middle-x p-5">\n    <div class="toast align-items-center border-0 py-2 text-bg-dark animate__animated animate__faster animate__fadeInUp"\n         role="alert"\n         aria-live="assertive"\n         data-bs-animation="false"\n         aria-atomic="true"\n         data-controller="toast">\n      <div class="d-flex">\n        <div class="toast-body">\n          ${t}\n        </div>\n        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n      </div>\n    </div>\n  </div>`)}const DS=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],LS={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:t=>"undefined"!=typeof console&&console.warn(t),getWeek:t=>{const e=new Date(t.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var n=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},NS={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:t=>{const e=t%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},IS=(t,e=2)=>`000${t}`.slice(-1*e),PS=t=>!0===t?1:0;function $S(t,e){let n;return function(){clearTimeout(n),n=setTimeout((()=>t.apply(this,arguments)),e)}}const RS=t=>t instanceof Array?t:[t];function FS(t,e,n){if(!0===n)return t.classList.add(e);t.classList.remove(e)}function BS(t,e,n){const i=window.document.createElement(t);return e=e||"",n=n||"",i.className=e,void 0!==n&&(i.textContent=n),i}function jS(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function HS(t,e){return e(t)?t:t.parentNode?HS(t.parentNode,e):void 0}function zS(t,e){const n=BS("div","numInputWrapper"),i=BS("input","numInput "+t),r=BS("span","arrowUp"),s=BS("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?i.type="number":(i.type="text",i.pattern="\\d*"),void 0!==e)for(const t in e)i.setAttribute(t,e[t]);return n.appendChild(i),n.appendChild(r),n.appendChild(s),n}function VS(t){try{if("function"==typeof t.composedPath){return t.composedPath()[0]}return t.target}catch(e){return t.target}}const qS=()=>{},US=(t,e,n)=>n.months[e?"shorthand":"longhand"][t],WS={D:qS,F:function(t,e,n){t.setMonth(n.months.longhand.indexOf(e))},G:(t,e)=>{t.setHours(parseFloat(e))},H:(t,e)=>{t.setHours(parseFloat(e))},J:(t,e)=>{t.setDate(parseFloat(e))},K:(t,e,n)=>{t.setHours(t.getHours()%12+12*PS(new RegExp(n.amPM[1],"i").test(e)))},M:function(t,e,n){t.setMonth(n.months.shorthand.indexOf(e))},S:(t,e)=>{t.setSeconds(parseFloat(e))},U:(t,e)=>new Date(1e3*parseFloat(e)),W:function(t,e,n){const i=parseInt(e),r=new Date(t.getFullYear(),0,2+7*(i-1),0,0,0,0);return r.setDate(r.getDate()-r.getDay()+n.firstDayOfWeek),r},Y:(t,e)=>{t.setFullYear(parseFloat(e))},Z:(t,e)=>new Date(e),d:(t,e)=>{t.setDate(parseFloat(e))},h:(t,e)=>{t.setHours(parseFloat(e))},i:(t,e)=>{t.setMinutes(parseFloat(e))},j:(t,e)=>{t.setDate(parseFloat(e))},l:qS,m:(t,e)=>{t.setMonth(parseFloat(e)-1)},n:(t,e)=>{t.setMonth(parseFloat(e)-1)},s:(t,e)=>{t.setSeconds(parseFloat(e))},u:(t,e)=>new Date(parseFloat(e)),w:qS,y:(t,e)=>{t.setFullYear(2e3+parseFloat(e))}},KS={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},YS={Z:t=>t.toISOString(),D:function(t,e,n){return e.weekdays.shorthand[YS.w(t,e,n)]},F:function(t,e,n){return US(YS.n(t,e,n)-1,!1,e)},G:function(t,e,n){return IS(YS.h(t,e,n))},H:t=>IS(t.getHours()),J:function(t,e){return void 0!==e.ordinal?t.getDate()+e.ordinal(t.getDate()):t.getDate()},K:(t,e)=>e.amPM[PS(t.getHours()>11)],M:function(t,e){return US(t.getMonth(),!0,e)},S:t=>IS(t.getSeconds()),U:t=>t.getTime()/1e3,W:function(t,e,n){return n.getWeek(t)},Y:t=>IS(t.getFullYear(),4),d:t=>IS(t.getDate()),h:t=>t.getHours()%12?t.getHours()%12:12,i:t=>IS(t.getMinutes()),j:t=>t.getDate(),l:function(t,e){return e.weekdays.longhand[t.getDay()]},m:t=>IS(t.getMonth()+1),n:t=>t.getMonth()+1,s:t=>t.getSeconds(),u:t=>t.getTime(),w:t=>t.getDay(),y:t=>String(t.getFullYear()).substring(2)},JS=({config:t=LS,l10n:e=NS,isMobile:n=!1})=>(i,r,s)=>{const o=s||e;return void 0===t.formatDate||n?r.split("").map(((e,n,r)=>YS[e]&&"\\"!==r[n-1]?YS[e](i,o,t):"\\"!==e?e:"")).join(""):t.formatDate(i,r,o)},GS=({config:t=LS,l10n:e=NS})=>(n,i,r,s)=>{if(0!==n&&!n)return;const o=s||e;let a;const l=n;if(n instanceof Date)a=new Date(n.getTime());else if("string"!=typeof n&&void 0!==n.toFixed)a=new Date(n);else if("string"==typeof n){const e=i||(t||LS).dateFormat,s=String(n).trim();if("today"===s)a=new Date,r=!0;else if(/Z$/.test(s)||/GMT$/.test(s))a=new Date(n);else if(t&&t.parseDate)a=t.parseDate(n,e);else{a=t&&t.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);let i,r=[];for(let t=0,s=0,l="";t<e.length;t++){const c=e[t],d="\\"===c,h="\\"===e[t-1]||d;if(KS[c]&&!h){l+=KS[c];const t=new RegExp(l).exec(n);t&&(i=!0)&&r["Y"!==c?"push":"unshift"]({fn:WS[c],val:t[++s]})}else d||(l+=".");r.forEach((({fn:t,val:e})=>a=t(a,e,o)||a))}a=i?a:void 0}}if(a instanceof Date&&!isNaN(a.getTime()))return!0===r&&a.setHours(0,0,0,0),a;t.errorHandler(new Error(`Invalid date provided: ${l}`))};function XS(t,e,n=!0){return!1!==n?new Date(t.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):t.getTime()-e.getTime()}const QS=(t,e,n)=>t>Math.min(e,n)&&t<Math.max(e,n),ZS={DAY:864e5};function tx(t){let e=t.defaultHour,n=t.defaultMinute,i=t.defaultSeconds;if(void 0!==t.minDate){const r=t.minDate.getHours(),s=t.minDate.getMinutes(),o=t.minDate.getSeconds();e<r&&(e=r),e===r&&n<s&&(n=s),e===r&&n===s&&i<o&&(i=t.minDate.getSeconds())}if(void 0!==t.maxDate){const r=t.maxDate.getHours(),s=t.maxDate.getMinutes();e=Math.min(e,r),e===r&&(n=Math.min(s,n)),e===r&&n===s&&(i=t.maxDate.getSeconds())}return{hours:e,minutes:n,seconds:i}}"function"!=typeof Object.assign&&(Object.assign=function(t,...e){if(!t)throw TypeError("Cannot convert undefined or null to object");for(const n of e)n&&Object.keys(n).forEach((e=>t[e]=n[e]));return t});const ex=300;function nx(t,e){const n={config:Object.assign(Object.assign({},LS),rx.defaultConfig),l10n:NS};function i(t){return t.bind(n)}function r(){const t=n.config;!1===t.weekNumbers&&1===t.showMonths||!0!==t.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==n.calendarContainer&&(n.calendarContainer.style.visibility="hidden",n.calendarContainer.style.display="block"),void 0!==n.daysContainer){const e=(n.days.offsetWidth+1)*t.showMonths;n.daysContainer.style.width=e+"px",n.calendarContainer.style.width=e+(void 0!==n.weekWrapper?n.weekWrapper.offsetWidth:0)+"px",n.calendarContainer.style.removeProperty("visibility"),n.calendarContainer.style.removeProperty("display")}}))}function s(t){if(0===n.selectedDates.length){const t=void 0===n.config.minDate||XS(new Date,n.config.minDate)>=0?new Date:new Date(n.config.minDate.getTime()),e=tx(n.config);t.setHours(e.hours,e.minutes,e.seconds,t.getMilliseconds()),n.selectedDates=[t],n.latestSelectedDateObj=t}void 0!==t&&"blur"!==t.type&&function(t){t.preventDefault();const e="keydown"===t.type,i=VS(t),r=i;void 0!==n.amPM&&i===n.amPM&&(n.amPM.textContent=n.l10n.amPM[PS(n.amPM.textContent===n.l10n.amPM[0])]);const s=parseFloat(r.getAttribute("min")),o=parseFloat(r.getAttribute("max")),a=parseFloat(r.getAttribute("step")),l=parseInt(r.value,10),c=t.delta||(e?38===t.which?1:-1:0);let d=l+a*c;if(void 0!==r.value&&2===r.value.length){const t=r===n.hourElement,e=r===n.minuteElement;d<s?(d=o+d+PS(!t)+(PS(t)&&PS(!n.amPM)),e&&f(void 0,-1,n.hourElement)):d>o&&(d=r===n.hourElement?d-o-PS(!n.amPM):s,e&&f(void 0,1,n.hourElement)),n.amPM&&t&&(1===a?d+l===23:Math.abs(d-l)>a)&&(n.amPM.textContent=n.l10n.amPM[PS(n.amPM.textContent===n.l10n.amPM[0])]),r.value=IS(d)}}(t);const e=n._input.value;o(),X(),n._input.value!==e&&n._debouncedChange()}function o(){if(void 0===n.hourElement||void 0===n.minuteElement)return;let t=(parseInt(n.hourElement.value.slice(-2),10)||0)%24,e=(parseInt(n.minuteElement.value,10)||0)%60,i=void 0!==n.secondElement?(parseInt(n.secondElement.value,10)||0)%60:0;var r,s;void 0!==n.amPM&&(r=t,s=n.amPM.textContent,t=r%12+12*PS(s===n.l10n.amPM[1]));const o=void 0!==n.config.minTime||n.config.minDate&&n.minDateHasTime&&n.latestSelectedDateObj&&0===XS(n.latestSelectedDateObj,n.config.minDate,!0);if(void 0!==n.config.maxTime||n.config.maxDate&&n.maxDateHasTime&&n.latestSelectedDateObj&&0===XS(n.latestSelectedDateObj,n.config.maxDate,!0)){const r=void 0!==n.config.maxTime?n.config.maxTime:n.config.maxDate;t=Math.min(t,r.getHours()),t===r.getHours()&&(e=Math.min(e,r.getMinutes())),e===r.getMinutes()&&(i=Math.min(i,r.getSeconds()))}if(o){const r=void 0!==n.config.minTime?n.config.minTime:n.config.minDate;t=Math.max(t,r.getHours()),t===r.getHours()&&e<r.getMinutes()&&(e=r.getMinutes()),e===r.getMinutes()&&(i=Math.max(i,r.getSeconds()))}l(t,e,i)}function a(t){const e=t||n.latestSelectedDateObj;e&&l(e.getHours(),e.getMinutes(),e.getSeconds())}function l(t,e,i){void 0!==n.latestSelectedDateObj&&n.latestSelectedDateObj.setHours(t%24,e,i||0,0),n.hourElement&&n.minuteElement&&!n.isMobile&&(n.hourElement.value=IS(n.config.time_24hr?t:(12+t)%12+12*PS(t%12==0)),n.minuteElement.value=IS(e),void 0!==n.amPM&&(n.amPM.textContent=n.l10n.amPM[PS(t>=12)]),void 0!==n.secondElement&&(n.secondElement.value=IS(i)))}function c(t){const e=VS(t),n=parseInt(e.value)+(t.delta||0);(n/1e3>1||"Enter"===t.key&&!/[^\d]/.test(n.toString()))&&T(n)}function d(t,e,i,r){return e instanceof Array?e.forEach((e=>d(t,e,i,r))):t instanceof Array?t.forEach((t=>d(t,e,i,r))):(t.addEventListener(e,i,r),void n._handlers.push({remove:()=>t.removeEventListener(e,i)}))}function h(){W("onChange")}function u(t,e){const i=void 0!==t?n.parseDate(t):n.latestSelectedDateObj||(n.config.minDate&&n.config.minDate>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate<n.now?n.config.maxDate:n.now),r=n.currentYear,s=n.currentMonth;try{void 0!==i&&(n.currentYear=i.getFullYear(),n.currentMonth=i.getMonth())}catch(t){t.message="Invalid date supplied: "+i,n.config.errorHandler(t)}e&&n.currentYear!==r&&(W("onYearChange"),k()),!e||n.currentYear===r&&n.currentMonth===s||W("onMonthChange"),n.redraw()}function p(t){const e=VS(t);~e.className.indexOf("arrow")&&f(t,e.classList.contains("arrowUp")?1:-1)}function f(t,e,n){const i=t&&VS(t),r=n||i&&i.parentNode&&i.parentNode.firstChild,s=K("increment");s.delta=e,r&&r.dispatchEvent(s)}function m(t,e,i,r){const s=M(e,!0),o=BS("span","flatpickr-day "+t,e.getDate().toString());return o.dateObj=e,o.$i=r,o.setAttribute("aria-label",n.formatDate(e,n.config.ariaDateFormat)),-1===t.indexOf("hidden")&&0===XS(e,n.now)&&(n.todayDateElem=o,o.classList.add("today"),o.setAttribute("aria-current","date")),s?(o.tabIndex=-1,Y(e)&&(o.classList.add("selected"),n.selectedDateElem=o,"range"===n.config.mode&&(FS(o,"startRange",n.selectedDates[0]&&0===XS(e,n.selectedDates[0],!0)),FS(o,"endRange",n.selectedDates[1]&&0===XS(e,n.selectedDates[1],!0)),"nextMonthDay"===t&&o.classList.add("inRange")))):o.classList.add("flatpickr-disabled"),"range"===n.config.mode&&function(t){return!("range"!==n.config.mode||n.selectedDates.length<2)&&(XS(t,n.selectedDates[0])>=0&&XS(t,n.selectedDates[1])<=0)}(e)&&!Y(e)&&o.classList.add("inRange"),n.weekNumbers&&1===n.config.showMonths&&"prevMonthDay"!==t&&i%7==1&&n.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+n.config.getWeek(e)+"</span>"),W("onDayCreate",o),o}function g(t){t.focus(),"range"===n.config.mode&&I(t)}function b(t){const e=t>0?0:n.config.showMonths-1,i=t>0?n.config.showMonths:-1;for(let r=e;r!=i;r+=t){const e=n.daysContainer.children[r],i=t>0?0:e.children.length-1,s=t>0?e.children.length:-1;for(let n=i;n!=s;n+=t){const t=e.children[n];if(-1===t.className.indexOf("hidden")&&M(t.dateObj))return t}}}function v(t,e){const i=D(document.activeElement||document.body),r=void 0!==t?t:i?document.activeElement:void 0!==n.selectedDateElem&&D(n.selectedDateElem)?n.selectedDateElem:void 0!==n.todayDateElem&&D(n.todayDateElem)?n.todayDateElem:b(e>0?1:-1);void 0===r?n._input.focus():i?function(t,e){const i=-1===t.className.indexOf("Month")?t.dateObj.getMonth():n.currentMonth,r=e>0?n.config.showMonths:-1,s=e>0?1:-1;for(let o=i-n.currentMonth;o!=r;o+=s){const r=n.daysContainer.children[o],a=i-n.currentMonth===o?t.$i+e:e<0?r.children.length-1:0,l=r.children.length;for(let n=a;n>=0&&n<l&&n!=(e>0?l:-1);n+=s){const i=r.children[n];if(-1===i.className.indexOf("hidden")&&M(i.dateObj)&&Math.abs(t.$i-n)>=Math.abs(e))return g(i)}}n.changeMonth(s),v(b(s),0)}(r,e):g(r)}function y(t,e){const i=(new Date(t,e,1).getDay()-n.l10n.firstDayOfWeek+7)%7,r=n.utils.getDaysInMonth((e-1+12)%12,t),s=n.utils.getDaysInMonth(e,t),o=window.document.createDocumentFragment(),a=n.config.showMonths>1,l=a?"prevMonthDay hidden":"prevMonthDay",c=a?"nextMonthDay hidden":"nextMonthDay";let d=r+1-i,h=0;for(;d<=r;d++,h++)o.appendChild(m(l,new Date(t,e-1,d),d,h));for(d=1;d<=s;d++,h++)o.appendChild(m("",new Date(t,e,d),d,h));for(let r=s+1;r<=42-i&&(1===n.config.showMonths||h%7!=0);r++,h++)o.appendChild(m(c,new Date(t,e+1,r%s),r,h));const u=BS("div","dayContainer");return u.appendChild(o),u}function w(){if(void 0===n.daysContainer)return;jS(n.daysContainer),n.weekNumbers&&jS(n.weekNumbers);const t=document.createDocumentFragment();for(let e=0;e<n.config.showMonths;e++){const i=new Date(n.currentYear,n.currentMonth,1);i.setMonth(n.currentMonth+e),t.appendChild(y(i.getFullYear(),i.getMonth()))}n.daysContainer.appendChild(t),n.days=n.daysContainer.firstChild,"range"===n.config.mode&&1===n.selectedDates.length&&I()}function k(){if(n.config.showMonths>1||"dropdown"!==n.config.monthSelectorType)return;const t=function(t){return!(void 0!==n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&t<n.config.minDate.getMonth())&&!(void 0!==n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()&&t>n.config.maxDate.getMonth())};n.monthsDropdownContainer.tabIndex=-1,n.monthsDropdownContainer.innerHTML="";for(let e=0;e<12;e++){if(!t(e))continue;const i=BS("option","flatpickr-monthDropdown-month");i.value=new Date(n.currentYear,e).getMonth().toString(),i.textContent=US(e,n.config.shorthandCurrentMonth,n.l10n),i.tabIndex=-1,n.currentMonth===e&&(i.selected=!0),n.monthsDropdownContainer.appendChild(i)}}function S(){const t=BS("div","flatpickr-month"),e=window.document.createDocumentFragment();let i;n.config.showMonths>1||"static"===n.config.monthSelectorType?i=BS("span","cur-month"):(n.monthsDropdownContainer=BS("select","flatpickr-monthDropdown-months"),n.monthsDropdownContainer.setAttribute("aria-label",n.l10n.monthAriaLabel),d(n.monthsDropdownContainer,"change",(t=>{const e=VS(t),i=parseInt(e.value,10);n.changeMonth(i-n.currentMonth),W("onMonthChange")})),k(),i=n.monthsDropdownContainer);const r=zS("cur-year",{tabindex:"-1"}),s=r.getElementsByTagName("input")[0];s.setAttribute("aria-label",n.l10n.yearAriaLabel),n.config.minDate&&s.setAttribute("min",n.config.minDate.getFullYear().toString()),n.config.maxDate&&(s.setAttribute("max",n.config.maxDate.getFullYear().toString()),s.disabled=!!n.config.minDate&&n.config.minDate.getFullYear()===n.config.maxDate.getFullYear());const o=BS("div","flatpickr-current-month");return o.appendChild(i),o.appendChild(r),e.appendChild(o),t.appendChild(e),{container:t,yearElement:s,monthElement:i}}function x(){jS(n.monthNav),n.monthNav.appendChild(n.prevMonthNav),n.config.showMonths&&(n.yearElements=[],n.monthElements=[]);for(let t=n.config.showMonths;t--;){const t=S();n.yearElements.push(t.yearElement),n.monthElements.push(t.monthElement),n.monthNav.appendChild(t.container)}n.monthNav.appendChild(n.nextMonthNav)}function E(){n.weekdayContainer?jS(n.weekdayContainer):n.weekdayContainer=BS("div","flatpickr-weekdays");for(let t=n.config.showMonths;t--;){const t=BS("div","flatpickr-weekdaycontainer");n.weekdayContainer.appendChild(t)}return C(),n.weekdayContainer}function C(){if(!n.weekdayContainer)return;const t=n.l10n.firstDayOfWeek;let e=[...n.l10n.weekdays.shorthand];t>0&&t<e.length&&(e=[...e.splice(t,e.length),...e.splice(0,t)]);for(let t=n.config.showMonths;t--;)n.weekdayContainer.children[t].innerHTML=`\n      <span class='flatpickr-weekday'>\n        ${e.join("</span><span class='flatpickr-weekday'>")}\n      </span>\n      `}function _(t,e=!0){const i=e?t:t-n.currentMonth;i<0&&!0===n._hidePrevMonthArrow||i>0&&!0===n._hideNextMonthArrow||(n.currentMonth+=i,(n.currentMonth<0||n.currentMonth>11)&&(n.currentYear+=n.currentMonth>11?1:-1,n.currentMonth=(n.currentMonth+12)%12,W("onYearChange"),k()),w(),W("onMonthChange"),J())}function A(t){return!(!n.config.appendTo||!n.config.appendTo.contains(t))||n.calendarContainer.contains(t)}function O(t){if(n.isOpen&&!n.config.inline){const e=VS(t),i=A(e),r=e===n.input||e===n.altInput||n.element.contains(e)||t.path&&t.path.indexOf&&(~t.path.indexOf(n.input)||~t.path.indexOf(n.altInput)),o="blur"===t.type?r&&t.relatedTarget&&!A(t.relatedTarget):!r&&!i&&!A(t.relatedTarget),a=!n.config.ignoredFocusElements.some((t=>t.contains(e)));o&&a&&(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement&&""!==n.input.value&&void 0!==n.input.value&&s(),n.close(),n.config&&"range"===n.config.mode&&1===n.selectedDates.length&&(n.clear(!1),n.redraw()))}}function T(t){if(!t||n.config.minDate&&t<n.config.minDate.getFullYear()||n.config.maxDate&&t>n.config.maxDate.getFullYear())return;const e=t,i=n.currentYear!==e;n.currentYear=e||n.currentYear,n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth=Math.min(n.config.maxDate.getMonth(),n.currentMonth):n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&(n.currentMonth=Math.max(n.config.minDate.getMonth(),n.currentMonth)),i&&(n.redraw(),W("onYearChange"),k())}function M(t,e=!0){var i;const r=n.parseDate(t,void 0,e);if(n.config.minDate&&r&&XS(r,n.config.minDate,void 0!==e?e:!n.minDateHasTime)<0||n.config.maxDate&&r&&XS(r,n.config.maxDate,void 0!==e?e:!n.maxDateHasTime)>0)return!1;if(!n.config.enable&&0===n.config.disable.length)return!0;if(void 0===r)return!1;const s=!!n.config.enable,o=null!==(i=n.config.enable)&&void 0!==i?i:n.config.disable;for(let t,e=0;e<o.length;e++){if(t=o[e],"function"==typeof t&&t(r))return s;if(t instanceof Date&&void 0!==r&&t.getTime()===r.getTime())return s;if("string"==typeof t){const e=n.parseDate(t,void 0,!0);return e&&e.getTime()===r.getTime()?s:!s}if("object"==typeof t&&void 0!==r&&t.from&&t.to&&r.getTime()>=t.from.getTime()&&r.getTime()<=t.to.getTime())return s}return!s}function D(t){return void 0!==n.daysContainer&&(-1===t.className.indexOf("hidden")&&-1===t.className.indexOf("flatpickr-disabled")&&n.daysContainer.contains(t))}function L(t){!(t.target===n._input)||!(n.selectedDates.length>0||n._input.value.length>0)||t.relatedTarget&&A(t.relatedTarget)||n.setDate(n._input.value,!0,t.target===n.altInput?n.config.altFormat:n.config.dateFormat)}function N(e){const i=VS(e),r=n.config.wrap?t.contains(i):i===n._input,a=n.config.allowInput,l=n.isOpen&&(!a||!r),c=n.config.inline&&r&&!a;if(13===e.keyCode&&r){if(a)return n.setDate(n._input.value,!0,i===n.altInput?n.config.altFormat:n.config.dateFormat),i.blur();n.open()}else if(A(i)||l||c){const t=!!n.timeContainer&&n.timeContainer.contains(i);switch(e.keyCode){case 13:t?(e.preventDefault(),s(),H()):z(e);break;case 27:e.preventDefault(),H();break;case 8:case 46:r&&!n.config.allowInput&&(e.preventDefault(),n.clear());break;case 37:case 39:if(t||r)n.hourElement&&n.hourElement.focus();else if(e.preventDefault(),void 0!==n.daysContainer&&(!1===a||document.activeElement&&D(document.activeElement))){const t=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),_(t),v(b(1),0)):v(void 0,t)}break;case 38:case 40:e.preventDefault();const o=40===e.keyCode?1:-1;n.daysContainer&&void 0!==i.$i||i===n.input||i===n.altInput?e.ctrlKey?(e.stopPropagation(),T(n.currentYear-o),v(b(1),0)):t||v(void 0,7*o):i===n.currentYearElement?T(n.currentYear-o):n.config.enableTime&&(!t&&n.hourElement&&n.hourElement.focus(),s(e),n._debouncedChange());break;case 9:if(t){const t=[n.hourElement,n.minuteElement,n.secondElement,n.amPM].concat(n.pluginElements).filter((t=>t)),r=t.indexOf(i);if(-1!==r){const i=t[r+(e.shiftKey?-1:1)];e.preventDefault(),(i||n._input).focus()}}else!n.config.noCalendar&&n.daysContainer&&n.daysContainer.contains(i)&&e.shiftKey&&(e.preventDefault(),n._input.focus())}}if(void 0!==n.amPM&&i===n.amPM)switch(e.key){case n.l10n.amPM[0].charAt(0):case n.l10n.amPM[0].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[0],o(),X();break;case n.l10n.amPM[1].charAt(0):case n.l10n.amPM[1].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[1],o(),X()}(r||A(i))&&W("onKeyDown",e)}function I(t){if(1!==n.selectedDates.length||t&&(!t.classList.contains("flatpickr-day")||t.classList.contains("flatpickr-disabled")))return;const e=t?t.dateObj.getTime():n.days.firstElementChild.dateObj.getTime(),i=n.parseDate(n.selectedDates[0],void 0,!0).getTime(),r=Math.min(e,n.selectedDates[0].getTime()),s=Math.max(e,n.selectedDates[0].getTime());let o=!1,a=0,l=0;for(let t=r;t<s;t+=ZS.DAY)M(new Date(t),!0)||(o=o||t>r&&t<s,t<i&&(!a||t>a)?a=t:t>i&&(!l||t<l)&&(l=t));for(let r=0;r<n.config.showMonths;r++){const s=n.daysContainer.children[r];for(let r=0,c=s.children.length;r<c;r++){const c=s.children[r],d=c.dateObj.getTime(),h=a>0&&d<a||l>0&&d>l;h?(c.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((t=>{c.classList.remove(t)}))):o&&!h||(["startRange","inRange","endRange","notAllowed"].forEach((t=>{c.classList.remove(t)})),void 0!==t&&(t.classList.add(e<=n.selectedDates[0].getTime()?"startRange":"endRange"),i<e&&d===i?c.classList.add("startRange"):i>e&&d===i&&c.classList.add("endRange"),d>=a&&(0===l||d<=l)&&QS(d,i,e)&&c.classList.add("inRange")))}}}function P(){!n.isOpen||n.config.static||n.config.inline||B()}function $(t){return e=>{const i=n.config[`_${t}Date`]=n.parseDate(e,n.config.dateFormat),r=n.config[`_${"min"===t?"max":"min"}Date`];void 0!==i&&(n["min"===t?"minDateHasTime":"maxDateHasTime"]=i.getHours()>0||i.getMinutes()>0||i.getSeconds()>0),n.selectedDates&&(n.selectedDates=n.selectedDates.filter((t=>M(t))),n.selectedDates.length||"min"!==t||a(i),X()),n.daysContainer&&(j(),void 0!==i?n.currentYearElement[t]=i.getFullYear().toString():n.currentYearElement.removeAttribute(t),n.currentYearElement.disabled=!!r&&void 0!==i&&r.getFullYear()===i.getFullYear())}}function R(){return n.config.wrap?t.querySelector("[data-input]"):t}function F(){"object"!=typeof n.config.locale&&void 0===rx.l10ns[n.config.locale]&&n.config.errorHandler(new Error(`flatpickr: invalid locale ${n.config.locale}`)),n.l10n=Object.assign(Object.assign({},rx.l10ns.default),"object"==typeof n.config.locale?n.config.locale:"default"!==n.config.locale?rx.l10ns[n.config.locale]:void 0),KS.K=`(${n.l10n.amPM[0]}|${n.l10n.amPM[1]}|${n.l10n.amPM[0].toLowerCase()}|${n.l10n.amPM[1].toLowerCase()})`;void 0===Object.assign(Object.assign({},e),JSON.parse(JSON.stringify(t.dataset||{}))).time_24hr&&void 0===rx.defaultConfig.time_24hr&&(n.config.time_24hr=n.l10n.time_24hr),n.formatDate=JS(n),n.parseDate=GS({config:n.config,l10n:n.l10n})}function B(t){if("function"==typeof n.config.position)return void n.config.position(n,t);if(void 0===n.calendarContainer)return;W("onPreCalendarPosition");const e=t||n._positionElement,i=Array.prototype.reduce.call(n.calendarContainer.children,((t,e)=>t+e.offsetHeight),0),r=n.calendarContainer.offsetWidth,s=n.config.position.split(" "),o=s[0],a=s.length>1?s[1]:null,l=e.getBoundingClientRect(),c=window.innerHeight-l.bottom,d="above"===o||"below"!==o&&c<i&&l.top>i,h=window.pageYOffset+l.top+(d?-i-2:e.offsetHeight+2);if(FS(n.calendarContainer,"arrowTop",!d),FS(n.calendarContainer,"arrowBottom",d),n.config.inline)return;let u=window.pageXOffset+l.left,p=!1,f=!1;"center"===a?(u-=(r-l.width)/2,p=!0):"right"===a&&(u-=r-l.width,f=!0),FS(n.calendarContainer,"arrowLeft",!p&&!f),FS(n.calendarContainer,"arrowCenter",p),FS(n.calendarContainer,"arrowRight",f);const m=window.document.body.offsetWidth-(window.pageXOffset+l.right),g=u+r>window.document.body.offsetWidth,b=m+r>window.document.body.offsetWidth;if(FS(n.calendarContainer,"rightMost",g),!n.config.static)if(n.calendarContainer.style.top=`${h}px`,g)if(b){const t=function(){let t=null;for(let e=0;e<document.styleSheets.length;e++){const n=document.styleSheets[e];try{n.cssRules}catch(t){continue}t=n;break}return null!=t?t:function(){const t=document.createElement("style");return document.head.appendChild(t),t.sheet}()}();if(void 0===t)return;const e=window.document.body.offsetWidth,i=Math.max(0,e/2-r/2),s=".flatpickr-calendar.centerMost:before",o=".flatpickr-calendar.centerMost:after",a=t.cssRules.length,c=`{left:${l.left}px;right:auto;}`;FS(n.calendarContainer,"rightMost",!1),FS(n.calendarContainer,"centerMost",!0),t.insertRule(`${s},${o}${c}`,a),n.calendarContainer.style.left=`${i}px`,n.calendarContainer.style.right="auto"}else n.calendarContainer.style.left="auto",n.calendarContainer.style.right=`${m}px`;else n.calendarContainer.style.left=`${u}px`,n.calendarContainer.style.right="auto"}function j(){n.config.noCalendar||n.isMobile||(k(),J(),w())}function H(){n._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(n.close,0):n.close()}function z(t){t.preventDefault(),t.stopPropagation();const e=HS(VS(t),(t=>t.classList&&t.classList.contains("flatpickr-day")&&!t.classList.contains("flatpickr-disabled")&&!t.classList.contains("notAllowed")));if(void 0===e)return;const i=e,r=n.latestSelectedDateObj=new Date(i.dateObj.getTime()),s=(r.getMonth()<n.currentMonth||r.getMonth()>n.currentMonth+n.config.showMonths-1)&&"range"!==n.config.mode;if(n.selectedDateElem=i,"single"===n.config.mode)n.selectedDates=[r];else if("multiple"===n.config.mode){const t=Y(r);t?n.selectedDates.splice(parseInt(t),1):n.selectedDates.push(r)}else"range"===n.config.mode&&(2===n.selectedDates.length&&n.clear(!1,!1),n.latestSelectedDateObj=r,n.selectedDates.push(r),0!==XS(r,n.selectedDates[0],!0)&&n.selectedDates.sort(((t,e)=>t.getTime()-e.getTime())));if(o(),s){const t=n.currentYear!==r.getFullYear();n.currentYear=r.getFullYear(),n.currentMonth=r.getMonth(),t&&(W("onYearChange"),k()),W("onMonthChange")}if(J(),w(),X(),s||"range"===n.config.mode||1!==n.config.showMonths?void 0!==n.selectedDateElem&&void 0===n.hourElement&&n.selectedDateElem&&n.selectedDateElem.focus():g(i),void 0!==n.hourElement&&void 0!==n.hourElement&&n.hourElement.focus(),n.config.closeOnSelect){const t="single"===n.config.mode&&!n.config.enableTime,e="range"===n.config.mode&&2===n.selectedDates.length&&!n.config.enableTime;(t||e)&&H()}h()}n.parseDate=GS({config:n.config,l10n:n.l10n}),n._handlers=[],n.pluginElements=[],n.loadedPlugins=[],n._bind=d,n._setHoursFromDate=a,n._positionCalendar=B,n.changeMonth=_,n.changeYear=T,n.clear=function(t=!0,e=!0){n.input.value="",void 0!==n.altInput&&(n.altInput.value="");void 0!==n.mobileInput&&(n.mobileInput.value="");n.selectedDates=[],n.latestSelectedDateObj=void 0,!0===e&&(n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth());if(!0===n.config.enableTime){const{hours:t,minutes:e,seconds:i}=tx(n.config);l(t,e,i)}n.redraw(),t&&W("onChange")},n.close=function(){n.isOpen=!1,n.isMobile||(void 0!==n.calendarContainer&&n.calendarContainer.classList.remove("open"),void 0!==n._input&&n._input.classList.remove("active"));W("onClose")},n._createElement=BS,n.destroy=function(){void 0!==n.config&&W("onDestroy");for(let t=n._handlers.length;t--;)n._handlers[t].remove();if(n._handlers=[],n.mobileInput)n.mobileInput.parentNode&&n.mobileInput.parentNode.removeChild(n.mobileInput),n.mobileInput=void 0;else if(n.calendarContainer&&n.calendarContainer.parentNode)if(n.config.static&&n.calendarContainer.parentNode){const t=n.calendarContainer.parentNode;if(t.lastChild&&t.removeChild(t.lastChild),t.parentNode){for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t)}}else n.calendarContainer.parentNode.removeChild(n.calendarContainer);n.altInput&&(n.input.type="text",n.altInput.parentNode&&n.altInput.parentNode.removeChild(n.altInput),delete n.altInput);n.input&&(n.input.type=n.input._type,n.input.classList.remove("flatpickr-input"),n.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((t=>{try{delete n[t]}catch(t){}}))},n.isEnabled=M,n.jumpToDate=u,n.open=function(t,e=n._positionElement){if(!0===n.isMobile){if(t){t.preventDefault();const e=VS(t);e&&e.blur()}return void 0!==n.mobileInput&&(n.mobileInput.focus(),n.mobileInput.click()),void W("onOpen")}if(n._input.disabled||n.config.inline)return;const i=n.isOpen;n.isOpen=!0,i||(n.calendarContainer.classList.add("open"),n._input.classList.add("active"),W("onOpen"),B(e));!0===n.config.enableTime&&!0===n.config.noCalendar&&(!1!==n.config.allowInput||void 0!==t&&n.timeContainer.contains(t.relatedTarget)||setTimeout((()=>n.hourElement.select()),50))},n.redraw=j,n.set=function(t,e){if(null!==t&&"object"==typeof t){Object.assign(n.config,t);for(const e in t)void 0!==V[e]&&V[e].forEach((t=>t()))}else n.config[t]=e,void 0!==V[t]?V[t].forEach((t=>t())):DS.indexOf(t)>-1&&(n.config[t]=RS(e));n.redraw(),X(!0)},n.setDate=function(t,e=!1,i=n.config.dateFormat){if(0!==t&&!t||t instanceof Array&&0===t.length)return n.clear(e);q(t,i),n.latestSelectedDateObj=n.selectedDates[n.selectedDates.length-1],n.redraw(),u(void 0,e),a(),0===n.selectedDates.length&&n.clear(!1);X(e),e&&W("onChange")},n.toggle=function(t){if(!0===n.isOpen)return n.close();n.open(t)};const V={locale:[F,C],showMonths:[x,r,E],minDate:[u],maxDate:[u],clickOpens:[()=>{!0===n.config.clickOpens?(d(n._input,"focus",n.open),d(n._input,"click",n.open)):(n._input.removeEventListener("focus",n.open),n._input.removeEventListener("click",n.open))}]};function q(t,e){let i=[];if(t instanceof Array)i=t.map((t=>n.parseDate(t,e)));else if(t instanceof Date||"number"==typeof t)i=[n.parseDate(t,e)];else if("string"==typeof t)switch(n.config.mode){case"single":case"time":i=[n.parseDate(t,e)];break;case"multiple":i=t.split(n.config.conjunction).map((t=>n.parseDate(t,e)));break;case"range":i=t.split(n.l10n.rangeSeparator).map((t=>n.parseDate(t,e)))}else n.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(t)}`));n.selectedDates=n.config.allowInvalidPreload?i:i.filter((t=>t instanceof Date&&M(t,!1))),"range"===n.config.mode&&n.selectedDates.sort(((t,e)=>t.getTime()-e.getTime()))}function U(t){return t.slice().map((t=>"string"==typeof t||"number"==typeof t||t instanceof Date?n.parseDate(t,void 0,!0):t&&"object"==typeof t&&t.from&&t.to?{from:n.parseDate(t.from,void 0),to:n.parseDate(t.to,void 0)}:t)).filter((t=>t))}function W(t,e){if(void 0===n.config)return;const i=n.config[t];if(void 0!==i&&i.length>0)for(let t=0;i[t]&&t<i.length;t++)i[t](n.selectedDates,n.input.value,n,e);"onChange"===t&&(n.input.dispatchEvent(K("change")),n.input.dispatchEvent(K("input")))}function K(t){const e=document.createEvent("Event");return e.initEvent(t,!0,!0),e}function Y(t){for(let e=0;e<n.selectedDates.length;e++)if(0===XS(n.selectedDates[e],t))return""+e;return!1}function J(){n.config.noCalendar||n.isMobile||!n.monthNav||(n.yearElements.forEach(((t,e)=>{const i=new Date(n.currentYear,n.currentMonth,1);i.setMonth(n.currentMonth+e),n.config.showMonths>1||"static"===n.config.monthSelectorType?n.monthElements[e].textContent=US(i.getMonth(),n.config.shorthandCurrentMonth,n.l10n)+" ":n.monthsDropdownContainer.value=i.getMonth().toString(),t.value=i.getFullYear().toString()})),n._hidePrevMonthArrow=void 0!==n.config.minDate&&(n.currentYear===n.config.minDate.getFullYear()?n.currentMonth<=n.config.minDate.getMonth():n.currentYear<n.config.minDate.getFullYear()),n._hideNextMonthArrow=void 0!==n.config.maxDate&&(n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth+1>n.config.maxDate.getMonth():n.currentYear>n.config.maxDate.getFullYear()))}function G(t){return n.selectedDates.map((e=>n.formatDate(e,t))).filter(((t,e,i)=>"range"!==n.config.mode||n.config.enableTime||i.indexOf(t)===e)).join("range"!==n.config.mode?n.config.conjunction:n.l10n.rangeSeparator)}function X(t=!0){void 0!==n.mobileInput&&n.mobileFormatStr&&(n.mobileInput.value=void 0!==n.latestSelectedDateObj?n.formatDate(n.latestSelectedDateObj,n.mobileFormatStr):""),n.input.value=G(n.config.dateFormat),void 0!==n.altInput&&(n.altInput.value=G(n.config.altFormat)),!1!==t&&W("onValueUpdate")}function Q(t){const e=VS(t),i=n.prevMonthNav.contains(e),r=n.nextMonthNav.contains(e);i||r?_(i?-1:1):n.yearElements.indexOf(e)>=0?e.select():e.classList.contains("arrowUp")?n.changeYear(n.currentYear+1):e.classList.contains("arrowDown")&&n.changeYear(n.currentYear-1)}return function(){n.element=n.input=t,n.isOpen=!1,function(){const r=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],s=Object.assign(Object.assign({},JSON.parse(JSON.stringify(t.dataset||{}))),e),o={};n.config.parseDate=s.parseDate,n.config.formatDate=s.formatDate,Object.defineProperty(n.config,"enable",{get:()=>n.config._enable,set:t=>{n.config._enable=U(t)}}),Object.defineProperty(n.config,"disable",{get:()=>n.config._disable,set:t=>{n.config._disable=U(t)}});const a="time"===s.mode;if(!s.dateFormat&&(s.enableTime||a)){const t=rx.defaultConfig.dateFormat||LS.dateFormat;o.dateFormat=s.noCalendar||a?"H:i"+(s.enableSeconds?":S":""):t+" H:i"+(s.enableSeconds?":S":"")}if(s.altInput&&(s.enableTime||a)&&!s.altFormat){const t=rx.defaultConfig.altFormat||LS.altFormat;o.altFormat=s.noCalendar||a?"h:i"+(s.enableSeconds?":S K":" K"):t+` h:i${s.enableSeconds?":S":""} K`}Object.defineProperty(n.config,"minDate",{get:()=>n.config._minDate,set:$("min")}),Object.defineProperty(n.config,"maxDate",{get:()=>n.config._maxDate,set:$("max")});const l=t=>e=>{n.config["min"===t?"_minTime":"_maxTime"]=n.parseDate(e,"H:i:S")};Object.defineProperty(n.config,"minTime",{get:()=>n.config._minTime,set:l("min")}),Object.defineProperty(n.config,"maxTime",{get:()=>n.config._maxTime,set:l("max")}),"time"===s.mode&&(n.config.noCalendar=!0,n.config.enableTime=!0);Object.assign(n.config,o,s);for(let t=0;t<r.length;t++)n.config[r[t]]=!0===n.config[r[t]]||"true"===n.config[r[t]];DS.filter((t=>void 0!==n.config[t])).forEach((t=>{n.config[t]=RS(n.config[t]||[]).map(i)})),n.isMobile=!n.config.disableMobile&&!n.config.inline&&"single"===n.config.mode&&!n.config.disable.length&&!n.config.enable&&!n.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let t=0;t<n.config.plugins.length;t++){const e=n.config.plugins[t](n)||{};for(const t in e)DS.indexOf(t)>-1?n.config[t]=RS(e[t]).map(i).concat(n.config[t]):void 0===s[t]&&(n.config[t]=e[t])}s.altInputClass||(n.config.altInputClass=R().className+" "+n.config.altInputClass);W("onParseConfig")}(),F(),function(){if(n.input=R(),!n.input)return void n.config.errorHandler(new Error("Invalid input element specified"));n.input._type=n.input.type,n.input.type="text",n.input.classList.add("flatpickr-input"),n._input=n.input,n.config.altInput&&(n.altInput=BS(n.input.nodeName,n.config.altInputClass),n._input=n.altInput,n.altInput.placeholder=n.input.placeholder,n.altInput.disabled=n.input.disabled,n.altInput.required=n.input.required,n.altInput.tabIndex=n.input.tabIndex,n.altInput.type="text",n.input.setAttribute("type","hidden"),!n.config.static&&n.input.parentNode&&n.input.parentNode.insertBefore(n.altInput,n.input.nextSibling));n.config.allowInput||n._input.setAttribute("readonly","readonly");n._positionElement=n.config.positionElement||n._input}(),function(){n.selectedDates=[],n.now=n.parseDate(n.config.now)||new Date;const t=n.config.defaultDate||("INPUT"!==n.input.nodeName&&"TEXTAREA"!==n.input.nodeName||!n.input.placeholder||n.input.value!==n.input.placeholder?n.input.value:null);t&&q(t,n.config.dateFormat);n._initialDate=n.selectedDates.length>0?n.selectedDates[0]:n.config.minDate&&n.config.minDate.getTime()>n.now.getTime()?n.config.minDate:n.config.maxDate&&n.config.maxDate.getTime()<n.now.getTime()?n.config.maxDate:n.now,n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth(),n.selectedDates.length>0&&(n.latestSelectedDateObj=n.selectedDates[0]);void 0!==n.config.minTime&&(n.config.minTime=n.parseDate(n.config.minTime,"H:i"));void 0!==n.config.maxTime&&(n.config.maxTime=n.parseDate(n.config.maxTime,"H:i"));n.minDateHasTime=!!n.config.minDate&&(n.config.minDate.getHours()>0||n.config.minDate.getMinutes()>0||n.config.minDate.getSeconds()>0),n.maxDateHasTime=!!n.config.maxDate&&(n.config.maxDate.getHours()>0||n.config.maxDate.getMinutes()>0||n.config.maxDate.getSeconds()>0)}(),n.utils={getDaysInMonth:(t=n.currentMonth,e=n.currentYear)=>1===t&&(e%4==0&&e%100!=0||e%400==0)?29:n.l10n.daysInMonth[t]},n.isMobile||function(){const t=window.document.createDocumentFragment();if(n.calendarContainer=BS("div","flatpickr-calendar"),n.calendarContainer.tabIndex=-1,!n.config.noCalendar){if(t.appendChild((n.monthNav=BS("div","flatpickr-months"),n.yearElements=[],n.monthElements=[],n.prevMonthNav=BS("span","flatpickr-prev-month"),n.prevMonthNav.innerHTML=n.config.prevArrow,n.nextMonthNav=BS("span","flatpickr-next-month"),n.nextMonthNav.innerHTML=n.config.nextArrow,x(),Object.defineProperty(n,"_hidePrevMonthArrow",{get:()=>n.__hidePrevMonthArrow,set(t){n.__hidePrevMonthArrow!==t&&(FS(n.prevMonthNav,"flatpickr-disabled",t),n.__hidePrevMonthArrow=t)}}),Object.defineProperty(n,"_hideNextMonthArrow",{get:()=>n.__hideNextMonthArrow,set(t){n.__hideNextMonthArrow!==t&&(FS(n.nextMonthNav,"flatpickr-disabled",t),n.__hideNextMonthArrow=t)}}),n.currentYearElement=n.yearElements[0],J(),n.monthNav)),n.innerContainer=BS("div","flatpickr-innerContainer"),n.config.weekNumbers){const{weekWrapper:t,weekNumbers:e}=function(){n.calendarContainer.classList.add("hasWeeks");const t=BS("div","flatpickr-weekwrapper");t.appendChild(BS("span","flatpickr-weekday",n.l10n.weekAbbreviation));const e=BS("div","flatpickr-weeks");return t.appendChild(e),{weekWrapper:t,weekNumbers:e}}();n.innerContainer.appendChild(t),n.weekNumbers=e,n.weekWrapper=t}n.rContainer=BS("div","flatpickr-rContainer"),n.rContainer.appendChild(E()),n.daysContainer||(n.daysContainer=BS("div","flatpickr-days"),n.daysContainer.tabIndex=-1),w(),n.rContainer.appendChild(n.daysContainer),n.innerContainer.appendChild(n.rContainer),t.appendChild(n.innerContainer)}n.config.enableTime&&t.appendChild(function(){n.calendarContainer.classList.add("hasTime"),n.config.noCalendar&&n.calendarContainer.classList.add("noCalendar");const t=tx(n.config);n.timeContainer=BS("div","flatpickr-time"),n.timeContainer.tabIndex=-1;const e=BS("span","flatpickr-time-separator",":"),i=zS("flatpickr-hour",{"aria-label":n.l10n.hourAriaLabel});n.hourElement=i.getElementsByTagName("input")[0];const r=zS("flatpickr-minute",{"aria-label":n.l10n.minuteAriaLabel});n.minuteElement=r.getElementsByTagName("input")[0],n.hourElement.tabIndex=n.minuteElement.tabIndex=-1,n.hourElement.value=IS(n.latestSelectedDateObj?n.latestSelectedDateObj.getHours():n.config.time_24hr?t.hours:function(t){switch(t%24){case 0:case 12:return 12;default:return t%12}}(t.hours)),n.minuteElement.value=IS(n.latestSelectedDateObj?n.latestSelectedDateObj.getMinutes():t.minutes),n.hourElement.setAttribute("step",n.config.hourIncrement.toString()),n.minuteElement.setAttribute("step",n.config.minuteIncrement.toString()),n.hourElement.setAttribute("min",n.config.time_24hr?"0":"1"),n.hourElement.setAttribute("max",n.config.time_24hr?"23":"12"),n.hourElement.setAttribute("maxlength","2"),n.minuteElement.setAttribute("min","0"),n.minuteElement.setAttribute("max","59"),n.minuteElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(i),n.timeContainer.appendChild(e),n.timeContainer.appendChild(r),n.config.time_24hr&&n.timeContainer.classList.add("time24hr");if(n.config.enableSeconds){n.timeContainer.classList.add("hasSeconds");const e=zS("flatpickr-second");n.secondElement=e.getElementsByTagName("input")[0],n.secondElement.value=IS(n.latestSelectedDateObj?n.latestSelectedDateObj.getSeconds():t.seconds),n.secondElement.setAttribute("step",n.minuteElement.getAttribute("step")),n.secondElement.setAttribute("min","0"),n.secondElement.setAttribute("max","59"),n.secondElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(BS("span","flatpickr-time-separator",":")),n.timeContainer.appendChild(e)}n.config.time_24hr||(n.amPM=BS("span","flatpickr-am-pm",n.l10n.amPM[PS((n.latestSelectedDateObj?n.hourElement.value:n.config.defaultHour)>11)]),n.amPM.title=n.l10n.toggleTitle,n.amPM.tabIndex=-1,n.timeContainer.appendChild(n.amPM));return n.timeContainer}());FS(n.calendarContainer,"rangeMode","range"===n.config.mode),FS(n.calendarContainer,"animate",!0===n.config.animate),FS(n.calendarContainer,"multiMonth",n.config.showMonths>1),n.calendarContainer.appendChild(t);const e=void 0!==n.config.appendTo&&void 0!==n.config.appendTo.nodeType;if((n.config.inline||n.config.static)&&(n.calendarContainer.classList.add(n.config.inline?"inline":"static"),n.config.inline&&(!e&&n.element.parentNode?n.element.parentNode.insertBefore(n.calendarContainer,n._input.nextSibling):void 0!==n.config.appendTo&&n.config.appendTo.appendChild(n.calendarContainer)),n.config.static)){const t=BS("div","flatpickr-wrapper");n.element.parentNode&&n.element.parentNode.insertBefore(t,n.element),t.appendChild(n.element),n.altInput&&t.appendChild(n.altInput),t.appendChild(n.calendarContainer)}n.config.static||n.config.inline||(void 0!==n.config.appendTo?n.config.appendTo:window.document.body).appendChild(n.calendarContainer)}(),function(){n.config.wrap&&["open","close","toggle","clear"].forEach((t=>{Array.prototype.forEach.call(n.element.querySelectorAll(`[data-${t}]`),(e=>d(e,"click",n[t])))}));if(n.isMobile)return void function(){const t=n.config.enableTime?n.config.noCalendar?"time":"datetime-local":"date";n.mobileInput=BS("input",n.input.className+" flatpickr-mobile"),n.mobileInput.tabIndex=1,n.mobileInput.type=t,n.mobileInput.disabled=n.input.disabled,n.mobileInput.required=n.input.required,n.mobileInput.placeholder=n.input.placeholder,n.mobileFormatStr="datetime-local"===t?"Y-m-d\\TH:i:S":"date"===t?"Y-m-d":"H:i:S",n.selectedDates.length>0&&(n.mobileInput.defaultValue=n.mobileInput.value=n.formatDate(n.selectedDates[0],n.mobileFormatStr));n.config.minDate&&(n.mobileInput.min=n.formatDate(n.config.minDate,"Y-m-d"));n.config.maxDate&&(n.mobileInput.max=n.formatDate(n.config.maxDate,"Y-m-d"));n.input.getAttribute("step")&&(n.mobileInput.step=String(n.input.getAttribute("step")));n.input.type="hidden",void 0!==n.altInput&&(n.altInput.type="hidden");try{n.input.parentNode&&n.input.parentNode.insertBefore(n.mobileInput,n.input.nextSibling)}catch(t){}d(n.mobileInput,"change",(t=>{n.setDate(VS(t).value,!1,n.mobileFormatStr),W("onChange"),W("onClose")}))}();const t=$S(P,50);n._debouncedChange=$S(h,ex),n.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&d(n.daysContainer,"mouseover",(t=>{"range"===n.config.mode&&I(VS(t))}));d(window.document.body,"keydown",N),n.config.inline||n.config.static||d(window,"resize",t);void 0!==window.ontouchstart?d(window.document,"touchstart",O):d(window.document,"mousedown",O);d(window.document,"focus",O,{capture:!0}),!0===n.config.clickOpens&&(d(n._input,"focus",n.open),d(n._input,"click",n.open));void 0!==n.daysContainer&&(d(n.monthNav,"click",Q),d(n.monthNav,["keyup","increment"],c),d(n.daysContainer,"click",z));if(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement){const t=t=>VS(t).select();d(n.timeContainer,["increment"],s),d(n.timeContainer,"blur",s,{capture:!0}),d(n.timeContainer,"click",p),d([n.hourElement,n.minuteElement],["focus","click"],t),void 0!==n.secondElement&&d(n.secondElement,"focus",(()=>n.secondElement&&n.secondElement.select())),void 0!==n.amPM&&d(n.amPM,"click",(t=>{s(t),h()}))}n.config.allowInput&&d(n._input,"blur",L)}(),(n.selectedDates.length||n.config.noCalendar)&&(n.config.enableTime&&a(n.config.noCalendar?n.latestSelectedDateObj:void 0),X(!1)),r();const o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!n.isMobile&&o&&B(),W("onReady")}(),n}function ix(t,e){const n=Array.prototype.slice.call(t).filter((t=>t instanceof HTMLElement)),i=[];for(let t=0;t<n.length;t++){const r=n[t];try{if(null!==r.getAttribute("data-fp-omit"))continue;void 0!==r._flatpickr&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=nx(r,e||{}),i.push(r._flatpickr)}catch(t){console.error(t)}}return 1===i.length?i[0]:i}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(t){return ix(this,t)},HTMLElement.prototype.flatpickr=function(t){return ix([this],t)});var rx=function(t,e){return"string"==typeof t?ix(window.document.querySelectorAll(t),e):t instanceof Node?ix([t],e):ix(t,e)};function sx(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ox(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ax(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function lx(t){return lx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},lx(t)}function cx(t,e){return cx=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},cx(t,e)}function dx(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hx(t){return function(){var e,n=lx(t);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()){var i=lx(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return dx(this,e)}}function ux(t){return t.replace(/(?:[_-])([a-z0-9])/g,((t,e)=>e.toUpperCase()))}function px(t){return t.charAt(0).toUpperCase()+t.slice(1)}function fx(t,e){const n=gx(t);return Array.from(n.reduce(((t,n)=>(function(t,e){const n=t[e];return Array.isArray(n)?n:[]}(n,e).forEach((e=>t.add(e))),t)),new Set))}function mx(t,e){return gx(t).reduce(((t,n)=>(t.push(...function(t,e){const n=t[e];return n?Object.keys(n).map((t=>[t,n[t]])):[]}(n,e)),t)),[])}function gx(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}function bx([t,e]){return function(t,e){const n=`${r=t,r.replace(/([A-Z])/g,((t,e)=>`-${e.toLowerCase()}`))}-value`,i=function(t){const e=function(t){const e=vx(t.type);if(e){const n=yx(t.default);if(e!==n)throw new Error(`Type "${e}" must match the type of the default value. Given default value: "${t.default}" as "${n}"`);return e}}(t),n=yx(t),i=vx(t),r=e||n||i;if(r)return r;throw new Error(`Unknown value type "${t}"`)}(e);var r;return{type:i,key:n,name:ux(n),get defaultValue(){return function(t){const e=vx(t);if(e)return wx[e];const n=t.default;return void 0!==n?n:t}(e)},get hasCustomDefaultValue(){return void 0!==yx(e)},reader:kx[i],writer:Sx[i]||Sx.default}}(t,e)}function vx(t){switch(t){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function yx(t){switch(typeof t){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(t)?"array":"[object Object]"===Object.prototype.toString.call(t)?"object":void 0}rx.defaultConfig={},rx.l10ns={en:Object.assign({},NS),default:Object.assign({},NS)},rx.localize=t=>{rx.l10ns.default=Object.assign(Object.assign({},rx.l10ns.default),t)},rx.setDefaults=t=>{rx.defaultConfig=Object.assign(Object.assign({},rx.defaultConfig),t)},rx.parseDate=GS({}),rx.formatDate=JS({}),rx.compareDates=XS,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(t){return ix(this,t)}),Date.prototype.fp_incr=function(t){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof t?parseInt(t,10):t))},"undefined"!=typeof window&&(window.flatpickr=rx),(()=>{function t(t){function e(){return Reflect.construct(t,arguments,new.target)}return e.prototype=Object.create(t.prototype,{constructor:{value:e}}),Reflect.setPrototypeOf(e,t),e}try{return function(){const e=t((function(){this.a.call(this)}));e.prototype.a=function(){},new e}(),t}catch(t){return t=>class extends t{}}})();const wx={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},kx={array(t){const e=JSON.parse(t);if(!Array.isArray(e))throw new TypeError("Expected array");return e},boolean:t=>!("0"==t||"false"==t),number:t=>Number(t),object(t){const e=JSON.parse(t);if(null===e||"object"!=typeof e||Array.isArray(e))throw new TypeError("Expected object");return e},string:t=>t},Sx={default:function(t){return`${t}`},array:xx,object:xx};function xx(t){return JSON.stringify(t)}class Ex{constructor(t){this.context=t}static get shouldLoad(){return!0}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:e=this.element,detail:n={},prefix:i=this.identifier,bubbles:r=!0,cancelable:s=!0}={}){const o=new CustomEvent(i?`${i}:${t}`:t,{detail:n,bubbles:r,cancelable:s});return e.dispatchEvent(o),o}}Ex.blessings=[function(t){return fx(t,"classes").reduce(((t,e)=>{return Object.assign(t,{[`${n=e}Class`]:{get(){const{classes:t}=this;if(t.has(n))return t.get(n);{const e=t.getAttributeName(n);throw new Error(`Missing attribute "${e}"`)}}},[`${n}Classes`]:{get(){return this.classes.getAll(n)}},[`has${px(n)}Class`]:{get(){return this.classes.has(n)}}});var n}),{})},function(t){return fx(t,"targets").reduce(((t,e)=>{return Object.assign(t,{[`${n=e}Target`]:{get(){const t=this.targets.find(n);if(t)return t;throw new Error(`Missing target element "${n}" for "${this.identifier}" controller`)}},[`${n}Targets`]:{get(){return this.targets.findAll(n)}},[`has${px(n)}Target`]:{get(){return this.targets.has(n)}}});var n}),{})},function(t){const e=mx(t,"values"),n={valueDescriptorMap:{get(){return e.reduce(((t,e)=>{const n=bx(e),i=this.data.getAttributeNameForKey(n.key);return Object.assign(t,{[i]:n})}),{})}}};return e.reduce(((t,e)=>Object.assign(t,function(t){const e=bx(t),{key:n,name:i,reader:r,writer:s}=e;return{[i]:{get(){const t=this.data.get(n);return null!==t?r(t):e.defaultValue},set(t){void 0===t?this.data.delete(n):this.data.set(n,s(t))}},[`has${px(i)}`]:{get(){return this.data.has(n)||e.hasCustomDefaultValue}}}}(e))),n)}],Ex.targets=[],Ex.values={};const Cx=["altFormat","ariaDateFormat","dateFormat"],_x={string:["altInputClass","conjunction","mode","nextArrow","position","prevArrow","monthSelectorType"],boolean:["allowInput","altInput","animate","clickOpens","closeOnSelect","disableMobile","enableSeconds","enableTime","inline","noCalendar","shorthandCurrentMonth","static","time_24hr","weekNumbers","wrap"],date:["maxDate","minDate","maxTime","minTime","now"],array:["disable","enable","disableDaysOfWeek","enableDaysOfWeek"],number:["defaultHour","defaultMinute","defaultSeconds","hourIncrement","minuteIncrement","showMonths"],arrayOrString:["defaultDate"]},Ax=["change","open","close","monthChange","yearChange","ready","valueUpdate","dayCreate"],Ox=["calendarContainer","currentYearElement","days","daysContainer","input","nextMonthNav","monthNav","prevMonthNav","rContainer","selectedDateElem","todayDateElem","weekdayContainer"],Tx={"%Y":"Y","%y":"y","%C":"Y","%m":"m","%-m":"n","%_m":"n","%B":"F","%^B":"F","%b":"M","%^b":"M","%h":"M","%^h":"M","%d":"d","%-d":"j","%e":"j","%H":"H","%k":"H","%I":"h","%l":"h","%-l":"h","%P":"K","%p":"K","%M":"i","%S":"S","%A":"l","%a":"D","%w":"w"},Mx=new RegExp(Object.keys(Tx).join("|").replace(new RegExp("\\^","g"),"\\^"),"g");let Dx=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cx(t,e)}(s,t);var e,n,i,r=hx(s);function s(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),r.apply(this,arguments)}return e=s,n=[{key:"initialize",value:function(){this.config={}}},{key:"connect",value:function(){this._initializeEvents(),this._initializeOptions(),this._initializeDateFormats(),this.fp=rx(this.flatpickrElement,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ax(Object(n),!0).forEach((function(e){ox(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ax(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.config)),this._initializeElements()}},{key:"disconnect",value:function(){const t=this.inputTarget.value;this.fp.destroy(),this.inputTarget.value=t}},{key:"_initializeEvents",value:function(){Ax.forEach((t=>{if(this[t]){const n=`on${e=t,e.charAt(0).toUpperCase()+e.slice(1)}`;this.config[n]=this[t].bind(this)}var e}))}},{key:"_initializeOptions",value:function(){Object.keys(_x).forEach((t=>{_x[t].forEach((e=>{const n=e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase();this.data.has(n)&&(this.config[e]=this[`_${t}`](n))}))})),this._handleDaysOfWeek()}},{key:"_handleDaysOfWeek",value:function(){this.config.disableDaysOfWeek&&(this.config.disableDaysOfWeek=this._validateDaysOfWeek(this.config.disableDaysOfWeek),this.config.disable=[...this.config.disable||[],this._disable.bind(this)]),this.config.enableDaysOfWeek&&(this.config.enableDaysOfWeek=this._validateDaysOfWeek(this.config.enableDaysOfWeek),this.config.enable=[...this.config.enable||[],this._enable.bind(this)])}},{key:"_validateDaysOfWeek",value:function(t){return Array.isArray(t)?t.map((t=>parseInt(t))):(console.error("days of week must be a valid array"),[])}},{key:"_disable",value:function(t){return this.config.disableDaysOfWeek.includes(t.getDay())}},{key:"_enable",value:function(t){return this.config.enableDaysOfWeek.includes(t.getDay())}},{key:"_initializeDateFormats",value:function(){Cx.forEach((t=>{this.data.has(t)&&(this.config[t]=this.data.get(t).replace(Mx,(t=>Tx[t])))}))}},{key:"_initializeElements",value:function(){Ox.forEach((t=>{this[`${t}Target`]=this.fp[t]}))}},{key:"_string",value:function(t){return this.data.get(t)}},{key:"_date",value:function(t){return this.data.get(t)}},{key:"_boolean",value:function(t){return!("0"==this.data.get(t)||"false"==this.data.get(t))}},{key:"_array",value:function(t){return JSON.parse(this.data.get(t))}},{key:"_number",value:function(t){return parseInt(this.data.get(t))}},{key:"_arrayOrString",value:function(t){const e=this.data.get(t);try{return JSON.parse(e)}catch(t){return e}}},{key:"flatpickrElement",get:function(){return this.hasInstanceTarget&&this.instanceTarget||this.element}}],n&&sx(e.prototype,n),i&&sx(e,i),s}(Ex);ox(Dx,"targets",["instance"]);const Lx="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},Nx={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","févr","mars","avr","mai","juin","juil","août","sept","oct","nov","déc"],longhand:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ordinal:t=>t>1?"":"er",rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"Défiler pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0};Lx.l10ns.fr=Nx,Lx.l10ns;const Ix={fr:Nx,en:NS};
/**! 
   * hotkeys-js v3.10.2 
   * A simple micro-library for defining and dispatching keyboard shortcuts. It has no dependencies. 
   * 
   * Copyright (c) 2023 kenny wong <wowohoo@qq.com> 
   * http://jaywcjlove.github.io/hotkeys 
   * Licensed under the MIT license 
   */
var Px="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function $x(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on".concat(e),(function(){n(window.event)}))}function Rx(t,e){for(var n=e.slice(0,e.length-1),i=0;i<n.length;i++)n[i]=t[n[i].toLowerCase()];return n}function Fx(t){"string"!=typeof t&&(t="");for(var e=(t=t.replace(/\s/g,"")).split(","),n=e.lastIndexOf("");n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}for(var Bx={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Px?173:189,"=":Px?61:187,";":Px?59:186,"'":222,"[":219,"]":221,"\\":220},jx={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},Hx={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},zx={16:!1,18:!1,17:!1,91:!1},Vx={},qx=1;qx<20;qx++)Bx["f".concat(qx)]=111+qx;var Ux=[],Wx=!1,Kx="all",Yx=[],Jx=function(t){return Bx[t.toLowerCase()]||jx[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)};function Gx(t){Kx=t||"all"}function Xx(){return Kx||"all"}var Qx=function(t){var e=t.key,n=t.scope,i=t.method,r=t.splitKey,s=void 0===r?"+":r;Fx(e).forEach((function(t){var e=t.split(s),r=e.length,o=e[r-1],a="*"===o?"*":Jx(o);if(Vx[a]){n||(n=Xx());var l=r>1?Rx(jx,e):[];Vx[a]=Vx[a].filter((function(t){return!((!i||t.method===i)&&t.scope===n&&function(t,e){for(var n=t.length>=e.length?t:e,i=t.length>=e.length?e:t,r=!0,s=0;s<n.length;s++)-1===i.indexOf(n[s])&&(r=!1);return r}(t.mods,l))}))}}))};function Zx(t,e,n,i){var r;if(e.element===i&&(e.scope===n||"all"===e.scope)){for(var s in r=e.mods.length>0,zx)Object.prototype.hasOwnProperty.call(zx,s)&&(!zx[s]&&e.mods.indexOf(+s)>-1||zx[s]&&-1===e.mods.indexOf(+s))&&(r=!1);(0!==e.mods.length||zx[16]||zx[18]||zx[17]||zx[91])&&!r&&"*"!==e.shortcut||!1===e.method(t,e)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}function tE(t,e){var n=Vx["*"],i=t.keyCode||t.which||t.charCode;if(eE.filter.call(this,t)){if(93!==i&&224!==i||(i=91),-1===Ux.indexOf(i)&&229!==i&&Ux.push(i),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(e){var n=Hx[e];t[e]&&-1===Ux.indexOf(n)?Ux.push(n):!t[e]&&Ux.indexOf(n)>-1?Ux.splice(Ux.indexOf(n),1):"metaKey"===e&&t[e]&&3===Ux.length&&(t.ctrlKey||t.shiftKey||t.altKey||(Ux=Ux.slice(Ux.indexOf(n))))})),i in zx){for(var r in zx[i]=!0,jx)jx[r]===i&&(eE[r]=!0);if(!n)return}for(var s in zx)Object.prototype.hasOwnProperty.call(zx,s)&&(zx[s]=t[Hx[s]]);t.getModifierState&&(!t.altKey||t.ctrlKey)&&t.getModifierState("AltGraph")&&(-1===Ux.indexOf(17)&&Ux.push(17),-1===Ux.indexOf(18)&&Ux.push(18),zx[17]=!0,zx[18]=!0);var o=Xx();if(n)for(var a=0;a<n.length;a++)n[a].scope===o&&("keydown"===t.type&&n[a].keydown||"keyup"===t.type&&n[a].keyup)&&Zx(t,n[a],o,e);if(i in Vx)for(var l=0;l<Vx[i].length;l++)if(("keydown"===t.type&&Vx[i][l].keydown||"keyup"===t.type&&Vx[i][l].keyup)&&Vx[i][l].key){for(var c=Vx[i][l],d=c.splitKey,h=c.key.split(d),u=[],p=0;p<h.length;p++)u.push(Jx(h[p]));u.sort().join("")===Ux.sort().join("")&&Zx(t,c,o,e)}}}function eE(t,e,n){Ux=[];var i=Fx(t),r=[],s="all",o=document,a=0,l=!1,c=!0,d="+",h=!1;for(void 0===n&&"function"==typeof e&&(n=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(s=e.scope),e.element&&(o=e.element),e.keyup&&(l=e.keyup),void 0!==e.keydown&&(c=e.keydown),void 0!==e.capture&&(h=e.capture),"string"==typeof e.splitKey&&(d=e.splitKey)),"string"==typeof e&&(s=e);a<i.length;a++)r=[],(t=i[a].split(d)).length>1&&(r=Rx(jx,t)),(t="*"===(t=t[t.length-1])?"*":Jx(t))in Vx||(Vx[t]=[]),Vx[t].push({keyup:l,keydown:c,scope:s,mods:r,shortcut:i[a],method:n,key:i[a],splitKey:d,element:o});void 0!==o&&!function(t){return Yx.indexOf(t)>-1}(o)&&window&&(Yx.push(o),$x(o,"keydown",(function(t){tE(t,o)}),h),Wx||(Wx=!0,$x(window,"focus",(function(){Ux=[]}),h)),$x(o,"keyup",(function(t){tE(t,o),function(t){var e=t.keyCode||t.which||t.charCode,n=Ux.indexOf(e);if(n>=0&&Ux.splice(n,1),t.key&&"meta"===t.key.toLowerCase()&&Ux.splice(0,Ux.length),93!==e&&224!==e||(e=91),e in zx)for(var i in zx[e]=!1,jx)jx[i]===e&&(eE[i]=!1)}(t)}),h))}var nE={getPressedKeyString:function(){return Ux.map((function(t){return function(t){return Object.keys(Bx).find((function(e){return Bx[e]===t}))}(t)||function(t){return Object.keys(jx).find((function(e){return jx[e]===t}))}(t)||String.fromCharCode(t)}))},setScope:Gx,getScope:Xx,deleteScope:function(t,e){var n,i;for(var r in t||(t=Xx()),Vx)if(Object.prototype.hasOwnProperty.call(Vx,r))for(n=Vx[r],i=0;i<n.length;)n[i].scope===t?n.splice(i,1):i++;Xx()===t&&Gx(e||"all")},getPressedKeyCodes:function(){return Ux.slice(0)},isPressed:function(t){return"string"==typeof t&&(t=Jx(t)),-1!==Ux.indexOf(t)},filter:function(t){var e=t.target||t.srcElement,n=e.tagName,i=!0;return!e.isContentEditable&&("INPUT"!==n&&"TEXTAREA"!==n&&"SELECT"!==n||e.readOnly)||(i=!1),i},trigger:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(Vx).forEach((function(n){Vx[n].filter((function(n){return n.scope===e&&n.shortcut===t})).forEach((function(t){t&&t.method&&t.method()}))}))},unbind:function(t){if(void 0===t)Object.keys(Vx).forEach((function(t){return delete Vx[t]}));else if(Array.isArray(t))t.forEach((function(t){t.key&&Qx(t)}));else if("object"==typeof t)t.key&&Qx(t);else if("string"==typeof t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=n[0],s=n[1];"function"==typeof r&&(s=r,r=""),Qx({key:t,scope:r,method:s,splitKey:"+"})}},keyMap:Bx,modifier:jx,modifierMap:Hx};for(var iE in nE)Object.prototype.hasOwnProperty.call(nE,iE)&&(eE[iE]=nE[iE]);if("undefined"!=typeof window){var rE=window.hotkeys;eE.noConflict=function(t){return t&&window.hotkeys===eE&&(window.hotkeys=rE),eE},window.hotkeys=eE}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */const sE={debug:!1,logger:console,dispatchEvent:!0,eventPrefix:!0};class oE{constructor(t,e={}){var n,i,r;this.log=(t,e)=>{this.debug&&(this.logger.groupCollapsed(`%c${this.controller.identifier} %c#${t}`,"color: #3B82F6","color: unset"),this.logger.log(Object.assign({controllerId:this.controllerId},e)),this.logger.groupEnd())},this.warn=t=>{this.logger.warn(`%c${this.controller.identifier} %c${t}`,"color: #3B82F6; font-weight: bold","color: unset")},this.dispatch=(t,e={})=>{if(this.dispatchEvent){const{event:n}=e,i=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["event"]),r=this.extendedEvent(t,n||null,i);this.targetElement.dispatchEvent(r),this.log("dispatchEvent",Object.assign({eventName:r.type},i))}},this.call=(t,e={})=>{const n=this.controller[t];if("function"==typeof n)return n.call(this.controller,e)},this.extendedEvent=(t,e,n)=>{const{bubbles:i,cancelable:r,composed:s}=e||{bubbles:!0,cancelable:!0,composed:!0};e&&Object.assign(n,{originalEvent:e});return new CustomEvent(this.composeEventName(t),{bubbles:i,cancelable:r,composed:s,detail:n})},this.composeEventName=t=>{let e=t;return!0===this.eventPrefix?e=`${this.controller.identifier}:${t}`:"string"==typeof this.eventPrefix&&(e=`${this.eventPrefix}:${t}`),e},this.debug=null!==(i=null!==(n=null==e?void 0:e.debug)&&void 0!==n?n:t.application.stimulusUseDebug)&&void 0!==i?i:sE.debug,this.logger=null!==(r=null==e?void 0:e.logger)&&void 0!==r?r:sE.logger,this.controller=t,this.controllerId=t.element.id||t.element.dataset.id,this.targetElement=(null==e?void 0:e.element)||t.element;const{dispatchEvent:s,eventPrefix:o}=Object.assign({},sE,e);Object.assign(this,{dispatchEvent:s,eventPrefix:o}),this.controllerInitialize=t.initialize.bind(t),this.controllerConnect=t.connect.bind(t),this.controllerDisconnect=t.disconnect.bind(t)}}class aE extends oE{constructor(t,e={}){super(t,e),this.observe=()=>{this.targetElement.addEventListener("mouseenter",this.onEnter),this.targetElement.addEventListener("mouseleave",this.onLeave)},this.unobserve=()=>{this.targetElement.removeEventListener("mouseenter",this.onEnter),this.targetElement.removeEventListener("mouseleave",this.onLeave)},this.onEnter=t=>{this.call("mouseEnter",t),this.log("mouseEnter",{hover:!0}),this.dispatch("mouseEnter",{hover:!1})},this.onLeave=t=>{this.call("mouseLeave",t),this.log("mouseLeave",{hover:!1}),this.dispatch("mouseLeave",{hover:!1})},this.controller=t,this.enhanceController(),this.observe()}enhanceController(){const t=this.controller.disconnect.bind(this.controller);Object.assign(this.controller,{disconnect:()=>{this.unobserve(),t()}})}}(class extends pS{}).debounces=[];const lE=(t,e=200)=>{let n=null;return function(){const i=Array.from(arguments),r=this,s=i.map((t=>t.params));n&&clearTimeout(n),n=setTimeout((()=>(i.forEach(((t,e)=>t.params=s[e])),t.apply(r,i))),e)}};(class extends pS{}).throttles=[];class cE extends pS{connect(){this.checkForChanges()}watchTargetConnected(t){this.attachActionAttributes(t),this.checkForChanges()}watchTargetDisconnect(){this.checkForChanges()}checkForChanges(){const t=[];this.watchTargets.forEach((e=>{"checkbox"===e.type||"radio"===e.type?e.checked!==e.defaultChecked&&t.push(1):"SELECT"===e.tagName?!0===this.handleSelectChange(e)&&t.push(1):e.value!==e.defaultValue&&t.push(1)})),t.length>0?this.enableChangeControles():this.disableChangeControles()}enableChangeControles(){this.hasSaveButtonTarget&&(this.saveButtonTarget.disabled=!1)}disableChangeControles(){this.hasSaveButtonTarget&&(this.saveButtonTarget.disabled=!0)}handleSelectChange(t){let e,n,i,r=!1,s=0;for(e=0,n=t.options.length;e<n;e++)i=t.options[e],r=r||i.selected!==i.defaultSelected,i.defaultSelected&&(s=e);if(r&&!t.multiple&&(r=s!==t.selectedIndex),r)return!0}attachActionAttributes(t){t.hasAttribute("data-action")&&t.dataset.action.includes(`${this.identifier}#checkForChanges`)||(t.hasAttribute("data-action")?t.setAttribute("data-action",`${this.identifier}#checkForChanges ${t.dataset.action}`):t.setAttribute("data-action",`${this.identifier}#checkForChanges`))}}cE.targets=["saveButton","watch"];class dE extends pS{initialize(){this.toggle=this.toggle.bind(this),this.refresh=this.refresh.bind(this)}checkboxAllTargetConnected(t){t.addEventListener("change",this.toggle),this.refresh()}checkboxTargetConnected(t){t.addEventListener("change",this.refresh),this.refresh()}checkboxAllTargetDisconnected(t){t.removeEventListener("change",this.toggle),this.refresh()}checkboxTargetDisconnected(t){t.removeEventListener("change",this.refresh),this.refresh()}toggle(t){t.preventDefault(),this.checkboxTargets.forEach((e=>{e.checked=t.target.checked,this.triggerInputEvent(e)}))}refresh(){const t=this.checkboxTargets.length,e=this.checked.length;this.checkboxAllTarget.checked=e>0,this.checkboxAllTarget.indeterminate=e>0&&e<t}triggerInputEvent(t){const e=new Event("input",{bubbles:!1,cancelable:!0});t.dispatchEvent(e)}get checked(){return this.checkboxTargets.filter((t=>t.checked))}get unchecked(){return this.checkboxTargets.filter((t=>!t.checked))}}dE.targets=["checkboxAll","checkbox"];
/**!
   * Sortable 1.15.0
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   */
function hE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function uE(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hE(Object(n),!0).forEach((function(e){fE(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hE(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pE(t){return pE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pE(t)}function fE(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mE(){return mE=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},mE.apply(this,arguments)}function gE(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n,i,r={},s=Object.keys(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function bE(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var vE=bE(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),yE=bE(/Edge/i),wE=bE(/firefox/i),kE=bE(/safari/i)&&!bE(/chrome/i)&&!bE(/android/i),SE=bE(/iP(ad|od|hone)/i),xE=bE(/chrome/i)&&bE(/android/i),EE={capture:!1,passive:!1};function CE(t,e,n){t.addEventListener(e,n,!vE&&EE)}function _E(t,e,n){t.removeEventListener(e,n,!vE&&EE)}function AE(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return!1}return!1}}function OE(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function TE(t,e,n,i){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&AE(t,e):AE(t,e))||i&&t===n)return t;if(t===n)break}while(t=OE(t))}return null}var ME,DE=/\s+/g;function LE(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(DE," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(DE," ")}}function NE(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||-1!==e.indexOf("webkit")||(e="-webkit-"+e),i[e]=n+("string"==typeof n?"":"px")}}function IE(t,e){var n="";if("string"==typeof t)n=t;else do{var i=NE(t,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function PE(t,e,n){if(t){var i=t.getElementsByTagName(e),r=0,s=i.length;if(n)for(;r<s;r++)n(i[r],r);return i}return[]}function $E(){var t=document.scrollingElement;return t||document.documentElement}function RE(t,e,n,i,r){if(t.getBoundingClientRect||t===window){var s,o,a,l,c,d,h;if(t!==window&&t.parentNode&&t!==$E()?(o=(s=t.getBoundingClientRect()).top,a=s.left,l=s.bottom,c=s.right,d=s.height,h=s.width):(o=0,a=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,h=window.innerWidth),(e||n)&&t!==window&&(r=r||t.parentNode,!vE))do{if(r&&r.getBoundingClientRect&&("none"!==NE(r,"transform")||n&&"static"!==NE(r,"position"))){var u=r.getBoundingClientRect();o-=u.top+parseInt(NE(r,"border-top-width")),a-=u.left+parseInt(NE(r,"border-left-width")),l=o+s.height,c=a+s.width;break}}while(r=r.parentNode);if(i&&t!==window){var p=IE(r||t),f=p&&p.a,m=p&&p.d;p&&(l=(o/=m)+(d/=m),c=(a/=f)+(h/=f))}return{top:o,left:a,bottom:l,right:c,width:h,height:d}}}function FE(t,e,n){for(var i=VE(t,!0),r=RE(t)[e];i;){var s=RE(i)[n];if(!("top"===n||"left"===n?r>=s:r<=s))return i;if(i===$E())break;i=VE(i,!1)}return!1}function BE(t,e,n,i){for(var r=0,s=0,o=t.children;s<o.length;){if("none"!==o[s].style.display&&o[s]!==WC.ghost&&(i||o[s]!==WC.dragged)&&TE(o[s],n.draggable,t,!1)){if(r===e)return o[s];r++}s++}return null}function jE(t,e){for(var n=t.lastElementChild;n&&(n===WC.ghost||"none"===NE(n,"display")||e&&!AE(n,e));)n=n.previousElementSibling;return n||null}function HE(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===WC.clone||e&&!AE(t,e)||n++;return n}function zE(t){var e=0,n=0,i=$E();if(t)do{var r=IE(t),s=r.a,o=r.d;e+=t.scrollLeft*s,n+=t.scrollTop*o}while(t!==i&&(t=t.parentNode));return[e,n]}function VE(t,e){if(!t||!t.getBoundingClientRect)return $E();var n=t,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=NE(n);if(n.clientWidth<n.scrollWidth&&("auto"==r.overflowX||"scroll"==r.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==r.overflowY||"scroll"==r.overflowY)){if(!n.getBoundingClientRect||n===document.body)return $E();if(i||e)return n;i=!0}}}while(n=n.parentNode);return $E()}function qE(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function UE(t,e){return function(){if(!ME){var n=arguments;1===n.length?t.call(this,n[0]):t.apply(this,n),ME=setTimeout((function(){ME=void 0}),e)}}}function WE(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function KE(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}var YE="Sortable"+(new Date).getTime();function JE(){var t,e=[];return{captureAnimationState:function(){(e=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(t){if("none"!==NE(t,"display")&&t!==WC.ghost){e.push({target:t,rect:RE(t)});var n=uE({},e[e.length-1].rect);if(t.thisAnimationDuration){var i=IE(t,!0);i&&(n.top-=i.f,n.left-=i.e)}t.fromRect=n}}))},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(function(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n);return-1}(e,{target:t}),1)},animateAll:function(n){var i=this;if(!this.options.animation)return clearTimeout(t),void("function"==typeof n&&n());var r=!1,s=0;e.forEach((function(t){var e=0,n=t.target,o=n.fromRect,a=RE(n),l=n.prevFromRect,c=n.prevToRect,d=t.rect,h=IE(n,!0);h&&(a.top-=h.f,a.left-=h.e),n.toRect=a,n.thisAnimationDuration&&qE(l,a)&&!qE(o,a)&&(d.top-a.top)/(d.left-a.left)==(o.top-a.top)/(o.left-a.left)&&(e=function(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}(d,l,c,i.options)),qE(a,o)||(n.prevFromRect=o,n.prevToRect=a,e||(e=i.options.animation),i.animate(n,d,a,e)),e&&(r=!0,s=Math.max(s,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),r?t=setTimeout((function(){"function"==typeof n&&n()}),s):"function"==typeof n&&n(),e=[]},animate:function(t,e,n,i){if(i){NE(t,"transition",""),NE(t,"transform","");var r=IE(this.el),s=r&&r.a,o=r&&r.d,a=(e.left-n.left)/(s||1),l=(e.top-n.top)/(o||1);t.animatingX=!!a,t.animatingY=!!l,NE(t,"transform","translate3d("+a+"px,"+l+"px,0)"),this.forRepaintDummy=function(t){return t.offsetWidth}(t),NE(t,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),NE(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){NE(t,"transition",""),NE(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),i)}}}}var GE=[],XE={initializeByDefault:!0},QE={mount:function(t){for(var e in XE)XE.hasOwnProperty(e)&&!(e in t)&&(t[e]=XE[e]);GE.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),GE.push(t)},pluginEvent:function(t,e,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var r=t+"Global";GE.forEach((function(i){e[i.pluginName]&&(e[i.pluginName][r]&&e[i.pluginName][r](uE({sortable:e},n)),e.options[i.pluginName]&&e[i.pluginName][t]&&e[i.pluginName][t](uE({sortable:e},n)))}))},initializePlugins:function(t,e,n,i){for(var r in GE.forEach((function(i){var r=i.pluginName;if(t.options[r]||i.initializeByDefault){var s=new i(t,e,t.options);s.sortable=t,s.options=t.options,t[r]=s,mE(n,s.defaults)}})),t.options)if(t.options.hasOwnProperty(r)){var s=this.modifyOption(t,r,t.options[r]);void 0!==s&&(t.options[r]=s)}},getEventProperties:function(t,e){var n={};return GE.forEach((function(i){"function"==typeof i.eventProperties&&mE(n,i.eventProperties.call(e[i.pluginName],t))})),n},modifyOption:function(t,e,n){var i;return GE.forEach((function(r){t[r.pluginName]&&r.optionListeners&&"function"==typeof r.optionListeners[e]&&(i=r.optionListeners[e].call(t[r.pluginName],n))})),i}};var ZE=["evt"],tC=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,r=gE(n,ZE);QE.pluginEvent.bind(WC)(t,e,uE({dragEl:nC,parentEl:iC,ghostEl:rC,rootEl:sC,nextEl:oC,lastDownEl:aC,cloneEl:lC,cloneHidden:cC,dragStarted:SC,putSortable:mC,activeSortable:WC.active,originalEvent:i,oldIndex:dC,oldDraggableIndex:uC,newIndex:hC,newDraggableIndex:pC,hideGhostForTarget:zC,unhideGhostForTarget:VC,cloneNowHidden:function(){cC=!0},cloneNowShown:function(){cC=!1},dispatchSortableEvent:function(t){eC({sortable:e,name:t,originalEvent:i})}},r))};function eC(t){!function(t){var e=t.sortable,n=t.rootEl,i=t.name,r=t.targetEl,s=t.cloneEl,o=t.toEl,a=t.fromEl,l=t.oldIndex,c=t.newIndex,d=t.oldDraggableIndex,h=t.newDraggableIndex,u=t.originalEvent,p=t.putSortable,f=t.extraEventProperties;if(e=e||n&&n[YE]){var m,g=e.options,b="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||vE||yE?(m=document.createEvent("Event")).initEvent(i,!0,!0):m=new CustomEvent(i,{bubbles:!0,cancelable:!0}),m.to=o||n,m.from=a||n,m.item=r||n,m.clone=s,m.oldIndex=l,m.newIndex=c,m.oldDraggableIndex=d,m.newDraggableIndex=h,m.originalEvent=u,m.pullMode=p?p.lastPutMode:void 0;var v=uE(uE({},f),QE.getEventProperties(i,e));for(var y in v)m[y]=v[y];n&&n.dispatchEvent(m),g[b]&&g[b].call(e,m)}}(uE({putSortable:mC,cloneEl:lC,targetEl:nC,rootEl:sC,oldIndex:dC,oldDraggableIndex:uC,newIndex:hC,newDraggableIndex:pC},t))}var nC,iC,rC,sC,oC,aC,lC,cC,dC,hC,uC,pC,fC,mC,gC,bC,vC,yC,wC,kC,SC,xC,EC,CC,_C,AC=!1,OC=!1,TC=[],MC=!1,DC=!1,LC=[],NC=!1,IC=[],PC="undefined"!=typeof document,$C=SE,RC=yE||vE?"cssFloat":"float",FC=PC&&!xE&&!SE&&"draggable"in document.createElement("div"),BC=function(){if(PC){if(vE)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),jC=function(t,e){var n=NE(t),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=BE(t,0,e),s=BE(t,1,e),o=r&&NE(r),a=s&&NE(s),l=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+RE(r).width,c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+RE(s).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&o.float&&"none"!==o.float){var d="left"===o.float?"left":"right";return!s||"both"!==a.clear&&a.clear!==d?"horizontal":"vertical"}return r&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||l>=i&&"none"===n[RC]||s&&"none"===n[RC]&&l+c>i)?"vertical":"horizontal"},HC=function(t){function e(t,n){return function(i,r,s,o){var a=i.options.group.name&&r.options.group.name&&i.options.group.name===r.options.group.name;if(null==t&&(n||a))return!0;if(null==t||!1===t)return!1;if(n&&"clone"===t)return t;if("function"==typeof t)return e(t(i,r,s,o),n)(i,r,s,o);var l=(n?i:r).options.group.name;return!0===t||"string"==typeof t&&t===l||t.join&&t.indexOf(l)>-1}}var n={},i=t.group;i&&"object"==pE(i)||(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),n.revertClone=i.revertClone,t.group=n},zC=function(){!BC&&rC&&NE(rC,"display","none")},VC=function(){!BC&&rC&&NE(rC,"display","")};PC&&!xE&&document.addEventListener("click",(function(t){if(OC)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),OC=!1,!1}),!0);var qC=function(t){if(nC){var e=function(t,e){var n;return TC.some((function(i){var r=i[YE].options.emptyInsertThreshold;if(r&&!jE(i)){var s=RE(i),o=t>=s.left-r&&t<=s.right+r,a=e>=s.top-r&&e<=s.bottom+r;return o&&a?n=i:void 0}})),n}((t=t.touches?t.touches[0]:t).clientX,t.clientY);if(e){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[YE]._onDragOver(n)}}},UC=function(t){nC&&nC.parentNode[YE]._isOutsideThisEl(t.target)};function WC(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=mE({},e),t[YE]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return jC(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==WC.supportPointer&&"PointerEvent"in window&&!kE,emptyInsertThreshold:5};for(var i in QE.initializePlugins(this,t,n),n)!(i in e)&&(e[i]=n[i]);for(var r in HC(e),this)"_"===r.charAt(0)&&"function"==typeof this[r]&&(this[r]=this[r].bind(this));this.nativeDraggable=!e.forceFallback&&FC,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?CE(t,"pointerdown",this._onTapStart):(CE(t,"mousedown",this._onTapStart),CE(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(CE(t,"dragover",this),CE(t,"dragenter",this)),TC.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),mE(this,JE())}function KC(t,e,n,i,r,s,o,a){var l,c,d=t[YE],h=d.options.onMove;return!window.CustomEvent||vE||yE?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=r||e,l.relatedRect=s||RE(e),l.willInsertAfter=a,l.originalEvent=o,t.dispatchEvent(l),h&&(c=h.call(d,l,o)),c}function YC(t){t.draggable=!1}function JC(){NC=!1}function GC(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function XC(t){return setTimeout(t,0)}function QC(t){return clearTimeout(t)}WC.prototype={constructor:WC,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(xC=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,nC):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,i=this.options,r=i.preventOnFilter,s=t.type,o=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,a=(o||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||a,c=i.filter;if(function(t){IC.length=0;var e=t.getElementsByTagName("input"),n=e.length;for(;n--;){var i=e[n];i.checked&&IC.push(i)}}(n),!nC&&!(/mousedown|pointerdown/.test(s)&&0!==t.button||i.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!kE||!a||"SELECT"!==a.tagName.toUpperCase())&&!((a=TE(a,i.draggable,n,!1))&&a.animated||aC===a)){if(dC=HE(a),uC=HE(a,i.draggable),"function"==typeof c){if(c.call(this,t,a,this))return eC({sortable:e,rootEl:l,name:"filter",targetEl:a,toEl:n,fromEl:n}),tC("filter",e,{evt:t}),void(r&&t.cancelable&&t.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=TE(l,i.trim(),n,!1))return eC({sortable:e,rootEl:i,name:"filter",targetEl:a,fromEl:n,toEl:n}),tC("filter",e,{evt:t}),!0}))))return void(r&&t.cancelable&&t.preventDefault());i.handle&&!TE(l,i.handle,n,!1)||this._prepareDragStart(t,o,a)}}},_prepareDragStart:function(t,e,n){var i,r=this,s=r.el,o=r.options,a=s.ownerDocument;if(n&&!nC&&n.parentNode===s){var l=RE(n);if(sC=s,iC=(nC=n).parentNode,oC=nC.nextSibling,aC=n,fC=o.group,WC.dragged=nC,gC={target:nC,clientX:(e||t).clientX,clientY:(e||t).clientY},wC=gC.clientX-l.left,kC=gC.clientY-l.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,nC.style["will-change"]="all",i=function(){tC("delayEnded",r,{evt:t}),WC.eventCanceled?r._onDrop():(r._disableDelayedDragEvents(),!wE&&r.nativeDraggable&&(nC.draggable=!0),r._triggerDragStart(t,e),eC({sortable:r,name:"choose",originalEvent:t}),LE(nC,o.chosenClass,!0))},o.ignore.split(",").forEach((function(t){PE(nC,t.trim(),YC)})),CE(a,"dragover",qC),CE(a,"mousemove",qC),CE(a,"touchmove",qC),CE(a,"mouseup",r._onDrop),CE(a,"touchend",r._onDrop),CE(a,"touchcancel",r._onDrop),wE&&this.nativeDraggable&&(this.options.touchStartThreshold=4,nC.draggable=!0),tC("delayStart",this,{evt:t}),!o.delay||o.delayOnTouchOnly&&!e||this.nativeDraggable&&(yE||vE))i();else{if(WC.eventCanceled)return void this._onDrop();CE(a,"mouseup",r._disableDelayedDrag),CE(a,"touchend",r._disableDelayedDrag),CE(a,"touchcancel",r._disableDelayedDrag),CE(a,"mousemove",r._delayedDragTouchMoveHandler),CE(a,"touchmove",r._delayedDragTouchMoveHandler),o.supportPointer&&CE(a,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(i,o.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){nC&&YC(nC),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;_E(t,"mouseup",this._disableDelayedDrag),_E(t,"touchend",this._disableDelayedDrag),_E(t,"touchcancel",this._disableDelayedDrag),_E(t,"mousemove",this._delayedDragTouchMoveHandler),_E(t,"touchmove",this._delayedDragTouchMoveHandler),_E(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?CE(document,"pointermove",this._onTouchMove):CE(document,e?"touchmove":"mousemove",this._onTouchMove):(CE(nC,"dragend",this),CE(sC,"dragstart",this._onDragStart));try{document.selection?XC((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){if(AC=!1,sC&&nC){tC("dragStarted",this,{evt:e}),this.nativeDraggable&&CE(document,"dragover",UC);var n=this.options;!t&&LE(nC,n.dragClass,!1),LE(nC,n.ghostClass,!0),WC.active=this,t&&this._appendGhost(),eC({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(bC){this._lastX=bC.clientX,this._lastY=bC.clientY,zC();for(var t=document.elementFromPoint(bC.clientX,bC.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(bC.clientX,bC.clientY))!==e;)e=t;if(nC.parentNode[YE]._isOutsideThisEl(t),e)do{if(e[YE]){if(e[YE]._onDragOver({clientX:bC.clientX,clientY:bC.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);VC()}},_onTouchMove:function(t){if(gC){var e=this.options,n=e.fallbackTolerance,i=e.fallbackOffset,r=t.touches?t.touches[0]:t,s=rC&&IE(rC,!0),o=rC&&s&&s.a,a=rC&&s&&s.d,l=$C&&_C&&zE(_C),c=(r.clientX-gC.clientX+i.x)/(o||1)+(l?l[0]-LC[0]:0)/(o||1),d=(r.clientY-gC.clientY+i.y)/(a||1)+(l?l[1]-LC[1]:0)/(a||1);if(!WC.active&&!AC){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(rC){s?(s.e+=c-(vC||0),s.f+=d-(yC||0)):s={a:1,b:0,c:0,d:1,e:c,f:d};var h="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");NE(rC,"webkitTransform",h),NE(rC,"mozTransform",h),NE(rC,"msTransform",h),NE(rC,"transform",h),vC=c,yC=d,bC=r}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!rC){var t=this.options.fallbackOnBody?document.body:sC,e=RE(nC,!0,$C,!0,t),n=this.options;if($C){for(_C=t;"static"===NE(_C,"position")&&"none"===NE(_C,"transform")&&_C!==document;)_C=_C.parentNode;_C!==document.body&&_C!==document.documentElement?(_C===document&&(_C=$E()),e.top+=_C.scrollTop,e.left+=_C.scrollLeft):_C=$E(),LC=zE(_C)}LE(rC=nC.cloneNode(!0),n.ghostClass,!1),LE(rC,n.fallbackClass,!0),LE(rC,n.dragClass,!0),NE(rC,"transition",""),NE(rC,"transform",""),NE(rC,"box-sizing","border-box"),NE(rC,"margin",0),NE(rC,"top",e.top),NE(rC,"left",e.left),NE(rC,"width",e.width),NE(rC,"height",e.height),NE(rC,"opacity","0.8"),NE(rC,"position",$C?"absolute":"fixed"),NE(rC,"zIndex","100000"),NE(rC,"pointerEvents","none"),WC.ghost=rC,t.appendChild(rC),NE(rC,"transform-origin",wC/parseInt(rC.style.width)*100+"% "+kC/parseInt(rC.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,i=t.dataTransfer,r=n.options;tC("dragStart",this,{evt:t}),WC.eventCanceled?this._onDrop():(tC("setupClone",this),WC.eventCanceled||((lC=KE(nC)).removeAttribute("id"),lC.draggable=!1,lC.style["will-change"]="",this._hideClone(),LE(lC,this.options.chosenClass,!1),WC.clone=lC),n.cloneId=XC((function(){tC("clone",n),WC.eventCanceled||(n.options.removeCloneOnHide||sC.insertBefore(lC,nC),n._hideClone(),eC({sortable:n,name:"clone"}))})),!e&&LE(nC,r.dragClass,!0),e?(OC=!0,n._loopId=setInterval(n._emulateDragOver,50)):(_E(document,"mouseup",n._onDrop),_E(document,"touchend",n._onDrop),_E(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",r.setData&&r.setData.call(n,i,nC)),CE(document,"drop",n),NE(nC,"transform","translateZ(0)")),AC=!0,n._dragStartId=XC(n._dragStarted.bind(n,e,t)),CE(document,"selectstart",n),SC=!0,kE&&NE(document.body,"user-select","none"))},_onDragOver:function(t){var e,n,i,r,s=this.el,o=t.target,a=this.options,l=a.group,c=WC.active,d=fC===l,h=a.sort,u=mC||c,p=this,f=!1;if(!NC){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),o=TE(o,a.draggable,s,!0),T("dragOver"),WC.eventCanceled)return f;if(nC.contains(t.target)||o.animated&&o.animatingX&&o.animatingY||p._ignoreWhileAnimating===o)return D(!1);if(OC=!1,c&&!a.disabled&&(d?h||(i=iC!==sC):mC===this||(this.lastPutMode=fC.checkPull(this,c,nC,t))&&l.checkPut(this,c,nC,t))){if(r="vertical"===this._getDirection(t,o),e=RE(nC),T("dragOverValid"),WC.eventCanceled)return f;if(i)return iC=sC,M(),this._hideClone(),T("revert"),WC.eventCanceled||(oC?sC.insertBefore(nC,oC):sC.appendChild(nC)),D(!0);var m=jE(s,a.draggable);if(!m||function(t,e,n){var i=RE(jE(n.el,n.options.draggable)),r=10;return e?t.clientX>i.right+r||t.clientX<=i.right&&t.clientY>i.bottom&&t.clientX>=i.left:t.clientX>i.right&&t.clientY>i.top||t.clientX<=i.right&&t.clientY>i.bottom+r}(t,r,this)&&!m.animated){if(m===nC)return D(!1);if(m&&s===t.target&&(o=m),o&&(n=RE(o)),!1!==KC(sC,s,nC,e,o,n,t,!!o))return M(),m&&m.nextSibling?s.insertBefore(nC,m.nextSibling):s.appendChild(nC),iC=s,L(),D(!0)}else if(m&&function(t,e,n){var i=RE(BE(n.el,0,n.options,!0)),r=10;return e?t.clientX<i.left-r||t.clientY<i.top&&t.clientX<i.right:t.clientY<i.top-r||t.clientY<i.bottom&&t.clientX<i.left}(t,r,this)){var g=BE(s,0,a,!0);if(g===nC)return D(!1);if(n=RE(o=g),!1!==KC(sC,s,nC,e,o,n,t,!1))return M(),s.insertBefore(nC,g),iC=s,L(),D(!0)}else if(o.parentNode===s){n=RE(o);var b,v,y,w=nC.parentNode!==s,k=!function(t,e,n){var i=n?t.left:t.top,r=n?t.right:t.bottom,s=n?t.width:t.height,o=n?e.left:e.top,a=n?e.right:e.bottom,l=n?e.width:e.height;return i===o||r===a||i+s/2===o+l/2}(nC.animated&&nC.toRect||e,o.animated&&o.toRect||n,r),S=r?"top":"left",x=FE(o,"top","top")||FE(nC,"top","top"),E=x?x.scrollTop:void 0;if(xC!==o&&(v=n[S],MC=!1,DC=!k&&a.invertSwap||w),b=function(t,e,n,i,r,s,o,a){var l=i?t.clientY:t.clientX,c=i?n.height:n.width,d=i?n.top:n.left,h=i?n.bottom:n.right,u=!1;if(!o)if(a&&CC<c*r){if(!MC&&(1===EC?l>d+c*s/2:l<h-c*s/2)&&(MC=!0),MC)u=!0;else if(1===EC?l<d+CC:l>h-CC)return-EC}else if(l>d+c*(1-r)/2&&l<h-c*(1-r)/2)return function(t){return HE(nC)<HE(t)?1:-1}(e);if((u=u||o)&&(l<d+c*s/2||l>h-c*s/2))return l>d+c/2?1:-1;return 0}(t,o,n,r,k?1:a.swapThreshold,null==a.invertedSwapThreshold?a.swapThreshold:a.invertedSwapThreshold,DC,xC===o),0!==b){var C=HE(nC);do{C-=b,y=iC.children[C]}while(y&&("none"===NE(y,"display")||y===rC))}if(0===b||y===o)return D(!1);xC=o,EC=b;var _=o.nextElementSibling,A=!1,O=KC(sC,s,nC,e,o,n,t,A=1===b);if(!1!==O)return 1!==O&&-1!==O||(A=1===O),NC=!0,setTimeout(JC,30),M(),A&&!_?s.appendChild(nC):o.parentNode.insertBefore(nC,A?_:o),x&&WE(x,0,E-x.scrollTop),iC=nC.parentNode,void 0===v||DC||(CC=Math.abs(v-RE(o)[S])),L(),D(!0)}if(s.contains(nC))return D(!1)}return!1}function T(a,l){tC(a,p,uE({evt:t,isOwner:d,axis:r?"vertical":"horizontal",revert:i,dragRect:e,targetRect:n,canSort:h,fromSortable:u,target:o,completed:D,onMove:function(n,i){return KC(sC,s,nC,e,n,RE(n),t,i)},changed:L},l))}function M(){T("dragOverAnimationCapture"),p.captureAnimationState(),p!==u&&u.captureAnimationState()}function D(e){return T("dragOverCompleted",{insertion:e}),e&&(d?c._hideClone():c._showClone(p),p!==u&&(LE(nC,mC?mC.options.ghostClass:c.options.ghostClass,!1),LE(nC,a.ghostClass,!0)),mC!==p&&p!==WC.active?mC=p:p===WC.active&&mC&&(mC=null),u===p&&(p._ignoreWhileAnimating=o),p.animateAll((function(){T("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(o===nC&&!nC.animated||o===s&&!o.animated)&&(xC=null),a.dragoverBubble||t.rootEl||o===document||(nC.parentNode[YE]._isOutsideThisEl(t.target),!e&&qC(t)),!a.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),f=!0}function L(){hC=HE(nC),pC=HE(nC,a.draggable),eC({sortable:p,name:"change",toEl:s,newIndex:hC,newDraggableIndex:pC,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){_E(document,"mousemove",this._onTouchMove),_E(document,"touchmove",this._onTouchMove),_E(document,"pointermove",this._onTouchMove),_E(document,"dragover",qC),_E(document,"mousemove",qC),_E(document,"touchmove",qC)},_offUpEvents:function(){var t=this.el.ownerDocument;_E(t,"mouseup",this._onDrop),_E(t,"touchend",this._onDrop),_E(t,"pointerup",this._onDrop),_E(t,"touchcancel",this._onDrop),_E(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;hC=HE(nC),pC=HE(nC,n.draggable),tC("drop",this,{evt:t}),iC=nC&&nC.parentNode,hC=HE(nC),pC=HE(nC,n.draggable),WC.eventCanceled||(AC=!1,DC=!1,MC=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),QC(this.cloneId),QC(this._dragStartId),this.nativeDraggable&&(_E(document,"drop",this),_E(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),kE&&NE(document.body,"user-select",""),NE(nC,"transform",""),t&&(SC&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),rC&&rC.parentNode&&rC.parentNode.removeChild(rC),(sC===iC||mC&&"clone"!==mC.lastPutMode)&&lC&&lC.parentNode&&lC.parentNode.removeChild(lC),nC&&(this.nativeDraggable&&_E(nC,"dragend",this),YC(nC),nC.style["will-change"]="",SC&&!AC&&LE(nC,mC?mC.options.ghostClass:this.options.ghostClass,!1),LE(nC,this.options.chosenClass,!1),eC({sortable:this,name:"unchoose",toEl:iC,newIndex:null,newDraggableIndex:null,originalEvent:t}),sC!==iC?(hC>=0&&(eC({rootEl:iC,name:"add",toEl:iC,fromEl:sC,originalEvent:t}),eC({sortable:this,name:"remove",toEl:iC,originalEvent:t}),eC({rootEl:iC,name:"sort",toEl:iC,fromEl:sC,originalEvent:t}),eC({sortable:this,name:"sort",toEl:iC,originalEvent:t})),mC&&mC.save()):hC!==dC&&hC>=0&&(eC({sortable:this,name:"update",toEl:iC,originalEvent:t}),eC({sortable:this,name:"sort",toEl:iC,originalEvent:t})),WC.active&&(null!=hC&&-1!==hC||(hC=dC,pC=uC),eC({sortable:this,name:"end",toEl:iC,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){tC("nulling",this),sC=nC=iC=rC=oC=lC=aC=cC=gC=bC=SC=hC=pC=dC=uC=xC=EC=mC=fC=WC.dragged=WC.ghost=WC.clone=WC.active=null,IC.forEach((function(t){t.checked=!0})),IC.length=vC=yC=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":nC&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],n=this.el.children,i=0,r=n.length,s=this.options;i<r;i++)TE(t=n[i],s.draggable,this.el,!1)&&e.push(t.getAttribute(s.dataIdAttr)||GC(t));return e},sort:function(t,e){var n={},i=this.el;this.toArray().forEach((function(t,e){var r=i.children[e];TE(r,this.options.draggable,i,!1)&&(n[t]=r)}),this),e&&this.captureAnimationState(),t.forEach((function(t){n[t]&&(i.removeChild(n[t]),i.appendChild(n[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return TE(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var i=QE.modifyOption(this,t,e);n[t]=void 0!==i?i:e,"group"===t&&HC(n)},destroy:function(){tC("destroy",this);var t=this.el;t[YE]=null,_E(t,"mousedown",this._onTapStart),_E(t,"touchstart",this._onTapStart),_E(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(_E(t,"dragover",this),_E(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),TC.splice(TC.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!cC){if(tC("hideClone",this),WC.eventCanceled)return;NE(lC,"display","none"),this.options.removeCloneOnHide&&lC.parentNode&&lC.parentNode.removeChild(lC),cC=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(cC){if(tC("showClone",this),WC.eventCanceled)return;nC.parentNode!=sC||this.options.group.revertClone?oC?sC.insertBefore(lC,oC):sC.appendChild(lC):sC.insertBefore(lC,nC),this.options.group.revertClone&&this.animate(nC,lC),NE(lC,"display",""),cC=!1}}else this._hideClone()}},PC&&CE(document,"touchmove",(function(t){(WC.active||AC)&&t.cancelable&&t.preventDefault()})),WC.utils={on:CE,off:_E,css:NE,find:PE,is:function(t,e){return!!TE(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},throttle:UE,closest:TE,toggleClass:LE,clone:KE,index:HE,nextTick:XC,cancelNextTick:QC,detectDirection:jC,getChild:BE},WC.get=function(t){return t[YE]},WC.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(WC.utils=uE(uE({},WC.utils),t.utils)),QE.mount(t)}))},WC.create=function(t,e){return new WC(t,e)},WC.version="1.15.0";var ZC,t_,e_,n_,i_,r_,s_=[],o_=!1;function a_(){s_.forEach((function(t){clearInterval(t.pid)})),s_=[]}function l_(){clearInterval(r_)}var c_=UE((function(t,e,n,i){if(e.scroll){var r,s=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,l=e.scrollSpeed,c=$E(),d=!1;t_!==n&&(t_=n,a_(),ZC=e.scroll,r=e.scrollFn,!0===ZC&&(ZC=VE(n,!0)));var h=0,u=ZC;do{var p=u,f=RE(p),m=f.top,g=f.bottom,b=f.left,v=f.right,y=f.width,w=f.height,k=void 0,S=void 0,x=p.scrollWidth,E=p.scrollHeight,C=NE(p),_=p.scrollLeft,A=p.scrollTop;p===c?(k=y<x&&("auto"===C.overflowX||"scroll"===C.overflowX||"visible"===C.overflowX),S=w<E&&("auto"===C.overflowY||"scroll"===C.overflowY||"visible"===C.overflowY)):(k=y<x&&("auto"===C.overflowX||"scroll"===C.overflowX),S=w<E&&("auto"===C.overflowY||"scroll"===C.overflowY));var O=k&&(Math.abs(v-s)<=a&&_+y<x)-(Math.abs(b-s)<=a&&!!_),T=S&&(Math.abs(g-o)<=a&&A+w<E)-(Math.abs(m-o)<=a&&!!A);if(!s_[h])for(var M=0;M<=h;M++)s_[M]||(s_[M]={});s_[h].vx==O&&s_[h].vy==T&&s_[h].el===p||(s_[h].el=p,s_[h].vx=O,s_[h].vy=T,clearInterval(s_[h].pid),0==O&&0==T||(d=!0,s_[h].pid=setInterval(function(){i&&0===this.layer&&WC.active._onTouchMove(i_);var e=s_[this.layer].vy?s_[this.layer].vy*l:0,n=s_[this.layer].vx?s_[this.layer].vx*l:0;"function"==typeof r&&"continue"!==r.call(WC.dragged.parentNode[YE],n,e,t,i_,s_[this.layer].el)||WE(s_[this.layer].el,n,e)}.bind({layer:h}),24))),h++}while(e.bubbleScroll&&u!==c&&(u=VE(u,!1)));o_=d}}),30),d_=function(t){var e=t.originalEvent,n=t.putSortable,i=t.dragEl,r=t.activeSortable,s=t.dispatchSortableEvent,o=t.hideGhostForTarget,a=t.unhideGhostForTarget;if(e){var l=n||r;o();var c=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,d=document.elementFromPoint(c.clientX,c.clientY);a(),l&&!l.el.contains(d)&&(s("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function h_(){}function u_(){}h_.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=BE(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(e,i):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:d_},mE(h_,{pluginName:"revertOnSpill"}),u_.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable||this.sortable;n.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),n.animateAll()},drop:d_},mE(u_,{pluginName:"removeOnSpill"}),WC.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?CE(document,"dragover",this._handleAutoScroll):this.options.supportPointer?CE(document,"pointermove",this._handleFallbackAutoScroll):e.touches?CE(document,"touchmove",this._handleFallbackAutoScroll):CE(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?_E(document,"dragover",this._handleAutoScroll):(_E(document,"pointermove",this._handleFallbackAutoScroll),_E(document,"touchmove",this._handleFallbackAutoScroll),_E(document,"mousemove",this._handleFallbackAutoScroll)),l_(),a_(),clearTimeout(ME),ME=void 0},nulling:function(){i_=t_=ZC=o_=r_=e_=n_=null,s_.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n=this,i=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,s=document.elementFromPoint(i,r);if(i_=t,e||this.options.forceAutoScrollFallback||yE||vE||kE){c_(t,this.options,s,e);var o=VE(s,!0);!o_||r_&&i===e_&&r===n_||(r_&&l_(),r_=setInterval((function(){var s=VE(document.elementFromPoint(i,r),!0);s!==o&&(o=s,a_()),c_(t,n.options,s,e)}),10),e_=i,n_=r)}else{if(!this.options.bubbleScroll||VE(s,!0)===$E())return void a_();c_(t,this.options,VE(s,!1),!1)}}},mE(t,{pluginName:"scroll",initializeByDefault:!0})}),WC.mount(u_,h_);class p_{constructor(t){this.response=t}get statusCode(){return this.response.status}get redirected(){return this.response.redirected}get ok(){return this.response.ok}get unauthenticated(){return 401===this.statusCode}get unprocessableEntity(){return 422===this.statusCode}get authenticationURL(){return this.response.headers.get("WWW-Authenticate")}get contentType(){return(this.response.headers.get("Content-Type")||"").replace(/;.*$/,"")}get headers(){return this.response.headers}get html(){return this.contentType.match(/^(application|text)\/(html|xhtml\+xml)$/)?this.text:Promise.reject(new Error(`Expected an HTML response but got "${this.contentType}" instead`))}get json(){return this.contentType.match(/^application\/.*json$/)?this.responseJson||(this.responseJson=this.response.json()):Promise.reject(new Error(`Expected a JSON response but got "${this.contentType}" instead`))}get text(){return this.responseText||(this.responseText=this.response.text())}get isTurboStream(){return this.contentType.match(/^text\/vnd\.turbo-stream\.html/)}async renderTurboStream(){if(!this.isTurboStream)return Promise.reject(new Error(`Expected a Turbo Stream response but got "${this.contentType}" instead`));window.Turbo?await window.Turbo.renderStreamMessage(await this.text):console.warn("You must set `window.Turbo = Turbo` to automatically process Turbo Stream events with request.js")}}class f_{static register(t){this.interceptor=t}static get(){return this.interceptor}static reset(){this.interceptor=void 0}}function m_(t){const e=document.head.querySelector(`meta[name="${t}"]`);return e&&e.content}class g_{constructor(t,e,n={}){this.method=t,this.options=n,this.originalUrl=e.toString()}async perform(){try{const t=f_.get();t&&await t(this)}catch(t){console.error(t)}const t=new p_(await window.fetch(this.url,this.fetchOptions));return t.unauthenticated&&t.authenticationURL?Promise.reject(window.location.href=t.authenticationURL):(t.ok&&t.isTurboStream&&await t.renderTurboStream(),t)}addHeader(t,e){const n=this.additionalHeaders;n[t]=e,this.options.headers=n}sameHostname(){if(!this.originalUrl.startsWith("http:"))return!0;try{return new URL(this.originalUrl).hostname===window.location.hostname}catch(t){return!0}}get fetchOptions(){return{method:this.method.toUpperCase(),headers:this.headers,body:this.formattedBody,signal:this.signal,credentials:"same-origin",redirect:this.redirect}}get headers(){const t={"X-Requested-With":"XMLHttpRequest","Content-Type":this.contentType,Accept:this.accept};return this.sameHostname()&&(t["X-CSRF-Token"]=this.csrfToken),function(t){const e={};for(const n in t){const i=t[n];void 0!==i&&(e[n]=i)}return e}(Object.assign(t,this.additionalHeaders))}get csrfToken(){return function(t){const e=document.cookie?document.cookie.split("; "):[],n=`${encodeURIComponent(t)}=`,i=e.find((t=>t.startsWith(n)));if(i){const t=i.split("=").slice(1).join("=");if(t)return decodeURIComponent(t)}}(m_("csrf-param"))||m_("csrf-token")}get contentType(){return this.options.contentType?this.options.contentType:null==this.body||this.body instanceof window.FormData?void 0:this.body instanceof window.File?this.body.type:"application/json"}get accept(){switch(this.responseKind){case"html":return"text/html, application/xhtml+xml";case"turbo-stream":return"text/vnd.turbo-stream.html, text/html, application/xhtml+xml";case"json":return"application/json, application/vnd.api+json";default:return"*/*"}}get body(){return this.options.body}get query(){const t=(this.originalUrl.split("?")[1]||"").split("#")[0],e=new URLSearchParams(t);let n=this.options.query;var i;n instanceof window.FormData?(i=n,n=[...i].reduce(((t,[e,n])=>t.concat("string"==typeof n?[[e,n]]:[])),[])):n=n instanceof window.URLSearchParams?n.entries():Object.entries(n||{}),function(t,e){for(const[n,i]of e)i instanceof window.File||(t.has(n)&&!n.includes("[]")?(t.delete(n),t.set(n,i)):t.append(n,i))}(e,n);const r=e.toString();return r.length>0?`?${r}`:""}get url(){return this.originalUrl.split("?")[0].split("#")[0]+this.query}get responseKind(){return this.options.responseKind||"html"}get signal(){return this.options.signal}get redirect(){return this.options.redirect||"follow"}get additionalHeaders(){return this.options.headers||{}}get formattedBody(){const t="[object String]"===Object.prototype.toString.call(this.body);return"application/json"===this.headers["Content-Type"]&&!t?JSON.stringify(this.body):this.body}}class b_ extends pS{initialize(){this.onUpdate=this.onUpdate.bind(this)}connect(){this.sortable=new WC(this.element,{...this.defaultOptions,...this.options})}disconnect(){this.sortable.destroy(),this.sortable=void 0}async onUpdate({item:t,newIndex:e}){if(!t.dataset.sortableUpdateUrl)return;const n=this.resourceNameValue?`${this.resourceNameValue}[${this.paramNameValue}]`:this.paramNameValue,i=new FormData;i.append(n,e+1),await async function(t,e){return new g_("patch",t,e).perform()}(t.dataset.sortableUpdateUrl,{body:i,responseKind:this.responseKindValue})}get options(){return{animation:this.animationValue||this.defaultOptions.animation||150,handle:this.handleValue||this.defaultOptions.handle||void 0,onUpdate:this.onUpdate}}get defaultOptions(){return{}}}function v_(){Turbo.navigator.delegate.adapter.progressBar.setValue(0),Turbo.navigator.delegate.adapter.progressBar.show()}function y_(){Turbo.navigator.delegate.adapter.progressBar.setValue(1),Turbo.navigator.delegate.adapter.progressBar.hide()}function w_(t){return new Promise((e=>{v_(),e(t.then(y_))})),t}function k_(t,e){return w_(new g_("get",t,e).perform())}function S_(t,e){return w_(new g_("patch",t,e).perform())}b_.values={resourceName:String,paramName:{type:String,default:"position"},responseKind:{type:String,default:"html"},animation:Number,handle:String},f_.register((async t=>{t.addHeader("Authorization",`Bearer ${AypexAdmin.authorization.oauth_token}`)}));var x_=Object.freeze({__proto__:null,showProgressBar:v_,hideProgressBar:y_,withProgress:w_,get:k_,post:function(t,e){return w_(new g_("post",t,e).perform())},put:function(t,e){return w_(new g_("put",t,e).perform())},patch:S_,destroy:function(t,e){return w_(new g_("delete",t,e).perform())}});function E_(t,e){t.split(/\s+/).forEach((t=>{e(t)}))}class C_{constructor(){this._events=void 0,this._events={}}on(t,e){E_(t,(t=>{const n=this._events[t]||[];n.push(e),this._events[t]=n}))}off(t,e){var n=arguments.length;0!==n?E_(t,(t=>{if(1===n)return void delete this._events[t];const i=this._events[t];void 0!==i&&(i.splice(i.indexOf(e),1),this._events[t]=i)})):this._events={}}trigger(t,...e){var n=this;E_(t,(t=>{const i=n._events[t];void 0!==i&&i.forEach((t=>{t.apply(n,e)}))}))}}
/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */
const __=t=>(t=t.filter(Boolean)).length<2?t[0]||"":1==D_(t)?"["+t.join("")+"]":"(?:"+t.join("|")+")",A_=t=>{if(!T_(t))return t.join("");let e="",n=0;const i=()=>{n>1&&(e+="{"+n+"}")};return t.forEach(((r,s)=>{r!==t[s-1]?(i(),e+=r,n=1):n++})),i(),e},O_=t=>{let e=N_(t);return __(e)},T_=t=>new Set(t).size!==t.length,M_=t=>(t+"").replace(/([\$\(\)\*\+\.\?\[\]\^\{\|\}\\])/gu,"\\$1"),D_=t=>t.reduce(((t,e)=>Math.max(t,L_(e))),0),L_=t=>N_(t).length,N_=t=>Array.from(t)
/*! @orchidjs/unicode-variants | https://github.com/orchidjs/unicode-variants | Apache License (v2) */,I_=t=>{if(1===t.length)return[[t]];let e=[];const n=t.substring(1);return I_(n).forEach((function(n){let i=n.slice(0);i[0]=t.charAt(0)+i[0],e.push(i),i=n.slice(0),i.unshift(t.charAt(0)),e.push(i)})),e},P_=[[0,65535]];let $_,R_;const F_={},B_={"/":"⁄∕",0:"߀",a:"ⱥɐɑ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"ƀɓƃ",c:"ꜿƈȼↄ",d:"đɗɖᴅƌꮷԁɦ",e:"ɛǝᴇɇ",f:"ꝼƒ",g:"ǥɠꞡᵹꝿɢ",h:"ħⱨⱶɥ",i:"ɨı",j:"ɉȷ",k:"ƙⱪꝁꝃꝅꞣ",l:"łƚɫⱡꝉꝇꞁɭ",m:"ɱɯϻ",n:"ꞥƞɲꞑᴎлԉ",o:"øǿɔɵꝋꝍᴑ",oe:"œ",oi:"ƣ",oo:"ꝏ",ou:"ȣ",p:"ƥᵽꝑꝓꝕρ",q:"ꝗꝙɋ",r:"ɍɽꝛꞧꞃ",s:"ßȿꞩꞅʂ",t:"ŧƭʈⱦꞇ",th:"þ",tz:"ꜩ",u:"ʉ",v:"ʋꝟʌ",vy:"ꝡ",w:"ⱳ",y:"ƴɏỿ",z:"ƶȥɀⱬꝣ",hv:"ƕ"};for(let t in B_){let e=B_[t]||"";for(let n=0;n<e.length;n++){let i=e.substring(n,n+1);F_[i]=t}}const j_=new RegExp(Object.keys(F_).join("|")+"|[̀-ͯ·ʾʼ]","gu"),H_=(t,e="NFKD")=>t.normalize(e),z_=t=>N_(t).reduce(((t,e)=>t+V_(e)),""),V_=t=>(t=H_(t).toLowerCase().replace(j_,(t=>F_[t]||"")),H_(t,"NFC"));const q_=t=>{const e={},n=(t,n)=>{const i=e[t]||new Set,r=new RegExp("^"+O_(i)+"$","iu");n.match(r)||(i.add(M_(n)),e[t]=i)};for(let e of function*(t){for(const[e,n]of t)for(let t=e;t<=n;t++){let e=String.fromCharCode(t),n=z_(e);n!=e.toLowerCase()&&(n.length>3||0!=n.length&&(yield{folded:n,composed:e,code_point:t}))}}(t))n(e.folded,e.folded),n(e.folded,e.composed);return e},U_=t=>{const e=q_(t),n={};let i=[];for(let t in e){let r=e[t];r&&(n[t]=O_(r)),t.length>1&&i.push(M_(t))}i.sort(((t,e)=>e.length-t.length));const r=__(i);return R_=new RegExp("^"+r,"u"),n},W_=(t,e=1)=>(e=Math.max(e,t.length-1),__(I_(t).map((t=>((t,e=1)=>{let n=0;return t=t.map((t=>($_[t]&&(n+=t.length),$_[t]||t))),n>=e?A_(t):""})(t,e))))),K_=(t,e=!0)=>{let n=t.length>1?1:0;return __(t.map((t=>{let i=[];const r=e?t.length():t.length()-1;for(let e=0;e<r;e++)i.push(W_(t.substrs[e]||"",n));return A_(i)})))},Y_=(t,e)=>{for(const n of e){if(n.start!=t.start||n.end!=t.end)continue;if(n.substrs.join("")!==t.substrs.join(""))continue;let e=t.parts;const i=t=>{for(const n of e){if(n.start===t.start&&n.substr===t.substr)return!1;if(1!=t.length&&1!=n.length){if(t.start<n.start&&t.end>n.start)return!0;if(n.start<t.start&&n.end>t.start)return!0}}return!1};if(!(n.parts.filter(i).length>0))return!0}return!1};class J_{constructor(){this.parts=[],this.substrs=[],this.start=0,this.end=0}add(t){t&&(this.parts.push(t),this.substrs.push(t.substr),this.start=Math.min(t.start,this.start),this.end=Math.max(t.end,this.end))}last(){return this.parts[this.parts.length-1]}length(){return this.parts.length}clone(t,e){let n=new J_,i=JSON.parse(JSON.stringify(this.parts)),r=i.pop();for(const t of i)n.add(t);let s=e.substr.substring(0,t-r.start),o=s.length;return n.add({start:r.start,end:r.start+o,length:o,substr:s}),n}}const G_=t=>{var e;void 0===$_&&($_=U_(e||P_)),t=z_(t);let n="",i=[new J_];for(let e=0;e<t.length;e++){let r=t.substring(e).match(R_);const s=t.substring(e,e+1),o=r?r[0]:null;let a=[],l=new Set;for(const t of i){const n=t.last();if(!n||1==n.length||n.end<=e)if(o){const n=o.length;t.add({start:e,end:e+n,length:n,substr:o}),l.add("1")}else t.add({start:e,end:e+1,length:1,substr:s}),l.add("2");else if(o){let i=t.clone(e,n);const r=o.length;i.add({start:e,end:e+r,length:r,substr:o}),a.push(i)}else l.add("3")}if(a.length>0){a=a.sort(((t,e)=>t.length()-e.length()));for(let t of a)Y_(t,i)||i.push(t)}else if(e>0&&1==l.size&&!l.has("3")){n+=K_(i,!1);let t=new J_;const e=i[0];e&&t.add(e.last()),i=[t]}}return n+=K_(i,!0),n},X_=(t,e)=>{if(t)return t[e]},Q_=(t,e)=>{if(t){for(var n,i=e.split(".");(n=i.shift())&&(t=t[n]););return t}},Z_=(t,e,n)=>{var i,r;return t?(t+="",null==e.regex||-1===(r=t.search(e.regex))?0:(i=e.string.length/t.length,0===r&&(i+=.5),i*n)):0},tA=(t,e)=>{var n=t[e];if("function"==typeof n)return n;n&&!Array.isArray(n)&&(t[e]=[n])},eA=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)},nA=(t,e)=>"number"==typeof t&&"number"==typeof e?t>e?1:t<e?-1:0:(t=z_(t+"").toLowerCase())>(e=z_(e+"").toLowerCase())?1:e>t?-1:0;
/*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) */
/*! sifter.js | https://github.com/orchidjs/sifter.js | Apache License (v2) */
class iA{constructor(t,e){this.items=void 0,this.settings=void 0,this.items=t,this.settings=e||{diacritics:!0}}tokenize(t,e,n){if(!t||!t.length)return[];const i=[],r=t.split(/\s+/);var s;return n&&(s=new RegExp("^("+Object.keys(n).map(M_).join("|")+"):(.*)$")),r.forEach((t=>{let n,r=null,o=null;s&&(n=t.match(s))&&(r=n[1],t=n[2]),t.length>0&&(o=this.settings.diacritics?G_(t)||null:M_(t),o&&e&&(o="\\b"+o)),i.push({string:t,regex:o?new RegExp(o,"iu"):null,field:r})})),i}getScoreFunction(t,e){var n=this.prepareSearch(t,e);return this._getScoreFunction(n)}_getScoreFunction(t){const e=t.tokens,n=e.length;if(!n)return function(){return 0};const i=t.options.fields,r=t.weights,s=i.length,o=t.getAttrFn;if(!s)return function(){return 1};const a=1===s?function(t,e){const n=i[0].field;return Z_(o(e,n),t,r[n]||1)}:function(t,e){var n=0;if(t.field){const i=o(e,t.field);!t.regex&&i?n+=1/s:n+=Z_(i,t,1)}else eA(r,((i,r)=>{n+=Z_(o(e,r),t,i)}));return n/s};return 1===n?function(t){return a(e[0],t)}:"and"===t.options.conjunction?function(t){var i,r=0;for(let n of e){if((i=a(n,t))<=0)return 0;r+=i}return r/n}:function(t){var i=0;return eA(e,(e=>{i+=a(e,t)})),i/n}}getSortFunction(t,e){var n=this.prepareSearch(t,e);return this._getSortFunction(n)}_getSortFunction(t){var e,n=[];const i=this,r=t.options,s=!t.query&&r.sort_empty?r.sort_empty:r.sort;if("function"==typeof s)return s.bind(this);const o=function(e,n){return"$score"===e?n.score:t.getAttrFn(i.items[n.id],e)};if(s)for(let e of s)(t.query||"$score"!==e.field)&&n.push(e);if(t.query){e=!0;for(let t of n)if("$score"===t.field){e=!1;break}e&&n.unshift({field:"$score",direction:"desc"})}else n=n.filter((t=>"$score"!==t.field));return n.length?function(t,e){var i,r;for(let s of n){if(r=s.field,i=("desc"===s.direction?-1:1)*nA(o(r,t),o(r,e)))return i}return 0}:null}prepareSearch(t,e){const n={};var i=Object.assign({},e);if(tA(i,"sort"),tA(i,"sort_empty"),i.fields){tA(i,"fields");const t=[];i.fields.forEach((e=>{"string"==typeof e&&(e={field:e,weight:1}),t.push(e),n[e.field]="weight"in e?e.weight:1})),i.fields=t}return{options:i,query:t.toLowerCase().trim(),tokens:this.tokenize(t,i.respect_word_boundaries,n),total:0,items:[],weights:n,getAttrFn:i.nesting?Q_:X_}}search(t,e){var n,i,r=this;i=this.prepareSearch(t,e),e=i.options,t=i.query;const s=e.score||r._getScoreFunction(i);t.length?eA(r.items,((t,r)=>{n=s(t),(!1===e.filter||n>0)&&i.items.push({score:n,id:r})})):eA(r.items,((t,e)=>{i.items.push({score:1,id:e})}));const o=r._getSortFunction(i);return o&&i.items.sort(o),i.total=i.items.length,"number"==typeof e.limit&&(i.items=i.items.slice(0,e.limit)),i}}const rA=(t,e)=>{if(Array.isArray(t))t.forEach(e);else for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)},sA=t=>{if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(oA(t)){var e=document.createElement("template");return e.innerHTML=t.trim(),e.content.firstChild}return document.querySelector(t)},oA=t=>"string"==typeof t&&t.indexOf("<")>-1,aA=(t,e)=>{var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)},lA=(t,e)=>{Object.assign(t.style,e)},cA=(t,...e)=>{var n=hA(e);(t=uA(t)).map((t=>{n.map((e=>{t.classList.add(e)}))}))},dA=(t,...e)=>{var n=hA(e);(t=uA(t)).map((t=>{n.map((e=>{t.classList.remove(e)}))}))},hA=t=>{var e=[];return rA(t,(t=>{"string"==typeof t&&(t=t.trim().split(/[\11\12\14\15\40]/)),Array.isArray(t)&&(e=e.concat(t))})),e.filter(Boolean)},uA=t=>(Array.isArray(t)||(t=[t]),t),pA=(t,e,n)=>{if(!n||n.contains(t))for(;t&&t.matches;){if(t.matches(e))return t;t=t.parentNode}},fA=(t,e=0)=>e>0?t[t.length-1]:t[0],mA=(t,e)=>{if(!t)return-1;e=e||t.nodeName;for(var n=0;t=t.previousElementSibling;)t.matches(e)&&n++;return n},gA=(t,e)=>{rA(e,((e,n)=>{null==e?t.removeAttribute(n):t.setAttribute(n,""+e)}))},bA=(t,e)=>{t.parentNode&&t.parentNode.replaceChild(e,t)},vA=(t,e)=>{if(null===e)return;if("string"==typeof e){if(!e.length)return;e=new RegExp(e,"i")}const n=t=>3===t.nodeType?(t=>{var n=t.data.match(e);if(n&&t.data.length>0){var i=document.createElement("span");i.className="highlight";var r=t.splitText(n.index);r.splitText(n[0].length);var s=r.cloneNode(!0);return i.appendChild(s),bA(r,i),1}return 0})(t):((t=>{1!==t.nodeType||!t.childNodes||/(script|style)/i.test(t.tagName)||"highlight"===t.className&&"SPAN"===t.tagName||Array.from(t.childNodes).forEach((t=>{n(t)}))})(t),0);n(t)},yA="undefined"!=typeof navigator&&/Mac/.test(navigator.userAgent)?"metaKey":"ctrlKey";var wA={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:null,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,shouldOpen:null,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:null,allowEmptyOption:!1,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-wrapper",controlClass:"ts-control",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:'<input type="text" autocomplete="off" size="1" />',copyClassesToDropdown:!1,placeholder:null,hidePlaceholder:null,shouldLoad:function(t){return t.length>0},render:{}};const kA=t=>null==t?null:SA(t),SA=t=>"boolean"==typeof t?t?"1":"0":t+"",xA=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),EA=(t,e)=>{var n;return function(i,r){var s=this;n&&(s.loading=Math.max(s.loading-1,0),clearTimeout(n)),n=setTimeout((function(){n=null,s.loadedSearches[i]=!0,t.call(s,i,r)}),e)}},CA=(t,e,n)=>{var i,r=t.trigger,s={};for(i of(t.trigger=function(){var n=arguments[0];if(-1===e.indexOf(n))return r.apply(t,arguments);s[n]=arguments},n.apply(t,[]),t.trigger=r,e))i in s&&r.apply(t,s[i])},_A=(t,e=!1)=>{t&&(t.preventDefault(),e&&t.stopPropagation())},AA=(t,e,n,i)=>{t.addEventListener(e,n,i)},OA=(t,e)=>!!e&&(!!e[t]&&1===(e.altKey?1:0)+(e.ctrlKey?1:0)+(e.shiftKey?1:0)+(e.metaKey?1:0)),TA=(t,e)=>{const n=t.getAttribute("id");return n||(t.setAttribute("id",e),e)},MA=t=>t.replace(/[\\"']/g,"\\$&"),DA=(t,e)=>{e&&t.append(e)};function LA(t,e){var n=Object.assign({},wA,e),i=n.dataAttr,r=n.labelField,s=n.valueField,o=n.disabledField,a=n.optgroupField,l=n.optgroupLabelField,c=n.optgroupValueField,d=t.tagName.toLowerCase(),h=t.getAttribute("placeholder")||t.getAttribute("data-placeholder");if(!h&&!n.allowEmptyOption){let e=t.querySelector('option[value=""]');e&&(h=e.textContent)}var u={placeholder:h,options:[],optgroups:[],items:[],maxItems:null};return"select"===d?(()=>{var e,d=u.options,h={},p=1,f=t=>{var e=Object.assign({},t.dataset),n=i&&e[i];return"string"==typeof n&&n.length&&(e=Object.assign(e,JSON.parse(n))),e},m=(t,e)=>{var i=kA(t.value);if(null!=i&&(i||n.allowEmptyOption)){if(h.hasOwnProperty(i)){if(e){var l=h[i][a];l?Array.isArray(l)?l.push(e):h[i][a]=[l,e]:h[i][a]=e}}else{var c=f(t);c[r]=c[r]||t.textContent,c[s]=c[s]||i,c[o]=c[o]||t.disabled,c[a]=c[a]||e,c.$option=t,h[i]=c,d.push(c)}t.selected&&u.items.push(i)}};u.maxItems=t.hasAttribute("multiple")?null:1,rA(t.children,(t=>{"optgroup"===(e=t.tagName.toLowerCase())?(t=>{var e,n;(n=f(t))[l]=n[l]||t.getAttribute("label")||"",n[c]=n[c]||p++,n[o]=n[o]||t.disabled,u.optgroups.push(n),e=n[c],rA(t.children,(t=>{m(t,e)}))})(t):"option"===e&&m(t)}))})():(()=>{const e=t.getAttribute(i);if(e)u.options=JSON.parse(e),rA(u.options,(t=>{u.items.push(t[s])}));else{var o=t.value.trim()||"";if(!n.allowEmptyOption&&!o.length)return;const e=o.split(n.delimiter);rA(e,(t=>{const e={};e[r]=t,e[s]=t,u.options.push(e)})),u.items=e}})(),Object.assign({},wA,u,e)}var NA=0;class IA extends(function(t){return t.plugins={},class extends t{constructor(...t){super(...t),this.plugins={names:[],settings:{},requested:{},loaded:{}}}static define(e,n){t.plugins[e]={name:e,fn:n}}initializePlugins(t){var e,n;const i=this,r=[];if(Array.isArray(t))t.forEach((t=>{"string"==typeof t?r.push(t):(i.plugins.settings[t.name]=t.options,r.push(t.name))}));else if(t)for(e in t)t.hasOwnProperty(e)&&(i.plugins.settings[e]=t[e],r.push(e));for(;n=r.shift();)i.require(n)}loadPlugin(e){var n=this,i=n.plugins,r=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=r.fn.apply(n,[n.plugins.settings[e]||{}]),i.names.push(e)}require(t){var e=this,n=e.plugins;if(!e.plugins.loaded.hasOwnProperty(t)){if(n.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');e.loadPlugin(t)}return n.loaded[t]}}}(C_)){constructor(t,e){var n;super(),this.control_input=void 0,this.wrapper=void 0,this.dropdown=void 0,this.control=void 0,this.dropdown_content=void 0,this.focus_node=void 0,this.order=0,this.settings=void 0,this.input=void 0,this.tabIndex=void 0,this.is_select_tag=void 0,this.rtl=void 0,this.inputId=void 0,this._destroy=void 0,this.sifter=void 0,this.isOpen=!1,this.isDisabled=!1,this.isRequired=void 0,this.isInvalid=!1,this.isValid=!0,this.isLocked=!1,this.isFocused=!1,this.isInputHidden=!1,this.isSetup=!1,this.ignoreFocus=!1,this.ignoreHover=!1,this.hasOptions=!1,this.currentResults=void 0,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.activeOption=null,this.activeItems=[],this.optgroups={},this.options={},this.userOptions={},this.items=[],NA++;var i=sA(t);if(i.tomselect)throw new Error("Tom Select already initialized on this element");i.tomselect=this,n=(window.getComputedStyle&&window.getComputedStyle(i,null)).getPropertyValue("direction");const r=LA(i,e);this.settings=r,this.input=i,this.tabIndex=i.tabIndex||0,this.is_select_tag="select"===i.tagName.toLowerCase(),this.rtl=/rtl/i.test(n),this.inputId=TA(i,"tomselect-"+NA),this.isRequired=i.required,this.sifter=new iA(this.options,{diacritics:r.diacritics}),r.mode=r.mode||(1===r.maxItems?"single":"multi"),"boolean"!=typeof r.hideSelected&&(r.hideSelected="multi"===r.mode),"boolean"!=typeof r.hidePlaceholder&&(r.hidePlaceholder="multi"!==r.mode);var s=r.createFilter;"function"!=typeof s&&("string"==typeof s&&(s=new RegExp(s)),s instanceof RegExp?r.createFilter=t=>s.test(t):r.createFilter=t=>this.settings.duplicates||!this.options[t]),this.initializePlugins(r.plugins),this.setupCallbacks(),this.setupTemplates();const o=sA("<div>"),a=sA("<div>"),l=this._render("dropdown"),c=sA('<div role="listbox" tabindex="-1">'),d=this.input.getAttribute("class")||"",h=r.mode;var u;if(cA(o,r.wrapperClass,d,h),cA(a,r.controlClass),DA(o,a),cA(l,r.dropdownClass,h),r.copyClassesToDropdown&&cA(l,d),cA(c,r.dropdownContentClass),DA(l,c),sA(r.dropdownParent||o).appendChild(l),oA(r.controlInput)){u=sA(r.controlInput);eA(["autocorrect","autocapitalize","autocomplete"],(t=>{i.getAttribute(t)&&gA(u,{[t]:i.getAttribute(t)})})),u.tabIndex=-1,a.appendChild(u),this.focus_node=u}else r.controlInput?(u=sA(r.controlInput),this.focus_node=u):(u=sA("<input/>"),this.focus_node=a);this.wrapper=o,this.dropdown=l,this.dropdown_content=c,this.control=a,this.control_input=u,this.setup()}setup(){const t=this,e=t.settings,n=t.control_input,i=t.dropdown,r=t.dropdown_content,s=t.wrapper,o=t.control,a=t.input,l=t.focus_node,c={passive:!0},d=t.inputId+"-ts-dropdown";gA(r,{id:d}),gA(l,{role:"combobox","aria-haspopup":"listbox","aria-expanded":"false","aria-controls":d});const h=TA(l,t.inputId+"-ts-control"),u="label[for='"+(t=>t.replace(/['"\\]/g,"\\$&"))(t.inputId)+"']",p=document.querySelector(u),f=t.focus.bind(t);if(p){AA(p,"click",f),gA(p,{for:h});const e=TA(p,t.inputId+"-ts-label");gA(l,{"aria-labelledby":e}),gA(r,{"aria-labelledby":e})}if(s.style.width=a.style.width,t.plugins.names.length){const e="plugin-"+t.plugins.names.join(" plugin-");cA([s,i],e)}(null===e.maxItems||e.maxItems>1)&&t.is_select_tag&&gA(a,{multiple:"multiple"}),e.placeholder&&gA(n,{placeholder:e.placeholder}),!e.splitOn&&e.delimiter&&(e.splitOn=new RegExp("\\s*"+M_(e.delimiter)+"+\\s*")),e.load&&e.loadThrottle&&(e.load=EA(e.load,e.loadThrottle)),t.control_input.type=a.type,AA(i,"mousemove",(()=>{t.ignoreHover=!1})),AA(i,"mouseenter",(e=>{var n=pA(e.target,"[data-selectable]",i);n&&t.onOptionHover(e,n)}),{capture:!0}),AA(i,"click",(e=>{const n=pA(e.target,"[data-selectable]");n&&(t.onOptionSelect(e,n),_A(e,!0))})),AA(o,"click",(e=>{var i=pA(e.target,"[data-ts-item]",o);i&&t.onItemSelect(e,i)?_A(e,!0):""==n.value&&(t.onClick(),_A(e,!0))})),AA(l,"keydown",(e=>t.onKeyDown(e))),AA(n,"keypress",(e=>t.onKeyPress(e))),AA(n,"input",(e=>t.onInput(e))),AA(l,"blur",(e=>t.onBlur(e))),AA(l,"focus",(e=>t.onFocus(e))),AA(n,"paste",(e=>t.onPaste(e)));const m=e=>{const r=e.composedPath()[0];if(!s.contains(r)&&!i.contains(r))return t.isFocused&&t.blur(),void t.inputState();r==n&&t.isOpen?e.stopPropagation():_A(e,!0)},g=()=>{t.isOpen&&t.positionDropdown()};AA(document,"mousedown",m),AA(window,"scroll",g,c),AA(window,"resize",g,c),this._destroy=()=>{document.removeEventListener("mousedown",m),window.removeEventListener("scroll",g),window.removeEventListener("resize",g),p&&p.removeEventListener("click",f)},this.revertSettings={innerHTML:a.innerHTML,tabIndex:a.tabIndex},a.tabIndex=-1,a.insertAdjacentElement("afterend",t.wrapper),t.sync(!1),e.items=[],delete e.optgroups,delete e.options,AA(a,"invalid",(()=>{t.isValid&&(t.isValid=!1,t.isInvalid=!0,t.refreshState())})),t.updateOriginalInput(),t.refreshItems(),t.close(!1),t.inputState(),t.isSetup=!0,a.disabled?t.disable():t.enable(),t.on("change",this.onChange),cA(a,"tomselected","ts-hidden-accessible"),t.trigger("initialize"),!0===e.preload&&t.preload()}setupOptions(t=[],e=[]){this.addOptions(t),eA(e,(t=>{this.registerOptionGroup(t)}))}setupTemplates(){var t=this,e=t.settings.labelField,n=t.settings.optgroupLabelField,i={optgroup:t=>{let e=document.createElement("div");return e.className="optgroup",e.appendChild(t.options),e},optgroup_header:(t,e)=>'<div class="optgroup-header">'+e(t[n])+"</div>",option:(t,n)=>"<div>"+n(t[e])+"</div>",item:(t,n)=>"<div>"+n(t[e])+"</div>",option_create:(t,e)=>'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>",no_results:()=>'<div class="no-results">No results found</div>',loading:()=>'<div class="spinner"></div>',not_loading:()=>{},dropdown:()=>"<div></div>"};t.settings.render=Object.assign({},i,t.settings.render)}setupCallbacks(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",item_select:"onItemSelect",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in n)(e=this.settings[n[t]])&&this.on(t,e)}sync(t=!0){const e=this,n=t?LA(e.input,{delimiter:e.settings.delimiter}):e.settings;e.setupOptions(n.options,n.optgroups),e.setValue(n.items||[],!0),e.lastQuery=null}onClick(){var t=this;if(t.activeItems.length>0)return t.clearActiveItems(),void t.focus();t.isFocused&&t.isOpen?t.blur():t.focus()}onMouseDown(){}onChange(){aA(this.input,"input"),aA(this.input,"change")}onPaste(t){var e=this;e.isInputHidden||e.isLocked?_A(t):e.settings.splitOn&&setTimeout((()=>{var t=e.inputValue();if(t.match(e.settings.splitOn)){var n=t.trim().split(e.settings.splitOn);eA(n,(t=>{kA(t)&&(this.options[t]?e.addItem(t):e.createItem(t))}))}}),0)}onKeyPress(t){var e=this;if(!e.isLocked){var n=String.fromCharCode(t.keyCode||t.which);return e.settings.create&&"multi"===e.settings.mode&&n===e.settings.delimiter?(e.createItem(),void _A(t)):void 0}_A(t)}onKeyDown(t){var e=this;if(e.ignoreHover=!0,e.isLocked)9!==t.keyCode&&_A(t);else{switch(t.keyCode){case 65:if(OA(yA,t)&&""==e.control_input.value)return _A(t),void e.selectAll();break;case 27:return e.isOpen&&(_A(t,!0),e.close()),void e.clearActiveItems();case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.activeOption){let t=e.getAdjacent(e.activeOption,1);t&&e.setActiveOption(t)}return void _A(t);case 38:if(e.activeOption){let t=e.getAdjacent(e.activeOption,-1);t&&e.setActiveOption(t)}return void _A(t);case 13:return void(e.canSelect(e.activeOption)?(e.onOptionSelect(t,e.activeOption),_A(t)):(e.settings.create&&e.createItem()||document.activeElement==e.control_input&&e.isOpen)&&_A(t));case 37:return void e.advanceSelection(-1,t);case 39:return void e.advanceSelection(1,t);case 9:return void(e.settings.selectOnTab&&(e.canSelect(e.activeOption)&&(e.onOptionSelect(t,e.activeOption),_A(t)),e.settings.create&&e.createItem()&&_A(t)));case 8:case 46:return void e.deleteSelection(t)}e.isInputHidden&&!OA(yA,t)&&_A(t)}}onInput(t){var e=this;if(!e.isLocked){var n=e.inputValue();e.lastValue!==n&&(e.lastValue=n,e.settings.shouldLoad.call(e,n)&&e.load(n),e.refreshOptions(),e.trigger("type",n))}}onOptionHover(t,e){this.ignoreHover||this.setActiveOption(e,!1)}onFocus(t){var e=this,n=e.isFocused;if(e.isDisabled)return e.blur(),void _A(t);e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.preload(),n||e.trigger("focus"),e.activeItems.length||(e.showInput(),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())}onBlur(t){if(!1!==document.hasFocus()){var e=this;if(e.isFocused){e.isFocused=!1,e.ignoreFocus=!1;var n=()=>{e.close(),e.setActiveItem(),e.setCaret(e.items.length),e.trigger("blur")};e.settings.create&&e.settings.createOnBlur?e.createItem(null,n):n()}}}onOptionSelect(t,e){var n,i=this;e.parentElement&&e.parentElement.matches("[data-disabled]")||(e.classList.contains("create")?i.createItem(null,(()=>{i.settings.closeAfterSelect&&i.close()})):void 0!==(n=e.dataset.value)&&(i.lastQuery=null,i.addItem(n),i.settings.closeAfterSelect&&i.close(),!i.settings.hideSelected&&t.type&&/click/.test(t.type)&&i.setActiveOption(e)))}canSelect(t){return!!(this.isOpen&&t&&this.dropdown_content.contains(t))}onItemSelect(t,e){var n=this;return!n.isLocked&&"multi"===n.settings.mode&&(_A(t),n.setActiveItem(e,t),!0)}canLoad(t){return!!this.settings.load&&!this.loadedSearches.hasOwnProperty(t)}load(t){const e=this;if(!e.canLoad(t))return;cA(e.wrapper,e.settings.loadingClass),e.loading++;const n=e.loadCallback.bind(e);e.settings.load.call(e,t,n)}loadCallback(t,e){const n=this;n.loading=Math.max(n.loading-1,0),n.lastQuery=null,n.clearActiveOption(),n.setupOptions(t,e),n.refreshOptions(n.isFocused&&!n.isInputHidden),n.loading||dA(n.wrapper,n.settings.loadingClass),n.trigger("load",t,e)}preload(){var t=this.wrapper.classList;t.contains("preloaded")||(t.add("preloaded"),this.load(""))}setTextboxValue(t=""){var e=this.control_input;e.value!==t&&(e.value=t,aA(e,"update"),this.lastValue=t)}getValue(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}setValue(t,e){CA(this,e?[]:["change"],(()=>{this.clear(e),this.addItems(t,e)}))}setMaxItems(t){0===t&&(t=null),this.settings.maxItems=t,this.refreshState()}setActiveItem(t,e){var n,i,r,s,o,a,l=this;if("single"!==l.settings.mode){if(!t)return l.clearActiveItems(),void(l.isFocused&&l.showInput());if("click"===(n=e&&e.type.toLowerCase())&&OA("shiftKey",e)&&l.activeItems.length){for(a=l.getLastActive(),(r=Array.prototype.indexOf.call(l.control.children,a))>(s=Array.prototype.indexOf.call(l.control.children,t))&&(o=r,r=s,s=o),i=r;i<=s;i++)t=l.control.children[i],-1===l.activeItems.indexOf(t)&&l.setActiveItemClass(t);_A(e)}else"click"===n&&OA(yA,e)||"keydown"===n&&OA("shiftKey",e)?t.classList.contains("active")?l.removeActiveItem(t):l.setActiveItemClass(t):(l.clearActiveItems(),l.setActiveItemClass(t));l.hideInput(),l.isFocused||l.focus()}}setActiveItemClass(t){const e=this,n=e.control.querySelector(".last-active");n&&dA(n,"last-active"),cA(t,"active last-active"),e.trigger("item_select",t),-1==e.activeItems.indexOf(t)&&e.activeItems.push(t)}removeActiveItem(t){var e=this.activeItems.indexOf(t);this.activeItems.splice(e,1),dA(t,"active")}clearActiveItems(){dA(this.activeItems,"active"),this.activeItems=[]}setActiveOption(t,e=!0){t!==this.activeOption&&(this.clearActiveOption(),t&&(this.activeOption=t,gA(this.focus_node,{"aria-activedescendant":t.getAttribute("id")}),gA(t,{"aria-selected":"true"}),cA(t,"active"),e&&this.scrollToOption(t)))}scrollToOption(t,e){if(!t)return;const n=this.dropdown_content,i=n.clientHeight,r=n.scrollTop||0,s=t.offsetHeight,o=t.getBoundingClientRect().top-n.getBoundingClientRect().top+r;o+s>i+r?this.scroll(o-i+s,e):o<r&&this.scroll(o,e)}scroll(t,e){const n=this.dropdown_content;e&&(n.style.scrollBehavior=e),n.scrollTop=t,n.style.scrollBehavior=""}clearActiveOption(){this.activeOption&&(dA(this.activeOption,"active"),gA(this.activeOption,{"aria-selected":null})),this.activeOption=null,gA(this.focus_node,{"aria-activedescendant":null})}selectAll(){const t=this;if("single"===t.settings.mode)return;const e=t.controlChildren();e.length&&(t.hideInput(),t.close(),t.activeItems=e,eA(e,(e=>{t.setActiveItemClass(e)})))}inputState(){var t=this;t.control.contains(t.control_input)&&(gA(t.control_input,{placeholder:t.settings.placeholder}),t.activeItems.length>0||!t.isFocused&&t.settings.hidePlaceholder&&t.items.length>0?(t.setTextboxValue(),t.isInputHidden=!0):(t.settings.hidePlaceholder&&t.items.length>0&&gA(t.control_input,{placeholder:""}),t.isInputHidden=!1),t.wrapper.classList.toggle("input-hidden",t.isInputHidden))}hideInput(){this.inputState()}showInput(){this.inputState()}inputValue(){return this.control_input.value.trim()}focus(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.control_input.offsetWidth?t.control_input.focus():t.focus_node.focus(),setTimeout((()=>{t.ignoreFocus=!1,t.onFocus()}),0))}blur(){this.focus_node.blur(),this.onBlur()}getScoreFunction(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())}getSearchOptions(){var t=this.settings,e=t.sortField;return"string"==typeof t.sortField&&(e=[{field:t.sortField}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}}search(t){var e,n,i=this,r=this.getSearchOptions();if(i.settings.score&&"function"!=typeof(n=i.settings.score.call(i,t)))throw new Error('Tom Select "score" setting must be a function that returns a function');return t!==i.lastQuery?(i.lastQuery=t,e=i.sifter.search(t,Object.assign(r,{score:n})),i.currentResults=e):e=Object.assign({},i.currentResults),i.settings.hideSelected&&(e.items=e.items.filter((t=>{let e=kA(t.id);return!(e&&-1!==i.items.indexOf(e))}))),e}refreshOptions(t=!0){var e,n,i,r,s,o,a,l,c,d;const h={},u=[];var p=this,f=p.inputValue();const m=f===p.lastQuery||""==f&&null==p.lastQuery;var g=p.search(f),b=null,v=p.settings.shouldOpen||!1,y=p.dropdown_content;for(m&&(b=p.activeOption)&&(c=b.closest("[data-group]")),r=g.items.length,"number"==typeof p.settings.maxOptions&&(r=Math.min(r,p.settings.maxOptions)),r>0&&(v=!0),e=0;e<r;e++){let t=g.items[e];if(!t)continue;let r=t.id,a=p.options[r];if(void 0===a)continue;let l=SA(r),d=p.getOption(l,!0);for(p.settings.hideSelected||d.classList.toggle("selected",p.items.includes(l)),s=a[p.settings.optgroupField]||"",n=0,i=(o=Array.isArray(s)?s:[s])&&o.length;n<i;n++){s=o[n],p.optgroups.hasOwnProperty(s)||(s="");let t=h[s];void 0===t&&(t=document.createDocumentFragment(),u.push(s)),n>0&&(d=d.cloneNode(!0),gA(d,{id:a.$id+"-clone-"+n,"aria-selected":null}),d.classList.add("ts-cloned"),dA(d,"active"),p.activeOption&&p.activeOption.dataset.value==r&&c&&c.dataset.group===s.toString()&&(b=d)),t.appendChild(d),h[s]=t}}p.settings.lockOptgroupOrder&&u.sort(((t,e)=>{const n=p.optgroups[t],i=p.optgroups[e];return(n&&n.$order||0)-(i&&i.$order||0)})),a=document.createDocumentFragment(),eA(u,(t=>{let e=h[t];if(!e||!e.children.length)return;let n=p.optgroups[t];if(void 0!==n){let t=document.createDocumentFragment(),i=p.render("optgroup_header",n);DA(t,i),DA(t,e);let r=p.render("optgroup",{group:n,options:t});DA(a,r)}else DA(a,e)})),y.innerHTML="",DA(y,a),p.settings.highlight&&((t=>{var e=t.querySelectorAll("span.highlight");Array.prototype.forEach.call(e,(function(t){var e=t.parentNode;e.replaceChild(t.firstChild,t),e.normalize()}))})(y),g.query.length&&g.tokens.length&&eA(g.tokens,(t=>{vA(y,t.regex)})));var w=t=>{let e=p.render(t,{input:f});return e&&(v=!0,y.insertBefore(e,y.firstChild)),e};if(p.loading?w("loading"):p.settings.shouldLoad.call(p,f)?0===g.items.length&&w("no_results"):w("not_loading"),(l=p.canCreate(f))&&(d=w("option_create")),p.hasOptions=g.items.length>0||l,v){if(g.items.length>0){if(b||"single"!==p.settings.mode||null==p.items[0]||(b=p.getOption(p.items[0])),!y.contains(b)){let t=0;d&&!p.settings.addPrecedence&&(t=1),b=p.selectable()[t]}}else d&&(b=d);t&&!p.isOpen&&(p.open(),p.scrollToOption(b,"auto")),p.setActiveOption(b)}else p.clearActiveOption(),t&&p.isOpen&&p.close(!1)}selectable(){return this.dropdown_content.querySelectorAll("[data-selectable]")}addOption(t,e=!1){const n=this;if(Array.isArray(t))return n.addOptions(t,e),!1;const i=kA(t[n.settings.valueField]);return null!==i&&!n.options.hasOwnProperty(i)&&(t.$order=t.$order||++n.order,t.$id=n.inputId+"-opt-"+t.$order,n.options[i]=t,n.lastQuery=null,e&&(n.userOptions[i]=e,n.trigger("option_add",i,t)),i)}addOptions(t,e=!1){eA(t,(t=>{this.addOption(t,e)}))}registerOption(t){return this.addOption(t)}registerOptionGroup(t){var e=kA(t[this.settings.optgroupValueField]);return null!==e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)}addOptionGroup(t,e){var n;e[this.settings.optgroupValueField]=t,(n=this.registerOptionGroup(e))&&this.trigger("optgroup_add",n,e)}removeOptionGroup(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.clearCache(),this.trigger("optgroup_remove",t))}clearOptionGroups(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}updateOption(t,e){const n=this;var i,r;const s=kA(t),o=kA(e[n.settings.valueField]);if(null===s)return;const a=n.options[s];if(null==a)return;if("string"!=typeof o)throw new Error("Value must be set in option data");const l=n.getOption(s),c=n.getItem(s);if(e.$order=e.$order||a.$order,delete n.options[s],n.uncacheValue(o),n.options[o]=e,l){if(n.dropdown_content.contains(l)){const t=n._render("option",e);bA(l,t),n.activeOption===l&&n.setActiveOption(t)}l.remove()}c&&(-1!==(r=n.items.indexOf(s))&&n.items.splice(r,1,o),i=n._render("item",e),c.classList.contains("active")&&cA(i,"active"),bA(c,i)),n.lastQuery=null}removeOption(t,e){const n=this;t=SA(t),n.uncacheValue(t),delete n.userOptions[t],delete n.options[t],n.lastQuery=null,n.trigger("option_remove",t),n.removeItem(t,e)}clearOptions(t){const e=(t||this.clearFilter).bind(this);this.loadedSearches={},this.userOptions={},this.clearCache();const n={};eA(this.options,((t,i)=>{e(t,i)&&(n[i]=t)})),this.options=this.sifter.items=n,this.lastQuery=null,this.trigger("option_clear")}clearFilter(t,e){return this.items.indexOf(e)>=0}getOption(t,e=!1){const n=kA(t);if(null===n)return null;const i=this.options[n];if(null!=i){if(i.$div)return i.$div;if(e)return this._render("option",i)}return null}getAdjacent(t,e,n="option"){var i;if(!t)return null;i="item"==n?this.controlChildren():this.dropdown_content.querySelectorAll("[data-selectable]");for(let n=0;n<i.length;n++)if(i[n]==t)return e>0?i[n+1]:i[n-1];return null}getItem(t){if("object"==typeof t)return t;var e=kA(t);return null!==e?this.control.querySelector(`[data-value="${MA(e)}"]`):null}addItems(t,e){var n=this,i=Array.isArray(t)?t:[t];i=i.filter((t=>-1===n.items.indexOf(t)));const r=i[i.length-1];i.forEach((t=>{n.isPending=t!==r,n.addItem(t,e)}))}addItem(t,e){CA(this,e?[]:["change","dropdown_close"],(()=>{var n,i;const r=this,s=r.settings.mode,o=kA(t);if((!o||-1===r.items.indexOf(o)||("single"===s&&r.close(),"single"!==s&&r.settings.duplicates))&&null!==o&&r.options.hasOwnProperty(o)&&("single"===s&&r.clear(e),"multi"!==s||!r.isFull())){if(n=r._render("item",r.options[o]),r.control.contains(n)&&(n=n.cloneNode(!0)),i=r.isFull(),r.items.splice(r.caretPos,0,o),r.insertAtCaret(n),r.isSetup){if(!r.isPending&&r.settings.hideSelected){let t=r.getOption(o),e=r.getAdjacent(t,1);e&&r.setActiveOption(e)}r.isPending||r.settings.closeAfterSelect||r.refreshOptions(r.isFocused&&"single"!==s),0!=r.settings.closeAfterSelect&&r.isFull()?r.close():r.isPending||r.positionDropdown(),r.trigger("item_add",o,n),r.isPending||r.updateOriginalInput({silent:e})}(!r.isPending||!i&&r.isFull())&&(r.inputState(),r.refreshState())}}))}removeItem(t=null,e){const n=this;if(!(t=n.getItem(t)))return;var i,r;const s=t.dataset.value;i=mA(t),t.remove(),t.classList.contains("active")&&(r=n.activeItems.indexOf(t),n.activeItems.splice(r,1),dA(t,"active")),n.items.splice(i,1),n.lastQuery=null,!n.settings.persist&&n.userOptions.hasOwnProperty(s)&&n.removeOption(s,e),i<n.caretPos&&n.setCaret(n.caretPos-1),n.updateOriginalInput({silent:e}),n.refreshState(),n.positionDropdown(),n.trigger("item_remove",s,t)}createItem(t=null,e=(()=>{})){3===arguments.length&&(e=arguments[2]),"function"!=typeof e&&(e=()=>{});var n,i=this,r=i.caretPos;if(t=t||i.inputValue(),!i.canCreate(t))return e(),!1;i.lock();var s=!1,o=t=>{if(i.unlock(),!t||"object"!=typeof t)return e();var n=kA(t[i.settings.valueField]);if("string"!=typeof n)return e();i.setTextboxValue(),i.addOption(t,!0),i.setCaret(r),i.addItem(n),e(t),s=!0};return n="function"==typeof i.settings.create?i.settings.create.call(this,t,o):{[i.settings.labelField]:t,[i.settings.valueField]:t},s||o(n),!0}refreshItems(){var t=this;t.lastQuery=null,t.isSetup&&t.addItems(t.items),t.updateOriginalInput(),t.refreshState()}refreshState(){const t=this;t.refreshValidityState();const e=t.isFull(),n=t.isLocked;t.wrapper.classList.toggle("rtl",t.rtl);const i=t.wrapper.classList;var r;i.toggle("focus",t.isFocused),i.toggle("disabled",t.isDisabled),i.toggle("required",t.isRequired),i.toggle("invalid",!t.isValid),i.toggle("locked",n),i.toggle("full",e),i.toggle("input-active",t.isFocused&&!t.isInputHidden),i.toggle("dropdown-active",t.isOpen),i.toggle("has-options",(r=t.options,0===Object.keys(r).length)),i.toggle("has-items",t.items.length>0)}refreshValidityState(){var t=this;t.input.validity&&(t.isValid=t.input.validity.valid,t.isInvalid=!t.isValid)}isFull(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}updateOriginalInput(t={}){const e=this;var n,i;const r=e.input.querySelector('option[value=""]');if(e.is_select_tag){const s=[],o=e.input.querySelectorAll("option:checked").length;function a(t,n,i){return t||(t=sA('<option value="'+xA(n)+'">'+xA(i)+"</option>")),t!=r&&e.input.append(t),s.push(t),(t!=r||o>0)&&(t.selected=!0),t}e.input.querySelectorAll("option:checked").forEach((t=>{t.selected=!1})),0==e.items.length&&"single"==e.settings.mode?a(r,"",""):e.items.forEach((t=>{if(n=e.options[t],i=n[e.settings.labelField]||"",s.includes(n.$option)){a(e.input.querySelector(`option[value="${MA(t)}"]:not(:checked)`),t,i)}else n.$option=a(n.$option,t,i)}))}else e.input.value=e.getValue();e.isSetup&&(t.silent||e.trigger("change",e.getValue()))}open(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.isOpen=!0,gA(t.focus_node,{"aria-expanded":"true"}),t.refreshState(),lA(t.dropdown,{visibility:"hidden",display:"block"}),t.positionDropdown(),lA(t.dropdown,{visibility:"visible",display:"block"}),t.focus(),t.trigger("dropdown_open",t.dropdown))}close(t=!0){var e=this,n=e.isOpen;t&&(e.setTextboxValue(),"single"===e.settings.mode&&e.items.length&&e.hideInput()),e.isOpen=!1,gA(e.focus_node,{"aria-expanded":"false"}),lA(e.dropdown,{display:"none"}),e.settings.hideSelected&&e.clearActiveOption(),e.refreshState(),n&&e.trigger("dropdown_close",e.dropdown)}positionDropdown(){if("body"===this.settings.dropdownParent){var t=this.control,e=t.getBoundingClientRect(),n=t.offsetHeight+e.top+window.scrollY,i=e.left+window.scrollX;lA(this.dropdown,{width:e.width+"px",top:n+"px",left:i+"px"})}}clear(t){var e=this;if(e.items.length){var n=e.controlChildren();eA(n,(t=>{e.removeItem(t,!0)})),e.showInput(),t||e.updateOriginalInput(),e.trigger("clear")}}insertAtCaret(t){const e=this,n=e.caretPos,i=e.control;i.insertBefore(t,i.children[n]||null),e.setCaret(n+1)}deleteSelection(t){var e,n,i,r,s,o=this;e=t&&8===t.keyCode?-1:1,n={start:(s=o.control_input).selectionStart||0,length:(s.selectionEnd||0)-(s.selectionStart||0)};const a=[];if(o.activeItems.length)r=fA(o.activeItems,e),i=mA(r),e>0&&i++,eA(o.activeItems,(t=>a.push(t)));else if((o.isFocused||"single"===o.settings.mode)&&o.items.length){const t=o.controlChildren();let i;e<0&&0===n.start&&0===n.length?i=t[o.caretPos-1]:e>0&&n.start===o.inputValue().length&&(i=t[o.caretPos]),void 0!==i&&a.push(i)}if(!o.shouldDelete(a,t))return!1;for(_A(t,!0),void 0!==i&&o.setCaret(i);a.length;)o.removeItem(a.pop());return o.showInput(),o.positionDropdown(),o.refreshOptions(!1),!0}shouldDelete(t,e){const n=t.map((t=>t.dataset.value));return!(!n.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete(n,e))}advanceSelection(t,e){var n,i,r=this;r.rtl&&(t*=-1),r.inputValue().length||(OA(yA,e)||OA("shiftKey",e)?(i=(n=r.getLastActive(t))?n.classList.contains("active")?r.getAdjacent(n,t,"item"):n:t>0?r.control_input.nextElementSibling:r.control_input.previousElementSibling)&&(i.classList.contains("active")&&r.removeActiveItem(n),r.setActiveItemClass(i)):r.moveCaret(t))}moveCaret(t){}getLastActive(t){let e=this.control.querySelector(".last-active");if(e)return e;var n=this.control.querySelectorAll(".active");return n?fA(n,t):void 0}setCaret(t){this.caretPos=this.items.length}controlChildren(){return Array.from(this.control.querySelectorAll("[data-ts-item]"))}lock(){this.isLocked=!0,this.refreshState()}unlock(){this.isLocked=!1,this.refreshState()}disable(){var t=this;t.input.disabled=!0,t.control_input.disabled=!0,t.focus_node.tabIndex=-1,t.isDisabled=!0,this.close(),t.lock()}enable(){var t=this;t.input.disabled=!1,t.control_input.disabled=!1,t.focus_node.tabIndex=t.tabIndex,t.isDisabled=!1,t.unlock()}destroy(){var t=this,e=t.revertSettings;t.trigger("destroy"),t.off(),t.wrapper.remove(),t.dropdown.remove(),t.input.innerHTML=e.innerHTML,t.input.tabIndex=e.tabIndex,dA(t.input,"tomselected","ts-hidden-accessible"),t._destroy(),delete t.input.tomselect}render(t,e){var n,i;const r=this;if("function"!=typeof this.settings.render[t])return null;if(!(i=r.settings.render[t].call(this,e,xA)))return null;if(i=sA(i),"option"===t||"option_create"===t?e[r.settings.disabledField]?gA(i,{"aria-disabled":"true"}):gA(i,{"data-selectable":""}):"optgroup"===t&&(n=e.group[r.settings.optgroupValueField],gA(i,{"data-group":n}),e.group[r.settings.disabledField]&&gA(i,{"data-disabled":""})),"option"===t||"item"===t){const n=SA(e[r.settings.valueField]);gA(i,{"data-value":n}),"item"===t?(cA(i,r.settings.itemClass),gA(i,{"data-ts-item":""})):(cA(i,r.settings.optionClass),gA(i,{role:"option",id:e.$id}),e.$div=i,r.options[n]=e)}return i}_render(t,e){const n=this.render(t,e);if(null==n)throw"HTMLElement expected";return n}clearCache(){eA(this.options,(t=>{t.$div&&(t.$div.remove(),delete t.$div)}))}uncacheValue(t){const e=this.getOption(t);e&&e.remove()}canCreate(t){return this.settings.create&&t.length>0&&this.settings.createFilter.call(this,t)}hook(t,e,n){var i=this,r=i[e];i[e]=function(){var e,s;return"after"===t&&(e=r.apply(i,arguments)),s=n.apply(i,arguments),"instead"===t?s:("before"===t&&(e=r.apply(i,arguments)),e)}}}IA.define("change_listener",(function(){AA(this.input,"change",(()=>{this.sync()}))})),IA.define("checkbox_options",(function(){var t=this,e=t.onOptionSelect;t.settings.hideSelected=!1;var n=function(t){setTimeout((()=>{var e=t.querySelector("input");e instanceof HTMLInputElement&&(t.classList.contains("selected")?e.checked=!0:e.checked=!1)}),1)};t.hook("after","setupTemplates",(()=>{var e=t.settings.render.option;t.settings.render.option=(n,i)=>{var r=sA(e.call(t,n,i)),s=document.createElement("input");s.addEventListener("click",(function(t){_A(t)})),s.type="checkbox";const o=kA(n[t.settings.valueField]);return o&&t.items.indexOf(o)>-1&&(s.checked=!0),r.prepend(s),r}})),t.on("item_remove",(e=>{var i=t.getOption(e);i&&(i.classList.remove("selected"),n(i))})),t.on("item_add",(e=>{var i=t.getOption(e);i&&n(i)})),t.hook("instead","onOptionSelect",((i,r)=>{if(r.classList.contains("selected"))return r.classList.remove("selected"),t.removeItem(r.dataset.value),t.refreshOptions(),void _A(i,!0);e.call(t,i,r),n(r)}))})),IA.define("clear_button",(function(t){const e=this,n=Object.assign({className:"clear-button",title:"Clear All",html:t=>`<div class="${t.className}" title="${t.title}">&#10799;</div>`},t);e.on("initialize",(()=>{var t=sA(n.html(n));t.addEventListener("click",(t=>{e.isDisabled||(e.clear(),"single"===e.settings.mode&&e.settings.allowEmptyOption&&e.addItem(""),t.preventDefault(),t.stopPropagation())})),e.control.appendChild(t)}))})),IA.define("drag_drop",(function(){var t=this;if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===t.settings.mode){var e=t.lock,n=t.unlock;t.hook("instead","lock",(()=>{var n=$(t.control).data("sortable");return n&&n.disable(),e.call(t)})),t.hook("instead","unlock",(()=>{var e=$(t.control).data("sortable");return e&&e.enable(),n.call(t)})),t.on("initialize",(()=>{var e=$(t.control).sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:t.isLocked,start:(t,n)=>{n.placeholder.css("width",n.helper.css("width")),e.css({overflow:"visible"})},stop:()=>{e.css({overflow:"hidden"});var n=[];e.children("[data-value]").each((function(){this.dataset.value&&n.push(this.dataset.value)})),t.setValue(n)}})}))}})),IA.define("dropdown_header",(function(t){const e=this,n=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:t=>'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a class="'+t.closeClass+'">&times;</a></div></div>'},t);e.on("initialize",(()=>{var t=sA(n.html(n)),i=t.querySelector("."+n.closeClass);i&&i.addEventListener("click",(t=>{_A(t,!0),e.close()})),e.dropdown.insertBefore(t,e.dropdown.firstChild)}))})),IA.define("caret_position",(function(){var t=this;t.hook("instead","setCaret",(e=>{"single"!==t.settings.mode&&t.control.contains(t.control_input)?(e=Math.max(0,Math.min(t.items.length,e)))==t.caretPos||t.isPending||t.controlChildren().forEach(((n,i)=>{i<e?t.control_input.insertAdjacentElement("beforebegin",n):t.control.appendChild(n)})):e=t.items.length,t.caretPos=e})),t.hook("instead","moveCaret",(e=>{if(!t.isFocused)return;const n=t.getLastActive(e);if(n){const i=mA(n);t.setCaret(e>0?i+1:i),t.setActiveItem(),dA(n,"last-active")}else t.setCaret(t.caretPos+e)}))})),IA.define("dropdown_input",(function(){const t=this;t.settings.shouldOpen=!0,t.hook("before","setup",(()=>{t.focus_node=t.control,cA(t.control_input,"dropdown-input");const e=sA('<div class="dropdown-input-wrap">');e.append(t.control_input),t.dropdown.insertBefore(e,t.dropdown.firstChild);const n=sA('<input class="items-placeholder" tabindex="-1" />');n.placeholder=t.settings.placeholder||"",t.control.append(n)})),t.on("initialize",(()=>{t.control_input.addEventListener("keydown",(e=>{switch(e.keyCode){case 27:return t.isOpen&&(_A(e,!0),t.close()),void t.clearActiveItems();case 9:t.focus_node.tabIndex=-1}return t.onKeyDown.call(t,e)})),t.on("blur",(()=>{t.focus_node.tabIndex=t.isDisabled?-1:t.tabIndex})),t.on("dropdown_open",(()=>{t.control_input.focus()}));const e=t.onBlur;t.hook("instead","onBlur",(n=>{if(!n||n.relatedTarget!=t.control_input)return e.call(t)})),AA(t.control_input,"blur",(()=>t.onBlur())),t.hook("before","close",(()=>{t.isOpen&&t.focus_node.focus({preventScroll:!0})}))}))})),IA.define("input_autogrow",(function(){var t=this;t.on("initialize",(()=>{var e=document.createElement("span"),n=t.control_input;e.style.cssText="position:absolute; top:-99999px; left:-99999px; width:auto; padding:0; white-space:pre; ",t.wrapper.appendChild(e);for(const t of["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"])e.style[t]=n.style[t];var i=()=>{e.textContent=n.value,n.style.width=e.clientWidth+"px"};i(),t.on("update item_add item_remove",i),AA(n,"input",i),AA(n,"keyup",i),AA(n,"blur",i),AA(n,"update",i)}))})),IA.define("no_backspace_delete",(function(){var t=this,e=t.deleteSelection;this.hook("instead","deleteSelection",(n=>!!t.activeItems.length&&e.call(t,n)))})),IA.define("no_active_items",(function(){this.hook("instead","setActiveItem",(()=>{})),this.hook("instead","selectAll",(()=>{}))})),IA.define("optgroup_columns",(function(){var t=this,e=t.onKeyDown;t.hook("instead","onKeyDown",(n=>{var i,r,s,o;if(!t.isOpen||37!==n.keyCode&&39!==n.keyCode)return e.call(t,n);t.ignoreHover=!0,o=pA(t.activeOption,"[data-group]"),i=mA(t.activeOption,"[data-selectable]"),o&&(o=37===n.keyCode?o.previousSibling:o.nextSibling)&&(r=(s=o.querySelectorAll("[data-selectable]"))[Math.min(s.length-1,i)])&&t.setActiveOption(r)}))})),IA.define("remove_button",(function(t){const e=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},t);var n=this;if(e.append){var i='<a href="javascript:void(0)" class="'+e.className+'" tabindex="-1" title="'+xA(e.title)+'">'+e.label+"</a>";n.hook("after","setupTemplates",(()=>{var t=n.settings.render.item;n.settings.render.item=(e,r)=>{var s=sA(t.call(n,e,r)),o=sA(i);return s.appendChild(o),AA(o,"mousedown",(t=>{_A(t,!0)})),AA(o,"click",(t=>{_A(t,!0),n.isLocked||n.shouldDelete([s],t)&&(n.removeItem(s),n.refreshOptions(!1),n.inputState())})),s}}))}})),IA.define("restore_on_backspace",(function(t){const e=this,n=Object.assign({text:t=>t[e.settings.labelField]},t);e.on("item_remove",(function(t){if(e.isFocused&&""===e.control_input.value.trim()){var i=e.options[t];i&&e.setTextboxValue(n.text.call(e,i))}}))})),IA.define("virtual_scroll",(function(){const t=this,e=t.canLoad,n=t.clearActiveOption,i=t.loadCallback;var r,s,o={},a=!1,l=[];if(t.settings.shouldLoadMore||(t.settings.shouldLoadMore=()=>{if(r.clientHeight/(r.scrollHeight-r.scrollTop)>.9)return!0;if(t.activeOption){var e=t.selectable();if(Array.from(e).indexOf(t.activeOption)>=e.length-2)return!0}return!1}),!t.settings.firstUrl)throw"virtual_scroll plugin requires a firstUrl() method";t.settings.sortField=[{field:"$order"},{field:"$score"}];const c=e=>!("number"==typeof t.settings.maxOptions&&r.children.length>=t.settings.maxOptions)&&!(!(e in o)||!o[e]),d=(e,n)=>t.items.indexOf(n)>=0||l.indexOf(n)>=0;t.setNextUrl=(t,e)=>{o[t]=e},t.getUrl=e=>{if(e in o){const t=o[e];return o[e]=!1,t}return o={},t.settings.firstUrl.call(t,e)},t.hook("instead","clearActiveOption",(()=>{if(!a)return n.call(t)})),t.hook("instead","canLoad",(n=>n in o?c(n):e.call(t,n))),t.hook("instead","loadCallback",((e,n)=>{if(a){if(s){const n=e[0];void 0!==n&&(s.dataset.value=n[t.settings.valueField])}}else t.clearOptions(d);i.call(t,e,n),a=!1})),t.hook("after","refreshOptions",(()=>{const e=t.lastValue;var n;c(e)?(n=t.render("loading_more",{query:e}))&&(n.setAttribute("data-selectable",""),s=n):e in o&&!r.querySelector(".no-results")&&(n=t.render("no_more_results",{query:e})),n&&(cA(n,t.settings.optionClass),r.append(n))})),t.on("initialize",(()=>{l=Object.keys(t.options),r=t.dropdown_content,t.settings.render=Object.assign({},{loading_more:()=>'<div class="loading-more-results">Loading more results ... </div>',no_more_results:()=>'<div class="no-more-results">No more results</div>'},t.settings.render),r.addEventListener("scroll",(()=>{t.settings.shouldLoadMore.call(t)&&c(t.lastValue)&&(a||(a=!0,t.load.call(t,t.lastValue)))}))}))})),IA.define("conditional_search",(function(t){this.hook("after","setup",(function(){Object.keys(this.options).length<10&&this.dropdown.classList.add("hideSearchInput")}))})),IA.define("search_icon",(function(){}));class PA extends pS{static values={plugins:{type:Array,default:[]}};initialize(){this.config={onInitialize:function(){this.popper=Bg(this.control,this.dropdown,{modifiers:[{name:"offset",options:{offset:[0,5]}}]})},onDropdownOpen:function(){this.popper.update()},plugins:this.pluginsValue,...this.customConfigs}}connect(){if(this.element.setAttribute("autocomplete","random"),this.element.options.length&&""==this.element.options[0].value)this.config.plugins.includes("clear_button")||this.config.plugins.push("clear_button");else{const t=this.config.plugins.filter((t=>"clear_button"!==t));this.config.plugins=t}if(this.element.attributes.multiple)this.config.plugins.includes("remove_button")||this.config.plugins.push("remove_button");else{const t=this.config.plugins.filter((t=>"remove_button"!==t));this.config.plugins=t}this.ts=new IA(this.element,{...this.config})}disconnect(){this.ts.destroy()}}const $A=({attributes:t,...e})=>t&&t.constructor===Object?{...e,...t}:e,RA=t=>t&&"object"==typeof t?Array.isArray(t)?t.map((t=>$A(t))):$A(t):{},FA=(t,e)=>{const n=((t,e)=>{if(Array.isArray(e))return e.find((e=>e.id===t.id&&e.type===t.type))})(t,e);if(!n)return[void 0,e];const i=e.map((t=>{if(t!==n)return t;const{relationships:e,...i}=n;return i}));return[{...t,...RA(n)},i]},BA=(t,e)=>{let{relationships:n,...i}=t;t.hasOwnProperty("attributes")&&(i=RA(i));for(const t in n){if(i.hasOwnProperty(t))continue;const r=n[t].data;let s;if(r&&Array.isArray(r)){let t=[];r.forEach((n=>{let i;[i,e]=FA(n,e),i&&t.push(i)})),t=t.map((t=>BA(t,e))),t.length&&(s=t)}else if(r){const[t,n]=FA(r,e);t&&(s=BA(t,n))}s&&(i[t]=s)}return i};var jA="object"==typeof global&&global&&global.Object===Object&&global,HA="object"==typeof self&&self&&self.Object===Object&&self,zA=(jA||HA||Function("return this")()).Symbol,VA=Object.prototype,qA=VA.hasOwnProperty,UA=VA.toString,WA=zA?zA.toStringTag:void 0;var KA=Object.prototype.toString;var YA="[object Null]",JA="[object Undefined]",GA=zA?zA.toStringTag:void 0;function XA(t){return null==t?void 0===t?JA:YA:GA&&GA in Object(t)?function(t){var e=qA.call(t,WA),n=t[WA];try{t[WA]=void 0;var i=!0}catch(t){}var r=UA.call(t);return i&&(e?t[WA]=n:delete t[WA]),r}(t):function(t){return KA.call(t)}(t)}var QA,ZA,tO=(QA=Object.getPrototypeOf,ZA=Object,function(t){return QA(ZA(t))});function eO(t){return null!=t&&"object"==typeof t}var nO=Function.prototype,iO=Object.prototype,rO=nO.toString,sO=iO.hasOwnProperty,oO=rO.call(Object);function aO(t){if(!eO(t)||"[object Object]"!=XA(t))return!1;var e=tO(t);if(null===e)return!0;var n=sO.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&rO.call(n)==oO}var lO=Array.isArray,cO="[object Symbol]";var dO=1/0,hO=zA?zA.prototype:void 0,uO=hO?hO.toString:void 0;function pO(t){if("string"==typeof t)return t;if(lO(t))return function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}(t,pO)+"";if(function(t){return"symbol"==typeof t||eO(t)&&XA(t)==cO}(t))return uO?uO.call(t):"";var e=t+"";return"0"==e&&1/t==-dO?"-0":e}function fO(t){return null==t?"":pO(t)}function mO(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:function(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}(t,e,n)}var gO=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function bO(t){return gO.test(t)}var vO="\\ud800-\\udfff",yO="["+vO+"]",wO="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",kO="\\ud83c[\\udffb-\\udfff]",SO="[^"+vO+"]",xO="(?:\\ud83c[\\udde6-\\uddff]){2}",EO="[\\ud800-\\udbff][\\udc00-\\udfff]",CO="(?:"+wO+"|"+kO+")"+"?",_O="[\\ufe0e\\ufe0f]?",AO=_O+CO+("(?:\\u200d(?:"+[SO,xO,EO].join("|")+")"+_O+CO+")*"),OO="(?:"+[SO+wO+"?",wO,xO,EO,yO].join("|")+")",TO=RegExp(kO+"(?="+kO+")|"+OO+AO,"g");function MO(t){return bO(t)?function(t){return t.match(TO)||[]}(t):function(t){return t.split("")}(t)}var DO,LO=(DO="toUpperCase",function(t){var e=bO(t=fO(t))?MO(t):void 0,n=e?e[0]:t.charAt(0),i=e?mO(e,1).join(""):t.slice(1);return n[DO]()+i});var NO,IO=(NO={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},function(t){return null==NO?void 0:NO[t]}),PO=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$O=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var RO=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var FO=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var BO="\\ud800-\\udfff",jO="\\u2700-\\u27bf",HO="a-z\\xdf-\\xf6\\xf8-\\xff",zO="A-Z\\xc0-\\xd6\\xd8-\\xde",VO="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",qO="["+VO+"]",UO="\\d+",WO="["+jO+"]",KO="["+HO+"]",YO="[^"+BO+VO+UO+jO+HO+zO+"]",JO="(?:\\ud83c[\\udde6-\\uddff]){2}",GO="[\\ud800-\\udbff][\\udc00-\\udfff]",XO="["+zO+"]",QO="(?:"+KO+"|"+YO+")",ZO="(?:"+XO+"|"+YO+")",tT="(?:['’](?:d|ll|m|re|s|t|ve))?",eT="(?:['’](?:D|LL|M|RE|S|T|VE))?",nT="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",iT="[\\ufe0e\\ufe0f]?",rT=iT+nT+("(?:\\u200d(?:"+["[^"+BO+"]",JO,GO].join("|")+")"+iT+nT+")*"),sT="(?:"+[WO,JO,GO].join("|")+")"+rT,oT=RegExp([XO+"?"+KO+"+"+tT+"(?="+[qO,XO,"$"].join("|")+")",ZO+"+"+eT+"(?="+[qO,XO+QO,"$"].join("|")+")",XO+"?"+QO+"+"+tT,XO+"+"+eT,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",UO,sT].join("|"),"g");function aT(t,e,n){return t=fO(t),void 0===(e=n?void 0:e)?function(t){return FO.test(t)}(t)?function(t){return t.match(oT)||[]}(t):function(t){return t.match(RO)||[]}(t):t.match(e)||[]}var lT=RegExp("['’]","g");var cT,dT=(cT=function(t,e,n){return e=e.toLowerCase(),t+(n?LO(fO(e).toLowerCase()):e)},function(t){return function(t,e,n,i){var r=-1,s=null==t?0:t.length;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n}(aT(function(t){return(t=fO(t))&&t.replace(PO,IO).replace($O,"")}(t).replace(lT,"")),cT,"")}),hT=dT;const uT=t=>(Object.keys(t).forEach((e=>{const n=(i=e).indexOf("-")>-1||i.indexOf("_")>-1?hT(e):e;var i;const r=t[e];delete t[e],t[n]=r,aO(r)&&(t[n]=uT(r)),Array.isArray(r)&&(t[n]=r.map((t=>aO(t)?uT(t):t)))})),t),pT=(t,e={})=>{const{data:n={},included:i,...r}=t;let s;return s=Array.isArray(n)?n.map((t=>BA(t,i))):BA(n,i),((t,e)=>{"camelCase"===e.transformKeys&&uT(t)})(s,e),{data:s,...r}};class fT extends PA{static values={uri:{type:String,default:"/api/v2/platform/"},endpoint:String,val:{type:String,default:"id"},txt:{type:String,default:"name"},fields:{type:Array,default:["name"]},ransack:Array,customParams:Array,include:String,debug:{type:Boolean,default:!1},loadThrottle:{type:Number,default:400},queryCount:{type:Number,default:2},options:{type:Array,default:[]},plugins:{type:Array,default:["dropdown_input","search_icon"]}};initialize(){this.customConfigs={valueField:this.valValue,labelField:this.txtValue,searchField:this.fieldsValue,loadThrottle:this.loadThrottleValue,load:(t,e)=>this.search(t,e),onChange:t=>this.doNext(t),shouldLoad:t=>t.length>this.queryCountValue},super.initialize()}async search(t,e){const n=await k_(this.buildRequestURL(t));if(n.ok){const t=await n.json,i=this.requestFormatted(t);this.debugValue&&console.log(i),e(i)}else console.log(n),e()}buildRequestURL(t){const e=this.uriValue+this.endpointValue,n=new URL(AypexAdmin.localizedPathFor(e));return this.hasRansackValue&&this.ransackValue.forEach((e=>{n.searchParams.append(`[filter]${e}`,t)})),this.hasIncludeValue&&n.searchParams.append("include",this.includeValue),this.hasCustomParamsValue&&this.customParamsValue.forEach((t=>{n.searchParams.append(t[0],t[1])})),n}requestFormatted(t){return pT(t)}doNext(t){this.debugValue&&console.log("Override the doNext function if you need to do something special on change")}}window.Stimulus=class{constructor(t=document.documentElement,e=rS){this.logger=console,this.debug=!1,this.logDebugActivity=(t,e,n={})=>{this.debug&&this.logFormattedMessage(t,e,n)},this.element=t,this.schema=e,this.dispatcher=new gk(this),this.router=new iS(this),this.actionDescriptorFilters=Object.assign({},bk)}static start(t,e){const n=new this(t,e);return n.start(),n}async start(){await new Promise((t=>{"loading"==document.readyState?document.addEventListener("DOMContentLoaded",(()=>t())):t()})),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(t,e){this.load({identifier:t,controllerConstructor:e})}registerActionOption(t,e){this.actionDescriptorFilters[t]=e}load(t,...e){(Array.isArray(t)?t:[t,...e]).forEach((t=>{t.controllerConstructor.shouldLoad&&this.router.loadDefinition(t)}))}unload(t,...e){(Array.isArray(t)?t:[t,...e]).forEach((t=>this.router.unloadIdentifier(t)))}get controllers(){return this.router.contexts.map((t=>t.controller))}getControllerForElementAndIdentifier(t,e){const n=this.router.getContextForElementAndIdentifier(t,e);return n?n.controller:null}handleError(t,e,n){var i;this.logger.error("%s\n\n%o\n\n%o",e,t,n),null===(i=window.onerror)||void 0===i||i.call(window,e,"",0,0,t)}logFormattedMessage(t,e,n={}){n=Object.assign({application:this},n),this.logger.groupCollapsed(`${t} #${e}`),this.logger.log("details:",Object.assign({},n)),this.logger.groupEnd()}}.start(),Stimulus.register("bs-instance",class extends pS{static values={class:String,connection:String,method:String};connect(){if(this.hasConnectionValue){const t=bootstrap[this.classValue].getOrCreateInstance(this.element);if(null==t)return;t[this.connectionValue]()}}manipulate(){const t=bootstrap[this.classValue].getInstance(this.element);null!=t&&t[this.methodValue]()}}),Stimulus.register("card-formatting",class extends pS{static targets=["number","exp","code","type"];static values={datePattern:{type:Array,default:["m","Y"]}};connect(){let t;const e=this.numberTarget,n=this.typeTarget,i=this.codeTarget,r=this.expTarget,s=function(e){t&&t.destroy(),t=new TS(i,{numericOnly:!0,blocks:[e]})};s(3),this.cardNumberCleave=new TS(e,{creditCard:!0,onCreditCardTypeChanged:function(t){n.value=t,s("amex"===t?4:3)}}),this.cardExpCleave=new TS(r,{date:!0,datePattern:this.datePatternValue})}disconnect(){this.cardExpCleave.destroy(),this.cardNumberCleave.destroy()}}),Stimulus.register("checkbox-validation",class extends pS{static targets=["message"];connect(){let t;const e=this.element,n=e.querySelectorAll('input[type="checkbox"]'),i=function(t){t.preventDefault();Array.prototype.slice.call(e.querySelectorAll('input[type="checkbox"]:checked')).map((function(t){return t.value})).length<=0&&(this.checked=!0)};for(t=n.length;t--;)n[t].addEventListener("change",i,!1)}}),Stimulus.register("clipboard",class extends pS{static targets=["source"];copy(t){navigator.clipboard.writeText(this.sourceTarget.value).then((()=>{console.log("Successfully copied to clipboard"),MS(`Successfully copied ${this.sourceTarget.placeholder} to clipboard`)}),(()=>{console.log("Failed to copy clipboard"),MS(`Failed to copy ${this.sourceTarget.placeholder} to clipboard`)}))}}),Stimulus.register("datepicker",class extends Dx{static targets=["watch"];static values={locale:String};locales=Ix;connect(){this.config={locale:this.localeValue,altInput:!0,time_24hr:!0,altInputClass:"flatpickr-alt-input form-control rounded-start",showMonths:1,onReady:function(t,e,n){n.input.type="text",n.input.style.display="none"}},super.connect()}change(t,e,n){if(this.element.dataset.datepickerFrom){document.getElementById(this.element.dataset.targetPairId)._flatpickr.set("minDate",t[0])}if(this.element.dataset.datepickerTo){document.getElementById(this.element.dataset.targetPairId)._flatpickr.set("maxDate",t[0])}}}),Stimulus.register("dom",class extends pS{static targets=["element"];static values={duration:{default:500,type:Number}};removeElement(){this.element.classList.add("animate__fadeOut"),setTimeout((()=>this.elementTarget.remove()),this.durationValue)}}),Stimulus.register("form-state",class extends cE{enableChangeControles(){const t=document.getElementById("globalFormSubmitButton");super.enableChangeControles(),this.hasSaveButtonTarget&&(this.saveButtonTarget.disabled=!1),t&&(t.disabled=!1)}disableChangeControles(){const t=document.getElementById("globalFormSubmitButton");super.disableChangeControles(),this.hasSaveButtonTarget&&(this.saveButtonTarget.disabled=!0),t&&(t.disabled=!0)}}),Stimulus.register("form-validation",class extends pS{static targets=["submitBtn"];connect(){this.submitBtnTarget.hidden=!0}validate(){this.submitBtnTarget.click()}}),Stimulus.register("form--autosave",class extends pS{static targets=["submitButton","paramHolder"];static values={delay:{default:250,type:Number}};static debounces=[{name:"save"}];initialize(){this.save=this.save.bind(this)}connect(){((t,e)=>{const n=t;n.constructor.debounces.forEach((t=>{if("string"==typeof t&&(n[t]=lE(n[t],null==e?void 0:e.wait)),"object"==typeof t){const{name:i,wait:r}=t;if(!i)return;n[i]=lE(n[i],r||(null==e?void 0:e.wait))}}))})(this,{wait:this.delayValue}),this.hasSubmitButtonTarget&&(this.submitButtonTarget.style.display="none")}save(t){if(this.hasParamHolderTarget){const t=new URL(this.submitButtonTarget.href),e=t.searchParams,n=this.paramHolderTarget.name,i=this.paramHolderTarget.value;e.set(n,i),this.submitButtonTarget.href=t.href}this.submitButtonTarget.click()}}),Stimulus.register("form--reset",class extends pS{static targets=["resettable"];resetForm(){this.hasResettableTarget&&this.resettableTarget.reset()}clearForm(){const t=this.resettableTarget.elements;this.resettableTarget.reset();for(let e=0;e<t.length;e++){switch(t[e].type.toLowerCase()){case"text":case"password":case"textarea":case"hidden":t[e].value="";break;case"radio":case"checkbox":t[e].checked&&(t[e].checked=!1);break;case"select-one":case"select-multi":t[e].selectedIndex=-1}}}}),Stimulus.register("iframe",class extends pS{connect(){this.element.style["background-color"];const t=this.element.contentWindow;console.log(this.element.style.backgroundColor),t.addEventListener("load",(function(){t.document.querySelector("html").style.backgroundColor="transparent"}))}}),Stimulus.register("input--checkbox-state",class extends dE{static targets=["checkboxAll","checkbox","actionPanel","initialPanel"];initialize(){super.initialize(),this.reportState=this.reportState.bind(this)}connect(){super.connect(),this.checkboxAllTarget.addEventListener("change",this.reportState),this.checkboxTargets.forEach((t=>t.addEventListener("change",this.reportState)))}disconnect(){super.disconnect(),this.checkboxAllTarget.removeEventListener("change",this.reportState),this.checkboxTargets.forEach((t=>t.removeEventListener("change",this.reportState)))}reportState(){this.checkboxAllTarget.checked||this.checkboxAllTarget.indeterminate?this.activateOptionsPanel():this.deactivateOptionsPanel()}activateOptionsPanel(){this.actionPanelTargets.forEach((t=>{t.style.display="flex"})),this.initialPanelTargets.forEach((t=>{t.style.display="none"}))}deactivateOptionsPanel(){this.actionPanelTargets.forEach((t=>{t.style.display="none"})),this.initialPanelTargets.forEach((t=>{t.style.display="flex"}))}}),Stimulus.register("input-disable",class extends pS{static targets=["disable","notice","container"];checkForChanges(t){!0===this.handleSelectChange(t.target)?this.enforceChangedState():this.disableChangedState()}enforceChangedState(){this.hasContainerTarget&&(this.containerTarget.style.display="none"),this.hasDisableTarget&&this.disableTargets.forEach((t=>{t.disabled=!0})),this.hasNoticeTarget&&(this.noticeTarget.style.display="block")}disableChangedState(){this.hasContainerTarget&&(this.containerTarget.style.display="block"),this.hasDisableTarget&&this.disableTargets.forEach((t=>{t.disabled=!1})),this.hasNoticeTarget&&(this.noticeTarget.style.display="none")}handleSelectChange(t){let e,n,i,r,s;for(i=0,r=t.options.length;i<r;i++)s=t.options[i],e=e||s.selected!==s.defaultSelected,s.defaultSelected&&(n=i);if(e&&!t.multiple&&(e=n!==t.selectedIndex),e)return!0}}),Stimulus.register("input-formatting",class extends pS{static values={options:{type:Object,default:{}}};connect(){this.cleaveInstance=new TS(this.element,{...this.optionsValue})}disconnect(){this.cleaveInstance.destroy()}}),Stimulus.register("input--format-decimal",class extends pS{static values={options:{type:Object,default:{}}};connect(){this.cleaveInstance=new TS(this.element,{numeral:!0,numeralThousandsGroupStyle:"none"})}disconnect(){this.cleaveInstance.destroy()}}),Stimulus.register("input--format-integer",class extends pS{static values={options:{type:Object,default:{}}};connect(){this.cleaveInstance=new TS(this.element,{numeral:!0,numeralDecimalScale:0,numeralThousandsGroupStyle:"none"})}disconnect(){this.cleaveInstance.destroy()}}),Stimulus.register("input--required",class extends pS{static targets=["saveButton"];static values={saveButtonId:String};connect(){this.isFormValid()||this.attachActionAttributes()}attachActionAttributes(){this.element.querySelectorAll("input, select").forEach((t=>{t.hasAttribute("data-action")&&t.dataset.action.includes(`${this.identifier}#isFormValid`)||(t.hasAttribute("data-action")?t.setAttribute("data-action",`${this.identifier}#isFormValid ${t.dataset.action}`):t.setAttribute("data-action",`${this.identifier}#isFormValid`))}))}manipulateDom(t){if(!0===t){if(this.hasSaveButtonIdValue){document.querySelector(`#${this.saveButtonIdValue}`).disabled=!1}this.hasSaveButtonTarget&&(this.saveButtonTarget.disabled=!1)}else{if(this.hasSaveButtonIdValue){document.querySelector(`#${this.saveButtonIdValue}`).disabled=!0}this.hasSaveButtonTarget&&(this.saveButtonTarget.disabled=!0)}}isFormValid(){const t=this.element.checkValidity();return this.manipulateDom(t),t}}),Stimulus.register("menu",class extends pS{connect(){const t=this.element;t.closest(".nav-sidebar").classList.add("active-option");const e=t.closest(".nav-pills");e&&e.classList.add("show")}disconnect(){const t=this.element;t.closest(".nav-sidebar").classList.remove("active-option");const e=t.closest(".nav-pills");e&&e.classList.remove("show")}}),Stimulus.register("modal",class extends pS{connect(){if(document.documentElement.hasAttribute("data-turbo-preview")){const t=document.querySelector(".modal-backdrop");t&&t.remove()}else this.modal=new bootstrap.Modal(this.element,{keyboard:!1}),this.modal.show()}disconnect(){this.modal&&this.modal.dispose()}submitEnd(t){!0!==t.detail.formSubmission.submitter.formNoValidate&&t.detail.success&&this.modal.hide()}}),Stimulus.register("number-increment",class extends pS{static targets=["decreaseButton","increaseButton","submitBtn"];connect(){const t=this.element.querySelector("input[type=number]"),e=this.element.querySelector("input[type=submit]");this.decreaseButtonTarget.addEventListener("click",(function(){t.stepDown(),e.click()})),this.increaseButtonTarget.addEventListener("click",(function(){t.stepUp(),e.click()}))}disconnect(){this.decreaseButtonTarget.removeEventListener("click",null),this.increaseButtonTarget.removeEventListener("click",null)}}),Stimulus.register("password-toggle",class extends pS{static targets=["unhide"];password(){"password"===this.unhideTarget.type?this.unhideTarget.type="text":this.unhideTarget.type="password"}}),Stimulus.register("sortable",class extends b_{async onUpdate({item:t,newIndex:e,oldIndex:n}){if(!t.dataset.sortableUpdateUrl)return;const i=this.resourceNameValue?`${this.resourceNameValue}[${this.paramNameValue}]`:this.paramNameValue,r=new FormData;r.append(i,e+1),await S_(t.dataset.sortableUpdateUrl,{body:r,responseKind:this.responseKindValue})}get defaultOptions(){return{animation:500,handle:".handle"}}}),Stimulus.register("sortable-tree",class extends pS{static values={resourceName:String,paramName:{type:String,default:"position"},responseKind:{type:String,default:"turbo_stream"},animation:Number,handle:{type:String,default:".handle"},dragClass:{type:String,default:"item-dragged"}};initialize(){this.end=this.end.bind(this)}connect(){const t={...this.options},e=this.element.querySelectorAll("[data-sortable-tree-parent-id-value]");for(let n=0;n<e.length;n++)this.sTb=new WC(e[n],t)}disconnect(){this.sTb.destroy()}async end({item:t,newIndex:e,to:n}){if(!t.dataset.sortableTreeUpdateUrlValue)return;const i={[t.dataset.sortableTreeResourceNameValue]:{new_parent_id:n.dataset.sortableTreeParentIdValue,new_position_idx:e}};await S_(t.dataset.sortableTreeUpdateUrlValue,{body:i,responseKind:this.responseKindValue})}get options(){return{group:{name:"sortable-tree",pull:!0,put:!0},handle:this.handleValue,swapThreshold:.5,emptyInsertThreshold:8,dragClass:this.dragClassValue,draggable:".draggable",animation:350,forceFallback:!1,onEnd:this.end}}}),Stimulus.register("toast",class extends pS{connect(){this.toast=new bootstrap.Toast(this.element),this.toast.show()}disconnect(){this.toast.dispose()}}),Stimulus.register("scroll-iframe",class extends pS{static values={iframeId:String,identifier:Number};connect(){((t,e={})=>{const n=new aE(t,e);n.observe,n.unobserve})(this,{element:this.element})}mouseEnter(){null!=this.section&&(this.section.hasAttribute("data-controller")?this.section.dataset.controller=`scroll ${this.origionalControllerAttributes}`:this.section.setAttribute("data-controller","scroll"))}mouseLeave(){null!=this.section&&(this.section.hasAttribute("data-controller")?this.section.dataset.controller=`${this.origionalControllerAttributes}`:this.section.removeAttribute("data-controller"))}get origionalControllerAttributes(){const t=this.section.dataset.controller.replace("scroll",""),e=[...new Set(t.split(" "))].filter((t=>""!==t));return e}get section(){const t=document.getElementById("page-live-preview"),e=`#aypex_section_id_${this.identifierValue}`;return t.contentWindow.document.querySelector(e)}}),Stimulus.register("ts--search",fT),Stimulus.register("ts--select",class extends PA{initialize(){this.customConfigs={maxOptions:500},super.initialize()}}),Stimulus.register("ts--search-user",class extends fT{initialize(){super.initialize(),this.config.render={option:this.render_option,item:this.render_item}}render_option(t,e){return t.first_name||t.last_name?`<div>\n                <div>\n                  <span class="text-muted">Name:</span> ${t.first_name?e(t.first_name):""} ${t.last_name?e(t.last_name):""}\n                </div>\n                <div>\n                  <small><span class="text-muted">Email:</span> ${e(t.email)} </small>\n                </div>\n                <div>\n                  ${t.bill_address?`<div><small><span class="text-muted">Bill To:</span> ${e(t.bill_address.address1)}, ${e(t.bill_address.country.iso)}</small> </div>`:""}\n                  ${t.ship_address?`<div><small><span class="text-muted">Ship To:</span> ${e(t.ship_address.address1)}, ${e(t.ship_address.country.iso)}</small> </div>`:""}\n                </div>\n              </div>`:`<div>\n                <div>\n                  <span class="text-muted">Email:</span> ${e(t.email)}\n                </div>\n                <div>\n                  ${t.bill_address?`<div><small><span class="text-muted">Bill To:</span> ${e(t.bill_address.address1)}, ${e(t.bill_address.country.iso_name)}</small> </div>`:""}\n                  ${t.ship_address?`<div><small><span class="text-muted">Ship To:</span> ${e(t.ship_address.address1)}, ${e(t.ship_address.country.iso_name)}</small> </div>`:""}\n                </div>\n              </div>`}render_item(t,e){return`<div>${e(t.email)}</div>`}}),Stimulus.register("ts--search-variant",class extends fT{initialize(){super.initialize(),this.config.render={option:this.render_option,item:this.render_item}}render_option(t,e){return t.images?`\n\n        <div class="row">\n          <div class="col-auto d-flex align-items-center">\n            <img src="${e(t.images[0].original_url)}" alt="${e(t.name)}" width="50" height="50">\n          </div>\n          <div class="col">\n            <div><span class="text-muted">Product Name:</span> ${e(t.name)}</div>\n            <div><span class="text-muted">Options:</span> ${t.options_text}</div>\n            ${t.sku?`<div><span class="text-muted">SKU:</span> ${e(t.sku)}</div>`:""}\n            ${t.total_on_hand?`<div><span class="text-muted">On Hand:</span> ${e(t.total_on_hand)}</div>`:'<span class="text-muted">On Hand:</span> Not Tracked'}\n          </div>\n        </div>\n\n              `:`\n\n        <div class="row">\n          <div class="col-auto d-flex align-items-center text-muted">\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="50" height="50">\n              <path fill="none" d="M0 0h24v24H0z"/>\n              <path fill="currentColor" d="M5 11.1l2-2 5.5 5.5 3.5-3.5 3 3V5H5v6.1zm0 2.829V19h3.1l2.986-2.985L7 11.929l-2 2zM10.929 19H19v-2.071l-3-3L10.929 19zM4 3h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm11.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>\n            </svg>\n          </div>\n          <div class="col">\n            <div><span class="text-muted">Product Name:</span> ${e(t.name)}</div>\n            <div><span class="text-muted">Options:</span> ${t.options_text}</div>\n            ${t.sku?`<div><span class="text-muted">SKU:</span> ${e(t.sku)}</div>`:""}\n            ${t.total_on_hand?`<div><span class="text-muted">On Hand:</span> ${e(t.total_on_hand)}</div>`:'<span class="text-muted">On Hand:</span> Not Tracked'}\n          </div>\n        </div>\n\n            `}render_item(t,e){return`<div>${t.name} | ${t.options_text}</div>`}});const mT={};window.AypexAdmin||(window.AypexAdmin=mT);const gT=function(t){const e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),n=window.location.search;return`${e+window.AypexAdmin.paths.platform_api_mounted_at+t+n}`};mT.localizedPathFor=function(t){const e=this.localization.default_locale,n=this.localization.current_locale;if(e!==n){const e=new URL(gT(t)),i=e.searchParams,r=e.pathname;return i.set("locale",n),e.origin+r+"?"+i.toString()}return gT(t)},document.addEventListener("turbo:before-stream-render",(function(t){if("update"===t.target.action){const e=document.getElementById(t.target.target),n=e.dataset.streamEnterClass;n&&(e.classList.add(n),e.addEventListener("animationend",(function(){e.classList.remove(n)})))}if("append"===t.target.action){const e=t.target.templateContent.firstElementChild.dataset.streamEnterClass;e&&t.target.templateElement.content.firstElementChild.classList.add(e)}if("remove"===t.target.action){const e=document.getElementById(t.target.target);if(e){const n=e.dataset.streamExitClass;n&&(t.preventDefault(),e.classList.add(n),e.addEventListener("animationend",(function(){t.target.performAction()})))}}})),Turbo.setConfirmMethod(((t,e)=>{const n=document.getElementById("custom-turbo-confirm");return n.querySelector("p").textContent=t,n.showModal(),new Promise(((t,e)=>{n.addEventListener("close",(()=>{t("confirm"===n.returnValue)}),{once:!0})}))})),window.AypexAdmin.RequestUtility||(window.AypexAdmin.RequestUtility=x_),console.log("Aypex Admin Initialized");var bT={logger:self.console,WebSocket:self.WebSocket},vT={log(...t){this.enabled&&(t.push(Date.now()),bT.logger.log("[ActionCable]",...t))}};const yT=()=>(new Date).getTime(),wT=t=>(yT()-t)/1e3;class kT{constructor(t){this.visibilityDidChange=this.visibilityDidChange.bind(this),this.connection=t,this.reconnectAttempts=0}start(){this.isRunning()||(this.startedAt=yT(),delete this.stoppedAt,this.startPolling(),addEventListener("visibilitychange",this.visibilityDidChange),vT.log(`ConnectionMonitor started. stale threshold = ${this.constructor.staleThreshold} s`))}stop(){this.isRunning()&&(this.stoppedAt=yT(),this.stopPolling(),removeEventListener("visibilitychange",this.visibilityDidChange),vT.log("ConnectionMonitor stopped"))}isRunning(){return this.startedAt&&!this.stoppedAt}recordPing(){this.pingedAt=yT()}recordConnect(){this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,vT.log("ConnectionMonitor recorded connect")}recordDisconnect(){this.disconnectedAt=yT(),vT.log("ConnectionMonitor recorded disconnect")}startPolling(){this.stopPolling(),this.poll()}stopPolling(){clearTimeout(this.pollTimeout)}poll(){this.pollTimeout=setTimeout((()=>{this.reconnectIfStale(),this.poll()}),this.getPollInterval())}getPollInterval(){const{staleThreshold:t,reconnectionBackoffRate:e}=this.constructor;return 1e3*t*Math.pow(1+e,Math.min(this.reconnectAttempts,10))*(1+(0===this.reconnectAttempts?1:e)*Math.random())}reconnectIfStale(){this.connectionIsStale()&&(vT.log(`ConnectionMonitor detected stale connection. reconnectAttempts = ${this.reconnectAttempts}, time stale = ${wT(this.refreshedAt)} s, stale threshold = ${this.constructor.staleThreshold} s`),this.reconnectAttempts++,this.disconnectedRecently()?vT.log(`ConnectionMonitor skipping reopening recent disconnect. time disconnected = ${wT(this.disconnectedAt)} s`):(vT.log("ConnectionMonitor reopening"),this.connection.reopen()))}get refreshedAt(){return this.pingedAt?this.pingedAt:this.startedAt}connectionIsStale(){return wT(this.refreshedAt)>this.constructor.staleThreshold}disconnectedRecently(){return this.disconnectedAt&&wT(this.disconnectedAt)<this.constructor.staleThreshold}visibilityDidChange(){"visible"===document.visibilityState&&setTimeout((()=>{!this.connectionIsStale()&&this.connection.isOpen()||(vT.log(`ConnectionMonitor reopening stale connection on visibilitychange. visibilityState = ${document.visibilityState}`),this.connection.reopen())}),200)}}kT.staleThreshold=6,kT.reconnectionBackoffRate=.15;var ST=kT,xT={message_types:{welcome:"welcome",disconnect:"disconnect",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},disconnect_reasons:{unauthorized:"unauthorized",invalid_request:"invalid_request",server_restart:"server_restart"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]};const{message_types:ET,protocols:CT}=xT,_T=CT.slice(0,CT.length-1),AT=[].indexOf;class OT{constructor(t){this.open=this.open.bind(this),this.consumer=t,this.subscriptions=this.consumer.subscriptions,this.monitor=new ST(this),this.disconnected=!0}send(t){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(t)),!0)}open(){return this.isActive()?(vT.log(`Attempted to open WebSocket, but existing socket is ${this.getState()}`),!1):(vT.log(`Opening WebSocket, current state is ${this.getState()}, subprotocols: ${CT}`),this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new bT.WebSocket(this.consumer.url,CT),this.installEventHandlers(),this.monitor.start(),!0)}close({allowReconnect:t}={allowReconnect:!0}){if(t||this.monitor.stop(),this.isOpen())return this.webSocket.close()}reopen(){if(vT.log(`Reopening WebSocket, current state is ${this.getState()}`),!this.isActive())return this.open();try{return this.close()}catch(t){vT.log("Failed to reopen WebSocket",t)}finally{vT.log(`Reopening WebSocket in ${this.constructor.reopenDelay}ms`),setTimeout(this.open,this.constructor.reopenDelay)}}getProtocol(){if(this.webSocket)return this.webSocket.protocol}isOpen(){return this.isState("open")}isActive(){return this.isState("open","connecting")}isProtocolSupported(){return AT.call(_T,this.getProtocol())>=0}isState(...t){return AT.call(t,this.getState())>=0}getState(){if(this.webSocket)for(let t in bT.WebSocket)if(bT.WebSocket[t]===this.webSocket.readyState)return t.toLowerCase();return null}installEventHandlers(){for(let t in this.events){const e=this.events[t].bind(this);this.webSocket[`on${t}`]=e}}uninstallEventHandlers(){for(let t in this.events)this.webSocket[`on${t}`]=function(){}}}OT.reopenDelay=500,OT.prototype.events={message(t){if(!this.isProtocolSupported())return;const{identifier:e,message:n,reason:i,reconnect:r,type:s}=JSON.parse(t.data);switch(s){case ET.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case ET.disconnect:return vT.log(`Disconnecting. Reason: ${i}`),this.close({allowReconnect:r});case ET.ping:return this.monitor.recordPing();case ET.confirmation:return this.subscriptions.confirmSubscription(e),this.subscriptions.notify(e,"connected");case ET.rejection:return this.subscriptions.reject(e);default:return this.subscriptions.notify(e,"received",n)}},open(){if(vT.log(`WebSocket onopen event, using '${this.getProtocol()}' subprotocol`),this.disconnected=!1,!this.isProtocolSupported())return vT.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close(t){if(vT.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error(){vT.log("WebSocket onerror event")}};var TT=OT;class MT{constructor(t,e={},n){this.consumer=t,this.identifier=JSON.stringify(e),function(t,e){if(null!=e)for(let n in e){const i=e[n];t[n]=i}}(this,n)}perform(t,e={}){return e.action=t,this.send(e)}send(t){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(t)})}unsubscribe(){return this.consumer.subscriptions.remove(this)}}var DT=class{constructor(t){this.subscriptions=t,this.pendingSubscriptions=[]}guarantee(t){-1==this.pendingSubscriptions.indexOf(t)?(vT.log(`SubscriptionGuarantor guaranteeing ${t.identifier}`),this.pendingSubscriptions.push(t)):vT.log(`SubscriptionGuarantor already guaranteeing ${t.identifier}`),this.startGuaranteeing()}forget(t){vT.log(`SubscriptionGuarantor forgetting ${t.identifier}`),this.pendingSubscriptions=this.pendingSubscriptions.filter((e=>e!==t))}startGuaranteeing(){this.stopGuaranteeing(),this.retrySubscribing()}stopGuaranteeing(){clearTimeout(this.retryTimeout)}retrySubscribing(){this.retryTimeout=setTimeout((()=>{this.subscriptions&&"function"==typeof this.subscriptions.subscribe&&this.pendingSubscriptions.map((t=>{vT.log(`SubscriptionGuarantor resubscribing ${t.identifier}`),this.subscriptions.subscribe(t)}))}),500)}};class LT{constructor(t){this.consumer=t,this.guarantor=new DT(this),this.subscriptions=[]}create(t,e){const n="object"==typeof t?t:{channel:t},i=new MT(this.consumer,n,e);return this.add(i)}add(t){return this.subscriptions.push(t),this.consumer.ensureActiveConnection(),this.notify(t,"initialized"),this.subscribe(t),t}remove(t){return this.forget(t),this.findAll(t.identifier).length||this.sendCommand(t,"unsubscribe"),t}reject(t){return this.findAll(t).map((t=>(this.forget(t),this.notify(t,"rejected"),t)))}forget(t){return this.guarantor.forget(t),this.subscriptions=this.subscriptions.filter((e=>e!==t)),t}findAll(t){return this.subscriptions.filter((e=>e.identifier===t))}reload(){return this.subscriptions.map((t=>this.subscribe(t)))}notifyAll(t,...e){return this.subscriptions.map((n=>this.notify(n,t,...e)))}notify(t,e,...n){let i;return i="string"==typeof t?this.findAll(t):[t],i.map((t=>"function"==typeof t[e]?t[e](...n):void 0))}subscribe(t){this.sendCommand(t,"subscribe")&&this.guarantor.guarantee(t)}confirmSubscription(t){vT.log(`Subscription confirmed ${t}`),this.findAll(t).map((t=>this.guarantor.forget(t)))}sendCommand(t,e){const{identifier:n}=t;return this.consumer.send({command:e,identifier:n})}}class NT{constructor(t){this._url=t,this.subscriptions=new LT(this),this.connection=new TT(this)}get url(){return IT(this._url)}send(t){return this.connection.send(t)}connect(){return this.connection.open()}disconnect(){return this.connection.close({allowReconnect:!1})}ensureActiveConnection(){if(!this.connection.isActive())return this.connection.open()}}function IT(t){if("function"==typeof t&&(t=t()),t&&!/^wss?:/i.test(t)){const e=document.createElement("a");return e.href=t,e.href=e.href,e.protocol=e.protocol.replace("http","ws"),e.href}return t}function PT(t){const e=document.head.querySelector(`meta[name='action-cable-${t}']`);if(e)return e.getAttribute("content")}var $T=Object.freeze({__proto__:null,Connection:TT,ConnectionMonitor:ST,Consumer:NT,INTERNAL:xT,Subscription:MT,Subscriptions:LT,SubscriptionGuarantor:DT,adapters:bT,createWebSocketURL:IT,logger:vT,createConsumer:function(t=PT("url")||xT.default_mount_path){return new NT(t)},getConfig:PT})}));
//# sourceMappingURL=aypex_admin.min.js.map
